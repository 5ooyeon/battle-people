var aM=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var woe=aM((Coe,ZA)=>{function xk(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var me=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ms(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function sM(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}var Ek={exports:{}},bv={},Sk={exports:{}},tt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _d=Symbol.for("react.element"),uM=Symbol.for("react.portal"),cM=Symbol.for("react.fragment"),lM=Symbol.for("react.strict_mode"),dM=Symbol.for("react.profiler"),fM=Symbol.for("react.provider"),hM=Symbol.for("react.context"),pM=Symbol.for("react.forward_ref"),vM=Symbol.for("react.suspense"),mM=Symbol.for("react.memo"),gM=Symbol.for("react.lazy"),hE=Symbol.iterator;function yM(e){return e===null||typeof e!="object"?null:(e=hE&&e[hE]||e["@@iterator"],typeof e=="function"?e:null)}var Ck={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_k=Object.assign,kk={};function wc(e,t,n){this.props=e,this.context=t,this.refs=kk,this.updater=n||Ck}wc.prototype.isReactComponent={};wc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};wc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Rk(){}Rk.prototype=wc.prototype;function mb(e,t,n){this.props=e,this.context=t,this.refs=kk,this.updater=n||Ck}var gb=mb.prototype=new Rk;gb.constructor=mb;_k(gb,wc.prototype);gb.isPureReactComponent=!0;var pE=Array.isArray,Ik=Object.prototype.hasOwnProperty,yb={current:null},Tk={key:!0,ref:!0,__self:!0,__source:!0};function Ok(e,t,n){var r,i={},o=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(o=""+t.key),t)Ik.call(t,r)&&!Tk.hasOwnProperty(r)&&(i[r]=t[r]);var s=arguments.length-2;if(s===1)i.children=n;else if(1<s){for(var u=Array(s),c=0;c<s;c++)u[c]=arguments[c+2];i.children=u}if(e&&e.defaultProps)for(r in s=e.defaultProps,s)i[r]===void 0&&(i[r]=s[r]);return{$$typeof:_d,type:e,key:o,ref:a,props:i,_owner:yb.current}}function bM(e,t){return{$$typeof:_d,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function bb(e){return typeof e=="object"&&e!==null&&e.$$typeof===_d}function wM(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var vE=/\/+/g;function tg(e,t){return typeof e=="object"&&e!==null&&e.key!=null?wM(""+e.key):t.toString(36)}function bh(e,t,n,r,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case _d:case uM:a=!0}}if(a)return a=e,i=i(a),e=r===""?"."+tg(a,0):r,pE(i)?(n="",e!=null&&(n=e.replace(vE,"$&/")+"/"),bh(i,t,n,"",function(c){return c})):i!=null&&(bb(i)&&(i=bM(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(vE,"$&/")+"/")+e)),t.push(i)),1;if(a=0,r=r===""?".":r+":",pE(e))for(var s=0;s<e.length;s++){o=e[s];var u=r+tg(o,s);a+=bh(o,t,n,u,i)}else if(u=yM(e),typeof u=="function")for(e=u.call(e),s=0;!(o=e.next()).done;)o=o.value,u=r+tg(o,s++),a+=bh(o,t,n,u,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function bf(e,t,n){if(e==null)return e;var r=[],i=0;return bh(e,r,"","",function(o){return t.call(n,o,i++)}),r}function xM(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var dr={current:null},wh={transition:null},EM={ReactCurrentDispatcher:dr,ReactCurrentBatchConfig:wh,ReactCurrentOwner:yb};function Pk(){throw Error("act(...) is not supported in production builds of React.")}tt.Children={map:bf,forEach:function(e,t,n){bf(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return bf(e,function(){t++}),t},toArray:function(e){return bf(e,function(t){return t})||[]},only:function(e){if(!bb(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};tt.Component=wc;tt.Fragment=cM;tt.Profiler=dM;tt.PureComponent=mb;tt.StrictMode=lM;tt.Suspense=vM;tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EM;tt.act=Pk;tt.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=_k({},e.props),i=e.key,o=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,a=yb.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(u in t)Ik.call(t,u)&&!Tk.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&s!==void 0?s[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){s=Array(u);for(var c=0;c<u;c++)s[c]=arguments[c+2];r.children=s}return{$$typeof:_d,type:e.type,key:i,ref:o,props:r,_owner:a}};tt.createContext=function(e){return e={$$typeof:hM,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:fM,_context:e},e.Consumer=e};tt.createElement=Ok;tt.createFactory=function(e){var t=Ok.bind(null,e);return t.type=e,t};tt.createRef=function(){return{current:null}};tt.forwardRef=function(e){return{$$typeof:pM,render:e}};tt.isValidElement=bb;tt.lazy=function(e){return{$$typeof:gM,_payload:{_status:-1,_result:e},_init:xM}};tt.memo=function(e,t){return{$$typeof:mM,type:e,compare:t===void 0?null:t}};tt.startTransition=function(e){var t=wh.transition;wh.transition={};try{e()}finally{wh.transition=t}};tt.unstable_act=Pk;tt.useCallback=function(e,t){return dr.current.useCallback(e,t)};tt.useContext=function(e){return dr.current.useContext(e)};tt.useDebugValue=function(){};tt.useDeferredValue=function(e){return dr.current.useDeferredValue(e)};tt.useEffect=function(e,t){return dr.current.useEffect(e,t)};tt.useId=function(){return dr.current.useId()};tt.useImperativeHandle=function(e,t,n){return dr.current.useImperativeHandle(e,t,n)};tt.useInsertionEffect=function(e,t){return dr.current.useInsertionEffect(e,t)};tt.useLayoutEffect=function(e,t){return dr.current.useLayoutEffect(e,t)};tt.useMemo=function(e,t){return dr.current.useMemo(e,t)};tt.useReducer=function(e,t,n){return dr.current.useReducer(e,t,n)};tt.useRef=function(e){return dr.current.useRef(e)};tt.useState=function(e){return dr.current.useState(e)};tt.useSyncExternalStore=function(e,t,n){return dr.current.useSyncExternalStore(e,t,n)};tt.useTransition=function(){return dr.current.useTransition()};tt.version="18.3.1";Sk.exports=tt;var O=Sk.exports;const we=Ms(O),zh=xk({__proto__:null,default:we},[O]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SM=O,CM=Symbol.for("react.element"),_M=Symbol.for("react.fragment"),kM=Object.prototype.hasOwnProperty,RM=SM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,IM={key:!0,ref:!0,__self:!0,__source:!0};function Nk(e,t,n){var r,i={},o=null,a=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)kM.call(t,r)&&!IM.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:CM,type:e,key:o,ref:a,props:i,_owner:RM.current}}bv.Fragment=_M;bv.jsx=Nk;bv.jsxs=Nk;Ek.exports=bv;var C=Ek.exports,sy={},Dk={exports:{}},Gr={},Ak={exports:{}},Mk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(N,j){var P=N.length;N.push(j);e:for(;0<P;){var A=P-1>>>1,U=N[A];if(0<i(U,j))N[A]=j,N[P]=U,P=A;else break e}}function n(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var j=N[0],P=N.pop();if(P!==j){N[0]=P;e:for(var A=0,U=N.length,H=U>>>1;A<H;){var q=2*(A+1)-1,Q=N[q],V=q+1,re=N[V];if(0>i(Q,P))V<U&&0>i(re,Q)?(N[A]=re,N[V]=P,A=V):(N[A]=Q,N[q]=P,A=q);else if(V<U&&0>i(re,P))N[A]=re,N[V]=P,A=V;else break e}}return j}function i(N,j){var P=N.sortIndex-j.sortIndex;return P!==0?P:N.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var a=Date,s=a.now();e.unstable_now=function(){return a.now()-s}}var u=[],c=[],l=1,d=null,f=3,h=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(N){for(var j=n(c);j!==null;){if(j.callback===null)r(c);else if(j.startTime<=N)r(c),j.sortIndex=j.expirationTime,t(u,j);else break;j=n(c)}}function w(N){if(m=!1,b(N),!p)if(n(u)!==null)p=!0,M(E);else{var j=n(c);j!==null&&I(w,j.startTime-N)}}function E(N,j){p=!1,m&&(m=!1,v(S),S=-1),h=!0;var P=f;try{for(b(j),d=n(u);d!==null&&(!(d.expirationTime>j)||N&&!B());){var A=d.callback;if(typeof A=="function"){d.callback=null,f=d.priorityLevel;var U=A(d.expirationTime<=j);j=e.unstable_now(),typeof U=="function"?d.callback=U:d===n(u)&&r(u),b(j)}else r(u);d=n(u)}if(d!==null)var H=!0;else{var q=n(c);q!==null&&I(w,q.startTime-j),H=!1}return H}finally{d=null,f=P,h=!1}}var x=!1,R=null,S=-1,_=5,T=-1;function B(){return!(e.unstable_now()-T<_)}function L(){if(R!==null){var N=e.unstable_now();T=N;var j=!0;try{j=R(!0,N)}finally{j?k():(x=!1,R=null)}}else x=!1}var k;if(typeof y=="function")k=function(){y(L)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,F=D.port2;D.port1.onmessage=L,k=function(){F.postMessage(null)}}else k=function(){g(L,0)};function M(N){R=N,x||(x=!0,k())}function I(N,j){S=g(function(){N(e.unstable_now())},j)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(N){N.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,M(E))},e.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<N?Math.floor(1e3/N):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(N){switch(f){case 1:case 2:case 3:var j=3;break;default:j=f}var P=f;f=j;try{return N()}finally{f=P}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(N,j){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var P=f;f=N;try{return j()}finally{f=P}},e.unstable_scheduleCallback=function(N,j,P){var A=e.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?A+P:A):P=A,N){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=P+U,N={id:l++,callback:j,priorityLevel:N,startTime:P,expirationTime:U,sortIndex:-1},P>A?(N.sortIndex=P,t(c,N),n(u)===null&&N===n(c)&&(m?(v(S),S=-1):m=!0,I(w,P-A))):(N.sortIndex=U,t(u,N),p||h||(p=!0,M(E))),N},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(N){var j=f;return function(){var P=f;f=j;try{return N.apply(this,arguments)}finally{f=P}}}})(Mk);Ak.exports=Mk;var TM=Ak.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OM=O,Hr=TM;function fe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Lk=new Set,Vl={};function Ls(e,t){Ku(e,t),Ku(e+"Capture",t)}function Ku(e,t){for(Vl[e]=t,e=0;e<t.length;e++)Lk.add(t[e])}var ko=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),uy=Object.prototype.hasOwnProperty,PM=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,mE={},gE={};function NM(e){return uy.call(gE,e)?!0:uy.call(mE,e)?!1:PM.test(e)?gE[e]=!0:(mE[e]=!0,!1)}function DM(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function AM(e,t,n,r){if(t===null||typeof t>"u"||DM(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function fr(e,t,n,r,i,o,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var Dn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Dn[e]=new fr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Dn[t]=new fr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Dn[e]=new fr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Dn[e]=new fr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Dn[e]=new fr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Dn[e]=new fr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Dn[e]=new fr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Dn[e]=new fr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Dn[e]=new fr(e,5,!1,e.toLowerCase(),null,!1,!1)});var wb=/[\-:]([a-z])/g;function xb(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(wb,xb);Dn[t]=new fr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(wb,xb);Dn[t]=new fr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(wb,xb);Dn[t]=new fr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Dn[e]=new fr(e,1,!1,e.toLowerCase(),null,!1,!1)});Dn.xlinkHref=new fr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Dn[e]=new fr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Eb(e,t,n,r){var i=Dn.hasOwnProperty(t)?Dn[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(AM(t,n,i,r)&&(n=null),r||i===null?NM(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Oo=OM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wf=Symbol.for("react.element"),gu=Symbol.for("react.portal"),yu=Symbol.for("react.fragment"),Sb=Symbol.for("react.strict_mode"),cy=Symbol.for("react.profiler"),Fk=Symbol.for("react.provider"),Bk=Symbol.for("react.context"),Cb=Symbol.for("react.forward_ref"),ly=Symbol.for("react.suspense"),dy=Symbol.for("react.suspense_list"),_b=Symbol.for("react.memo"),Zo=Symbol.for("react.lazy"),jk=Symbol.for("react.offscreen"),yE=Symbol.iterator;function Hc(e){return e===null||typeof e!="object"?null:(e=yE&&e[yE]||e["@@iterator"],typeof e=="function"?e:null)}var jt=Object.assign,ng;function vl(e){if(ng===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ng=t&&t[1]||""}return`
`+ng+e}var rg=!1;function ig(e,t){if(!e||rg)return"";rg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),o=r.stack.split(`
`),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(a!==1||s!==1)do if(a--,s--,0>s||i[a]!==o[s]){var u=`
`+i[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=a&&0<=s);break}}}finally{rg=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?vl(e):""}function MM(e){switch(e.tag){case 5:return vl(e.type);case 16:return vl("Lazy");case 13:return vl("Suspense");case 19:return vl("SuspenseList");case 0:case 2:case 15:return e=ig(e.type,!1),e;case 11:return e=ig(e.type.render,!1),e;case 1:return e=ig(e.type,!0),e;default:return""}}function fy(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case yu:return"Fragment";case gu:return"Portal";case cy:return"Profiler";case Sb:return"StrictMode";case ly:return"Suspense";case dy:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Bk:return(e.displayName||"Context")+".Consumer";case Fk:return(e._context.displayName||"Context")+".Provider";case Cb:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case _b:return t=e.displayName||null,t!==null?t:fy(e.type)||"Memo";case Zo:t=e._payload,e=e._init;try{return fy(e(t))}catch{}}return null}function LM(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return fy(t);case 8:return t===Sb?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function _a(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function $k(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function FM(e){var t=$k(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function xf(e){e._valueTracker||(e._valueTracker=FM(e))}function Vk(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=$k(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Hh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function hy(e,t){var n=t.checked;return jt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function bE(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=_a(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Wk(e,t){t=t.checked,t!=null&&Eb(e,"checked",t,!1)}function py(e,t){Wk(e,t);var n=_a(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?vy(e,t.type,n):t.hasOwnProperty("defaultValue")&&vy(e,t.type,_a(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function wE(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function vy(e,t,n){(t!=="number"||Hh(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ml=Array.isArray;function Nu(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+_a(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function my(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(fe(91));return jt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function xE(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(fe(92));if(ml(n)){if(1<n.length)throw Error(fe(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:_a(n)}}function Uk(e,t){var n=_a(t.value),r=_a(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function EE(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function zk(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gy(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?zk(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ef,Hk=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ef=Ef||document.createElement("div"),Ef.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ef.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Wl(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Sl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},BM=["Webkit","ms","Moz","O"];Object.keys(Sl).forEach(function(e){BM.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Sl[t]=Sl[e]})});function Gk(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Sl.hasOwnProperty(e)&&Sl[e]?(""+t).trim():t+"px"}function qk(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Gk(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var jM=jt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yy(e,t){if(t){if(jM[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(fe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(fe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(fe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(fe(62))}}function by(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wy=null;function kb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var xy=null,Du=null,Au=null;function SE(e){if(e=Id(e)){if(typeof xy!="function")throw Error(fe(280));var t=e.stateNode;t&&(t=Cv(t),xy(e.stateNode,e.type,t))}}function Xk(e){Du?Au?Au.push(e):Au=[e]:Du=e}function Kk(){if(Du){var e=Du,t=Au;if(Au=Du=null,SE(e),t)for(e=0;e<t.length;e++)SE(t[e])}}function Yk(e,t){return e(t)}function Qk(){}var og=!1;function Jk(e,t,n){if(og)return e(t,n);og=!0;try{return Yk(e,t,n)}finally{og=!1,(Du!==null||Au!==null)&&(Qk(),Kk())}}function Ul(e,t){var n=e.stateNode;if(n===null)return null;var r=Cv(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(fe(231,t,typeof n));return n}var Ey=!1;if(ko)try{var Gc={};Object.defineProperty(Gc,"passive",{get:function(){Ey=!0}}),window.addEventListener("test",Gc,Gc),window.removeEventListener("test",Gc,Gc)}catch{Ey=!1}function $M(e,t,n,r,i,o,a,s,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var Cl=!1,Gh=null,qh=!1,Sy=null,VM={onError:function(e){Cl=!0,Gh=e}};function WM(e,t,n,r,i,o,a,s,u){Cl=!1,Gh=null,$M.apply(VM,arguments)}function UM(e,t,n,r,i,o,a,s,u){if(WM.apply(this,arguments),Cl){if(Cl){var c=Gh;Cl=!1,Gh=null}else throw Error(fe(198));qh||(qh=!0,Sy=c)}}function Fs(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Zk(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function CE(e){if(Fs(e)!==e)throw Error(fe(188))}function zM(e){var t=e.alternate;if(!t){if(t=Fs(e),t===null)throw Error(fe(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return CE(i),e;if(o===r)return CE(i),t;o=o.sibling}throw Error(fe(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,s=i.child;s;){if(s===n){a=!0,n=i,r=o;break}if(s===r){a=!0,r=i,n=o;break}s=s.sibling}if(!a){for(s=o.child;s;){if(s===n){a=!0,n=o,r=i;break}if(s===r){a=!0,r=o,n=i;break}s=s.sibling}if(!a)throw Error(fe(189))}}if(n.alternate!==r)throw Error(fe(190))}if(n.tag!==3)throw Error(fe(188));return n.stateNode.current===n?e:t}function eR(e){return e=zM(e),e!==null?tR(e):null}function tR(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=tR(e);if(t!==null)return t;e=e.sibling}return null}var nR=Hr.unstable_scheduleCallback,_E=Hr.unstable_cancelCallback,HM=Hr.unstable_shouldYield,GM=Hr.unstable_requestPaint,Xt=Hr.unstable_now,qM=Hr.unstable_getCurrentPriorityLevel,Rb=Hr.unstable_ImmediatePriority,rR=Hr.unstable_UserBlockingPriority,Xh=Hr.unstable_NormalPriority,XM=Hr.unstable_LowPriority,iR=Hr.unstable_IdlePriority,wv=null,Ji=null;function KM(e){if(Ji&&typeof Ji.onCommitFiberRoot=="function")try{Ji.onCommitFiberRoot(wv,e,void 0,(e.current.flags&128)===128)}catch{}}var Ei=Math.clz32?Math.clz32:JM,YM=Math.log,QM=Math.LN2;function JM(e){return e>>>=0,e===0?32:31-(YM(e)/QM|0)|0}var Sf=64,Cf=4194304;function gl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Kh(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,a=n&268435455;if(a!==0){var s=a&~i;s!==0?r=gl(s):(o&=a,o!==0&&(r=gl(o)))}else a=n&~i,a!==0?r=gl(a):o!==0&&(r=gl(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Ei(t),i=1<<n,r|=e[n],t&=~i;return r}function ZM(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function e3(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-Ei(o),s=1<<a,u=i[a];u===-1?(!(s&n)||s&r)&&(i[a]=ZM(s,t)):u<=t&&(e.expiredLanes|=s),o&=~s}}function Cy(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function oR(){var e=Sf;return Sf<<=1,!(Sf&4194240)&&(Sf=64),e}function ag(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function kd(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ei(t),e[t]=n}function t3(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Ei(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}function Ib(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ei(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var ht=0;function aR(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var sR,Tb,uR,cR,lR,_y=!1,_f=[],fa=null,ha=null,pa=null,zl=new Map,Hl=new Map,na=[],n3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kE(e,t){switch(e){case"focusin":case"focusout":fa=null;break;case"dragenter":case"dragleave":ha=null;break;case"mouseover":case"mouseout":pa=null;break;case"pointerover":case"pointerout":zl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hl.delete(t.pointerId)}}function qc(e,t,n,r,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},t!==null&&(t=Id(t),t!==null&&Tb(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function r3(e,t,n,r,i){switch(t){case"focusin":return fa=qc(fa,e,t,n,r,i),!0;case"dragenter":return ha=qc(ha,e,t,n,r,i),!0;case"mouseover":return pa=qc(pa,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return zl.set(o,qc(zl.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Hl.set(o,qc(Hl.get(o)||null,e,t,n,r,i)),!0}return!1}function dR(e){var t=ts(e.target);if(t!==null){var n=Fs(t);if(n!==null){if(t=n.tag,t===13){if(t=Zk(n),t!==null){e.blockedOn=t,lR(e.priority,function(){uR(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function xh(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=ky(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);wy=r,n.target.dispatchEvent(r),wy=null}else return t=Id(n),t!==null&&Tb(t),e.blockedOn=n,!1;t.shift()}return!0}function RE(e,t,n){xh(e)&&n.delete(t)}function i3(){_y=!1,fa!==null&&xh(fa)&&(fa=null),ha!==null&&xh(ha)&&(ha=null),pa!==null&&xh(pa)&&(pa=null),zl.forEach(RE),Hl.forEach(RE)}function Xc(e,t){e.blockedOn===t&&(e.blockedOn=null,_y||(_y=!0,Hr.unstable_scheduleCallback(Hr.unstable_NormalPriority,i3)))}function Gl(e){function t(i){return Xc(i,e)}if(0<_f.length){Xc(_f[0],e);for(var n=1;n<_f.length;n++){var r=_f[n];r.blockedOn===e&&(r.blockedOn=null)}}for(fa!==null&&Xc(fa,e),ha!==null&&Xc(ha,e),pa!==null&&Xc(pa,e),zl.forEach(t),Hl.forEach(t),n=0;n<na.length;n++)r=na[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<na.length&&(n=na[0],n.blockedOn===null);)dR(n),n.blockedOn===null&&na.shift()}var Mu=Oo.ReactCurrentBatchConfig,Yh=!0;function o3(e,t,n,r){var i=ht,o=Mu.transition;Mu.transition=null;try{ht=1,Ob(e,t,n,r)}finally{ht=i,Mu.transition=o}}function a3(e,t,n,r){var i=ht,o=Mu.transition;Mu.transition=null;try{ht=4,Ob(e,t,n,r)}finally{ht=i,Mu.transition=o}}function Ob(e,t,n,r){if(Yh){var i=ky(e,t,n,r);if(i===null)mg(e,t,r,Qh,n),kE(e,r);else if(r3(i,e,t,n,r))r.stopPropagation();else if(kE(e,r),t&4&&-1<n3.indexOf(e)){for(;i!==null;){var o=Id(i);if(o!==null&&sR(o),o=ky(e,t,n,r),o===null&&mg(e,t,r,Qh,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else mg(e,t,r,null,n)}}var Qh=null;function ky(e,t,n,r){if(Qh=null,e=kb(r),e=ts(e),e!==null)if(t=Fs(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Zk(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qh=e,null}function fR(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qM()){case Rb:return 1;case rR:return 4;case Xh:case XM:return 16;case iR:return 536870912;default:return 16}default:return 16}}var oa=null,Pb=null,Eh=null;function hR(){if(Eh)return Eh;var e,t=Pb,n=t.length,r,i="value"in oa?oa.value:oa.textContent,o=i.length;for(e=0;e<n&&t[e]===i[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===i[o-r];r++);return Eh=i.slice(e,1<r?1-r:void 0)}function Sh(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function kf(){return!0}function IE(){return!1}function qr(e){function t(n,r,i,o,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(n=e[s],this[s]=n?n(o):o[s]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?kf:IE,this.isPropagationStopped=IE,this}return jt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=kf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=kf)},persist:function(){},isPersistent:kf}),t}var xc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nb=qr(xc),Rd=jt({},xc,{view:0,detail:0}),s3=qr(Rd),sg,ug,Kc,xv=jt({},Rd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Db,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Kc&&(Kc&&e.type==="mousemove"?(sg=e.screenX-Kc.screenX,ug=e.screenY-Kc.screenY):ug=sg=0,Kc=e),sg)},movementY:function(e){return"movementY"in e?e.movementY:ug}}),TE=qr(xv),u3=jt({},xv,{dataTransfer:0}),c3=qr(u3),l3=jt({},Rd,{relatedTarget:0}),cg=qr(l3),d3=jt({},xc,{animationName:0,elapsedTime:0,pseudoElement:0}),f3=qr(d3),h3=jt({},xc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),p3=qr(h3),v3=jt({},xc,{data:0}),OE=qr(v3),m3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},g3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},y3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function b3(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=y3[e])?!!t[e]:!1}function Db(){return b3}var w3=jt({},Rd,{key:function(e){if(e.key){var t=m3[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Sh(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?g3[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Db,charCode:function(e){return e.type==="keypress"?Sh(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Sh(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),x3=qr(w3),E3=jt({},xv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),PE=qr(E3),S3=jt({},Rd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Db}),C3=qr(S3),_3=jt({},xc,{propertyName:0,elapsedTime:0,pseudoElement:0}),k3=qr(_3),R3=jt({},xv,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),I3=qr(R3),T3=[9,13,27,32],Ab=ko&&"CompositionEvent"in window,_l=null;ko&&"documentMode"in document&&(_l=document.documentMode);var O3=ko&&"TextEvent"in window&&!_l,pR=ko&&(!Ab||_l&&8<_l&&11>=_l),NE=" ",DE=!1;function vR(e,t){switch(e){case"keyup":return T3.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mR(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var bu=!1;function P3(e,t){switch(e){case"compositionend":return mR(t);case"keypress":return t.which!==32?null:(DE=!0,NE);case"textInput":return e=t.data,e===NE&&DE?null:e;default:return null}}function N3(e,t){if(bu)return e==="compositionend"||!Ab&&vR(e,t)?(e=hR(),Eh=Pb=oa=null,bu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return pR&&t.locale!=="ko"?null:t.data;default:return null}}var D3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function AE(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!D3[e.type]:t==="textarea"}function gR(e,t,n,r){Xk(r),t=Jh(t,"onChange"),0<t.length&&(n=new Nb("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var kl=null,ql=null;function A3(e){IR(e,0)}function Ev(e){var t=Eu(e);if(Vk(t))return e}function M3(e,t){if(e==="change")return t}var yR=!1;if(ko){var lg;if(ko){var dg="oninput"in document;if(!dg){var ME=document.createElement("div");ME.setAttribute("oninput","return;"),dg=typeof ME.oninput=="function"}lg=dg}else lg=!1;yR=lg&&(!document.documentMode||9<document.documentMode)}function LE(){kl&&(kl.detachEvent("onpropertychange",bR),ql=kl=null)}function bR(e){if(e.propertyName==="value"&&Ev(ql)){var t=[];gR(t,ql,e,kb(e)),Jk(A3,t)}}function L3(e,t,n){e==="focusin"?(LE(),kl=t,ql=n,kl.attachEvent("onpropertychange",bR)):e==="focusout"&&LE()}function F3(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ev(ql)}function B3(e,t){if(e==="click")return Ev(t)}function j3(e,t){if(e==="input"||e==="change")return Ev(t)}function $3(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ri=typeof Object.is=="function"?Object.is:$3;function Xl(e,t){if(Ri(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!uy.call(t,i)||!Ri(e[i],t[i]))return!1}return!0}function FE(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function BE(e,t){var n=FE(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=FE(n)}}function wR(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?wR(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function xR(){for(var e=window,t=Hh();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Hh(e.document)}return t}function Mb(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function V3(e){var t=xR(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&wR(n.ownerDocument.documentElement,n)){if(r!==null&&Mb(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=BE(n,o);var a=BE(n,r);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var W3=ko&&"documentMode"in document&&11>=document.documentMode,wu=null,Ry=null,Rl=null,Iy=!1;function jE(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Iy||wu==null||wu!==Hh(r)||(r=wu,"selectionStart"in r&&Mb(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Rl&&Xl(Rl,r)||(Rl=r,r=Jh(Ry,"onSelect"),0<r.length&&(t=new Nb("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=wu)))}function Rf(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var xu={animationend:Rf("Animation","AnimationEnd"),animationiteration:Rf("Animation","AnimationIteration"),animationstart:Rf("Animation","AnimationStart"),transitionend:Rf("Transition","TransitionEnd")},fg={},ER={};ko&&(ER=document.createElement("div").style,"AnimationEvent"in window||(delete xu.animationend.animation,delete xu.animationiteration.animation,delete xu.animationstart.animation),"TransitionEvent"in window||delete xu.transitionend.transition);function Sv(e){if(fg[e])return fg[e];if(!xu[e])return e;var t=xu[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in ER)return fg[e]=t[n];return e}var SR=Sv("animationend"),CR=Sv("animationiteration"),_R=Sv("animationstart"),kR=Sv("transitionend"),RR=new Map,$E="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Da(e,t){RR.set(e,t),Ls(t,[e])}for(var hg=0;hg<$E.length;hg++){var pg=$E[hg],U3=pg.toLowerCase(),z3=pg[0].toUpperCase()+pg.slice(1);Da(U3,"on"+z3)}Da(SR,"onAnimationEnd");Da(CR,"onAnimationIteration");Da(_R,"onAnimationStart");Da("dblclick","onDoubleClick");Da("focusin","onFocus");Da("focusout","onBlur");Da(kR,"onTransitionEnd");Ku("onMouseEnter",["mouseout","mouseover"]);Ku("onMouseLeave",["mouseout","mouseover"]);Ku("onPointerEnter",["pointerout","pointerover"]);Ku("onPointerLeave",["pointerout","pointerover"]);Ls("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ls("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ls("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ls("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ls("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ls("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),H3=new Set("cancel close invalid load scroll toggle".split(" ").concat(yl));function VE(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,UM(r,t,void 0,e),e.currentTarget=null}function IR(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==o&&i.isPropagationStopped())break e;VE(i,s,c),o=u}else for(a=0;a<r.length;a++){if(s=r[a],u=s.instance,c=s.currentTarget,s=s.listener,u!==o&&i.isPropagationStopped())break e;VE(i,s,c),o=u}}}if(qh)throw e=Sy,qh=!1,Sy=null,e}function _t(e,t){var n=t[Dy];n===void 0&&(n=t[Dy]=new Set);var r=e+"__bubble";n.has(r)||(TR(t,e,2,!1),n.add(r))}function vg(e,t,n){var r=0;t&&(r|=4),TR(n,e,r,t)}var If="_reactListening"+Math.random().toString(36).slice(2);function Kl(e){if(!e[If]){e[If]=!0,Lk.forEach(function(n){n!=="selectionchange"&&(H3.has(n)||vg(n,!1,e),vg(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[If]||(t[If]=!0,vg("selectionchange",!1,t))}}function TR(e,t,n,r){switch(fR(t)){case 1:var i=o3;break;case 4:i=a3;break;default:i=Ob}n=i.bind(null,t,n,e),i=void 0,!Ey||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function mg(e,t,n,r,i){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var s=r.stateNode.containerInfo;if(s===i||s.nodeType===8&&s.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;a=a.return}for(;s!==null;){if(a=ts(s),a===null)return;if(u=a.tag,u===5||u===6){r=o=a;continue e}s=s.parentNode}}r=r.return}Jk(function(){var c=o,l=kb(n),d=[];e:{var f=RR.get(e);if(f!==void 0){var h=Nb,p=e;switch(e){case"keypress":if(Sh(n)===0)break e;case"keydown":case"keyup":h=x3;break;case"focusin":p="focus",h=cg;break;case"focusout":p="blur",h=cg;break;case"beforeblur":case"afterblur":h=cg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=TE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=c3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=C3;break;case SR:case CR:case _R:h=f3;break;case kR:h=k3;break;case"scroll":h=s3;break;case"wheel":h=I3;break;case"copy":case"cut":case"paste":h=p3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=PE}var m=(t&4)!==0,g=!m&&e==="scroll",v=m?f!==null?f+"Capture":null:f;m=[];for(var y=c,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,v!==null&&(w=Ul(y,v),w!=null&&m.push(Yl(y,w,b)))),g)break;y=y.return}0<m.length&&(f=new h(f,p,null,n,l),d.push({event:f,listeners:m}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&n!==wy&&(p=n.relatedTarget||n.fromElement)&&(ts(p)||p[Ro]))break e;if((h||f)&&(f=l.window===l?l:(f=l.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=c,p=p?ts(p):null,p!==null&&(g=Fs(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=c),h!==p)){if(m=TE,w="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=PE,w="onPointerLeave",v="onPointerEnter",y="pointer"),g=h==null?f:Eu(h),b=p==null?f:Eu(p),f=new m(w,y+"leave",h,n,l),f.target=g,f.relatedTarget=b,w=null,ts(l)===c&&(m=new m(v,y+"enter",p,n,l),m.target=b,m.relatedTarget=g,w=m),g=w,h&&p)t:{for(m=h,v=p,y=0,b=m;b;b=Js(b))y++;for(b=0,w=v;w;w=Js(w))b++;for(;0<y-b;)m=Js(m),y--;for(;0<b-y;)v=Js(v),b--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=Js(m),v=Js(v)}m=null}else m=null;h!==null&&WE(d,f,h,m,!1),p!==null&&g!==null&&WE(d,g,p,m,!0)}}e:{if(f=c?Eu(c):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var E=M3;else if(AE(f))if(yR)E=j3;else{E=F3;var x=L3}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(E=B3);if(E&&(E=E(e,c))){gR(d,E,n,l);break e}x&&x(e,f,c),e==="focusout"&&(x=f._wrapperState)&&x.controlled&&f.type==="number"&&vy(f,"number",f.value)}switch(x=c?Eu(c):window,e){case"focusin":(AE(x)||x.contentEditable==="true")&&(wu=x,Ry=c,Rl=null);break;case"focusout":Rl=Ry=wu=null;break;case"mousedown":Iy=!0;break;case"contextmenu":case"mouseup":case"dragend":Iy=!1,jE(d,n,l);break;case"selectionchange":if(W3)break;case"keydown":case"keyup":jE(d,n,l)}var R;if(Ab)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else bu?vR(e,n)&&(S="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(S="onCompositionStart");S&&(pR&&n.locale!=="ko"&&(bu||S!=="onCompositionStart"?S==="onCompositionEnd"&&bu&&(R=hR()):(oa=l,Pb="value"in oa?oa.value:oa.textContent,bu=!0)),x=Jh(c,S),0<x.length&&(S=new OE(S,e,null,n,l),d.push({event:S,listeners:x}),R?S.data=R:(R=mR(n),R!==null&&(S.data=R)))),(R=O3?P3(e,n):N3(e,n))&&(c=Jh(c,"onBeforeInput"),0<c.length&&(l=new OE("onBeforeInput","beforeinput",null,n,l),d.push({event:l,listeners:c}),l.data=R))}IR(d,t)})}function Yl(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Jh(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Ul(e,n),o!=null&&r.unshift(Yl(e,o,i)),o=Ul(e,t),o!=null&&r.push(Yl(e,o,i))),e=e.return}return r}function Js(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function WE(e,t,n,r,i){for(var o=t._reactName,a=[];n!==null&&n!==r;){var s=n,u=s.alternate,c=s.stateNode;if(u!==null&&u===r)break;s.tag===5&&c!==null&&(s=c,i?(u=Ul(n,o),u!=null&&a.unshift(Yl(n,u,s))):i||(u=Ul(n,o),u!=null&&a.push(Yl(n,u,s)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var G3=/\r\n?/g,q3=/\u0000|\uFFFD/g;function UE(e){return(typeof e=="string"?e:""+e).replace(G3,`
`).replace(q3,"")}function Tf(e,t,n){if(t=UE(t),UE(e)!==t&&n)throw Error(fe(425))}function Zh(){}var Ty=null,Oy=null;function Py(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ny=typeof setTimeout=="function"?setTimeout:void 0,X3=typeof clearTimeout=="function"?clearTimeout:void 0,zE=typeof Promise=="function"?Promise:void 0,K3=typeof queueMicrotask=="function"?queueMicrotask:typeof zE<"u"?function(e){return zE.resolve(null).then(e).catch(Y3)}:Ny;function Y3(e){setTimeout(function(){throw e})}function gg(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),Gl(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Gl(t)}function va(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function HE(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Ec=Math.random().toString(36).slice(2),qi="__reactFiber$"+Ec,Ql="__reactProps$"+Ec,Ro="__reactContainer$"+Ec,Dy="__reactEvents$"+Ec,Q3="__reactListeners$"+Ec,J3="__reactHandles$"+Ec;function ts(e){var t=e[qi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ro]||n[qi]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=HE(e);e!==null;){if(n=e[qi])return n;e=HE(e)}return t}e=n,n=e.parentNode}return null}function Id(e){return e=e[qi]||e[Ro],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Eu(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(fe(33))}function Cv(e){return e[Ql]||null}var Ay=[],Su=-1;function Aa(e){return{current:e}}function It(e){0>Su||(e.current=Ay[Su],Ay[Su]=null,Su--)}function St(e,t){Su++,Ay[Su]=e.current,e.current=t}var ka={},Jn=Aa(ka),Er=Aa(!1),Es=ka;function Yu(e,t){var n=e.type.contextTypes;if(!n)return ka;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Sr(e){return e=e.childContextTypes,e!=null}function ep(){It(Er),It(Jn)}function GE(e,t,n){if(Jn.current!==ka)throw Error(fe(168));St(Jn,t),St(Er,n)}function OR(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(fe(108,LM(e)||"Unknown",i));return jt({},n,r)}function tp(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ka,Es=Jn.current,St(Jn,e),St(Er,Er.current),!0}function qE(e,t,n){var r=e.stateNode;if(!r)throw Error(fe(169));n?(e=OR(e,t,Es),r.__reactInternalMemoizedMergedChildContext=e,It(Er),It(Jn),St(Jn,e)):It(Er),St(Er,n)}var yo=null,_v=!1,yg=!1;function PR(e){yo===null?yo=[e]:yo.push(e)}function Z3(e){_v=!0,PR(e)}function Ma(){if(!yg&&yo!==null){yg=!0;var e=0,t=ht;try{var n=yo;for(ht=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}yo=null,_v=!1}catch(i){throw yo!==null&&(yo=yo.slice(e+1)),nR(Rb,Ma),i}finally{ht=t,yg=!1}}return null}var Cu=[],_u=0,np=null,rp=0,Yr=[],Qr=0,Ss=null,xo=1,Eo="";function Xa(e,t){Cu[_u++]=rp,Cu[_u++]=np,np=e,rp=t}function NR(e,t,n){Yr[Qr++]=xo,Yr[Qr++]=Eo,Yr[Qr++]=Ss,Ss=e;var r=xo;e=Eo;var i=32-Ei(r)-1;r&=~(1<<i),n+=1;var o=32-Ei(t)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,xo=1<<32-Ei(t)+i|n<<i|r,Eo=o+e}else xo=1<<o|n<<i|r,Eo=e}function Lb(e){e.return!==null&&(Xa(e,1),NR(e,1,0))}function Fb(e){for(;e===np;)np=Cu[--_u],Cu[_u]=null,rp=Cu[--_u],Cu[_u]=null;for(;e===Ss;)Ss=Yr[--Qr],Yr[Qr]=null,Eo=Yr[--Qr],Yr[Qr]=null,xo=Yr[--Qr],Yr[Qr]=null}var Wr=null,Fr=null,Pt=!1,bi=null;function DR(e,t){var n=ti(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function XE(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Wr=e,Fr=va(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Wr=e,Fr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ss!==null?{id:xo,overflow:Eo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=ti(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Wr=e,Fr=null,!0):!1;default:return!1}}function My(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ly(e){if(Pt){var t=Fr;if(t){var n=t;if(!XE(e,t)){if(My(e))throw Error(fe(418));t=va(n.nextSibling);var r=Wr;t&&XE(e,t)?DR(r,n):(e.flags=e.flags&-4097|2,Pt=!1,Wr=e)}}else{if(My(e))throw Error(fe(418));e.flags=e.flags&-4097|2,Pt=!1,Wr=e}}}function KE(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Wr=e}function Of(e){if(e!==Wr)return!1;if(!Pt)return KE(e),Pt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Py(e.type,e.memoizedProps)),t&&(t=Fr)){if(My(e))throw AR(),Error(fe(418));for(;t;)DR(e,t),t=va(t.nextSibling)}if(KE(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(fe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Fr=va(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Fr=null}}else Fr=Wr?va(e.stateNode.nextSibling):null;return!0}function AR(){for(var e=Fr;e;)e=va(e.nextSibling)}function Qu(){Fr=Wr=null,Pt=!1}function Bb(e){bi===null?bi=[e]:bi.push(e)}var e4=Oo.ReactCurrentBatchConfig;function Yc(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(fe(309));var r=n.stateNode}if(!r)throw Error(fe(147,e));var i=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(a){var s=i.refs;a===null?delete s[o]:s[o]=a},t._stringRef=o,t)}if(typeof e!="string")throw Error(fe(284));if(!n._owner)throw Error(fe(290,e))}return e}function Pf(e,t){throw e=Object.prototype.toString.call(t),Error(fe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function YE(e){var t=e._init;return t(e._payload)}function MR(e){function t(v,y){if(e){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function n(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function r(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function i(v,y){return v=ba(v,y),v.index=0,v.sibling=null,v}function o(v,y,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function a(v){return e&&v.alternate===null&&(v.flags|=2),v}function s(v,y,b,w){return y===null||y.tag!==6?(y=_g(b,v.mode,w),y.return=v,y):(y=i(y,b),y.return=v,y)}function u(v,y,b,w){var E=b.type;return E===yu?l(v,y,b.props.children,w,b.key):y!==null&&(y.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Zo&&YE(E)===y.type)?(w=i(y,b.props),w.ref=Yc(v,y,b),w.return=v,w):(w=Oh(b.type,b.key,b.props,null,v.mode,w),w.ref=Yc(v,y,b),w.return=v,w)}function c(v,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=kg(b,v.mode,w),y.return=v,y):(y=i(y,b.children||[]),y.return=v,y)}function l(v,y,b,w,E){return y===null||y.tag!==7?(y=ps(b,v.mode,w,E),y.return=v,y):(y=i(y,b),y.return=v,y)}function d(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=_g(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case wf:return b=Oh(y.type,y.key,y.props,null,v.mode,b),b.ref=Yc(v,null,y),b.return=v,b;case gu:return y=kg(y,v.mode,b),y.return=v,y;case Zo:var w=y._init;return d(v,w(y._payload),b)}if(ml(y)||Hc(y))return y=ps(y,v.mode,b,null),y.return=v,y;Pf(v,y)}return null}function f(v,y,b,w){var E=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return E!==null?null:s(v,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case wf:return b.key===E?u(v,y,b,w):null;case gu:return b.key===E?c(v,y,b,w):null;case Zo:return E=b._init,f(v,y,E(b._payload),w)}if(ml(b)||Hc(b))return E!==null?null:l(v,y,b,w,null);Pf(v,b)}return null}function h(v,y,b,w,E){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(b)||null,s(y,v,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case wf:return v=v.get(w.key===null?b:w.key)||null,u(y,v,w,E);case gu:return v=v.get(w.key===null?b:w.key)||null,c(y,v,w,E);case Zo:var x=w._init;return h(v,y,b,x(w._payload),E)}if(ml(w)||Hc(w))return v=v.get(b)||null,l(y,v,w,E,null);Pf(y,w)}return null}function p(v,y,b,w){for(var E=null,x=null,R=y,S=y=0,_=null;R!==null&&S<b.length;S++){R.index>S?(_=R,R=null):_=R.sibling;var T=f(v,R,b[S],w);if(T===null){R===null&&(R=_);break}e&&R&&T.alternate===null&&t(v,R),y=o(T,y,S),x===null?E=T:x.sibling=T,x=T,R=_}if(S===b.length)return n(v,R),Pt&&Xa(v,S),E;if(R===null){for(;S<b.length;S++)R=d(v,b[S],w),R!==null&&(y=o(R,y,S),x===null?E=R:x.sibling=R,x=R);return Pt&&Xa(v,S),E}for(R=r(v,R);S<b.length;S++)_=h(R,v,S,b[S],w),_!==null&&(e&&_.alternate!==null&&R.delete(_.key===null?S:_.key),y=o(_,y,S),x===null?E=_:x.sibling=_,x=_);return e&&R.forEach(function(B){return t(v,B)}),Pt&&Xa(v,S),E}function m(v,y,b,w){var E=Hc(b);if(typeof E!="function")throw Error(fe(150));if(b=E.call(b),b==null)throw Error(fe(151));for(var x=E=null,R=y,S=y=0,_=null,T=b.next();R!==null&&!T.done;S++,T=b.next()){R.index>S?(_=R,R=null):_=R.sibling;var B=f(v,R,T.value,w);if(B===null){R===null&&(R=_);break}e&&R&&B.alternate===null&&t(v,R),y=o(B,y,S),x===null?E=B:x.sibling=B,x=B,R=_}if(T.done)return n(v,R),Pt&&Xa(v,S),E;if(R===null){for(;!T.done;S++,T=b.next())T=d(v,T.value,w),T!==null&&(y=o(T,y,S),x===null?E=T:x.sibling=T,x=T);return Pt&&Xa(v,S),E}for(R=r(v,R);!T.done;S++,T=b.next())T=h(R,v,S,T.value,w),T!==null&&(e&&T.alternate!==null&&R.delete(T.key===null?S:T.key),y=o(T,y,S),x===null?E=T:x.sibling=T,x=T);return e&&R.forEach(function(L){return t(v,L)}),Pt&&Xa(v,S),E}function g(v,y,b,w){if(typeof b=="object"&&b!==null&&b.type===yu&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case wf:e:{for(var E=b.key,x=y;x!==null;){if(x.key===E){if(E=b.type,E===yu){if(x.tag===7){n(v,x.sibling),y=i(x,b.props.children),y.return=v,v=y;break e}}else if(x.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Zo&&YE(E)===x.type){n(v,x.sibling),y=i(x,b.props),y.ref=Yc(v,x,b),y.return=v,v=y;break e}n(v,x);break}else t(v,x);x=x.sibling}b.type===yu?(y=ps(b.props.children,v.mode,w,b.key),y.return=v,v=y):(w=Oh(b.type,b.key,b.props,null,v.mode,w),w.ref=Yc(v,y,b),w.return=v,v=w)}return a(v);case gu:e:{for(x=b.key;y!==null;){if(y.key===x)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(v,y.sibling),y=i(y,b.children||[]),y.return=v,v=y;break e}else{n(v,y);break}else t(v,y);y=y.sibling}y=kg(b,v.mode,w),y.return=v,v=y}return a(v);case Zo:return x=b._init,g(v,y,x(b._payload),w)}if(ml(b))return p(v,y,b,w);if(Hc(b))return m(v,y,b,w);Pf(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(v,y.sibling),y=i(y,b),y.return=v,v=y):(n(v,y),y=_g(b,v.mode,w),y.return=v,v=y),a(v)):n(v,y)}return g}var Ju=MR(!0),LR=MR(!1),ip=Aa(null),op=null,ku=null,jb=null;function $b(){jb=ku=op=null}function Vb(e){var t=ip.current;It(ip),e._currentValue=t}function Fy(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Lu(e,t){op=e,jb=ku=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(br=!0),e.firstContext=null)}function oi(e){var t=e._currentValue;if(jb!==e)if(e={context:e,memoizedValue:t,next:null},ku===null){if(op===null)throw Error(fe(308));ku=e,op.dependencies={lanes:0,firstContext:e}}else ku=ku.next=e;return t}var ns=null;function Wb(e){ns===null?ns=[e]:ns.push(e)}function FR(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Wb(t)):(n.next=i.next,i.next=n),t.interleaved=n,Io(e,r)}function Io(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var ea=!1;function Ub(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function BR(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function So(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ma(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,ot&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Io(e,n)}return i=r.interleaved,i===null?(t.next=t,Wb(r)):(t.next=i.next,i.next=t),r.interleaved=t,Io(e,n)}function Ch(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Ib(e,n)}}function QE(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?i=o=t:o=o.next=t}else i=o=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ap(e,t,n,r){var i=e.updateQueue;ea=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var u=s,c=u.next;u.next=null,a===null?o=c:a.next=c,a=u;var l=e.alternate;l!==null&&(l=l.updateQueue,s=l.lastBaseUpdate,s!==a&&(s===null?l.firstBaseUpdate=c:s.next=c,l.lastBaseUpdate=u))}if(o!==null){var d=i.baseState;a=0,l=c=u=null,s=o;do{var f=s.lane,h=s.eventTime;if((r&f)===f){l!==null&&(l=l.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,m=s;switch(f=t,h=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=jt({},d,f);break e;case 2:ea=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,f=i.effects,f===null?i.effects=[s]:f.push(s))}else h={eventTime:h,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},l===null?(c=l=h,u=d):l=l.next=h,a|=f;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;f=s,s=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(l===null&&(u=d),i.baseState=u,i.firstBaseUpdate=c,i.lastBaseUpdate=l,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);_s|=a,e.lanes=a,e.memoizedState=d}}function JE(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(fe(191,i));i.call(r)}}}var Td={},Zi=Aa(Td),Jl=Aa(Td),Zl=Aa(Td);function rs(e){if(e===Td)throw Error(fe(174));return e}function zb(e,t){switch(St(Zl,t),St(Jl,e),St(Zi,Td),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:gy(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=gy(t,e)}It(Zi),St(Zi,t)}function Zu(){It(Zi),It(Jl),It(Zl)}function jR(e){rs(Zl.current);var t=rs(Zi.current),n=gy(t,e.type);t!==n&&(St(Jl,e),St(Zi,n))}function Hb(e){Jl.current===e&&(It(Zi),It(Jl))}var At=Aa(0);function sp(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var bg=[];function Gb(){for(var e=0;e<bg.length;e++)bg[e]._workInProgressVersionPrimary=null;bg.length=0}var _h=Oo.ReactCurrentDispatcher,wg=Oo.ReactCurrentBatchConfig,Cs=0,Bt=null,rn=null,vn=null,up=!1,Il=!1,ed=0,t4=0;function Mn(){throw Error(fe(321))}function qb(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ri(e[n],t[n]))return!1;return!0}function Xb(e,t,n,r,i,o){if(Cs=o,Bt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,_h.current=e===null||e.memoizedState===null?o4:a4,e=n(r,i),Il){o=0;do{if(Il=!1,ed=0,25<=o)throw Error(fe(301));o+=1,vn=rn=null,t.updateQueue=null,_h.current=s4,e=n(r,i)}while(Il)}if(_h.current=cp,t=rn!==null&&rn.next!==null,Cs=0,vn=rn=Bt=null,up=!1,t)throw Error(fe(300));return e}function Kb(){var e=ed!==0;return ed=0,e}function Ui(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vn===null?Bt.memoizedState=vn=e:vn=vn.next=e,vn}function ai(){if(rn===null){var e=Bt.alternate;e=e!==null?e.memoizedState:null}else e=rn.next;var t=vn===null?Bt.memoizedState:vn.next;if(t!==null)vn=t,rn=e;else{if(e===null)throw Error(fe(310));rn=e,e={memoizedState:rn.memoizedState,baseState:rn.baseState,baseQueue:rn.baseQueue,queue:rn.queue,next:null},vn===null?Bt.memoizedState=vn=e:vn=vn.next=e}return vn}function td(e,t){return typeof t=="function"?t(e):t}function xg(e){var t=ai(),n=t.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=e;var r=rn,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var s=a=null,u=null,c=o;do{var l=c.lane;if((Cs&l)===l)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var d={lane:l,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(s=u=d,a=r):u=u.next=d,Bt.lanes|=l,_s|=l}c=c.next}while(c!==null&&c!==o);u===null?a=r:u.next=s,Ri(r,t.memoizedState)||(br=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do o=i.lane,Bt.lanes|=o,_s|=o,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Eg(e){var t=ai(),n=t.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do o=e(o,a.action),a=a.next;while(a!==i);Ri(o,t.memoizedState)||(br=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function $R(){}function VR(e,t){var n=Bt,r=ai(),i=t(),o=!Ri(r.memoizedState,i);if(o&&(r.memoizedState=i,br=!0),r=r.queue,Yb(zR.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||vn!==null&&vn.memoizedState.tag&1){if(n.flags|=2048,nd(9,UR.bind(null,n,r,i,t),void 0,null),yn===null)throw Error(fe(349));Cs&30||WR(n,t,i)}return i}function WR(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Bt.updateQueue,t===null?(t={lastEffect:null,stores:null},Bt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function UR(e,t,n,r){t.value=n,t.getSnapshot=r,HR(t)&&GR(e)}function zR(e,t,n){return n(function(){HR(t)&&GR(e)})}function HR(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ri(e,n)}catch{return!0}}function GR(e){var t=Io(e,1);t!==null&&Si(t,e,1,-1)}function ZE(e){var t=Ui();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:td,lastRenderedState:e},t.queue=e,e=e.dispatch=i4.bind(null,Bt,e),[t.memoizedState,e]}function nd(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Bt.updateQueue,t===null?(t={lastEffect:null,stores:null},Bt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function qR(){return ai().memoizedState}function kh(e,t,n,r){var i=Ui();Bt.flags|=e,i.memoizedState=nd(1|t,n,void 0,r===void 0?null:r)}function kv(e,t,n,r){var i=ai();r=r===void 0?null:r;var o=void 0;if(rn!==null){var a=rn.memoizedState;if(o=a.destroy,r!==null&&qb(r,a.deps)){i.memoizedState=nd(t,n,o,r);return}}Bt.flags|=e,i.memoizedState=nd(1|t,n,o,r)}function eS(e,t){return kh(8390656,8,e,t)}function Yb(e,t){return kv(2048,8,e,t)}function XR(e,t){return kv(4,2,e,t)}function KR(e,t){return kv(4,4,e,t)}function YR(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function QR(e,t,n){return n=n!=null?n.concat([e]):null,kv(4,4,YR.bind(null,t,e),n)}function Qb(){}function JR(e,t){var n=ai();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&qb(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function ZR(e,t){var n=ai();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&qb(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function eI(e,t,n){return Cs&21?(Ri(n,t)||(n=oR(),Bt.lanes|=n,_s|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,br=!0),e.memoizedState=n)}function n4(e,t){var n=ht;ht=n!==0&&4>n?n:4,e(!0);var r=wg.transition;wg.transition={};try{e(!1),t()}finally{ht=n,wg.transition=r}}function tI(){return ai().memoizedState}function r4(e,t,n){var r=ya(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},nI(e))rI(t,n);else if(n=FR(e,t,n,r),n!==null){var i=lr();Si(n,e,r,i),iI(n,t,r)}}function i4(e,t,n){var r=ya(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(nI(e))rI(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var a=t.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,Ri(s,a)){var u=t.interleaved;u===null?(i.next=i,Wb(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}n=FR(e,t,i,r),n!==null&&(i=lr(),Si(n,e,r,i),iI(n,t,r))}}function nI(e){var t=e.alternate;return e===Bt||t!==null&&t===Bt}function rI(e,t){Il=up=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function iI(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Ib(e,n)}}var cp={readContext:oi,useCallback:Mn,useContext:Mn,useEffect:Mn,useImperativeHandle:Mn,useInsertionEffect:Mn,useLayoutEffect:Mn,useMemo:Mn,useReducer:Mn,useRef:Mn,useState:Mn,useDebugValue:Mn,useDeferredValue:Mn,useTransition:Mn,useMutableSource:Mn,useSyncExternalStore:Mn,useId:Mn,unstable_isNewReconciler:!1},o4={readContext:oi,useCallback:function(e,t){return Ui().memoizedState=[e,t===void 0?null:t],e},useContext:oi,useEffect:eS,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,kh(4194308,4,YR.bind(null,t,e),n)},useLayoutEffect:function(e,t){return kh(4194308,4,e,t)},useInsertionEffect:function(e,t){return kh(4,2,e,t)},useMemo:function(e,t){var n=Ui();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ui();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=r4.bind(null,Bt,e),[r.memoizedState,e]},useRef:function(e){var t=Ui();return e={current:e},t.memoizedState=e},useState:ZE,useDebugValue:Qb,useDeferredValue:function(e){return Ui().memoizedState=e},useTransition:function(){var e=ZE(!1),t=e[0];return e=n4.bind(null,e[1]),Ui().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Bt,i=Ui();if(Pt){if(n===void 0)throw Error(fe(407));n=n()}else{if(n=t(),yn===null)throw Error(fe(349));Cs&30||WR(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,eS(zR.bind(null,r,o,e),[e]),r.flags|=2048,nd(9,UR.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Ui(),t=yn.identifierPrefix;if(Pt){var n=Eo,r=xo;n=(r&~(1<<32-Ei(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=ed++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=t4++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},a4={readContext:oi,useCallback:JR,useContext:oi,useEffect:Yb,useImperativeHandle:QR,useInsertionEffect:XR,useLayoutEffect:KR,useMemo:ZR,useReducer:xg,useRef:qR,useState:function(){return xg(td)},useDebugValue:Qb,useDeferredValue:function(e){var t=ai();return eI(t,rn.memoizedState,e)},useTransition:function(){var e=xg(td)[0],t=ai().memoizedState;return[e,t]},useMutableSource:$R,useSyncExternalStore:VR,useId:tI,unstable_isNewReconciler:!1},s4={readContext:oi,useCallback:JR,useContext:oi,useEffect:Yb,useImperativeHandle:QR,useInsertionEffect:XR,useLayoutEffect:KR,useMemo:ZR,useReducer:Eg,useRef:qR,useState:function(){return Eg(td)},useDebugValue:Qb,useDeferredValue:function(e){var t=ai();return rn===null?t.memoizedState=e:eI(t,rn.memoizedState,e)},useTransition:function(){var e=Eg(td)[0],t=ai().memoizedState;return[e,t]},useMutableSource:$R,useSyncExternalStore:VR,useId:tI,unstable_isNewReconciler:!1};function vi(e,t){if(e&&e.defaultProps){t=jt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function By(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:jt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Rv={isMounted:function(e){return(e=e._reactInternals)?Fs(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=lr(),i=ya(e),o=So(r,i);o.payload=t,n!=null&&(o.callback=n),t=ma(e,o,i),t!==null&&(Si(t,e,i,r),Ch(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=lr(),i=ya(e),o=So(r,i);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=ma(e,o,i),t!==null&&(Si(t,e,i,r),Ch(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=lr(),r=ya(e),i=So(n,r);i.tag=2,t!=null&&(i.callback=t),t=ma(e,i,r),t!==null&&(Si(t,e,r,n),Ch(t,e,r))}};function tS(e,t,n,r,i,o,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,a):t.prototype&&t.prototype.isPureReactComponent?!Xl(n,r)||!Xl(i,o):!0}function oI(e,t,n){var r=!1,i=ka,o=t.contextType;return typeof o=="object"&&o!==null?o=oi(o):(i=Sr(t)?Es:Jn.current,r=t.contextTypes,o=(r=r!=null)?Yu(e,i):ka),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Rv,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function nS(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Rv.enqueueReplaceState(t,t.state,null)}function jy(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Ub(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=oi(o):(o=Sr(t)?Es:Jn.current,i.context=Yu(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(By(e,t,o,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Rv.enqueueReplaceState(i,i.state,null),ap(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function ec(e,t){try{var n="",r=t;do n+=MM(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function Sg(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function $y(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var u4=typeof WeakMap=="function"?WeakMap:Map;function aI(e,t,n){n=So(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){dp||(dp=!0,Yy=r),$y(e,t)},n}function sI(e,t,n){n=So(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){$y(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){$y(e,t),typeof r!="function"&&(ga===null?ga=new Set([this]):ga.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function rS(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new u4;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=E4.bind(null,e,t,n),t.then(e,e))}function iS(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function oS(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=So(-1,1),t.tag=2,ma(n,t,1))),n.lanes|=1),e)}var c4=Oo.ReactCurrentOwner,br=!1;function or(e,t,n,r){t.child=e===null?LR(t,null,n,r):Ju(t,e.child,n,r)}function aS(e,t,n,r,i){n=n.render;var o=t.ref;return Lu(t,i),r=Xb(e,t,n,r,o,i),n=Kb(),e!==null&&!br?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,To(e,t,i)):(Pt&&n&&Lb(t),t.flags|=1,or(e,t,r,i),t.child)}function sS(e,t,n,r,i){if(e===null){var o=n.type;return typeof o=="function"&&!ow(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,uI(e,t,o,r,i)):(e=Oh(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&i)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:Xl,n(a,r)&&e.ref===t.ref)return To(e,t,i)}return t.flags|=1,e=ba(o,r),e.ref=t.ref,e.return=t,t.child=e}function uI(e,t,n,r,i){if(e!==null){var o=e.memoizedProps;if(Xl(o,r)&&e.ref===t.ref)if(br=!1,t.pendingProps=r=o,(e.lanes&i)!==0)e.flags&131072&&(br=!0);else return t.lanes=e.lanes,To(e,t,i)}return Vy(e,t,n,r,i)}function cI(e,t,n){var r=t.pendingProps,i=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},St(Iu,Nr),Nr|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,St(Iu,Nr),Nr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,St(Iu,Nr),Nr|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,St(Iu,Nr),Nr|=r;return or(e,t,i,n),t.child}function lI(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Vy(e,t,n,r,i){var o=Sr(n)?Es:Jn.current;return o=Yu(t,o),Lu(t,i),n=Xb(e,t,n,r,o,i),r=Kb(),e!==null&&!br?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,To(e,t,i)):(Pt&&r&&Lb(t),t.flags|=1,or(e,t,n,i),t.child)}function uS(e,t,n,r,i){if(Sr(n)){var o=!0;tp(t)}else o=!1;if(Lu(t,i),t.stateNode===null)Rh(e,t),oI(t,n,r),jy(t,n,r,i),r=!0;else if(e===null){var a=t.stateNode,s=t.memoizedProps;a.props=s;var u=a.context,c=n.contextType;typeof c=="object"&&c!==null?c=oi(c):(c=Sr(n)?Es:Jn.current,c=Yu(t,c));var l=n.getDerivedStateFromProps,d=typeof l=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==r||u!==c)&&nS(t,a,r,c),ea=!1;var f=t.memoizedState;a.state=f,ap(t,r,a,i),u=t.memoizedState,s!==r||f!==u||Er.current||ea?(typeof l=="function"&&(By(t,n,l,r),u=t.memoizedState),(s=ea||tS(t,n,s,r,f,u,c))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=c,r=s):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,BR(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:vi(t.type,s),a.props=c,d=t.pendingProps,f=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=oi(u):(u=Sr(n)?Es:Jn.current,u=Yu(t,u));var h=n.getDerivedStateFromProps;(l=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==d||f!==u)&&nS(t,a,r,u),ea=!1,f=t.memoizedState,a.state=f,ap(t,r,a,i);var p=t.memoizedState;s!==d||f!==p||Er.current||ea?(typeof h=="function"&&(By(t,n,h,r),p=t.memoizedState),(c=ea||tS(t,n,c,r,f,p,u)||!1)?(l||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,p,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,p,u)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=u,r=c):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Wy(e,t,n,r,o,i)}function Wy(e,t,n,r,i,o){lI(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return i&&qE(t,n,!1),To(e,t,o);r=t.stateNode,c4.current=t;var s=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=Ju(t,e.child,null,o),t.child=Ju(t,null,s,o)):or(e,t,s,o),t.memoizedState=r.state,i&&qE(t,n,!0),t.child}function dI(e){var t=e.stateNode;t.pendingContext?GE(e,t.pendingContext,t.pendingContext!==t.context):t.context&&GE(e,t.context,!1),zb(e,t.containerInfo)}function cS(e,t,n,r,i){return Qu(),Bb(i),t.flags|=256,or(e,t,n,r),t.child}var Uy={dehydrated:null,treeContext:null,retryLane:0};function zy(e){return{baseLanes:e,cachePool:null,transitions:null}}function fI(e,t,n){var r=t.pendingProps,i=At.current,o=!1,a=(t.flags&128)!==0,s;if((s=a)||(s=e!==null&&e.memoizedState===null?!1:(i&2)!==0),s?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),St(At,i&1),e===null)return Ly(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,o?(r=t.mode,o=t.child,a={mode:"hidden",children:a},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=Ov(a,r,0,null),e=ps(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=zy(n),t.memoizedState=Uy,e):Jb(t,a));if(i=e.memoizedState,i!==null&&(s=i.dehydrated,s!==null))return l4(e,t,a,r,s,i,n);if(o){o=r.fallback,a=t.mode,i=e.child,s=i.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=ba(i,u),r.subtreeFlags=i.subtreeFlags&14680064),s!==null?o=ba(s,o):(o=ps(o,a,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,a=e.child.memoizedState,a=a===null?zy(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=e.childLanes&~n,t.memoizedState=Uy,r}return o=e.child,e=o.sibling,r=ba(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Jb(e,t){return t=Ov({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Nf(e,t,n,r){return r!==null&&Bb(r),Ju(t,e.child,null,n),e=Jb(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function l4(e,t,n,r,i,o,a){if(n)return t.flags&256?(t.flags&=-257,r=Sg(Error(fe(422))),Nf(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Ov({mode:"visible",children:r.children},i,0,null),o=ps(o,i,a,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&Ju(t,e.child,null,a),t.child.memoizedState=zy(a),t.memoizedState=Uy,o);if(!(t.mode&1))return Nf(e,t,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var s=r.dgst;return r=s,o=Error(fe(419)),r=Sg(o,r,void 0),Nf(e,t,a,r)}if(s=(a&e.childLanes)!==0,br||s){if(r=yn,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Io(e,i),Si(r,e,i,-1))}return iw(),r=Sg(Error(fe(421))),Nf(e,t,a,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=S4.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,Fr=va(i.nextSibling),Wr=t,Pt=!0,bi=null,e!==null&&(Yr[Qr++]=xo,Yr[Qr++]=Eo,Yr[Qr++]=Ss,xo=e.id,Eo=e.overflow,Ss=t),t=Jb(t,r.children),t.flags|=4096,t)}function lS(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Fy(e.return,t,n)}function Cg(e,t,n,r,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function hI(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(or(e,t,r.children,n),r=At.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&lS(e,n,t);else if(e.tag===19)lS(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(St(At,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&sp(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Cg(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&sp(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Cg(t,!0,n,null,o);break;case"together":Cg(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Rh(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function To(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),_s|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(fe(153));if(t.child!==null){for(e=t.child,n=ba(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ba(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function d4(e,t,n){switch(t.tag){case 3:dI(t),Qu();break;case 5:jR(t);break;case 1:Sr(t.type)&&tp(t);break;case 4:zb(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;St(ip,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(St(At,At.current&1),t.flags|=128,null):n&t.child.childLanes?fI(e,t,n):(St(At,At.current&1),e=To(e,t,n),e!==null?e.sibling:null);St(At,At.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return hI(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),St(At,At.current),r)break;return null;case 22:case 23:return t.lanes=0,cI(e,t,n)}return To(e,t,n)}var pI,Hy,vI,mI;pI=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Hy=function(){};vI=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,rs(Zi.current);var o=null;switch(n){case"input":i=hy(e,i),r=hy(e,r),o=[];break;case"select":i=jt({},i,{value:void 0}),r=jt({},r,{value:void 0}),o=[];break;case"textarea":i=my(e,i),r=my(e,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Zh)}yy(n,r);var a;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var s=i[c];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Vl.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var u=r[c];if(s=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&u!==s&&(u!=null||s!=null))if(c==="style")if(s){for(a in s)!s.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&s[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(o||(o=[]),o.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,s=s?s.__html:void 0,u!=null&&s!==u&&(o=o||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Vl.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&_t("scroll",e),o||s===u||(o=[])):(o=o||[]).push(c,u))}n&&(o=o||[]).push("style",n);var c=o;(t.updateQueue=c)&&(t.flags|=4)}};mI=function(e,t,n,r){n!==r&&(t.flags|=4)};function Qc(e,t){if(!Pt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ln(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function f4(e,t,n){var r=t.pendingProps;switch(Fb(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ln(t),null;case 1:return Sr(t.type)&&ep(),Ln(t),null;case 3:return r=t.stateNode,Zu(),It(Er),It(Jn),Gb(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Of(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,bi!==null&&(Zy(bi),bi=null))),Hy(e,t),Ln(t),null;case 5:Hb(t);var i=rs(Zl.current);if(n=t.type,e!==null&&t.stateNode!=null)vI(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(fe(166));return Ln(t),null}if(e=rs(Zi.current),Of(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[qi]=t,r[Ql]=o,e=(t.mode&1)!==0,n){case"dialog":_t("cancel",r),_t("close",r);break;case"iframe":case"object":case"embed":_t("load",r);break;case"video":case"audio":for(i=0;i<yl.length;i++)_t(yl[i],r);break;case"source":_t("error",r);break;case"img":case"image":case"link":_t("error",r),_t("load",r);break;case"details":_t("toggle",r);break;case"input":bE(r,o),_t("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},_t("invalid",r);break;case"textarea":xE(r,o),_t("invalid",r)}yy(n,o),i=null;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];a==="children"?typeof s=="string"?r.textContent!==s&&(o.suppressHydrationWarning!==!0&&Tf(r.textContent,s,e),i=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(o.suppressHydrationWarning!==!0&&Tf(r.textContent,s,e),i=["children",""+s]):Vl.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&_t("scroll",r)}switch(n){case"input":xf(r),wE(r,o,!0);break;case"textarea":xf(r),EE(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Zh)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=zk(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[qi]=t,e[Ql]=r,pI(e,t,!1,!1),t.stateNode=e;e:{switch(a=by(n,r),n){case"dialog":_t("cancel",e),_t("close",e),i=r;break;case"iframe":case"object":case"embed":_t("load",e),i=r;break;case"video":case"audio":for(i=0;i<yl.length;i++)_t(yl[i],e);i=r;break;case"source":_t("error",e),i=r;break;case"img":case"image":case"link":_t("error",e),_t("load",e),i=r;break;case"details":_t("toggle",e),i=r;break;case"input":bE(e,r),i=hy(e,r),_t("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=jt({},r,{value:void 0}),_t("invalid",e);break;case"textarea":xE(e,r),i=my(e,r),_t("invalid",e);break;default:i=r}yy(n,i),s=i;for(o in s)if(s.hasOwnProperty(o)){var u=s[o];o==="style"?qk(e,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Hk(e,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Wl(e,u):typeof u=="number"&&Wl(e,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Vl.hasOwnProperty(o)?u!=null&&o==="onScroll"&&_t("scroll",e):u!=null&&Eb(e,o,u,a))}switch(n){case"input":xf(e),wE(e,r,!1);break;case"textarea":xf(e),EE(e);break;case"option":r.value!=null&&e.setAttribute("value",""+_a(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?Nu(e,!!r.multiple,o,!1):r.defaultValue!=null&&Nu(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Zh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ln(t),null;case 6:if(e&&t.stateNode!=null)mI(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(fe(166));if(n=rs(Zl.current),rs(Zi.current),Of(t)){if(r=t.stateNode,n=t.memoizedProps,r[qi]=t,(o=r.nodeValue!==n)&&(e=Wr,e!==null))switch(e.tag){case 3:Tf(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Tf(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[qi]=t,t.stateNode=r}return Ln(t),null;case 13:if(It(At),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Pt&&Fr!==null&&t.mode&1&&!(t.flags&128))AR(),Qu(),t.flags|=98560,o=!1;else if(o=Of(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(fe(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(fe(317));o[qi]=t}else Qu(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ln(t),o=!1}else bi!==null&&(Zy(bi),bi=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||At.current&1?on===0&&(on=3):iw())),t.updateQueue!==null&&(t.flags|=4),Ln(t),null);case 4:return Zu(),Hy(e,t),e===null&&Kl(t.stateNode.containerInfo),Ln(t),null;case 10:return Vb(t.type._context),Ln(t),null;case 17:return Sr(t.type)&&ep(),Ln(t),null;case 19:if(It(At),o=t.memoizedState,o===null)return Ln(t),null;if(r=(t.flags&128)!==0,a=o.rendering,a===null)if(r)Qc(o,!1);else{if(on!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=sp(e),a!==null){for(t.flags|=128,Qc(o,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,e=a.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return St(At,At.current&1|2),t.child}e=e.sibling}o.tail!==null&&Xt()>tc&&(t.flags|=128,r=!0,Qc(o,!1),t.lanes=4194304)}else{if(!r)if(e=sp(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Qc(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!Pt)return Ln(t),null}else 2*Xt()-o.renderingStartTime>tc&&n!==1073741824&&(t.flags|=128,r=!0,Qc(o,!1),t.lanes=4194304);o.isBackwards?(a.sibling=t.child,t.child=a):(n=o.last,n!==null?n.sibling=a:t.child=a,o.last=a)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Xt(),t.sibling=null,n=At.current,St(At,r?n&1|2:n&1),t):(Ln(t),null);case 22:case 23:return rw(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Nr&1073741824&&(Ln(t),t.subtreeFlags&6&&(t.flags|=8192)):Ln(t),null;case 24:return null;case 25:return null}throw Error(fe(156,t.tag))}function h4(e,t){switch(Fb(t),t.tag){case 1:return Sr(t.type)&&ep(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Zu(),It(Er),It(Jn),Gb(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Hb(t),null;case 13:if(It(At),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(fe(340));Qu()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return It(At),null;case 4:return Zu(),null;case 10:return Vb(t.type._context),null;case 22:case 23:return rw(),null;case 24:return null;default:return null}}var Df=!1,zn=!1,p4=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function Ru(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){zt(e,t,r)}else n.current=null}function Gy(e,t,n){try{n()}catch(r){zt(e,t,r)}}var dS=!1;function v4(e,t){if(Ty=Yh,e=xR(),Mb(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,s=-1,u=-1,c=0,l=0,d=e,f=null;t:for(;;){for(var h;d!==n||i!==0&&d.nodeType!==3||(s=a+i),d!==o||r!==0&&d.nodeType!==3||(u=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===e)break t;if(f===n&&++c===i&&(s=a),f===o&&++l===r&&(u=a),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=s===-1||u===-1?null:{start:s,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Oy={focusedElem:e,selectionRange:n},Yh=!1,Ce=t;Ce!==null;)if(t=Ce,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ce=e;else for(;Ce!==null;){t=Ce;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:vi(t.type,m),g);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(fe(163))}}catch(w){zt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,Ce=e;break}Ce=t.return}return p=dS,dS=!1,p}function Tl(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&Gy(t,n,o)}i=i.next}while(i!==r)}}function Iv(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function qy(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function gI(e){var t=e.alternate;t!==null&&(e.alternate=null,gI(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[qi],delete t[Ql],delete t[Dy],delete t[Q3],delete t[J3])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function yI(e){return e.tag===5||e.tag===3||e.tag===4}function fS(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||yI(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Xy(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Zh));else if(r!==4&&(e=e.child,e!==null))for(Xy(e,t,n),e=e.sibling;e!==null;)Xy(e,t,n),e=e.sibling}function Ky(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Ky(e,t,n),e=e.sibling;e!==null;)Ky(e,t,n),e=e.sibling}var kn=null,mi=!1;function Wo(e,t,n){for(n=n.child;n!==null;)bI(e,t,n),n=n.sibling}function bI(e,t,n){if(Ji&&typeof Ji.onCommitFiberUnmount=="function")try{Ji.onCommitFiberUnmount(wv,n)}catch{}switch(n.tag){case 5:zn||Ru(n,t);case 6:var r=kn,i=mi;kn=null,Wo(e,t,n),kn=r,mi=i,kn!==null&&(mi?(e=kn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):kn.removeChild(n.stateNode));break;case 18:kn!==null&&(mi?(e=kn,n=n.stateNode,e.nodeType===8?gg(e.parentNode,n):e.nodeType===1&&gg(e,n),Gl(e)):gg(kn,n.stateNode));break;case 4:r=kn,i=mi,kn=n.stateNode.containerInfo,mi=!0,Wo(e,t,n),kn=r,mi=i;break;case 0:case 11:case 14:case 15:if(!zn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&Gy(n,t,a),i=i.next}while(i!==r)}Wo(e,t,n);break;case 1:if(!zn&&(Ru(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){zt(n,t,s)}Wo(e,t,n);break;case 21:Wo(e,t,n);break;case 22:n.mode&1?(zn=(r=zn)||n.memoizedState!==null,Wo(e,t,n),zn=r):Wo(e,t,n);break;default:Wo(e,t,n)}}function hS(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new p4),t.forEach(function(r){var i=C4.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function fi(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,a=t,s=a;e:for(;s!==null;){switch(s.tag){case 5:kn=s.stateNode,mi=!1;break e;case 3:kn=s.stateNode.containerInfo,mi=!0;break e;case 4:kn=s.stateNode.containerInfo,mi=!0;break e}s=s.return}if(kn===null)throw Error(fe(160));bI(o,a,i),kn=null,mi=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(c){zt(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)wI(t,e),t=t.sibling}function wI(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fi(t,e),Fi(e),r&4){try{Tl(3,e,e.return),Iv(3,e)}catch(m){zt(e,e.return,m)}try{Tl(5,e,e.return)}catch(m){zt(e,e.return,m)}}break;case 1:fi(t,e),Fi(e),r&512&&n!==null&&Ru(n,n.return);break;case 5:if(fi(t,e),Fi(e),r&512&&n!==null&&Ru(n,n.return),e.flags&32){var i=e.stateNode;try{Wl(i,"")}catch(m){zt(e,e.return,m)}}if(r&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,a=n!==null?n.memoizedProps:o,s=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{s==="input"&&o.type==="radio"&&o.name!=null&&Wk(i,o),by(s,a);var c=by(s,o);for(a=0;a<u.length;a+=2){var l=u[a],d=u[a+1];l==="style"?qk(i,d):l==="dangerouslySetInnerHTML"?Hk(i,d):l==="children"?Wl(i,d):Eb(i,l,d,c)}switch(s){case"input":py(i,o);break;case"textarea":Uk(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?Nu(i,!!o.multiple,h,!1):f!==!!o.multiple&&(o.defaultValue!=null?Nu(i,!!o.multiple,o.defaultValue,!0):Nu(i,!!o.multiple,o.multiple?[]:"",!1))}i[Ql]=o}catch(m){zt(e,e.return,m)}}break;case 6:if(fi(t,e),Fi(e),r&4){if(e.stateNode===null)throw Error(fe(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(m){zt(e,e.return,m)}}break;case 3:if(fi(t,e),Fi(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Gl(t.containerInfo)}catch(m){zt(e,e.return,m)}break;case 4:fi(t,e),Fi(e);break;case 13:fi(t,e),Fi(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(tw=Xt())),r&4&&hS(e);break;case 22:if(l=n!==null&&n.memoizedState!==null,e.mode&1?(zn=(c=zn)||l,fi(t,e),zn=c):fi(t,e),Fi(e),r&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!l&&e.mode&1)for(Ce=e,l=e.child;l!==null;){for(d=Ce=l;Ce!==null;){switch(f=Ce,h=f.child,f.tag){case 0:case 11:case 14:case 15:Tl(4,f,f.return);break;case 1:Ru(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){zt(r,n,m)}}break;case 5:Ru(f,f.return);break;case 22:if(f.memoizedState!==null){vS(d);continue}}h!==null?(h.return=f,Ce=h):vS(d)}l=l.sibling}e:for(l=null,d=e;;){if(d.tag===5){if(l===null){l=d;try{i=d.stateNode,c?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(s=d.stateNode,u=d.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,s.style.display=Gk("display",a))}catch(m){zt(e,e.return,m)}}}else if(d.tag===6){if(l===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){zt(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;l===d&&(l=null),d=d.return}l===d&&(l=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:fi(t,e),Fi(e),r&4&&hS(e);break;case 21:break;default:fi(t,e),Fi(e)}}function Fi(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(yI(n)){var r=n;break e}n=n.return}throw Error(fe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Wl(i,""),r.flags&=-33);var o=fS(e);Ky(e,o,i);break;case 3:case 4:var a=r.stateNode.containerInfo,s=fS(e);Xy(e,s,a);break;default:throw Error(fe(161))}}catch(u){zt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function m4(e,t,n){Ce=e,xI(e)}function xI(e,t,n){for(var r=(e.mode&1)!==0;Ce!==null;){var i=Ce,o=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||Df;if(!a){var s=i.alternate,u=s!==null&&s.memoizedState!==null||zn;s=Df;var c=zn;if(Df=a,(zn=u)&&!c)for(Ce=i;Ce!==null;)a=Ce,u=a.child,a.tag===22&&a.memoizedState!==null?mS(i):u!==null?(u.return=a,Ce=u):mS(i);for(;o!==null;)Ce=o,xI(o),o=o.sibling;Ce=i,Df=s,zn=c}pS(e)}else i.subtreeFlags&8772&&o!==null?(o.return=i,Ce=o):pS(e)}}function pS(e){for(;Ce!==null;){var t=Ce;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:zn||Iv(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!zn)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:vi(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&JE(t,o,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}JE(t,a,n)}break;case 5:var s=t.stateNode;if(n===null&&t.flags&4){n=s;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var l=c.memoizedState;if(l!==null){var d=l.dehydrated;d!==null&&Gl(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(fe(163))}zn||t.flags&512&&qy(t)}catch(f){zt(t,t.return,f)}}if(t===e){Ce=null;break}if(n=t.sibling,n!==null){n.return=t.return,Ce=n;break}Ce=t.return}}function vS(e){for(;Ce!==null;){var t=Ce;if(t===e){Ce=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Ce=n;break}Ce=t.return}}function mS(e){for(;Ce!==null;){var t=Ce;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Iv(4,t)}catch(u){zt(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(u){zt(t,i,u)}}var o=t.return;try{qy(t)}catch(u){zt(t,o,u)}break;case 5:var a=t.return;try{qy(t)}catch(u){zt(t,a,u)}}}catch(u){zt(t,t.return,u)}if(t===e){Ce=null;break}var s=t.sibling;if(s!==null){s.return=t.return,Ce=s;break}Ce=t.return}}var g4=Math.ceil,lp=Oo.ReactCurrentDispatcher,Zb=Oo.ReactCurrentOwner,ri=Oo.ReactCurrentBatchConfig,ot=0,yn=null,en=null,Nn=0,Nr=0,Iu=Aa(0),on=0,rd=null,_s=0,Tv=0,ew=0,Ol=null,mr=null,tw=0,tc=1/0,mo=null,dp=!1,Yy=null,ga=null,Af=!1,aa=null,fp=0,Pl=0,Qy=null,Ih=-1,Th=0;function lr(){return ot&6?Xt():Ih!==-1?Ih:Ih=Xt()}function ya(e){return e.mode&1?ot&2&&Nn!==0?Nn&-Nn:e4.transition!==null?(Th===0&&(Th=oR()),Th):(e=ht,e!==0||(e=window.event,e=e===void 0?16:fR(e.type)),e):1}function Si(e,t,n,r){if(50<Pl)throw Pl=0,Qy=null,Error(fe(185));kd(e,n,r),(!(ot&2)||e!==yn)&&(e===yn&&(!(ot&2)&&(Tv|=n),on===4&&ra(e,Nn)),Cr(e,r),n===1&&ot===0&&!(t.mode&1)&&(tc=Xt()+500,_v&&Ma()))}function Cr(e,t){var n=e.callbackNode;e3(e,t);var r=Kh(e,e===yn?Nn:0);if(r===0)n!==null&&_E(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&_E(n),t===1)e.tag===0?Z3(gS.bind(null,e)):PR(gS.bind(null,e)),K3(function(){!(ot&6)&&Ma()}),n=null;else{switch(aR(r)){case 1:n=Rb;break;case 4:n=rR;break;case 16:n=Xh;break;case 536870912:n=iR;break;default:n=Xh}n=TI(n,EI.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function EI(e,t){if(Ih=-1,Th=0,ot&6)throw Error(fe(327));var n=e.callbackNode;if(Fu()&&e.callbackNode!==n)return null;var r=Kh(e,e===yn?Nn:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=hp(e,r);else{t=r;var i=ot;ot|=2;var o=CI();(yn!==e||Nn!==t)&&(mo=null,tc=Xt()+500,hs(e,t));do try{w4();break}catch(s){SI(e,s)}while(!0);$b(),lp.current=o,ot=i,en!==null?t=0:(yn=null,Nn=0,t=on)}if(t!==0){if(t===2&&(i=Cy(e),i!==0&&(r=i,t=Jy(e,i))),t===1)throw n=rd,hs(e,0),ra(e,r),Cr(e,Xt()),n;if(t===6)ra(e,r);else{if(i=e.current.alternate,!(r&30)&&!y4(i)&&(t=hp(e,r),t===2&&(o=Cy(e),o!==0&&(r=o,t=Jy(e,o))),t===1))throw n=rd,hs(e,0),ra(e,r),Cr(e,Xt()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(fe(345));case 2:Ka(e,mr,mo);break;case 3:if(ra(e,r),(r&130023424)===r&&(t=tw+500-Xt(),10<t)){if(Kh(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){lr(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Ny(Ka.bind(null,e,mr,mo),t);break}Ka(e,mr,mo);break;case 4:if(ra(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-Ei(r);o=1<<a,a=t[a],a>i&&(i=a),r&=~o}if(r=i,r=Xt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*g4(r/1960))-r,10<r){e.timeoutHandle=Ny(Ka.bind(null,e,mr,mo),r);break}Ka(e,mr,mo);break;case 5:Ka(e,mr,mo);break;default:throw Error(fe(329))}}}return Cr(e,Xt()),e.callbackNode===n?EI.bind(null,e):null}function Jy(e,t){var n=Ol;return e.current.memoizedState.isDehydrated&&(hs(e,t).flags|=256),e=hp(e,t),e!==2&&(t=mr,mr=n,t!==null&&Zy(t)),e}function Zy(e){mr===null?mr=e:mr.push.apply(mr,e)}function y4(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Ri(o(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ra(e,t){for(t&=~ew,t&=~Tv,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ei(t),r=1<<n;e[n]=-1,t&=~r}}function gS(e){if(ot&6)throw Error(fe(327));Fu();var t=Kh(e,0);if(!(t&1))return Cr(e,Xt()),null;var n=hp(e,t);if(e.tag!==0&&n===2){var r=Cy(e);r!==0&&(t=r,n=Jy(e,r))}if(n===1)throw n=rd,hs(e,0),ra(e,t),Cr(e,Xt()),n;if(n===6)throw Error(fe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ka(e,mr,mo),Cr(e,Xt()),null}function nw(e,t){var n=ot;ot|=1;try{return e(t)}finally{ot=n,ot===0&&(tc=Xt()+500,_v&&Ma())}}function ks(e){aa!==null&&aa.tag===0&&!(ot&6)&&Fu();var t=ot;ot|=1;var n=ri.transition,r=ht;try{if(ri.transition=null,ht=1,e)return e()}finally{ht=r,ri.transition=n,ot=t,!(ot&6)&&Ma()}}function rw(){Nr=Iu.current,It(Iu)}function hs(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,X3(n)),en!==null)for(n=en.return;n!==null;){var r=n;switch(Fb(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ep();break;case 3:Zu(),It(Er),It(Jn),Gb();break;case 5:Hb(r);break;case 4:Zu();break;case 13:It(At);break;case 19:It(At);break;case 10:Vb(r.type._context);break;case 22:case 23:rw()}n=n.return}if(yn=e,en=e=ba(e.current,null),Nn=Nr=t,on=0,rd=null,ew=Tv=_s=0,mr=Ol=null,ns!==null){for(t=0;t<ns.length;t++)if(n=ns[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var a=o.next;o.next=i,r.next=a}n.pending=r}ns=null}return e}function SI(e,t){do{var n=en;try{if($b(),_h.current=cp,up){for(var r=Bt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}up=!1}if(Cs=0,vn=rn=Bt=null,Il=!1,ed=0,Zb.current=null,n===null||n.return===null){on=1,rd=t,en=null;break}e:{var o=e,a=n.return,s=n,u=t;if(t=Nn,s.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,l=s,d=l.tag;if(!(l.mode&1)&&(d===0||d===11||d===15)){var f=l.alternate;f?(l.updateQueue=f.updateQueue,l.memoizedState=f.memoizedState,l.lanes=f.lanes):(l.updateQueue=null,l.memoizedState=null)}var h=iS(a);if(h!==null){h.flags&=-257,oS(h,a,s,o,t),h.mode&1&&rS(o,c,t),t=h,u=c;var p=t.updateQueue;if(p===null){var m=new Set;m.add(u),t.updateQueue=m}else p.add(u);break e}else{if(!(t&1)){rS(o,c,t),iw();break e}u=Error(fe(426))}}else if(Pt&&s.mode&1){var g=iS(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),oS(g,a,s,o,t),Bb(ec(u,s));break e}}o=u=ec(u,s),on!==4&&(on=2),Ol===null?Ol=[o]:Ol.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var v=aI(o,u,t);QE(o,v);break e;case 1:s=u;var y=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(ga===null||!ga.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t;var w=sI(o,s,t);QE(o,w);break e}}o=o.return}while(o!==null)}kI(n)}catch(E){t=E,en===n&&n!==null&&(en=n=n.return);continue}break}while(!0)}function CI(){var e=lp.current;return lp.current=cp,e===null?cp:e}function iw(){(on===0||on===3||on===2)&&(on=4),yn===null||!(_s&268435455)&&!(Tv&268435455)||ra(yn,Nn)}function hp(e,t){var n=ot;ot|=2;var r=CI();(yn!==e||Nn!==t)&&(mo=null,hs(e,t));do try{b4();break}catch(i){SI(e,i)}while(!0);if($b(),ot=n,lp.current=r,en!==null)throw Error(fe(261));return yn=null,Nn=0,on}function b4(){for(;en!==null;)_I(en)}function w4(){for(;en!==null&&!HM();)_I(en)}function _I(e){var t=II(e.alternate,e,Nr);e.memoizedProps=e.pendingProps,t===null?kI(e):en=t,Zb.current=null}function kI(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=h4(n,t),n!==null){n.flags&=32767,en=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{on=6,en=null;return}}else if(n=f4(n,t,Nr),n!==null){en=n;return}if(t=t.sibling,t!==null){en=t;return}en=t=e}while(t!==null);on===0&&(on=5)}function Ka(e,t,n){var r=ht,i=ri.transition;try{ri.transition=null,ht=1,x4(e,t,n,r)}finally{ri.transition=i,ht=r}return null}function x4(e,t,n,r){do Fu();while(aa!==null);if(ot&6)throw Error(fe(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(fe(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(t3(e,o),e===yn&&(en=yn=null,Nn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Af||(Af=!0,TI(Xh,function(){return Fu(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=ri.transition,ri.transition=null;var a=ht;ht=1;var s=ot;ot|=4,Zb.current=null,v4(e,n),wI(n,e),V3(Oy),Yh=!!Ty,Oy=Ty=null,e.current=n,m4(n),GM(),ot=s,ht=a,ri.transition=o}else e.current=n;if(Af&&(Af=!1,aa=e,fp=i),o=e.pendingLanes,o===0&&(ga=null),KM(n.stateNode),Cr(e,Xt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(dp)throw dp=!1,e=Yy,Yy=null,e;return fp&1&&e.tag!==0&&Fu(),o=e.pendingLanes,o&1?e===Qy?Pl++:(Pl=0,Qy=e):Pl=0,Ma(),null}function Fu(){if(aa!==null){var e=aR(fp),t=ri.transition,n=ht;try{if(ri.transition=null,ht=16>e?16:e,aa===null)var r=!1;else{if(e=aa,aa=null,fp=0,ot&6)throw Error(fe(331));var i=ot;for(ot|=4,Ce=e.current;Ce!==null;){var o=Ce,a=o.child;if(Ce.flags&16){var s=o.deletions;if(s!==null){for(var u=0;u<s.length;u++){var c=s[u];for(Ce=c;Ce!==null;){var l=Ce;switch(l.tag){case 0:case 11:case 15:Tl(8,l,o)}var d=l.child;if(d!==null)d.return=l,Ce=d;else for(;Ce!==null;){l=Ce;var f=l.sibling,h=l.return;if(gI(l),l===c){Ce=null;break}if(f!==null){f.return=h,Ce=f;break}Ce=h}}}var p=o.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}Ce=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,Ce=a;else e:for(;Ce!==null;){if(o=Ce,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Tl(9,o,o.return)}var v=o.sibling;if(v!==null){v.return=o.return,Ce=v;break e}Ce=o.return}}var y=e.current;for(Ce=y;Ce!==null;){a=Ce;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,Ce=b;else e:for(a=y;Ce!==null;){if(s=Ce,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:Iv(9,s)}}catch(E){zt(s,s.return,E)}if(s===a){Ce=null;break e}var w=s.sibling;if(w!==null){w.return=s.return,Ce=w;break e}Ce=s.return}}if(ot=i,Ma(),Ji&&typeof Ji.onPostCommitFiberRoot=="function")try{Ji.onPostCommitFiberRoot(wv,e)}catch{}r=!0}return r}finally{ht=n,ri.transition=t}}return!1}function yS(e,t,n){t=ec(n,t),t=aI(e,t,1),e=ma(e,t,1),t=lr(),e!==null&&(kd(e,1,t),Cr(e,t))}function zt(e,t,n){if(e.tag===3)yS(e,e,n);else for(;t!==null;){if(t.tag===3){yS(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ga===null||!ga.has(r))){e=ec(n,e),e=sI(t,e,1),t=ma(t,e,1),e=lr(),t!==null&&(kd(t,1,e),Cr(t,e));break}}t=t.return}}function E4(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=lr(),e.pingedLanes|=e.suspendedLanes&n,yn===e&&(Nn&n)===n&&(on===4||on===3&&(Nn&130023424)===Nn&&500>Xt()-tw?hs(e,0):ew|=n),Cr(e,t)}function RI(e,t){t===0&&(e.mode&1?(t=Cf,Cf<<=1,!(Cf&130023424)&&(Cf=4194304)):t=1);var n=lr();e=Io(e,t),e!==null&&(kd(e,t,n),Cr(e,n))}function S4(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),RI(e,n)}function C4(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(fe(314))}r!==null&&r.delete(t),RI(e,n)}var II;II=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Er.current)br=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return br=!1,d4(e,t,n);br=!!(e.flags&131072)}else br=!1,Pt&&t.flags&1048576&&NR(t,rp,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Rh(e,t),e=t.pendingProps;var i=Yu(t,Jn.current);Lu(t,n),i=Xb(null,t,r,e,i,n);var o=Kb();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Sr(r)?(o=!0,tp(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Ub(t),i.updater=Rv,t.stateNode=i,i._reactInternals=t,jy(t,r,e,n),t=Wy(null,t,r,!0,o,n)):(t.tag=0,Pt&&o&&Lb(t),or(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Rh(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=k4(r),e=vi(r,e),i){case 0:t=Vy(null,t,r,e,n);break e;case 1:t=uS(null,t,r,e,n);break e;case 11:t=aS(null,t,r,e,n);break e;case 14:t=sS(null,t,r,vi(r.type,e),n);break e}throw Error(fe(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:vi(r,i),Vy(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:vi(r,i),uS(e,t,r,i,n);case 3:e:{if(dI(t),e===null)throw Error(fe(387));r=t.pendingProps,o=t.memoizedState,i=o.element,BR(e,t),ap(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=ec(Error(fe(423)),t),t=cS(e,t,r,n,i);break e}else if(r!==i){i=ec(Error(fe(424)),t),t=cS(e,t,r,n,i);break e}else for(Fr=va(t.stateNode.containerInfo.firstChild),Wr=t,Pt=!0,bi=null,n=LR(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Qu(),r===i){t=To(e,t,n);break e}or(e,t,r,n)}t=t.child}return t;case 5:return jR(t),e===null&&Ly(t),r=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,a=i.children,Py(r,i)?a=null:o!==null&&Py(r,o)&&(t.flags|=32),lI(e,t),or(e,t,a,n),t.child;case 6:return e===null&&Ly(t),null;case 13:return fI(e,t,n);case 4:return zb(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Ju(t,null,r,n):or(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:vi(r,i),aS(e,t,r,i,n);case 7:return or(e,t,t.pendingProps,n),t.child;case 8:return or(e,t,t.pendingProps.children,n),t.child;case 12:return or(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,St(ip,r._currentValue),r._currentValue=a,o!==null)if(Ri(o.value,a)){if(o.children===i.children&&!Er.current){t=To(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var s=o.dependencies;if(s!==null){a=o.child;for(var u=s.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=So(-1,n&-n),u.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var l=c.pending;l===null?u.next=u:(u.next=l.next,l.next=u),c.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),Fy(o.return,n,t),s.lanes|=n;break}u=u.next}}else if(o.tag===10)a=o.type===t.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(fe(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),Fy(a,n,t),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===t){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}or(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Lu(t,n),i=oi(i),r=r(i),t.flags|=1,or(e,t,r,n),t.child;case 14:return r=t.type,i=vi(r,t.pendingProps),i=vi(r.type,i),sS(e,t,r,i,n);case 15:return uI(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:vi(r,i),Rh(e,t),t.tag=1,Sr(r)?(e=!0,tp(t)):e=!1,Lu(t,n),oI(t,r,i),jy(t,r,i,n),Wy(null,t,r,!0,e,n);case 19:return hI(e,t,n);case 22:return cI(e,t,n)}throw Error(fe(156,t.tag))};function TI(e,t){return nR(e,t)}function _4(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ti(e,t,n,r){return new _4(e,t,n,r)}function ow(e){return e=e.prototype,!(!e||!e.isReactComponent)}function k4(e){if(typeof e=="function")return ow(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Cb)return 11;if(e===_b)return 14}return 2}function ba(e,t){var n=e.alternate;return n===null?(n=ti(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oh(e,t,n,r,i,o){var a=2;if(r=e,typeof e=="function")ow(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case yu:return ps(n.children,i,o,t);case Sb:a=8,i|=8;break;case cy:return e=ti(12,n,t,i|2),e.elementType=cy,e.lanes=o,e;case ly:return e=ti(13,n,t,i),e.elementType=ly,e.lanes=o,e;case dy:return e=ti(19,n,t,i),e.elementType=dy,e.lanes=o,e;case jk:return Ov(n,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Fk:a=10;break e;case Bk:a=9;break e;case Cb:a=11;break e;case _b:a=14;break e;case Zo:a=16,r=null;break e}throw Error(fe(130,e==null?e:typeof e,""))}return t=ti(a,n,t,i),t.elementType=e,t.type=r,t.lanes=o,t}function ps(e,t,n,r){return e=ti(7,e,r,t),e.lanes=n,e}function Ov(e,t,n,r){return e=ti(22,e,r,t),e.elementType=jk,e.lanes=n,e.stateNode={isHidden:!1},e}function _g(e,t,n){return e=ti(6,e,null,t),e.lanes=n,e}function kg(e,t,n){return t=ti(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function R4(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ag(0),this.expirationTimes=ag(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ag(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function aw(e,t,n,r,i,o,a,s,u){return e=new R4(e,t,n,s,u),t===1?(t=1,o===!0&&(t|=8)):t=0,o=ti(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ub(o),e}function I4(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gu,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function OI(e){if(!e)return ka;e=e._reactInternals;e:{if(Fs(e)!==e||e.tag!==1)throw Error(fe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Sr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(fe(171))}if(e.tag===1){var n=e.type;if(Sr(n))return OR(e,n,t)}return t}function PI(e,t,n,r,i,o,a,s,u){return e=aw(n,r,!0,e,i,o,a,s,u),e.context=OI(null),n=e.current,r=lr(),i=ya(n),o=So(r,i),o.callback=t??null,ma(n,o,i),e.current.lanes=i,kd(e,i,r),Cr(e,r),e}function Pv(e,t,n,r){var i=t.current,o=lr(),a=ya(i);return n=OI(n),t.context===null?t.context=n:t.pendingContext=n,t=So(o,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=ma(i,t,a),e!==null&&(Si(e,i,a,o),Ch(e,i,a)),a}function pp(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function bS(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function sw(e,t){bS(e,t),(e=e.alternate)&&bS(e,t)}function T4(){return null}var NI=typeof reportError=="function"?reportError:function(e){console.error(e)};function uw(e){this._internalRoot=e}Nv.prototype.render=uw.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(fe(409));Pv(e,t,null,null)};Nv.prototype.unmount=uw.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ks(function(){Pv(null,e,null,null)}),t[Ro]=null}};function Nv(e){this._internalRoot=e}Nv.prototype.unstable_scheduleHydration=function(e){if(e){var t=cR();e={blockedOn:null,target:e,priority:t};for(var n=0;n<na.length&&t!==0&&t<na[n].priority;n++);na.splice(n,0,e),n===0&&dR(e)}};function cw(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Dv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function wS(){}function O4(e,t,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var c=pp(a);o.call(c)}}var a=PI(t,r,e,0,null,!1,!1,"",wS);return e._reactRootContainer=a,e[Ro]=a.current,Kl(e.nodeType===8?e.parentNode:e),ks(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var s=r;r=function(){var c=pp(u);s.call(c)}}var u=aw(e,0,!1,null,null,!1,!1,"",wS);return e._reactRootContainer=u,e[Ro]=u.current,Kl(e.nodeType===8?e.parentNode:e),ks(function(){Pv(t,u,n,r)}),u}function Av(e,t,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if(typeof i=="function"){var s=i;i=function(){var u=pp(a);s.call(u)}}Pv(t,a,e,i)}else a=O4(n,t,e,i,r);return pp(a)}sR=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=gl(t.pendingLanes);n!==0&&(Ib(t,n|1),Cr(t,Xt()),!(ot&6)&&(tc=Xt()+500,Ma()))}break;case 13:ks(function(){var r=Io(e,1);if(r!==null){var i=lr();Si(r,e,1,i)}}),sw(e,1)}};Tb=function(e){if(e.tag===13){var t=Io(e,134217728);if(t!==null){var n=lr();Si(t,e,134217728,n)}sw(e,134217728)}};uR=function(e){if(e.tag===13){var t=ya(e),n=Io(e,t);if(n!==null){var r=lr();Si(n,e,t,r)}sw(e,t)}};cR=function(){return ht};lR=function(e,t){var n=ht;try{return ht=e,t()}finally{ht=n}};xy=function(e,t,n){switch(t){case"input":if(py(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Cv(r);if(!i)throw Error(fe(90));Vk(r),py(r,i)}}}break;case"textarea":Uk(e,n);break;case"select":t=n.value,t!=null&&Nu(e,!!n.multiple,t,!1)}};Yk=nw;Qk=ks;var P4={usingClientEntryPoint:!1,Events:[Id,Eu,Cv,Xk,Kk,nw]},Jc={findFiberByHostInstance:ts,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},N4={bundleType:Jc.bundleType,version:Jc.version,rendererPackageName:Jc.rendererPackageName,rendererConfig:Jc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Oo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=eR(e),e===null?null:e.stateNode},findFiberByHostInstance:Jc.findFiberByHostInstance||T4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mf.isDisabled&&Mf.supportsFiber)try{wv=Mf.inject(N4),Ji=Mf}catch{}}Gr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P4;Gr.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!cw(t))throw Error(fe(200));return I4(e,t,null,n)};Gr.createRoot=function(e,t){if(!cw(e))throw Error(fe(299));var n=!1,r="",i=NI;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=aw(e,1,!1,null,null,n,!1,r,i),e[Ro]=t.current,Kl(e.nodeType===8?e.parentNode:e),new uw(t)};Gr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(fe(188)):(e=Object.keys(e).join(","),Error(fe(268,e)));return e=eR(t),e=e===null?null:e.stateNode,e};Gr.flushSync=function(e){return ks(e)};Gr.hydrate=function(e,t,n){if(!Dv(t))throw Error(fe(200));return Av(null,e,t,!0,n)};Gr.hydrateRoot=function(e,t,n){if(!cw(e))throw Error(fe(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",a=NI;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=PI(t,null,e,1,n??null,i,!1,o,a),e[Ro]=t.current,Kl(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Nv(t)};Gr.render=function(e,t,n){if(!Dv(t))throw Error(fe(200));return Av(null,e,t,!1,n)};Gr.unmountComponentAtNode=function(e){if(!Dv(e))throw Error(fe(40));return e._reactRootContainer?(ks(function(){Av(null,null,e,!1,function(){e._reactRootContainer=null,e[Ro]=null})}),!0):!1};Gr.unstable_batchedUpdates=nw;Gr.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Dv(n))throw Error(fe(200));if(e==null||e._reactInternals===void 0)throw Error(fe(38));return Av(e,t,n,!1,r)};Gr.version="18.3.1-next-f1338f8080-20240426";function DI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(DI)}catch(e){console.error(e)}}DI(),Dk.exports=Gr;var _r=Dk.exports;const D4=Ms(_r),A4=xk({__proto__:null,default:D4},[_r]);var xS=_r;sy.createRoot=xS.createRoot,sy.hydrateRoot=xS.hydrateRoot;/**
 * @remix-run/router v1.17.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dt(){return Dt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Dt.apply(this,arguments)}var Jt;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Jt||(Jt={}));const ES="popstate";function M4(e){e===void 0&&(e={});function t(r,i){let{pathname:o,search:a,hash:s}=r.location;return id("",{pathname:o,search:a,hash:s},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Rs(i)}return F4(t,n,null,e)}function Xe(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function nc(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function L4(){return Math.random().toString(36).substr(2,8)}function SS(e,t){return{usr:e.state,key:e.key,idx:t}}function id(e,t,n,r){return n===void 0&&(n=null),Dt({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?La(t):t,{state:n,key:t&&t.key||r||L4()})}function Rs(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function La(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function F4(e,t,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,a=i.history,s=Jt.Pop,u=null,c=l();c==null&&(c=0,a.replaceState(Dt({},a.state,{idx:c}),""));function l(){return(a.state||{idx:null}).idx}function d(){s=Jt.Pop;let g=l(),v=g==null?null:g-c;c=g,u&&u({action:s,location:m.location,delta:v})}function f(g,v){s=Jt.Push;let y=id(m.location,g,v);c=l()+1;let b=SS(y,c),w=m.createHref(y);try{a.pushState(b,"",w)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;i.location.assign(w)}o&&u&&u({action:s,location:m.location,delta:1})}function h(g,v){s=Jt.Replace;let y=id(m.location,g,v);c=l();let b=SS(y,c),w=m.createHref(y);a.replaceState(b,"",w),o&&u&&u({action:s,location:m.location,delta:0})}function p(g){let v=i.location.origin!=="null"?i.location.origin:i.location.href,y=typeof g=="string"?g:Rs(g);return y=y.replace(/ $/,"%20"),Xe(v,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,v)}let m={get action(){return s},get location(){return e(i,a)},listen(g){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(ES,d),u=g,()=>{i.removeEventListener(ES,d),u=null}},createHref(g){return t(i,g)},createURL:p,encodeLocation(g){let v=p(g);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:h,go(g){return a.go(g)}};return m}var Et;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Et||(Et={}));const B4=new Set(["lazy","caseSensitive","path","id","index","children"]);function j4(e){return e.index===!0}function od(e,t,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),e.map((i,o)=>{let a=[...n,String(o)],s=typeof i.id=="string"?i.id:a.join("-");if(Xe(i.index!==!0||!i.children,"Cannot specify children on an index route"),Xe(!r[s],'Found a route id collision on id "'+s+`".  Route id's must be globally unique within Data Router usages`),j4(i)){let u=Dt({},i,t(i),{id:s});return r[s]=u,u}else{let u=Dt({},i,t(i),{id:s,children:void 0});return r[s]=u,i.children&&(u.children=od(i.children,t,a,r)),u}})}function Za(e,t,n){return n===void 0&&(n="/"),Ph(e,t,n,!1)}function Ph(e,t,n,r){let i=typeof t=="string"?La(t):t,o=Sc(i.pathname||"/",n);if(o==null)return null;let a=AI(e);V4(a);let s=null;for(let u=0;s==null&&u<a.length;++u){let c=J4(o);s=Y4(a[u],c,r)}return s}function $4(e,t){let{route:n,pathname:r,params:i}=e;return{id:n.id,pathname:r,params:i,data:t[n.id],handle:n.handle}}function AI(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(o,a,s)=>{let u={relativePath:s===void 0?o.path||"":s,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};u.relativePath.startsWith("/")&&(Xe(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let c=Co([r,u.relativePath]),l=n.concat(u);o.children&&o.children.length>0&&(Xe(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),AI(o.children,t,l,c)),!(o.path==null&&!o.index)&&t.push({path:c,score:X4(c,o.index),routesMeta:l})};return e.forEach((o,a)=>{var s;if(o.path===""||!((s=o.path)!=null&&s.includes("?")))i(o,a);else for(let u of MI(o.path))i(o,a,u)}),t}function MI(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let a=MI(r.join("/")),s=[];return s.push(...a.map(u=>u===""?o:[o,u].join("/"))),i&&s.push(...a),s.map(u=>e.startsWith("/")&&u===""?"/":u)}function V4(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:K4(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const W4=/^:[\w-]+$/,U4=3,z4=2,H4=1,G4=10,q4=-2,CS=e=>e==="*";function X4(e,t){let n=e.split("/"),r=n.length;return n.some(CS)&&(r+=q4),t&&(r+=z4),n.filter(i=>!CS(i)).reduce((i,o)=>i+(W4.test(o)?U4:o===""?H4:G4),r)}function K4(e,t){return e.length===t.length&&e.slice(0,-1).every((r,i)=>r===t[i])?e[e.length-1]-t[t.length-1]:0}function Y4(e,t,n){n===void 0&&(n=!1);let{routesMeta:r}=e,i={},o="/",a=[];for(let s=0;s<r.length;++s){let u=r[s],c=s===r.length-1,l=o==="/"?t:t.slice(o.length)||"/",d=_S({path:u.relativePath,caseSensitive:u.caseSensitive,end:c},l),f=u.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=_S({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},l)),!d)return null;Object.assign(i,d.params),a.push({params:i,pathname:Co([o,d.pathname]),pathnameBase:tL(Co([o,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(o=Co([o,d.pathnameBase]))}return a}function _S(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=Q4(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let o=i[0],a=o.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:r.reduce((c,l,d)=>{let{paramName:f,isOptional:h}=l;if(f==="*"){let m=s[d]||"";a=o.slice(0,o.length-m.length).replace(/(.)\/+$/,"$1")}const p=s[d];return h&&!p?c[f]=void 0:c[f]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:a,pattern:e}}function Q4(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),nc(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,s,u)=>(r.push({paramName:s,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function J4(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return nc(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Sc(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function Z4(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:i=""}=typeof e=="string"?La(e):e;return{pathname:n?n.startsWith("/")?n:eL(n,t):t,search:nL(r),hash:rL(i)}}function eL(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Rg(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function LI(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Mv(e,t){let n=LI(e);return t?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Lv(e,t,n,r){r===void 0&&(r=!1);let i;typeof e=="string"?i=La(e):(i=Dt({},e),Xe(!i.pathname||!i.pathname.includes("?"),Rg("?","pathname","search",i)),Xe(!i.pathname||!i.pathname.includes("#"),Rg("#","pathname","hash",i)),Xe(!i.search||!i.search.includes("#"),Rg("#","search","hash",i)));let o=e===""||i.pathname==="",a=o?"/":i.pathname,s;if(a==null)s=n;else{let d=t.length-1;if(!r&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}s=d>=0?t[d]:"/"}let u=Z4(i,s),c=a&&a!=="/"&&a.endsWith("/"),l=(o||a===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(c||l)&&(u.pathname+="/"),u}const Co=e=>e.join("/").replace(/\/\/+/g,"/"),tL=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),nL=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,rL=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class lw{constructor(t,n,r,i){i===void 0&&(i=!1),this.status=t,this.statusText=n||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function Fv(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const FI=["post","put","patch","delete"],iL=new Set(FI),oL=["get",...FI],aL=new Set(oL),sL=new Set([301,302,303,307,308]),uL=new Set([307,308]),Ig={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},cL={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Zc={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},dw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,lL=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),BI="remix-router-transitions";function dL(e){const t=e.window?e.window:typeof window<"u"?window:void 0,n=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u",r=!n;Xe(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(e.mapRouteProperties)i=e.mapRouteProperties;else if(e.detectErrorBoundary){let G=e.detectErrorBoundary;i=K=>({hasErrorBoundary:G(K)})}else i=lL;let o={},a=od(e.routes,i,void 0,o),s,u=e.basename||"/",c=e.unstable_dataStrategy||mL,l=e.unstable_patchRoutesOnMiss,d=Dt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,unstable_skipActionErrorRevalidation:!1},e.future),f=null,h=new Set,p=null,m=null,g=null,v=e.hydrationData!=null,y=Za(a,e.history.location,u),b=null;if(y==null&&!l){let G=ir(404,{pathname:e.history.location.pathname}),{matches:K,route:te}=MS(a);y=K,b={[te.id]:G}}y&&l&&eg(y,a,e.history.location.pathname).active&&(y=null);let w;if(!y)w=!1,y=[];else if(y.some(G=>G.route.lazy))w=!1;else if(!y.some(G=>G.route.loader))w=!0;else if(d.v7_partialHydration){let G=e.hydrationData?e.hydrationData.loaderData:null,K=e.hydrationData?e.hydrationData.errors:null,te=se=>se.route.loader?typeof se.route.loader=="function"&&se.route.loader.hydrate===!0?!1:G&&G[se.route.id]!==void 0||K&&K[se.route.id]!==void 0:!0;if(K){let se=y.findIndex(Ee=>K[Ee.route.id]!==void 0);w=y.slice(0,se+1).every(te)}else w=y.every(te)}else w=e.hydrationData!=null;let E,x={historyAction:e.history.action,location:e.history.location,matches:y,initialized:w,navigation:Ig,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||b,fetchers:new Map,blockers:new Map},R=Jt.Pop,S=!1,_,T=!1,B=new Map,L=null,k=!1,D=!1,F=[],M=[],I=new Map,N=0,j=-1,P=new Map,A=new Set,U=new Map,H=new Map,q=new Set,Q=new Map,V=new Map,re=new Map,Z=!1;function he(){if(f=e.history.listen(G=>{let{action:K,location:te,delta:se}=G;if(Z){Z=!1;return}nc(V.size===0||se!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Ee=cE({currentLocation:x.location,nextLocation:te,historyAction:K});if(Ee&&se!=null){Z=!0,e.history.go(se*-1),hf(Ee,{state:"blocked",location:te,proceed(){hf(Ee,{state:"proceeding",proceed:void 0,reset:void 0,location:te}),e.history.go(se)},reset(){let Pe=new Map(x.blockers);Pe.set(Ee,Zc),pe({blockers:Pe})}});return}return be(K,te)}),n){TL(t,B);let G=()=>OL(t,B);t.addEventListener("pagehide",G),L=()=>t.removeEventListener("pagehide",G)}return x.initialized||be(Jt.Pop,x.location,{initialHydration:!0}),E}function xe(){f&&f(),L&&L(),h.clear(),_&&_.abort(),x.fetchers.forEach((G,K)=>Mi(K)),x.blockers.forEach((G,K)=>uE(K))}function ie(G){return h.add(G),()=>h.delete(G)}function pe(G,K){K===void 0&&(K={}),x=Dt({},x,G);let te=[],se=[];d.v7_fetcherPersist&&x.fetchers.forEach((Ee,Pe)=>{Ee.state==="idle"&&(q.has(Pe)?se.push(Pe):te.push(Pe))}),[...h].forEach(Ee=>Ee(x,{deletedFetchers:se,unstable_viewTransitionOpts:K.viewTransitionOpts,unstable_flushSync:K.flushSync===!0})),d.v7_fetcherPersist&&(te.forEach(Ee=>x.fetchers.delete(Ee)),se.forEach(Ee=>Mi(Ee)))}function ce(G,K,te){var se,Ee;let{flushSync:Pe}=te===void 0?{}:te,Le=x.actionData!=null&&x.navigation.formMethod!=null&&gi(x.navigation.formMethod)&&x.navigation.state==="loading"&&((se=G.state)==null?void 0:se._isRedirect)!==!0,ve;K.actionData?Object.keys(K.actionData).length>0?ve=K.actionData:ve=null:Le?ve=x.actionData:ve=null;let ze=K.loaderData?DS(x.loaderData,K.loaderData,K.matches||[],K.errors):x.loaderData,De=x.blockers;De.size>0&&(De=new Map(De),De.forEach((st,gt)=>De.set(gt,Zc)));let Ae=S===!0||x.navigation.formMethod!=null&&gi(x.navigation.formMethod)&&((Ee=G.state)==null?void 0:Ee._isRedirect)!==!0;s&&(a=s,s=void 0),k||R===Jt.Pop||(R===Jt.Push?e.history.push(G,G.state):R===Jt.Replace&&e.history.replace(G,G.state));let vt;if(R===Jt.Pop){let st=B.get(x.location.pathname);st&&st.has(G.pathname)?vt={currentLocation:x.location,nextLocation:G}:B.has(G.pathname)&&(vt={currentLocation:G,nextLocation:x.location})}else if(T){let st=B.get(x.location.pathname);st?st.add(G.pathname):(st=new Set([G.pathname]),B.set(x.location.pathname,st)),vt={currentLocation:x.location,nextLocation:G}}pe(Dt({},K,{actionData:ve,loaderData:ze,historyAction:R,location:G,initialized:!0,navigation:Ig,revalidation:"idle",restoreScrollPosition:dE(G,K.matches||x.matches),preventScrollReset:Ae,blockers:De}),{viewTransitionOpts:vt,flushSync:Pe===!0}),R=Jt.Pop,S=!1,T=!1,k=!1,D=!1,F=[],M=[]}async function Y(G,K){if(typeof G=="number"){e.history.go(G);return}let te=e1(x.location,x.matches,u,d.v7_prependBasename,G,d.v7_relativeSplatPath,K==null?void 0:K.fromRouteId,K==null?void 0:K.relative),{path:se,submission:Ee,error:Pe}=kS(d.v7_normalizeFormMethod,!1,te,K),Le=x.location,ve=id(x.location,se,K&&K.state);ve=Dt({},ve,e.history.encodeLocation(ve));let ze=K&&K.replace!=null?K.replace:void 0,De=Jt.Push;ze===!0?De=Jt.Replace:ze===!1||Ee!=null&&gi(Ee.formMethod)&&Ee.formAction===x.location.pathname+x.location.search&&(De=Jt.Replace);let Ae=K&&"preventScrollReset"in K?K.preventScrollReset===!0:void 0,vt=(K&&K.unstable_flushSync)===!0,st=cE({currentLocation:Le,nextLocation:ve,historyAction:De});if(st){hf(st,{state:"blocked",location:ve,proceed(){hf(st,{state:"proceeding",proceed:void 0,reset:void 0,location:ve}),Y(G,K)},reset(){let gt=new Map(x.blockers);gt.set(st,Zc),pe({blockers:gt})}});return}return await be(De,ve,{submission:Ee,pendingError:Pe,preventScrollReset:Ae,replace:K&&K.replace,enableViewTransition:K&&K.unstable_viewTransition,flushSync:vt})}function de(){if(Ye(),pe({revalidation:"loading"}),x.navigation.state!=="submitting"){if(x.navigation.state==="idle"){be(x.historyAction,x.location,{startUninterruptedRevalidation:!0});return}be(R||x.historyAction,x.navigation.location,{overrideNavigation:x.navigation})}}async function be(G,K,te){_&&_.abort(),_=null,R=G,k=(te&&te.startUninterruptedRevalidation)===!0,nM(x.location,x.matches),S=(te&&te.preventScrollReset)===!0,T=(te&&te.enableViewTransition)===!0;let se=s||a,Ee=te&&te.overrideNavigation,Pe=Za(se,K,u),Le=(te&&te.flushSync)===!0,ve=eg(Pe,se,K.pathname);if(ve.active&&ve.matches&&(Pe=ve.matches),!Pe){let{error:ct,notFoundMatches:Cn,route:Qt}=Jm(K.pathname);ce(K,{matches:Cn,loaderData:{},errors:{[Qt.id]:ct}},{flushSync:Le});return}if(x.initialized&&!D&&EL(x.location,K)&&!(te&&te.submission&&gi(te.submission.formMethod))){ce(K,{matches:Pe},{flushSync:Le});return}_=new AbortController;let ze=Zs(e.history,K,_.signal,te&&te.submission),De;if(te&&te.pendingError)De=[Nl(Pe).route.id,{type:Et.error,error:te.pendingError}];else if(te&&te.submission&&gi(te.submission.formMethod)){let ct=await le(ze,K,te.submission,Pe,ve.active,{replace:te.replace,flushSync:Le});if(ct.shortCircuited)return;if(ct.pendingActionResult){let[Cn,Qt]=ct.pendingActionResult;if(Dr(Qt)&&Fv(Qt.error)&&Qt.error.status===404){_=null,ce(K,{matches:ct.matches,loaderData:{},errors:{[Cn]:Qt.error}});return}}Pe=ct.matches||Pe,De=ct.pendingActionResult,Ee=Tg(K,te.submission),Le=!1,ve.active=!1,ze=Zs(e.history,ze.url,ze.signal)}let{shortCircuited:Ae,matches:vt,loaderData:st,errors:gt}=await Tt(ze,K,Pe,ve.active,Ee,te&&te.submission,te&&te.fetcherSubmission,te&&te.replace,te&&te.initialHydration===!0,Le,De);Ae||(_=null,ce(K,Dt({matches:vt||Pe},AS(De),{loaderData:st,errors:gt})))}async function le(G,K,te,se,Ee,Pe){Pe===void 0&&(Pe={}),Ye();let Le=RL(K,te);if(pe({navigation:Le},{flushSync:Pe.flushSync===!0}),Ee){let De=await vf(se,K.pathname,G.signal);if(De.type==="aborted")return{shortCircuited:!0};if(De.type==="error"){let{error:Ae,notFoundMatches:vt,route:st}=pf(K.pathname,De);return{matches:vt,pendingActionResult:[st.id,{type:Et.error,error:Ae}]}}else if(De.matches)se=De.matches;else{let{notFoundMatches:Ae,error:vt,route:st}=Jm(K.pathname);return{matches:Ae,pendingActionResult:[st.id,{type:Et.error,error:vt}]}}}let ve,ze=bl(se,K);if(!ze.route.action&&!ze.route.lazy)ve={type:Et.error,error:ir(405,{method:G.method,pathname:K.pathname,routeId:ze.route.id})};else if(ve=(await it("action",G,[ze],se))[0],G.signal.aborted)return{shortCircuited:!0};if(os(ve)){let De;return Pe&&Pe.replace!=null?De=Pe.replace:De=OS(ve.response.headers.get("Location"),new URL(G.url),u)===x.location.pathname+x.location.search,await Sn(G,ve,{submission:te,replace:De}),{shortCircuited:!0}}if(is(ve))throw ir(400,{type:"defer-action"});if(Dr(ve)){let De=Nl(se,ze.route.id);return(Pe&&Pe.replace)!==!0&&(R=Jt.Push),{matches:se,pendingActionResult:[De.route.id,ve]}}return{matches:se,pendingActionResult:[ze.route.id,ve]}}async function Tt(G,K,te,se,Ee,Pe,Le,ve,ze,De,Ae){let vt=Ee||Tg(K,Pe),st=Pe||Le||BS(vt),gt=!k&&(!d.v7_partialHydration||!ze);if(se){if(gt){let Vt=yt(Ae);pe(Dt({navigation:vt},Vt!==void 0?{actionData:Vt}:{}),{flushSync:De})}let qe=await vf(te,K.pathname,G.signal);if(qe.type==="aborted")return{shortCircuited:!0};if(qe.type==="error"){let{error:Vt,notFoundMatches:Or,route:wt}=pf(K.pathname,qe);return{matches:Or,loaderData:{},errors:{[wt.id]:Vt}}}else if(qe.matches)te=qe.matches;else{let{error:Vt,notFoundMatches:Or,route:wt}=Jm(K.pathname);return{matches:Or,loaderData:{},errors:{[wt.id]:Vt}}}}let ct=s||a,[Cn,Qt]=RS(e.history,x,te,st,K,d.v7_partialHydration&&ze===!0,d.unstable_skipActionErrorRevalidation,D,F,M,q,U,A,ct,u,Ae);if(Zm(qe=>!(te&&te.some(Vt=>Vt.route.id===qe))||Cn&&Cn.some(Vt=>Vt.route.id===qe)),j=++N,Cn.length===0&&Qt.length===0){let qe=Xs();return ce(K,Dt({matches:te,loaderData:{},errors:Ae&&Dr(Ae[1])?{[Ae[0]]:Ae[1].error}:null},AS(Ae),qe?{fetchers:new Map(x.fetchers)}:{}),{flushSync:De}),{shortCircuited:!0}}if(gt){let qe={};if(!se){qe.navigation=vt;let Vt=yt(Ae);Vt!==void 0&&(qe.actionData=Vt)}Qt.length>0&&(qe.fetchers=Gt(Qt)),pe(qe,{flushSync:De})}Qt.forEach(qe=>{I.has(qe.key)&&hr(qe.key),qe.controller&&I.set(qe.key,qe.controller)});let zc=()=>Qt.forEach(qe=>hr(qe.key));_&&_.signal.addEventListener("abort",zc);let{loaderResults:Vo,fetcherResults:Ks}=await bt(x.matches,te,Cn,Qt,G);if(G.signal.aborted)return{shortCircuited:!0};_&&_.signal.removeEventListener("abort",zc),Qt.forEach(qe=>I.delete(qe.key));let Ys=LS([...Vo,...Ks]);if(Ys){if(Ys.idx>=Cn.length){let qe=Qt[Ys.idx-Cn.length].key;A.add(qe)}return await Sn(G,Ys.result,{replace:ve}),{shortCircuited:!0}}let{loaderData:Qs,errors:Li}=NS(x,te,Cn,Vo,Ae,Qt,Ks,Q);Q.forEach((qe,Vt)=>{qe.subscribe(Or=>{(Or||qe.done)&&Q.delete(Vt)})}),d.v7_partialHydration&&ze&&x.errors&&Object.entries(x.errors).filter(qe=>{let[Vt]=qe;return!Cn.some(Or=>Or.route.id===Vt)}).forEach(qe=>{let[Vt,Or]=qe;Li=Object.assign(Li||{},{[Vt]:Or})});let mf=Xs(),gf=sE(j),yf=mf||gf||Qt.length>0;return Dt({matches:te,loaderData:Qs,errors:Li},yf?{fetchers:new Map(x.fetchers)}:{})}function yt(G){if(G&&!Dr(G[1]))return{[G[0]]:G[1].data};if(x.actionData)return Object.keys(x.actionData).length===0?null:x.actionData}function Gt(G){return G.forEach(K=>{let te=x.fetchers.get(K.key),se=el(void 0,te?te.data:void 0);x.fetchers.set(K.key,se)}),new Map(x.fetchers)}function er(G,K,te,se){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");I.has(G)&&hr(G);let Ee=(se&&se.unstable_flushSync)===!0,Pe=s||a,Le=e1(x.location,x.matches,u,d.v7_prependBasename,te,d.v7_relativeSplatPath,K,se==null?void 0:se.relative),ve=Za(Pe,Le,u),ze=eg(ve,Pe,Le);if(ze.active&&ze.matches&&(ve=ze.matches),!ve){pt(G,K,ir(404,{pathname:Le}),{flushSync:Ee});return}let{path:De,submission:Ae,error:vt}=kS(d.v7_normalizeFormMethod,!0,Le,se);if(vt){pt(G,K,vt,{flushSync:Ee});return}let st=bl(ve,De);if(S=(se&&se.preventScrollReset)===!0,Ae&&gi(Ae.formMethod)){tr(G,K,De,st,ve,ze.active,Ee,Ae);return}U.set(G,{routeId:K,path:De}),An(G,K,De,st,ve,ze.active,Ee,Ae)}async function tr(G,K,te,se,Ee,Pe,Le,ve){Ye(),U.delete(G);function ze(wt){if(!wt.route.action&&!wt.route.lazy){let fo=ir(405,{method:ve.formMethod,pathname:te,routeId:K});return pt(G,K,fo,{flushSync:Le}),!0}return!1}if(!Pe&&ze(se))return;let De=x.fetchers.get(G);Ne(G,IL(ve,De),{flushSync:Le});let Ae=new AbortController,vt=Zs(e.history,te,Ae.signal,ve);if(Pe){let wt=await vf(Ee,te,vt.signal);if(wt.type==="aborted")return;if(wt.type==="error"){let{error:fo}=pf(te,wt);pt(G,K,fo,{flushSync:Le});return}else if(wt.matches){if(Ee=wt.matches,se=bl(Ee,te),ze(se))return}else{pt(G,K,ir(404,{pathname:te}),{flushSync:Le});return}}I.set(G,Ae);let st=N,ct=(await it("action",vt,[se],Ee))[0];if(vt.signal.aborted){I.get(G)===Ae&&I.delete(G);return}if(d.v7_fetcherPersist&&q.has(G)){if(os(ct)||Dr(ct)){Ne(G,Qo(void 0));return}}else{if(os(ct))if(I.delete(G),j>st){Ne(G,Qo(void 0));return}else return A.add(G),Ne(G,el(ve)),Sn(vt,ct,{fetcherSubmission:ve});if(Dr(ct)){pt(G,K,ct.error);return}}if(is(ct))throw ir(400,{type:"defer-action"});let Cn=x.navigation.location||x.location,Qt=Zs(e.history,Cn,Ae.signal),zc=s||a,Vo=x.navigation.state!=="idle"?Za(zc,x.navigation.location,u):x.matches;Xe(Vo,"Didn't find any matches after fetcher action");let Ks=++N;P.set(G,Ks);let Ys=el(ve,ct.data);x.fetchers.set(G,Ys);let[Qs,Li]=RS(e.history,x,Vo,ve,Cn,!1,d.unstable_skipActionErrorRevalidation,D,F,M,q,U,A,zc,u,[se.route.id,ct]);Li.filter(wt=>wt.key!==G).forEach(wt=>{let fo=wt.key,fE=x.fetchers.get(fo),oM=el(void 0,fE?fE.data:void 0);x.fetchers.set(fo,oM),I.has(fo)&&hr(fo),wt.controller&&I.set(fo,wt.controller)}),pe({fetchers:new Map(x.fetchers)});let mf=()=>Li.forEach(wt=>hr(wt.key));Ae.signal.addEventListener("abort",mf);let{loaderResults:gf,fetcherResults:yf}=await bt(x.matches,Vo,Qs,Li,Qt);if(Ae.signal.aborted)return;Ae.signal.removeEventListener("abort",mf),P.delete(G),I.delete(G),Li.forEach(wt=>I.delete(wt.key));let qe=LS([...gf,...yf]);if(qe){if(qe.idx>=Qs.length){let wt=Li[qe.idx-Qs.length].key;A.add(wt)}return Sn(Qt,qe.result)}let{loaderData:Vt,errors:Or}=NS(x,x.matches,Qs,gf,void 0,Li,yf,Q);if(x.fetchers.has(G)){let wt=Qo(ct.data);x.fetchers.set(G,wt)}sE(Ks),x.navigation.state==="loading"&&Ks>j?(Xe(R,"Expected pending action"),_&&_.abort(),ce(x.navigation.location,{matches:Vo,loaderData:Vt,errors:Or,fetchers:new Map(x.fetchers)})):(pe({errors:Or,loaderData:DS(x.loaderData,Vt,Vo,Or),fetchers:new Map(x.fetchers)}),D=!1)}async function An(G,K,te,se,Ee,Pe,Le,ve){let ze=x.fetchers.get(G);Ne(G,el(ve,ze?ze.data:void 0),{flushSync:Le});let De=new AbortController,Ae=Zs(e.history,te,De.signal);if(Pe){let ct=await vf(Ee,te,Ae.signal);if(ct.type==="aborted")return;if(ct.type==="error"){let{error:Cn}=pf(te,ct);pt(G,K,Cn,{flushSync:Le});return}else if(ct.matches)Ee=ct.matches,se=bl(Ee,te);else{pt(G,K,ir(404,{pathname:te}),{flushSync:Le});return}}I.set(G,De);let vt=N,gt=(await it("loader",Ae,[se],Ee))[0];if(is(gt)&&(gt=await UI(gt,Ae.signal,!0)||gt),I.get(G)===De&&I.delete(G),!Ae.signal.aborted){if(q.has(G)){Ne(G,Qo(void 0));return}if(os(gt))if(j>vt){Ne(G,Qo(void 0));return}else{A.add(G),await Sn(Ae,gt);return}if(Dr(gt)){pt(G,K,gt.error);return}Xe(!is(gt),"Unhandled fetcher deferred data"),Ne(G,Qo(gt.data))}}async function Sn(G,K,te){let{submission:se,fetcherSubmission:Ee,replace:Pe}=te===void 0?{}:te;K.response.headers.has("X-Remix-Revalidate")&&(D=!0);let Le=K.response.headers.get("Location");Xe(Le,"Expected a Location header on the redirect Response"),Le=OS(Le,new URL(G.url),u);let ve=id(x.location,Le,{_isRedirect:!0});if(n){let gt=!1;if(K.response.headers.has("X-Remix-Reload-Document"))gt=!0;else if(dw.test(Le)){const ct=e.history.createURL(Le);gt=ct.origin!==t.location.origin||Sc(ct.pathname,u)==null}if(gt){Pe?t.location.replace(Le):t.location.assign(Le);return}}_=null;let ze=Pe===!0?Jt.Replace:Jt.Push,{formMethod:De,formAction:Ae,formEncType:vt}=x.navigation;!se&&!Ee&&De&&Ae&&vt&&(se=BS(x.navigation));let st=se||Ee;if(uL.has(K.response.status)&&st&&gi(st.formMethod))await be(ze,ve,{submission:Dt({},st,{formAction:Le}),preventScrollReset:S});else{let gt=Tg(ve,se);await be(ze,ve,{overrideNavigation:gt,fetcherSubmission:Ee,preventScrollReset:S})}}async function it(G,K,te,se){try{let Ee=await gL(c,G,K,te,se,o,i);return await Promise.all(Ee.map((Pe,Le)=>{if(CL(Pe)){let ve=Pe.result;return{type:Et.redirect,response:wL(ve,K,te[Le].route.id,se,u,d.v7_relativeSplatPath)}}return bL(Pe)}))}catch(Ee){return te.map(()=>({type:Et.error,error:Ee}))}}async function bt(G,K,te,se,Ee){let[Pe,...Le]=await Promise.all([te.length?it("loader",Ee,te,K):[],...se.map(ve=>{if(ve.matches&&ve.match&&ve.controller){let ze=Zs(e.history,ve.path,ve.controller.signal);return it("loader",ze,[ve.match],ve.matches).then(De=>De[0])}else return Promise.resolve({type:Et.error,error:ir(404,{pathname:ve.path})})})]);return await Promise.all([FS(G,te,Pe,Pe.map(()=>Ee.signal),!1,x.loaderData),FS(G,se.map(ve=>ve.match),Le,se.map(ve=>ve.controller?ve.controller.signal:null),!0)]),{loaderResults:Pe,fetcherResults:Le}}function Ye(){D=!0,F.push(...Zm()),U.forEach((G,K)=>{I.has(K)&&(M.push(K),hr(K))})}function Ne(G,K,te){te===void 0&&(te={}),x.fetchers.set(G,K),pe({fetchers:new Map(x.fetchers)},{flushSync:(te&&te.flushSync)===!0})}function pt(G,K,te,se){se===void 0&&(se={});let Ee=Nl(x.matches,K);Mi(G),pe({errors:{[Ee.route.id]:te},fetchers:new Map(x.fetchers)},{flushSync:(se&&se.flushSync)===!0})}function Ua(G){return d.v7_fetcherPersist&&(H.set(G,(H.get(G)||0)+1),q.has(G)&&q.delete(G)),x.fetchers.get(G)||cL}function Mi(G){let K=x.fetchers.get(G);I.has(G)&&!(K&&K.state==="loading"&&P.has(G))&&hr(G),U.delete(G),P.delete(G),A.delete(G),q.delete(G),x.fetchers.delete(G)}function Uc(G){if(d.v7_fetcherPersist){let K=(H.get(G)||0)-1;K<=0?(H.delete(G),q.add(G)):H.set(G,K)}else Mi(G);pe({fetchers:new Map(x.fetchers)})}function hr(G){let K=I.get(G);Xe(K,"Expected fetch controller: "+G),K.abort(),I.delete(G)}function qs(G){for(let K of G){let te=Ua(K),se=Qo(te.data);x.fetchers.set(K,se)}}function Xs(){let G=[],K=!1;for(let te of A){let se=x.fetchers.get(te);Xe(se,"Expected fetcher: "+te),se.state==="loading"&&(A.delete(te),G.push(te),K=!0)}return qs(G),K}function sE(G){let K=[];for(let[te,se]of P)if(se<G){let Ee=x.fetchers.get(te);Xe(Ee,"Expected fetcher: "+te),Ee.state==="loading"&&(hr(te),P.delete(te),K.push(te))}return qs(K),K.length>0}function eM(G,K){let te=x.blockers.get(G)||Zc;return V.get(G)!==K&&V.set(G,K),te}function uE(G){x.blockers.delete(G),V.delete(G)}function hf(G,K){let te=x.blockers.get(G)||Zc;Xe(te.state==="unblocked"&&K.state==="blocked"||te.state==="blocked"&&K.state==="blocked"||te.state==="blocked"&&K.state==="proceeding"||te.state==="blocked"&&K.state==="unblocked"||te.state==="proceeding"&&K.state==="unblocked","Invalid blocker state transition: "+te.state+" -> "+K.state);let se=new Map(x.blockers);se.set(G,K),pe({blockers:se})}function cE(G){let{currentLocation:K,nextLocation:te,historyAction:se}=G;if(V.size===0)return;V.size>1&&nc(!1,"A router only supports one blocker at a time");let Ee=Array.from(V.entries()),[Pe,Le]=Ee[Ee.length-1],ve=x.blockers.get(Pe);if(!(ve&&ve.state==="proceeding")&&Le({currentLocation:K,nextLocation:te,historyAction:se}))return Pe}function Jm(G){let K=ir(404,{pathname:G}),te=s||a,{matches:se,route:Ee}=MS(te);return Zm(),{notFoundMatches:se,route:Ee,error:K}}function pf(G,K){let te=K.partialMatches,se=te[te.length-1].route,Ee=ir(400,{type:"route-discovery",routeId:se.id,pathname:G,message:K.error!=null&&"message"in K.error?K.error:String(K.error)});return{notFoundMatches:te,route:se,error:Ee}}function Zm(G){let K=[];return Q.forEach((te,se)=>{(!G||G(se))&&(te.cancel(),K.push(se),Q.delete(se))}),K}function tM(G,K,te){if(p=G,g=K,m=te||null,!v&&x.navigation===Ig){v=!0;let se=dE(x.location,x.matches);se!=null&&pe({restoreScrollPosition:se})}return()=>{p=null,g=null,m=null}}function lE(G,K){return m&&m(G,K.map(se=>$4(se,x.loaderData)))||G.key}function nM(G,K){if(p&&g){let te=lE(G,K);p[te]=g()}}function dE(G,K){if(p){let te=lE(G,K),se=p[te];if(typeof se=="number")return se}return null}function eg(G,K,te){if(l)if(G){let se=G[G.length-1].route;if(se.path&&(se.path==="*"||se.path.endsWith("/*")))return{active:!0,matches:Ph(K,te,u,!0)}}else return{active:!0,matches:Ph(K,te,u,!0)||[]};return{active:!1,matches:null}}async function vf(G,K,te){let se=G,Ee=se.length>0?se[se.length-1].route:null;for(;;){let Pe=s==null,Le=s||a;try{await vL(l,K,se,Le,o,i,re,te)}catch(Ae){return{type:"error",error:Ae,partialMatches:se}}finally{Pe&&(a=[...a])}if(te.aborted)return{type:"aborted"};let ve=Za(Le,K,u),ze=!1;if(ve){let Ae=ve[ve.length-1].route;if(Ae.index)return{type:"success",matches:ve};if(Ae.path&&Ae.path.length>0)if(Ae.path==="*")ze=!0;else return{type:"success",matches:ve}}let De=Ph(Le,K,u,!0);if(!De||se.map(Ae=>Ae.route.id).join("-")===De.map(Ae=>Ae.route.id).join("-"))return{type:"success",matches:ze?ve:null};if(se=De,Ee=se[se.length-1].route,Ee.path==="*")return{type:"success",matches:se}}}function rM(G){o={},s=od(G,i,void 0,o)}function iM(G,K){let te=s==null;$I(G,K,s||a,o,i),te&&(a=[...a],pe({}))}return E={get basename(){return u},get future(){return d},get state(){return x},get routes(){return a},get window(){return t},initialize:he,subscribe:ie,enableScrollRestoration:tM,navigate:Y,fetch:er,revalidate:de,createHref:G=>e.history.createHref(G),encodeLocation:G=>e.history.encodeLocation(G),getFetcher:Ua,deleteFetcher:Uc,dispose:xe,getBlocker:eM,deleteBlocker:uE,patchRoutes:iM,_internalFetchControllers:I,_internalActiveDeferreds:Q,_internalSetRoutes:rM},E}function fL(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function e1(e,t,n,r,i,o,a,s){let u,c;if(a){u=[];for(let d of t)if(u.push(d),d.route.id===a){c=d;break}}else u=t,c=t[t.length-1];let l=Lv(i||".",Mv(u,o),Sc(e.pathname,n)||e.pathname,s==="path");return i==null&&(l.search=e.search,l.hash=e.hash),(i==null||i===""||i===".")&&c&&c.route.index&&!fw(l.search)&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),r&&n!=="/"&&(l.pathname=l.pathname==="/"?n:Co([n,l.pathname])),Rs(l)}function kS(e,t,n,r){if(!r||!fL(r))return{path:n};if(r.formMethod&&!kL(r.formMethod))return{path:n,error:ir(405,{method:r.formMethod})};let i=()=>({path:n,error:ir(400,{type:"invalid-body"})}),o=r.formMethod||"get",a=e?o.toUpperCase():o.toLowerCase(),s=VI(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!gi(a))return i();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((h,p)=>{let[m,g]=p;return""+h+m+"="+g+`
`},""):String(r.body);return{path:n,submission:{formMethod:a,formAction:s,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!gi(a))return i();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:a,formAction:s,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return i()}}}Xe(typeof FormData=="function","FormData is not available in this environment");let u,c;if(r.formData)u=t1(r.formData),c=r.formData;else if(r.body instanceof FormData)u=t1(r.body),c=r.body;else if(r.body instanceof URLSearchParams)u=r.body,c=PS(u);else if(r.body==null)u=new URLSearchParams,c=new FormData;else try{u=new URLSearchParams(r.body),c=PS(u)}catch{return i()}let l={formMethod:a,formAction:s,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(gi(l.formMethod))return{path:n,submission:l};let d=La(n);return t&&d.search&&fw(d.search)&&u.append("index",""),d.search="?"+u,{path:Rs(d),submission:l}}function hL(e,t){let n=e;if(t){let r=e.findIndex(i=>i.route.id===t);r>=0&&(n=e.slice(0,r))}return n}function RS(e,t,n,r,i,o,a,s,u,c,l,d,f,h,p,m){let g=m?Dr(m[1])?m[1].error:m[1].data:void 0,v=e.createURL(t.location),y=e.createURL(i),b=m&&Dr(m[1])?m[0]:void 0,w=b?hL(n,b):n,E=m?m[1].statusCode:void 0,x=a&&E&&E>=400,R=w.filter((_,T)=>{let{route:B}=_;if(B.lazy)return!0;if(B.loader==null)return!1;if(o)return typeof B.loader!="function"||B.loader.hydrate?!0:t.loaderData[B.id]===void 0&&(!t.errors||t.errors[B.id]===void 0);if(pL(t.loaderData,t.matches[T],_)||u.some(D=>D===_.route.id))return!0;let L=t.matches[T],k=_;return IS(_,Dt({currentUrl:v,currentParams:L.params,nextUrl:y,nextParams:k.params},r,{actionResult:g,unstable_actionStatus:E,defaultShouldRevalidate:x?!1:s||v.pathname+v.search===y.pathname+y.search||v.search!==y.search||jI(L,k)}))}),S=[];return d.forEach((_,T)=>{if(o||!n.some(F=>F.route.id===_.routeId)||l.has(T))return;let B=Za(h,_.path,p);if(!B){S.push({key:T,routeId:_.routeId,path:_.path,matches:null,match:null,controller:null});return}let L=t.fetchers.get(T),k=bl(B,_.path),D=!1;f.has(T)?D=!1:c.includes(T)?D=!0:L&&L.state!=="idle"&&L.data===void 0?D=s:D=IS(k,Dt({currentUrl:v,currentParams:t.matches[t.matches.length-1].params,nextUrl:y,nextParams:n[n.length-1].params},r,{actionResult:g,unstable_actionStatus:E,defaultShouldRevalidate:x?!1:s})),D&&S.push({key:T,routeId:_.routeId,path:_.path,matches:B,match:k,controller:new AbortController})}),[R,S]}function pL(e,t,n){let r=!t||n.route.id!==t.route.id,i=e[n.route.id]===void 0;return r||i}function jI(e,t){let n=e.route.path;return e.pathname!==t.pathname||n!=null&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function IS(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if(typeof n=="boolean")return n}return t.defaultShouldRevalidate}async function vL(e,t,n,r,i,o,a,s){let u=[t,...n.map(c=>c.route.id)].join("-");try{let c=a.get(u);c||(c=e({path:t,matches:n,patch:(l,d)=>{s.aborted||$I(l,d,r,i,o)}}),a.set(u,c)),c&&SL(c)&&await c}finally{a.delete(u)}}function $I(e,t,n,r,i){if(e){var o;let a=r[e];Xe(a,"No route found to patch children into: routeId = "+e);let s=od(t,i,[e,"patch",String(((o=a.children)==null?void 0:o.length)||"0")],r);a.children?a.children.push(...s):a.children=s}else{let a=od(t,i,["patch",String(n.length||"0")],r);n.push(...a)}}async function TS(e,t,n){if(!e.lazy)return;let r=await e.lazy();if(!e.lazy)return;let i=n[e.id];Xe(i,"No route found in manifest");let o={};for(let a in r){let u=i[a]!==void 0&&a!=="hasErrorBoundary";nc(!u,'Route "'+i.id+'" has a static property "'+a+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+a+'" will be ignored.')),!u&&!B4.has(a)&&(o[a]=r[a])}Object.assign(i,o),Object.assign(i,Dt({},t(i),{lazy:void 0}))}function mL(e){return Promise.all(e.matches.map(t=>t.resolve()))}async function gL(e,t,n,r,i,o,a,s){let u=r.reduce((d,f)=>d.add(f.route.id),new Set),c=new Set,l=await e({matches:i.map(d=>{let f=u.has(d.route.id);return Dt({},d,{shouldLoad:f,resolve:p=>(c.add(d.route.id),f?yL(t,n,d,o,a,p,s):Promise.resolve({type:Et.data,result:void 0}))})}),request:n,params:i[0].params,context:s});return i.forEach(d=>Xe(c.has(d.route.id),'`match.resolve()` was not called for route id "'+d.route.id+'". You must call `match.resolve()` on every match passed to `dataStrategy` to ensure all routes are properly loaded.')),l.filter((d,f)=>u.has(i[f].route.id))}async function yL(e,t,n,r,i,o,a){let s,u,c=l=>{let d,f=new Promise((m,g)=>d=g);u=()=>d(),t.signal.addEventListener("abort",u);let h=m=>typeof l!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+e+'" [routeId: '+n.route.id+"]"))):l({request:t,params:n.params,context:a},...m!==void 0?[m]:[]),p;return o?p=o(m=>h(m)):p=(async()=>{try{return{type:"data",result:await h()}}catch(m){return{type:"error",result:m}}})(),Promise.race([p,f])};try{let l=n.route[e];if(n.route.lazy)if(l){let d,[f]=await Promise.all([c(l).catch(h=>{d=h}),TS(n.route,i,r)]);if(d!==void 0)throw d;s=f}else if(await TS(n.route,i,r),l=n.route[e],l)s=await c(l);else if(e==="action"){let d=new URL(t.url),f=d.pathname+d.search;throw ir(405,{method:t.method,pathname:f,routeId:n.route.id})}else return{type:Et.data,result:void 0};else if(l)s=await c(l);else{let d=new URL(t.url),f=d.pathname+d.search;throw ir(404,{pathname:f})}Xe(s.result!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(l){return{type:Et.error,result:l}}finally{u&&t.signal.removeEventListener("abort",u)}return s}async function bL(e){let{result:t,type:n,status:r}=e;if(WI(t)){let a;try{let s=t.headers.get("Content-Type");s&&/\bapplication\/json\b/.test(s)?t.body==null?a=null:a=await t.json():a=await t.text()}catch(s){return{type:Et.error,error:s}}return n===Et.error?{type:Et.error,error:new lw(t.status,t.statusText,a),statusCode:t.status,headers:t.headers}:{type:Et.data,data:a,statusCode:t.status,headers:t.headers}}if(n===Et.error)return{type:Et.error,error:t,statusCode:Fv(t)?t.status:r};if(_L(t)){var i,o;return{type:Et.deferred,deferredData:t,statusCode:(i=t.init)==null?void 0:i.status,headers:((o=t.init)==null?void 0:o.headers)&&new Headers(t.init.headers)}}return{type:Et.data,data:t,statusCode:r}}function wL(e,t,n,r,i,o){let a=e.headers.get("Location");if(Xe(a,"Redirects returned/thrown from loaders/actions must have a Location header"),!dw.test(a)){let s=r.slice(0,r.findIndex(u=>u.route.id===n)+1);a=e1(new URL(t.url),s,i,!0,a,o),e.headers.set("Location",a)}return e}function OS(e,t,n){if(dw.test(e)){let r=e,i=r.startsWith("//")?new URL(t.protocol+r):new URL(r),o=Sc(i.pathname,n)!=null;if(i.origin===t.origin&&o)return i.pathname+i.search+i.hash}return e}function Zs(e,t,n,r){let i=e.createURL(VI(t)).toString(),o={signal:n};if(r&&gi(r.formMethod)){let{formMethod:a,formEncType:s}=r;o.method=a.toUpperCase(),s==="application/json"?(o.headers=new Headers({"Content-Type":s}),o.body=JSON.stringify(r.json)):s==="text/plain"?o.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?o.body=t1(r.formData):o.body=r.formData}return new Request(i,o)}function t1(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,typeof r=="string"?r:r.name);return t}function PS(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function xL(e,t,n,r,i,o){let a={},s=null,u,c=!1,l={},d=r&&Dr(r[1])?r[1].error:void 0;return n.forEach((f,h)=>{let p=t[h].route.id;if(Xe(!os(f),"Cannot handle redirect results in processLoaderData"),Dr(f)){let m=f.error;d!==void 0&&(m=d,d=void 0),s=s||{};{let g=Nl(e,p);s[g.route.id]==null&&(s[g.route.id]=m)}a[p]=void 0,c||(c=!0,u=Fv(f.error)?f.error.status:500),f.headers&&(l[p]=f.headers)}else is(f)?(i.set(p,f.deferredData),a[p]=f.deferredData.data,f.statusCode!=null&&f.statusCode!==200&&!c&&(u=f.statusCode),f.headers&&(l[p]=f.headers)):(a[p]=f.data,f.statusCode&&f.statusCode!==200&&!c&&(u=f.statusCode),f.headers&&(l[p]=f.headers))}),d!==void 0&&r&&(s={[r[0]]:d},a[r[0]]=void 0),{loaderData:a,errors:s,statusCode:u||200,loaderHeaders:l}}function NS(e,t,n,r,i,o,a,s){let{loaderData:u,errors:c}=xL(t,n,r,i,s);for(let l=0;l<o.length;l++){let{key:d,match:f,controller:h}=o[l];Xe(a!==void 0&&a[l]!==void 0,"Did not find corresponding fetcher result");let p=a[l];if(!(h&&h.signal.aborted))if(Dr(p)){let m=Nl(e.matches,f==null?void 0:f.route.id);c&&c[m.route.id]||(c=Dt({},c,{[m.route.id]:p.error})),e.fetchers.delete(d)}else if(os(p))Xe(!1,"Unhandled fetcher revalidation redirect");else if(is(p))Xe(!1,"Unhandled fetcher deferred data");else{let m=Qo(p.data);e.fetchers.set(d,m)}}return{loaderData:u,errors:c}}function DS(e,t,n,r){let i=Dt({},t);for(let o of n){let a=o.route.id;if(t.hasOwnProperty(a)?t[a]!==void 0&&(i[a]=t[a]):e[a]!==void 0&&o.route.loader&&(i[a]=e[a]),r&&r.hasOwnProperty(a))break}return i}function AS(e){return e?Dr(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function Nl(e,t){return(t?e.slice(0,e.findIndex(r=>r.route.id===t)+1):[...e]).reverse().find(r=>r.route.hasErrorBoundary===!0)||e[0]}function MS(e){let t=e.length===1?e[0]:e.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function ir(e,t){let{pathname:n,routeId:r,method:i,type:o,message:a}=t===void 0?{}:t,s="Unknown Server Error",u="Unknown @remix-run/router error";return e===400?(s="Bad Request",o==="route-discovery"?u='Unable to match URL "'+n+'" - the `children()` function for '+("route `"+r+"` threw the following error:\n"+a):i&&n&&r?u="You made a "+i+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":o==="defer-action"?u="defer() is not supported in actions":o==="invalid-body"&&(u="Unable to encode submission body")):e===403?(s="Forbidden",u='Route "'+r+'" does not match URL "'+n+'"'):e===404?(s="Not Found",u='No route matches URL "'+n+'"'):e===405&&(s="Method Not Allowed",i&&n&&r?u="You made a "+i.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(u='Invalid request method "'+i.toUpperCase()+'"')),new lw(e||500,s,new Error(u),!0)}function LS(e){for(let t=e.length-1;t>=0;t--){let n=e[t];if(os(n))return{result:n,idx:t}}}function VI(e){let t=typeof e=="string"?La(e):e;return Rs(Dt({},t,{hash:""}))}function EL(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function SL(e){return typeof e=="object"&&e!=null&&"then"in e}function CL(e){return WI(e.result)&&sL.has(e.result.status)}function is(e){return e.type===Et.deferred}function Dr(e){return e.type===Et.error}function os(e){return(e&&e.type)===Et.redirect}function _L(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function WI(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function kL(e){return aL.has(e.toLowerCase())}function gi(e){return iL.has(e.toLowerCase())}async function FS(e,t,n,r,i,o){for(let a=0;a<n.length;a++){let s=n[a],u=t[a];if(!u)continue;let c=e.find(d=>d.route.id===u.route.id),l=c!=null&&!jI(c,u)&&(o&&o[u.route.id])!==void 0;if(is(s)&&(i||l)){let d=r[a];Xe(d,"Expected an AbortSignal for revalidating fetcher deferred result"),await UI(s,d,i).then(f=>{f&&(n[a]=f||n[a])})}}}async function UI(e,t,n){if(n===void 0&&(n=!1),!await e.deferredData.resolveData(t)){if(n)try{return{type:Et.data,data:e.deferredData.unwrappedData}}catch(i){return{type:Et.error,error:i}}return{type:Et.data,data:e.deferredData.data}}}function fw(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function bl(e,t){let n=typeof t=="string"?La(t).search:t.search;if(e[e.length-1].route.index&&fw(n||""))return e[e.length-1];let r=LI(e);return r[r.length-1]}function BS(e){let{formMethod:t,formAction:n,formEncType:r,text:i,formData:o,json:a}=e;if(!(!t||!n||!r)){if(i!=null)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(o!=null)return{formMethod:t,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(a!==void 0)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:a,text:void 0}}}function Tg(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function RL(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function el(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function IL(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function Qo(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function TL(e,t){try{let n=e.sessionStorage.getItem(BI);if(n){let r=JSON.parse(n);for(let[i,o]of Object.entries(r||{}))o&&Array.isArray(o)&&t.set(i,new Set(o||[]))}}catch{}}function OL(e,t){if(t.size>0){let n={};for(let[r,i]of t)n[r]=[...i];try{e.sessionStorage.setItem(BI,JSON.stringify(n))}catch(r){nc(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.24.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vp(){return vp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vp.apply(this,arguments)}const Bv=O.createContext(null),zI=O.createContext(null),Fa=O.createContext(null),hw=O.createContext(null),ao=O.createContext({outlet:null,matches:[],isDataRoute:!1}),HI=O.createContext(null);function PL(e,t){let{relative:n}=t===void 0?{}:t;Cc()||Xe(!1);let{basename:r,navigator:i}=O.useContext(Fa),{hash:o,pathname:a,search:s}=qI(e,{relative:n}),u=a;return r!=="/"&&(u=a==="/"?r:Co([r,a])),i.createHref({pathname:u,search:s,hash:o})}function Cc(){return O.useContext(hw)!=null}function Po(){return Cc()||Xe(!1),O.useContext(hw).location}function GI(e){O.useContext(Fa).static||O.useLayoutEffect(e)}function xn(){let{isDataRoute:e}=O.useContext(ao);return e?GL():NL()}function NL(){Cc()||Xe(!1);let e=O.useContext(Bv),{basename:t,future:n,navigator:r}=O.useContext(Fa),{matches:i}=O.useContext(ao),{pathname:o}=Po(),a=JSON.stringify(Mv(i,n.v7_relativeSplatPath)),s=O.useRef(!1);return GI(()=>{s.current=!0}),O.useCallback(function(c,l){if(l===void 0&&(l={}),!s.current)return;if(typeof c=="number"){r.go(c);return}let d=Lv(c,JSON.parse(a),o,l.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Co([t,d.pathname])),(l.replace?r.replace:r.push)(d,l.state,l)},[t,r,a,o,e])}const DL=O.createContext(null);function AL(e){let t=O.useContext(ao).outlet;return t&&O.createElement(DL.Provider,{value:e},t)}function ML(){let{matches:e}=O.useContext(ao),t=e[e.length-1];return t?t.params:{}}function qI(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=O.useContext(Fa),{matches:i}=O.useContext(ao),{pathname:o}=Po(),a=JSON.stringify(Mv(i,r.v7_relativeSplatPath));return O.useMemo(()=>Lv(e,JSON.parse(a),o,n==="path"),[e,a,o,n])}function LL(e,t,n,r){Cc()||Xe(!1);let{navigator:i}=O.useContext(Fa),{matches:o}=O.useContext(ao),a=o[o.length-1],s=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let c=Po(),l;l=c;let d=l.pathname||"/",f=d;if(u!=="/"){let m=u.replace(/^\//,"").split("/");f="/"+d.replace(/^\//,"").split("/").slice(m.length).join("/")}let h=Za(e,{pathname:f});return VL(h&&h.map(m=>Object.assign({},m,{params:Object.assign({},s,m.params),pathname:Co([u,i.encodeLocation?i.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?u:Co([u,i.encodeLocation?i.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),o,n,r)}function FL(){let e=HL(),t=Fv(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return O.createElement(O.Fragment,null,O.createElement("h2",null,"Unexpected Application Error!"),O.createElement("h3",{style:{fontStyle:"italic"}},t),n?O.createElement("pre",{style:i},n):null,null)}const BL=O.createElement(FL,null);class jL extends O.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?O.createElement(ao.Provider,{value:this.props.routeContext},O.createElement(HI.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function $L(e){let{routeContext:t,match:n,children:r}=e,i=O.useContext(Bv);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),O.createElement(ao.Provider,{value:t},r)}function VL(e,t,n,r){var i;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var o;if((o=n)!=null&&o.errors)e=n.matches;else return null}let a=e,s=(i=n)==null?void 0:i.errors;if(s!=null){let l=a.findIndex(d=>d.route.id&&(s==null?void 0:s[d.route.id])!==void 0);l>=0||Xe(!1),a=a.slice(0,Math.min(a.length,l+1))}let u=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let l=0;l<a.length;l++){let d=a[l];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=l),d.route.id){let{loaderData:f,errors:h}=n,p=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||p){u=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((l,d,f)=>{let h,p=!1,m=null,g=null;n&&(h=s&&d.route.id?s[d.route.id]:void 0,m=d.route.errorElement||BL,u&&(c<0&&f===0?(qL("route-fallback"),p=!0,g=null):c===f&&(p=!0,g=d.route.hydrateFallbackElement||null)));let v=t.concat(a.slice(0,f+1)),y=()=>{let b;return h?b=m:p?b=g:d.route.Component?b=O.createElement(d.route.Component,null):d.route.element?b=d.route.element:b=l,O.createElement($L,{match:d,routeContext:{outlet:l,matches:v,isDataRoute:n!=null},children:b})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?O.createElement(jL,{location:n.location,revalidation:n.revalidation,component:m,error:h,children:y(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):y()},null)}var XI=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(XI||{}),mp=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(mp||{});function WL(e){let t=O.useContext(Bv);return t||Xe(!1),t}function UL(e){let t=O.useContext(zI);return t||Xe(!1),t}function zL(e){let t=O.useContext(ao);return t||Xe(!1),t}function KI(e){let t=zL(),n=t.matches[t.matches.length-1];return n.route.id||Xe(!1),n.route.id}function HL(){var e;let t=O.useContext(HI),n=UL(mp.UseRouteError),r=KI(mp.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function GL(){let{router:e}=WL(XI.UseNavigateStable),t=KI(mp.UseNavigateStable),n=O.useRef(!1);return GI(()=>{n.current=!0}),O.useCallback(function(i,o){o===void 0&&(o={}),n.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,vp({fromRouteId:t},o)))},[e,t])}const jS={};function qL(e,t,n){jS[e]||(jS[e]=!0)}function XL(e){let{to:t,replace:n,state:r,relative:i}=e;Cc()||Xe(!1);let{future:o,static:a}=O.useContext(Fa),{matches:s}=O.useContext(ao),{pathname:u}=Po(),c=xn(),l=Lv(t,Mv(s,o.v7_relativeSplatPath),u,i==="path"),d=JSON.stringify(l);return O.useEffect(()=>c(JSON.parse(d),{replace:n,state:r,relative:i}),[c,d,i,n,r]),null}function KL(e){return AL(e.context)}function YL(e){let{basename:t="/",children:n=null,location:r,navigationType:i=Jt.Pop,navigator:o,static:a=!1,future:s}=e;Cc()&&Xe(!1);let u=t.replace(/^\/*/,"/"),c=O.useMemo(()=>({basename:u,navigator:o,static:a,future:vp({v7_relativeSplatPath:!1},s)}),[u,s,o,a]);typeof r=="string"&&(r=La(r));let{pathname:l="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,m=O.useMemo(()=>{let g=Sc(l,u);return g==null?null:{location:{pathname:g,search:d,hash:f,state:h,key:p},navigationType:i}},[u,l,d,f,h,p,i]);return m==null?null:O.createElement(Fa.Provider,{value:c},O.createElement(hw.Provider,{children:n,value:m}))}new Promise(()=>{});function QL(e){let t={hasErrorBoundary:e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&Object.assign(t,{element:O.createElement(e.Component),Component:void 0}),e.HydrateFallback&&Object.assign(t,{hydrateFallbackElement:O.createElement(e.HydrateFallback),HydrateFallback:void 0}),e.ErrorBoundary&&Object.assign(t,{errorElement:O.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),t}/**
 * React Router DOM v6.24.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ad(){return ad=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ad.apply(this,arguments)}function JL(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,o;for(o=0;o<r.length;o++)i=r[o],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function ZL(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function eF(e,t){return e.button===0&&(!t||t==="_self")&&!ZL(e)}const tF=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],nF="6";try{window.__reactRouterVersion=nF}catch{}function rF(e,t){return dL({basename:void 0,future:ad({},void 0,{v7_prependBasename:!0}),history:M4({window:void 0}),hydrationData:iF(),routes:e,mapRouteProperties:QL,unstable_dataStrategy:void 0,unstable_patchRoutesOnMiss:void 0,window:void 0}).initialize()}function iF(){var e;let t=(e=window)==null?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=ad({},t,{errors:oF(t.errors)})),t}function oF(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,i]of t)if(i&&i.__type==="RouteErrorResponse")n[r]=new lw(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let o=window[i.__subType];if(typeof o=="function")try{let a=new o(i.message);a.stack="",n[r]=a}catch{}}if(n[r]==null){let o=new Error(i.message);o.stack="",n[r]=o}}else n[r]=i;return n}const aF=O.createContext({isTransitioning:!1}),sF=O.createContext(new Map),uF="startTransition",$S=zh[uF],cF="flushSync",VS=A4[cF];function lF(e){$S?$S(e):e()}function tl(e){VS?VS(e):e()}class dF{constructor(){this.status="pending",this.promise=new Promise((t,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",t(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function fF(e){let{fallbackElement:t,router:n,future:r}=e,[i,o]=O.useState(n.state),[a,s]=O.useState(),[u,c]=O.useState({isTransitioning:!1}),[l,d]=O.useState(),[f,h]=O.useState(),[p,m]=O.useState(),g=O.useRef(new Map),{v7_startTransition:v}=r||{},y=O.useCallback(R=>{v?lF(R):R()},[v]),b=O.useCallback((R,S)=>{let{deletedFetchers:_,unstable_flushSync:T,unstable_viewTransitionOpts:B}=S;_.forEach(k=>g.current.delete(k)),R.fetchers.forEach((k,D)=>{k.data!==void 0&&g.current.set(D,k.data)});let L=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!B||L){T?tl(()=>o(R)):y(()=>o(R));return}if(T){tl(()=>{f&&(l&&l.resolve(),f.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:B.currentLocation,nextLocation:B.nextLocation})});let k=n.window.document.startViewTransition(()=>{tl(()=>o(R))});k.finished.finally(()=>{tl(()=>{d(void 0),h(void 0),s(void 0),c({isTransitioning:!1})})}),tl(()=>h(k));return}f?(l&&l.resolve(),f.skipTransition(),m({state:R,currentLocation:B.currentLocation,nextLocation:B.nextLocation})):(s(R),c({isTransitioning:!0,flushSync:!1,currentLocation:B.currentLocation,nextLocation:B.nextLocation}))},[n.window,f,l,g,y]);O.useLayoutEffect(()=>n.subscribe(b),[n,b]),O.useEffect(()=>{u.isTransitioning&&!u.flushSync&&d(new dF)},[u]),O.useEffect(()=>{if(l&&a&&n.window){let R=a,S=l.promise,_=n.window.document.startViewTransition(async()=>{y(()=>o(R)),await S});_.finished.finally(()=>{d(void 0),h(void 0),s(void 0),c({isTransitioning:!1})}),h(_)}},[y,a,l,n.window]),O.useEffect(()=>{l&&a&&i.location.key===a.location.key&&l.resolve()},[l,f,i.location,a]),O.useEffect(()=>{!u.isTransitioning&&p&&(s(p.state),c({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),m(void 0))},[u.isTransitioning,p]),O.useEffect(()=>{},[]);let w=O.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:R=>n.navigate(R),push:(R,S,_)=>n.navigate(R,{state:S,preventScrollReset:_==null?void 0:_.preventScrollReset}),replace:(R,S,_)=>n.navigate(R,{replace:!0,state:S,preventScrollReset:_==null?void 0:_.preventScrollReset})}),[n]),E=n.basename||"/",x=O.useMemo(()=>({router:n,navigator:w,static:!1,basename:E}),[n,w,E]);return O.createElement(O.Fragment,null,O.createElement(Bv.Provider,{value:x},O.createElement(zI.Provider,{value:i},O.createElement(sF.Provider,{value:g.current},O.createElement(aF.Provider,{value:u},O.createElement(YL,{basename:E,location:i.location,navigationType:i.historyAction,navigator:w,future:{v7_relativeSplatPath:n.future.v7_relativeSplatPath}},i.initialized||n.future.v7_partialHydration?O.createElement(hF,{routes:n.routes,future:n.future,state:i}):t))))),null)}function hF(e){let{routes:t,future:n,state:r}=e;return LL(t,void 0,r,n)}const pF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",vF=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,eo=O.forwardRef(function(t,n){let{onClick:r,relative:i,reloadDocument:o,replace:a,state:s,target:u,to:c,preventScrollReset:l,unstable_viewTransition:d}=t,f=JL(t,tF),{basename:h}=O.useContext(Fa),p,m=!1;if(typeof c=="string"&&vF.test(c)&&(p=c,pF))try{let b=new URL(window.location.href),w=c.startsWith("//")?new URL(b.protocol+c):new URL(c),E=Sc(w.pathname,h);w.origin===b.origin&&E!=null?c=E+w.search+w.hash:m=!0}catch{}let g=PL(c,{relative:i}),v=mF(c,{replace:a,state:s,target:u,preventScrollReset:l,relative:i,unstable_viewTransition:d});function y(b){r&&r(b),b.defaultPrevented||v(b)}return O.createElement("a",ad({},f,{href:p||g,onClick:m||o?r:y,ref:n,target:u}))});var WS;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(WS||(WS={}));var US;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(US||(US={}));function mF(e,t){let{target:n,replace:r,state:i,preventScrollReset:o,relative:a,unstable_viewTransition:s}=t===void 0?{}:t,u=xn(),c=Po(),l=qI(e,{relative:a});return O.useCallback(d=>{if(eF(d,n)){d.preventDefault();let f=r!==void 0?r:Rs(c)===Rs(l);u(e,{replace:f,state:i,preventScrollReset:o,relative:a,unstable_viewTransition:s})}},[c,u,l,r,i,n,e,o,a,s])}function YI(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=YI(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function sa(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=YI(e))&&(r&&(r+=" "),r+=t);return r}const sd=e=>typeof e=="number"&&!isNaN(e),vs=e=>typeof e=="string",Br=e=>typeof e=="function",Nh=e=>vs(e)||Br(e)?e:null,n1=e=>O.isValidElement(e)||vs(e)||Br(e)||sd(e);function gF(e,t,n){n===void 0&&(n=300);const{scrollHeight:r,style:i}=e;requestAnimationFrame(()=>{i.minHeight="initial",i.height=r+"px",i.transition=`all ${n}ms`,requestAnimationFrame(()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(t,n)})})}function jv(e){let{enter:t,exit:n,appendPosition:r=!1,collapse:i=!0,collapseDuration:o=300}=e;return function(a){let{children:s,position:u,preventExitTransition:c,done:l,nodeRef:d,isIn:f,playToast:h}=a;const p=r?`${t}--${u}`:t,m=r?`${n}--${u}`:n,g=O.useRef(0);return O.useLayoutEffect(()=>{const v=d.current,y=p.split(" "),b=w=>{w.target===d.current&&(h(),v.removeEventListener("animationend",b),v.removeEventListener("animationcancel",b),g.current===0&&w.type!=="animationcancel"&&v.classList.remove(...y))};v.classList.add(...y),v.addEventListener("animationend",b),v.addEventListener("animationcancel",b)},[]),O.useEffect(()=>{const v=d.current,y=()=>{v.removeEventListener("animationend",y),i?gF(v,l,o):l()};f||(c?y():(g.current=1,v.className+=` ${m}`,v.addEventListener("animationend",y)))},[f]),we.createElement(we.Fragment,null,s)}}function zS(e,t){return e!=null?{content:e.content,containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,status:t}:{}}const ur=new Map;let ud=[];const r1=new Set,yF=e=>r1.forEach(t=>t(e)),QI=()=>ur.size>0;function JI(e,t){var n;if(t)return!((n=ur.get(t))==null||!n.isToastActive(e));let r=!1;return ur.forEach(i=>{i.isToastActive(e)&&(r=!0)}),r}function ZI(e,t){n1(e)&&(QI()||ud.push({content:e,options:t}),ur.forEach(n=>{n.buildToast(e,t)}))}function HS(e,t){ur.forEach(n=>{t!=null&&t!=null&&t.containerId?(t==null?void 0:t.containerId)===n.id&&n.toggle(e,t==null?void 0:t.id):n.toggle(e,t==null?void 0:t.id)})}function bF(e){const{subscribe:t,getSnapshot:n,setProps:r}=O.useRef(function(o){const a=o.containerId||1;return{subscribe(s){const u=function(l,d,f){let h=1,p=0,m=[],g=[],v=[],y=d;const b=new Map,w=new Set,E=()=>{v=Array.from(b.values()),w.forEach(S=>S())},x=S=>{g=S==null?[]:g.filter(_=>_!==S),E()},R=S=>{const{toastId:_,onOpen:T,updateId:B,children:L}=S.props,k=B==null;S.staleId&&b.delete(S.staleId),b.set(_,S),g=[...g,S.props.toastId].filter(D=>D!==S.staleId),E(),f(zS(S,k?"added":"updated")),k&&Br(T)&&T(O.isValidElement(L)&&L.props)};return{id:l,props:y,observe:S=>(w.add(S),()=>w.delete(S)),toggle:(S,_)=>{b.forEach(T=>{_!=null&&_!==T.props.toastId||Br(T.toggle)&&T.toggle(S)})},removeToast:x,toasts:b,clearQueue:()=>{p-=m.length,m=[]},buildToast:(S,_)=>{if((U=>{let{containerId:H,toastId:q,updateId:Q}=U;const V=H?H!==l:l!==1,re=b.has(q)&&Q==null;return V||re})(_))return;const{toastId:T,updateId:B,data:L,staleId:k,delay:D}=_,F=()=>{x(T)},M=B==null;M&&p++;const I={...y,style:y.toastStyle,key:h++,...Object.fromEntries(Object.entries(_).filter(U=>{let[H,q]=U;return q!=null})),toastId:T,updateId:B,data:L,closeToast:F,isIn:!1,className:Nh(_.className||y.toastClassName),bodyClassName:Nh(_.bodyClassName||y.bodyClassName),progressClassName:Nh(_.progressClassName||y.progressClassName),autoClose:!_.isLoading&&(N=_.autoClose,j=y.autoClose,N===!1||sd(N)&&N>0?N:j),deleteToast(){const U=b.get(T),{onClose:H,children:q}=U.props;Br(H)&&H(O.isValidElement(q)&&q.props),f(zS(U,"removed")),b.delete(T),p--,p<0&&(p=0),m.length>0?R(m.shift()):E()}};var N,j;I.closeButton=y.closeButton,_.closeButton===!1||n1(_.closeButton)?I.closeButton=_.closeButton:_.closeButton===!0&&(I.closeButton=!n1(y.closeButton)||y.closeButton);let P=S;O.isValidElement(S)&&!vs(S.type)?P=O.cloneElement(S,{closeToast:F,toastProps:I,data:L}):Br(S)&&(P=S({closeToast:F,toastProps:I,data:L}));const A={content:P,props:I,staleId:k};y.limit&&y.limit>0&&p>y.limit&&M?m.push(A):sd(D)?setTimeout(()=>{R(A)},D):R(A)},setProps(S){y=S},setToggle:(S,_)=>{b.get(S).toggle=_},isToastActive:S=>g.some(_=>_===S),getSnapshot:()=>y.newestOnTop?v.reverse():v}}(a,o,yF);ur.set(a,u);const c=u.observe(s);return ud.forEach(l=>ZI(l.content,l.options)),ud=[],()=>{c(),ur.delete(a)}},setProps(s){var u;(u=ur.get(a))==null||u.setProps(s)},getSnapshot(){var s;return(s=ur.get(a))==null?void 0:s.getSnapshot()}}}(e)).current;r(e);const i=O.useSyncExternalStore(t,n,n);return{getToastToRender:function(o){if(!i)return[];const a=new Map;return i.forEach(s=>{const{position:u}=s.props;a.has(u)||a.set(u,[]),a.get(u).push(s)}),Array.from(a,s=>o(s[0],s[1]))},isToastActive:JI,count:i==null?void 0:i.length}}function wF(e){const[t,n]=O.useState(!1),[r,i]=O.useState(!1),o=O.useRef(null),a=O.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:s,pauseOnHover:u,closeToast:c,onClick:l,closeOnClick:d}=e;var f,h;function p(){n(!0)}function m(){n(!1)}function g(b){const w=o.current;a.canDrag&&w&&(a.didMove=!0,t&&m(),a.delta=e.draggableDirection==="x"?b.clientX-a.start:b.clientY-a.start,a.start!==b.clientX&&(a.canCloseOnClick=!1),w.style.transform=`translate3d(${e.draggableDirection==="x"?`${a.delta}px, var(--y)`:`0, calc(${a.delta}px + var(--y))`},0)`,w.style.opacity=""+(1-Math.abs(a.delta/a.removalDistance)))}function v(){document.removeEventListener("pointermove",g),document.removeEventListener("pointerup",v);const b=o.current;if(a.canDrag&&a.didMove&&b){if(a.canDrag=!1,Math.abs(a.delta)>a.removalDistance)return i(!0),e.closeToast(),void e.collapseAll();b.style.transition="transform 0.2s, opacity 0.2s",b.style.removeProperty("transform"),b.style.removeProperty("opacity")}}(h=ur.get((f={id:e.toastId,containerId:e.containerId,fn:n}).containerId||1))==null||h.setToggle(f.id,f.fn),O.useEffect(()=>{if(e.pauseOnFocusLoss)return document.hasFocus()||m(),window.addEventListener("focus",p),window.addEventListener("blur",m),()=>{window.removeEventListener("focus",p),window.removeEventListener("blur",m)}},[e.pauseOnFocusLoss]);const y={onPointerDown:function(b){if(e.draggable===!0||e.draggable===b.pointerType){a.didMove=!1,document.addEventListener("pointermove",g),document.addEventListener("pointerup",v);const w=o.current;a.canCloseOnClick=!0,a.canDrag=!0,w.style.transition="none",e.draggableDirection==="x"?(a.start=b.clientX,a.removalDistance=w.offsetWidth*(e.draggablePercent/100)):(a.start=b.clientY,a.removalDistance=w.offsetHeight*(e.draggablePercent===80?1.5*e.draggablePercent:e.draggablePercent)/100)}},onPointerUp:function(b){const{top:w,bottom:E,left:x,right:R}=o.current.getBoundingClientRect();b.nativeEvent.type!=="touchend"&&e.pauseOnHover&&b.clientX>=x&&b.clientX<=R&&b.clientY>=w&&b.clientY<=E?m():p()}};return s&&u&&(y.onMouseEnter=m,e.stacked||(y.onMouseLeave=p)),d&&(y.onClick=b=>{l&&l(b),a.canCloseOnClick&&c()}),{playToast:p,pauseToast:m,isRunning:t,preventExitTransition:r,toastRef:o,eventHandlers:y}}function xF(e){let{delay:t,isRunning:n,closeToast:r,type:i="default",hide:o,className:a,style:s,controlledProgress:u,progress:c,rtl:l,isIn:d,theme:f}=e;const h=o||u&&c===0,p={...s,animationDuration:`${t}ms`,animationPlayState:n?"running":"paused"};u&&(p.transform=`scaleX(${c})`);const m=sa("Toastify__progress-bar",u?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${f}`,`Toastify__progress-bar--${i}`,{"Toastify__progress-bar--rtl":l}),g=Br(a)?a({rtl:l,type:i,defaultClassName:m}):sa(m,a),v={[u&&c>=1?"onTransitionEnd":"onAnimationEnd"]:u&&c<1?null:()=>{d&&r()}};return we.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":h},we.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${f} Toastify__progress-bar--${i}`}),we.createElement("div",{role:"progressbar","aria-hidden":h?"true":"false","aria-label":"notification timer",className:g,style:p,...v}))}let EF=1;const eT=()=>""+EF++;function SF(e){return e&&(vs(e.toastId)||sd(e.toastId))?e.toastId:eT()}function Dl(e,t){return ZI(e,t),t.toastId}function gp(e,t){return{...t,type:t&&t.type||e,toastId:SF(t)}}function Lf(e){return(t,n)=>Dl(t,gp(e,n))}function $e(e,t){return Dl(e,gp("default",t))}$e.loading=(e,t)=>Dl(e,gp("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),$e.promise=function(e,t,n){let r,{pending:i,error:o,success:a}=t;i&&(r=vs(i)?$e.loading(i,n):$e.loading(i.render,{...n,...i}));const s={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},u=(l,d,f)=>{if(d==null)return void $e.dismiss(r);const h={type:l,...s,...n,data:f},p=vs(d)?{render:d}:d;return r?$e.update(r,{...h,...p}):$e(p.render,{...h,...p}),f},c=Br(e)?e():e;return c.then(l=>u("success",a,l)).catch(l=>u("error",o,l)),c},$e.success=Lf("success"),$e.info=Lf("info"),$e.error=Lf("error"),$e.warning=Lf("warning"),$e.warn=$e.warning,$e.dark=(e,t)=>Dl(e,gp("default",{theme:"dark",...t})),$e.dismiss=function(e){(function(t){var n;if(QI()){if(t==null||vs(n=t)||sd(n))ur.forEach(r=>{r.removeToast(t)});else if(t&&("containerId"in t||"id"in t)){const r=ur.get(t.containerId);r?r.removeToast(t.id):ur.forEach(i=>{i.removeToast(t.id)})}}else ud=ud.filter(r=>t!=null&&r.options.toastId!==t)})(e)},$e.clearWaitingQueue=function(e){e===void 0&&(e={}),ur.forEach(t=>{!t.props.limit||e.containerId&&t.id!==e.containerId||t.clearQueue()})},$e.isActive=JI,$e.update=function(e,t){t===void 0&&(t={});const n=((r,i)=>{var o;let{containerId:a}=i;return(o=ur.get(a||1))==null?void 0:o.toasts.get(r)})(e,t);if(n){const{props:r,content:i}=n,o={delay:100,...r,...t,toastId:t.toastId||e,updateId:eT()};o.toastId!==e&&(o.staleId=e);const a=o.render||i;delete o.render,Dl(a,o)}},$e.done=e=>{$e.update(e,{progress:1})},$e.onChange=function(e){return r1.add(e),()=>{r1.delete(e)}},$e.play=e=>HS(!0,e),$e.pause=e=>HS(!1,e);const CF=typeof window<"u"?O.useLayoutEffect:O.useEffect,Ff=e=>{let{theme:t,type:n,isLoading:r,...i}=e;return we.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${n})`,...i})},Og={info:function(e){return we.createElement(Ff,{...e},we.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return we.createElement(Ff,{...e},we.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return we.createElement(Ff,{...e},we.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return we.createElement(Ff,{...e},we.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return we.createElement("div",{className:"Toastify__spinner"})}},_F=e=>{const{isRunning:t,preventExitTransition:n,toastRef:r,eventHandlers:i,playToast:o}=wF(e),{closeButton:a,children:s,autoClose:u,onClick:c,type:l,hideProgressBar:d,closeToast:f,transition:h,position:p,className:m,style:g,bodyClassName:v,bodyStyle:y,progressClassName:b,progressStyle:w,updateId:E,role:x,progress:R,rtl:S,toastId:_,deleteToast:T,isIn:B,isLoading:L,closeOnClick:k,theme:D}=e,F=sa("Toastify__toast",`Toastify__toast-theme--${D}`,`Toastify__toast--${l}`,{"Toastify__toast--rtl":S},{"Toastify__toast--close-on-click":k}),M=Br(m)?m({rtl:S,position:p,type:l,defaultClassName:F}):sa(F,m),I=function(A){let{theme:U,type:H,isLoading:q,icon:Q}=A,V=null;const re={theme:U,type:H};return Q===!1||(Br(Q)?V=Q({...re,isLoading:q}):O.isValidElement(Q)?V=O.cloneElement(Q,re):q?V=Og.spinner():(Z=>Z in Og)(H)&&(V=Og[H](re))),V}(e),N=!!R||!u,j={closeToast:f,type:l,theme:D};let P=null;return a===!1||(P=Br(a)?a(j):O.isValidElement(a)?O.cloneElement(a,j):function(A){let{closeToast:U,theme:H,ariaLabel:q="close"}=A;return we.createElement("button",{className:`Toastify__close-button Toastify__close-button--${H}`,type:"button",onClick:Q=>{Q.stopPropagation(),U(Q)},"aria-label":q},we.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},we.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(j)),we.createElement(h,{isIn:B,done:T,position:p,preventExitTransition:n,nodeRef:r,playToast:o},we.createElement("div",{id:_,onClick:c,"data-in":B,className:M,...i,style:g,ref:r},we.createElement("div",{...B&&{role:x},className:Br(v)?v({type:l}):sa("Toastify__toast-body",v),style:y},I!=null&&we.createElement("div",{className:sa("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!L})},I),we.createElement("div",null,s)),P,we.createElement(xF,{...E&&!N?{key:`pb-${E}`}:{},rtl:S,theme:D,delay:u,isRunning:t,isIn:B,closeToast:f,hide:d,type:l,style:w,className:b,controlledProgress:N,progress:R||0})))},$v=function(e,t){return t===void 0&&(t=!1),{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}},kF=jv($v("bounce",!0));jv($v("slide",!0));jv($v("zoom"));jv($v("flip"));const RF={position:"top-right",transition:kF,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};function IF(e){let t={...RF,...e};const n=e.stacked,[r,i]=O.useState(!0),o=O.useRef(null),{getToastToRender:a,isToastActive:s,count:u}=bF(t),{className:c,style:l,rtl:d,containerId:f}=t;function h(m){const g=sa("Toastify__toast-container",`Toastify__toast-container--${m}`,{"Toastify__toast-container--rtl":d});return Br(c)?c({position:m,rtl:d,defaultClassName:g}):sa(g,Nh(c))}function p(){n&&(i(!0),$e.play())}return CF(()=>{if(n){var m;const g=o.current.querySelectorAll('[data-in="true"]'),v=12,y=(m=t.position)==null?void 0:m.includes("top");let b=0,w=0;Array.from(g).reverse().forEach((E,x)=>{const R=E;R.classList.add("Toastify__toast--stacked"),x>0&&(R.dataset.collapsed=`${r}`),R.dataset.pos||(R.dataset.pos=y?"top":"bot");const S=b*(r?.2:1)+(r?0:v*x);R.style.setProperty("--y",`${y?S:-1*S}px`),R.style.setProperty("--g",`${v}`),R.style.setProperty("--s",""+(1-(r?w:0))),b+=R.offsetHeight,w+=.025})}},[r,u,n]),we.createElement("div",{ref:o,className:"Toastify",id:f,onMouseEnter:()=>{n&&(i(!1),$e.pause())},onMouseLeave:p},a((m,g)=>{const v=g.length?{...l}:{...l,pointerEvents:"none"};return we.createElement("div",{className:h(m),style:v,key:`container-${m}`},g.map(y=>{let{content:b,props:w}=y;return we.createElement(_F,{...w,stacked:n,collapseAll:p,isIn:s(w.toastId,w.containerId),style:w.style,key:`toast-${w.key}`},b)}))}))}var wr=function(){return wr=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},wr.apply(this,arguments)};function cd(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,o;r<i;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}var kt="-ms-",Al="-moz-",lt="-webkit-",tT="comm",Vv="rule",pw="decl",TF="@import",nT="@keyframes",OF="@layer",rT=Math.abs,vw=String.fromCharCode,i1=Object.assign;function PF(e,t){return mn(e,0)^45?(((t<<2^mn(e,0))<<2^mn(e,1))<<2^mn(e,2))<<2^mn(e,3):0}function iT(e){return e.trim()}function go(e,t){return(e=t.exec(e))?e[0]:e}function Ge(e,t,n){return e.replace(t,n)}function Dh(e,t,n){return e.indexOf(t,n)}function mn(e,t){return e.charCodeAt(t)|0}function rc(e,t,n){return e.slice(t,n)}function Hi(e){return e.length}function oT(e){return e.length}function wl(e,t){return t.push(e),e}function NF(e,t){return e.map(t).join("")}function GS(e,t){return e.filter(function(n){return!go(n,t)})}var Wv=1,ic=1,aT=0,si=0,Zt=0,_c="";function Uv(e,t,n,r,i,o,a,s){return{value:e,root:t,parent:n,type:r,props:i,children:o,line:Wv,column:ic,length:a,return:"",siblings:s}}function Jo(e,t){return i1(Uv("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function eu(e){for(;e.root;)e=Jo(e.root,{children:[e]});wl(e,e.siblings)}function DF(){return Zt}function AF(){return Zt=si>0?mn(_c,--si):0,ic--,Zt===10&&(ic=1,Wv--),Zt}function Ci(){return Zt=si<aT?mn(_c,si++):0,ic++,Zt===10&&(ic=1,Wv++),Zt}function ms(){return mn(_c,si)}function Ah(){return si}function zv(e,t){return rc(_c,e,t)}function o1(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function MF(e){return Wv=ic=1,aT=Hi(_c=e),si=0,[]}function LF(e){return _c="",e}function Pg(e){return iT(zv(si-1,a1(e===91?e+2:e===40?e+1:e)))}function FF(e){for(;(Zt=ms())&&Zt<33;)Ci();return o1(e)>2||o1(Zt)>3?"":" "}function BF(e,t){for(;--t&&Ci()&&!(Zt<48||Zt>102||Zt>57&&Zt<65||Zt>70&&Zt<97););return zv(e,Ah()+(t<6&&ms()==32&&Ci()==32))}function a1(e){for(;Ci();)switch(Zt){case e:return si;case 34:case 39:e!==34&&e!==39&&a1(Zt);break;case 40:e===41&&a1(e);break;case 92:Ci();break}return si}function jF(e,t){for(;Ci()&&e+Zt!==57;)if(e+Zt===84&&ms()===47)break;return"/*"+zv(t,si-1)+"*"+vw(e===47?e:Ci())}function $F(e){for(;!o1(ms());)Ci();return zv(e,si)}function VF(e){return LF(Mh("",null,null,null,[""],e=MF(e),0,[0],e))}function Mh(e,t,n,r,i,o,a,s,u){for(var c=0,l=0,d=a,f=0,h=0,p=0,m=1,g=1,v=1,y=0,b="",w=i,E=o,x=r,R=b;g;)switch(p=y,y=Ci()){case 40:if(p!=108&&mn(R,d-1)==58){Dh(R+=Ge(Pg(y),"&","&\f"),"&\f",rT(c?s[c-1]:0))!=-1&&(v=-1);break}case 34:case 39:case 91:R+=Pg(y);break;case 9:case 10:case 13:case 32:R+=FF(p);break;case 92:R+=BF(Ah()-1,7);continue;case 47:switch(ms()){case 42:case 47:wl(WF(jF(Ci(),Ah()),t,n,u),u);break;default:R+="/"}break;case 123*m:s[c++]=Hi(R)*v;case 125*m:case 59:case 0:switch(y){case 0:case 125:g=0;case 59+l:v==-1&&(R=Ge(R,/\f/g,"")),h>0&&Hi(R)-d&&wl(h>32?XS(R+";",r,n,d-1,u):XS(Ge(R," ","")+";",r,n,d-2,u),u);break;case 59:R+=";";default:if(wl(x=qS(R,t,n,c,l,i,s,b,w=[],E=[],d,o),o),y===123)if(l===0)Mh(R,t,x,x,w,o,d,s,E);else switch(f===99&&mn(R,3)===110?100:f){case 100:case 108:case 109:case 115:Mh(e,x,x,r&&wl(qS(e,x,x,0,0,i,s,b,i,w=[],d,E),E),i,E,d,s,r?w:E);break;default:Mh(R,x,x,x,[""],E,0,s,E)}}c=l=h=0,m=v=1,b=R="",d=a;break;case 58:d=1+Hi(R),h=p;default:if(m<1){if(y==123)--m;else if(y==125&&m++==0&&AF()==125)continue}switch(R+=vw(y),y*m){case 38:v=l>0?1:(R+="\f",-1);break;case 44:s[c++]=(Hi(R)-1)*v,v=1;break;case 64:ms()===45&&(R+=Pg(Ci())),f=ms(),l=d=Hi(b=R+=$F(Ah())),y++;break;case 45:p===45&&Hi(R)==2&&(m=0)}}return o}function qS(e,t,n,r,i,o,a,s,u,c,l,d){for(var f=i-1,h=i===0?o:[""],p=oT(h),m=0,g=0,v=0;m<r;++m)for(var y=0,b=rc(e,f+1,f=rT(g=a[m])),w=e;y<p;++y)(w=iT(g>0?h[y]+" "+b:Ge(b,/&\f/g,h[y])))&&(u[v++]=w);return Uv(e,t,n,i===0?Vv:s,u,c,l,d)}function WF(e,t,n,r){return Uv(e,t,n,tT,vw(DF()),rc(e,2,-2),0,r)}function XS(e,t,n,r,i){return Uv(e,t,n,pw,rc(e,0,r),rc(e,r+1,-1),r,i)}function sT(e,t,n){switch(PF(e,t)){case 5103:return lt+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return lt+e+e;case 4789:return Al+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return lt+e+Al+e+kt+e+e;case 5936:switch(mn(e,t+11)){case 114:return lt+e+kt+Ge(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return lt+e+kt+Ge(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return lt+e+kt+Ge(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return lt+e+kt+e+e;case 6165:return lt+e+kt+"flex-"+e+e;case 5187:return lt+e+Ge(e,/(\w+).+(:[^]+)/,lt+"box-$1$2"+kt+"flex-$1$2")+e;case 5443:return lt+e+kt+"flex-item-"+Ge(e,/flex-|-self/g,"")+(go(e,/flex-|baseline/)?"":kt+"grid-row-"+Ge(e,/flex-|-self/g,""))+e;case 4675:return lt+e+kt+"flex-line-pack"+Ge(e,/align-content|flex-|-self/g,"")+e;case 5548:return lt+e+kt+Ge(e,"shrink","negative")+e;case 5292:return lt+e+kt+Ge(e,"basis","preferred-size")+e;case 6060:return lt+"box-"+Ge(e,"-grow","")+lt+e+kt+Ge(e,"grow","positive")+e;case 4554:return lt+Ge(e,/([^-])(transform)/g,"$1"+lt+"$2")+e;case 6187:return Ge(Ge(Ge(e,/(zoom-|grab)/,lt+"$1"),/(image-set)/,lt+"$1"),e,"")+e;case 5495:case 3959:return Ge(e,/(image-set\([^]*)/,lt+"$1$`$1");case 4968:return Ge(Ge(e,/(.+:)(flex-)?(.*)/,lt+"box-pack:$3"+kt+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+lt+e+e;case 4200:if(!go(e,/flex-|baseline/))return kt+"grid-column-align"+rc(e,t)+e;break;case 2592:case 3360:return kt+Ge(e,"template-","")+e;case 4384:case 3616:return n&&n.some(function(r,i){return t=i,go(r.props,/grid-\w+-end/)})?~Dh(e+(n=n[t].value),"span",0)?e:kt+Ge(e,"-start","")+e+kt+"grid-row-span:"+(~Dh(n,"span",0)?go(n,/\d+/):+go(n,/\d+/)-+go(e,/\d+/))+";":kt+Ge(e,"-start","")+e;case 4896:case 4128:return n&&n.some(function(r){return go(r.props,/grid-\w+-start/)})?e:kt+Ge(Ge(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return Ge(e,/(.+)-inline(.+)/,lt+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Hi(e)-1-t>6)switch(mn(e,t+1)){case 109:if(mn(e,t+4)!==45)break;case 102:return Ge(e,/(.+:)(.+)-([^]+)/,"$1"+lt+"$2-$3$1"+Al+(mn(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~Dh(e,"stretch",0)?sT(Ge(e,"stretch","fill-available"),t,n)+e:e}break;case 5152:case 5920:return Ge(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(r,i,o,a,s,u,c){return kt+i+":"+o+c+(a?kt+i+"-span:"+(s?u:+u-+o)+c:"")+e});case 4949:if(mn(e,t+6)===121)return Ge(e,":",":"+lt)+e;break;case 6444:switch(mn(e,mn(e,14)===45?18:11)){case 120:return Ge(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+lt+(mn(e,14)===45?"inline-":"")+"box$3$1"+lt+"$2$3$1"+kt+"$2box$3")+e;case 100:return Ge(e,":",":"+kt)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Ge(e,"scroll-","scroll-snap-")+e}return e}function yp(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function UF(e,t,n,r){switch(e.type){case OF:if(e.children.length)break;case TF:case pw:return e.return=e.return||e.value;case tT:return"";case nT:return e.return=e.value+"{"+yp(e.children,r)+"}";case Vv:if(!Hi(e.value=e.props.join(",")))return""}return Hi(n=yp(e.children,r))?e.return=e.value+"{"+n+"}":""}function zF(e){var t=oT(e);return function(n,r,i,o){for(var a="",s=0;s<t;s++)a+=e[s](n,r,i,o)||"";return a}}function HF(e){return function(t){t.root||(t=t.return)&&e(t)}}function GF(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case pw:e.return=sT(e.value,e.length,n);return;case nT:return yp([Jo(e,{value:Ge(e.value,"@","@"+lt)})],r);case Vv:if(e.length)return NF(n=e.props,function(i){switch(go(i,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":eu(Jo(e,{props:[Ge(i,/:(read-\w+)/,":"+Al+"$1")]})),eu(Jo(e,{props:[i]})),i1(e,{props:GS(n,r)});break;case"::placeholder":eu(Jo(e,{props:[Ge(i,/:(plac\w+)/,":"+lt+"input-$1")]})),eu(Jo(e,{props:[Ge(i,/:(plac\w+)/,":"+Al+"$1")]})),eu(Jo(e,{props:[Ge(i,/:(plac\w+)/,kt+"input-$1")]})),eu(Jo(e,{props:[i]})),i1(e,{props:GS(n,r)});break}return""})}}var qF={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Pr={},oc=typeof process<"u"&&Pr!==void 0&&(Pr.REACT_APP_SC_ATTR||Pr.SC_ATTR)||"data-styled",uT="active",cT="data-styled-version",Hv="6.1.12",mw=`/*!sc*/
`,bp=typeof window<"u"&&"HTMLElement"in window,XF=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&Pr!==void 0&&Pr.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&Pr.REACT_APP_SC_DISABLE_SPEEDY!==""?Pr.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&Pr.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&Pr!==void 0&&Pr.SC_DISABLE_SPEEDY!==void 0&&Pr.SC_DISABLE_SPEEDY!==""&&Pr.SC_DISABLE_SPEEDY!=="false"&&Pr.SC_DISABLE_SPEEDY),Gv=Object.freeze([]),ac=Object.freeze({});function KF(e,t,n){return n===void 0&&(n=ac),e.theme!==n.theme&&e.theme||t||n.theme}var lT=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),YF=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,QF=/(^-|-$)/g;function KS(e){return e.replace(YF,"-").replace(QF,"")}var JF=/(a)(d)/gi,Bf=52,YS=function(e){return String.fromCharCode(e+(e>25?39:97))};function s1(e){var t,n="";for(t=Math.abs(e);t>Bf;t=t/Bf|0)n=YS(t%Bf)+n;return(YS(t%Bf)+n).replace(JF,"$1-$2")}var Ng,dT=5381,Tu=function(e,t){for(var n=t.length;n;)e=33*e^t.charCodeAt(--n);return e},fT=function(e){return Tu(dT,e)};function hT(e){return s1(fT(e)>>>0)}function ZF(e){return e.displayName||e.name||"Component"}function Dg(e){return typeof e=="string"&&!0}var pT=typeof Symbol=="function"&&Symbol.for,vT=pT?Symbol.for("react.memo"):60115,eB=pT?Symbol.for("react.forward_ref"):60112,tB={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},nB={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},mT={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},rB=((Ng={})[eB]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Ng[vT]=mT,Ng);function QS(e){return("type"in(t=e)&&t.type.$$typeof)===vT?mT:"$$typeof"in e?rB[e.$$typeof]:tB;var t}var iB=Object.defineProperty,oB=Object.getOwnPropertyNames,JS=Object.getOwnPropertySymbols,aB=Object.getOwnPropertyDescriptor,sB=Object.getPrototypeOf,ZS=Object.prototype;function gT(e,t,n){if(typeof t!="string"){if(ZS){var r=sB(t);r&&r!==ZS&&gT(e,r,n)}var i=oB(t);JS&&(i=i.concat(JS(t)));for(var o=QS(e),a=QS(t),s=0;s<i.length;++s){var u=i[s];if(!(u in nB||n&&n[u]||a&&u in a||o&&u in o)){var c=aB(t,u);try{iB(e,u,c)}catch{}}}}return e}function sc(e){return typeof e=="function"}function gw(e){return typeof e=="object"&&"styledComponentId"in e}function as(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function u1(e,t){if(e.length===0)return"";for(var n=e[0],r=1;r<e.length;r++)n+=e[r];return n}function ld(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function c1(e,t,n){if(n===void 0&&(n=!1),!n&&!ld(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var r=0;r<t.length;r++)e[r]=c1(e[r],t[r]);else if(ld(t))for(var r in t)e[r]=c1(e[r],t[r]);return e}function yw(e,t){Object.defineProperty(e,"toString",{value:t})}function Od(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var uB=function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var n=0,r=0;r<t;r++)n+=this.groupSizes[r];return n},e.prototype.insertRules=function(t,n){if(t>=this.groupSizes.length){for(var r=this.groupSizes,i=r.length,o=i;t>=o;)if((o<<=1)<0)throw Od(16,"".concat(t));this.groupSizes=new Uint32Array(o),this.groupSizes.set(r),this.length=o;for(var a=i;a<o;a++)this.groupSizes[a]=0}for(var s=this.indexOfGroup(t+1),u=(a=0,n.length);a<u;a++)this.tag.insertRule(s,n[a])&&(this.groupSizes[t]++,s++)},e.prototype.clearGroup=function(t){if(t<this.length){var n=this.groupSizes[t],r=this.indexOfGroup(t),i=r+n;this.groupSizes[t]=0;for(var o=r;o<i;o++)this.tag.deleteRule(r)}},e.prototype.getGroup=function(t){var n="";if(t>=this.length||this.groupSizes[t]===0)return n;for(var r=this.groupSizes[t],i=this.indexOfGroup(t),o=i+r,a=i;a<o;a++)n+="".concat(this.tag.getRule(a)).concat(mw);return n},e}(),Lh=new Map,wp=new Map,Fh=1,jf=function(e){if(Lh.has(e))return Lh.get(e);for(;wp.has(Fh);)Fh++;var t=Fh++;return Lh.set(e,t),wp.set(t,e),t},cB=function(e,t){Fh=t+1,Lh.set(e,t),wp.set(t,e)},lB="style[".concat(oc,"][").concat(cT,'="').concat(Hv,'"]'),dB=new RegExp("^".concat(oc,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),fB=function(e,t,n){for(var r,i=n.split(","),o=0,a=i.length;o<a;o++)(r=i[o])&&e.registerName(t,r)},hB=function(e,t){for(var n,r=((n=t.textContent)!==null&&n!==void 0?n:"").split(mw),i=[],o=0,a=r.length;o<a;o++){var s=r[o].trim();if(s){var u=s.match(dB);if(u){var c=0|parseInt(u[1],10),l=u[2];c!==0&&(cB(l,c),fB(e,l,u[3]),e.getTag().insertRules(c,i)),i.length=0}else i.push(s)}}},eC=function(e){for(var t=document.querySelectorAll(lB),n=0,r=t.length;n<r;n++){var i=t[n];i&&i.getAttribute(oc)!==uT&&(hB(e,i),i.parentNode&&i.parentNode.removeChild(i))}};function pB(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var yT=function(e){var t=document.head,n=e||t,r=document.createElement("style"),i=function(s){var u=Array.from(s.querySelectorAll("style[".concat(oc,"]")));return u[u.length-1]}(n),o=i!==void 0?i.nextSibling:null;r.setAttribute(oc,uT),r.setAttribute(cT,Hv);var a=pB();return a&&r.setAttribute("nonce",a),n.insertBefore(r,o),r},vB=function(){function e(t){this.element=yT(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(n){if(n.sheet)return n.sheet;for(var r=document.styleSheets,i=0,o=r.length;i<o;i++){var a=r[i];if(a.ownerNode===n)return a}throw Od(17)}(this.element),this.length=0}return e.prototype.insertRule=function(t,n){try{return this.sheet.insertRule(n,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var n=this.sheet.cssRules[t];return n&&n.cssText?n.cssText:""},e}(),mB=function(){function e(t){this.element=yT(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,n){if(t<=this.length&&t>=0){var r=document.createTextNode(n);return this.element.insertBefore(r,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e}(),gB=function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,n){return t<=this.length&&(this.rules.splice(t,0,n),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e}(),tC=bp,yB={isServer:!bp,useCSSOMInjection:!XF},bT=function(){function e(t,n,r){t===void 0&&(t=ac),n===void 0&&(n={});var i=this;this.options=wr(wr({},yB),t),this.gs=n,this.names=new Map(r),this.server=!!t.isServer,!this.server&&bp&&tC&&(tC=!1,eC(this)),yw(this,function(){return function(o){for(var a=o.getTag(),s=a.length,u="",c=function(d){var f=function(v){return wp.get(v)}(d);if(f===void 0)return"continue";var h=o.names.get(f),p=a.getGroup(d);if(h===void 0||!h.size||p.length===0)return"continue";var m="".concat(oc,".g").concat(d,'[id="').concat(f,'"]'),g="";h!==void 0&&h.forEach(function(v){v.length>0&&(g+="".concat(v,","))}),u+="".concat(p).concat(m,'{content:"').concat(g,'"}').concat(mw)},l=0;l<s;l++)c(l);return u}(i)})}return e.registerId=function(t){return jf(t)},e.prototype.rehydrate=function(){!this.server&&bp&&eC(this)},e.prototype.reconstructWithOptions=function(t,n){return n===void 0&&(n=!0),new e(wr(wr({},this.options),t),this.gs,n&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=function(n){var r=n.useCSSOMInjection,i=n.target;return n.isServer?new gB(i):r?new vB(i):new mB(i)}(this.options),new uB(t)));var t},e.prototype.hasNameForId=function(t,n){return this.names.has(t)&&this.names.get(t).has(n)},e.prototype.registerName=function(t,n){if(jf(t),this.names.has(t))this.names.get(t).add(n);else{var r=new Set;r.add(n),this.names.set(t,r)}},e.prototype.insertRules=function(t,n,r){this.registerName(t,n),this.getTag().insertRules(jf(t),r)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(jf(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e}(),bB=/&/g,wB=/^\s*\/\/.*$/gm;function wT(e,t){return e.map(function(n){return n.type==="rule"&&(n.value="".concat(t," ").concat(n.value),n.value=n.value.replaceAll(",",",".concat(t," ")),n.props=n.props.map(function(r){return"".concat(t," ").concat(r)})),Array.isArray(n.children)&&n.type!=="@keyframes"&&(n.children=wT(n.children,t)),n})}function xB(e){var t,n,r,i=ac,o=i.options,a=o===void 0?ac:o,s=i.plugins,u=s===void 0?Gv:s,c=function(f,h,p){return p.startsWith(n)&&p.endsWith(n)&&p.replaceAll(n,"").length>0?".".concat(t):f},l=u.slice();l.push(function(f){f.type===Vv&&f.value.includes("&")&&(f.props[0]=f.props[0].replace(bB,n).replace(r,c))}),a.prefix&&l.push(GF),l.push(UF);var d=function(f,h,p,m){h===void 0&&(h=""),p===void 0&&(p=""),m===void 0&&(m="&"),t=m,n=h,r=new RegExp("\\".concat(n,"\\b"),"g");var g=f.replace(wB,""),v=VF(p||h?"".concat(p," ").concat(h," { ").concat(g," }"):g);a.namespace&&(v=wT(v,a.namespace));var y=[];return yp(v,zF(l.concat(HF(function(b){return y.push(b)})))),y};return d.hash=u.length?u.reduce(function(f,h){return h.name||Od(15),Tu(f,h.name)},dT).toString():"",d}var EB=new bT,l1=xB(),xT=we.createContext({shouldForwardProp:void 0,styleSheet:EB,stylis:l1});xT.Consumer;we.createContext(void 0);function nC(){return O.useContext(xT)}var ET=function(){function e(t,n){var r=this;this.inject=function(i,o){o===void 0&&(o=l1);var a=r.name+o.hash;i.hasNameForId(r.id,a)||i.insertRules(r.id,a,o(r.rules,a,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=n,yw(this,function(){throw Od(12,String(r.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=l1),this.name+t.hash},e}(),SB=function(e){return e>="A"&&e<="Z"};function rC(e){for(var t="",n=0;n<e.length;n++){var r=e[n];if(n===1&&r==="-"&&e[0]==="-")return e;SB(r)?t+="-"+r.toLowerCase():t+=r}return t.startsWith("ms-")?"-"+t:t}var ST=function(e){return e==null||e===!1||e===""},CT=function(e){var t,n,r=[];for(var i in e){var o=e[i];e.hasOwnProperty(i)&&!ST(o)&&(Array.isArray(o)&&o.isCss||sc(o)?r.push("".concat(rC(i),":"),o,";"):ld(o)?r.push.apply(r,cd(cd(["".concat(i," {")],CT(o),!1),["}"],!1)):r.push("".concat(rC(i),": ").concat((t=i,(n=o)==null||typeof n=="boolean"||n===""?"":typeof n!="number"||n===0||t in qF||t.startsWith("--")?String(n).trim():"".concat(n,"px")),";")))}return r};function gs(e,t,n,r){if(ST(e))return[];if(gw(e))return[".".concat(e.styledComponentId)];if(sc(e)){if(!sc(o=e)||o.prototype&&o.prototype.isReactComponent||!t)return[e];var i=e(t);return gs(i,t,n,r)}var o;return e instanceof ET?n?(e.inject(n,r),[e.getName(r)]):[e]:ld(e)?CT(e):Array.isArray(e)?Array.prototype.concat.apply(Gv,e.map(function(a){return gs(a,t,n,r)})):[e.toString()]}function CB(e){for(var t=0;t<e.length;t+=1){var n=e[t];if(sc(n)&&!gw(n))return!1}return!0}var _B=fT(Hv),kB=function(){function e(t,n,r){this.rules=t,this.staticRulesId="",this.isStatic=(r===void 0||r.isStatic)&&CB(t),this.componentId=n,this.baseHash=Tu(_B,n),this.baseStyle=r,bT.registerId(n)}return e.prototype.generateAndInjectStyles=function(t,n,r){var i=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,n,r):"";if(this.isStatic&&!r.hash)if(this.staticRulesId&&n.hasNameForId(this.componentId,this.staticRulesId))i=as(i,this.staticRulesId);else{var o=u1(gs(this.rules,t,n,r)),a=s1(Tu(this.baseHash,o)>>>0);if(!n.hasNameForId(this.componentId,a)){var s=r(o,".".concat(a),void 0,this.componentId);n.insertRules(this.componentId,a,s)}i=as(i,a),this.staticRulesId=a}else{for(var u=Tu(this.baseHash,r.hash),c="",l=0;l<this.rules.length;l++){var d=this.rules[l];if(typeof d=="string")c+=d;else if(d){var f=u1(gs(d,t,n,r));u=Tu(u,f+l),c+=f}}if(c){var h=s1(u>>>0);n.hasNameForId(this.componentId,h)||n.insertRules(this.componentId,h,r(c,".".concat(h),void 0,this.componentId)),i=as(i,h)}}return i},e}(),_T=we.createContext(void 0);_T.Consumer;var Ag={};function RB(e,t,n){var r=gw(e),i=e,o=!Dg(e),a=t.attrs,s=a===void 0?Gv:a,u=t.componentId,c=u===void 0?function(w,E){var x=typeof w!="string"?"sc":KS(w);Ag[x]=(Ag[x]||0)+1;var R="".concat(x,"-").concat(hT(Hv+x+Ag[x]));return E?"".concat(E,"-").concat(R):R}(t.displayName,t.parentComponentId):u,l=t.displayName,d=l===void 0?function(w){return Dg(w)?"styled.".concat(w):"Styled(".concat(ZF(w),")")}(e):l,f=t.displayName&&t.componentId?"".concat(KS(t.displayName),"-").concat(t.componentId):t.componentId||c,h=r&&i.attrs?i.attrs.concat(s).filter(Boolean):s,p=t.shouldForwardProp;if(r&&i.shouldForwardProp){var m=i.shouldForwardProp;if(t.shouldForwardProp){var g=t.shouldForwardProp;p=function(w,E){return m(w,E)&&g(w,E)}}else p=m}var v=new kB(n,f,r?i.componentStyle:void 0);function y(w,E){return function(x,R,S){var _=x.attrs,T=x.componentStyle,B=x.defaultProps,L=x.foldedComponentIds,k=x.styledComponentId,D=x.target,F=we.useContext(_T),M=nC(),I=x.shouldForwardProp||M.shouldForwardProp,N=KF(R,F,B)||ac,j=function(Q,V,re){for(var Z,he=wr(wr({},V),{className:void 0,theme:re}),xe=0;xe<Q.length;xe+=1){var ie=sc(Z=Q[xe])?Z(he):Z;for(var pe in ie)he[pe]=pe==="className"?as(he[pe],ie[pe]):pe==="style"?wr(wr({},he[pe]),ie[pe]):ie[pe]}return V.className&&(he.className=as(he.className,V.className)),he}(_,R,N),P=j.as||D,A={};for(var U in j)j[U]===void 0||U[0]==="$"||U==="as"||U==="theme"&&j.theme===N||(U==="forwardedAs"?A.as=j.forwardedAs:I&&!I(U,P)||(A[U]=j[U]));var H=function(Q,V){var re=nC(),Z=Q.generateAndInjectStyles(V,re.styleSheet,re.stylis);return Z}(T,j),q=as(L,k);return H&&(q+=" "+H),j.className&&(q+=" "+j.className),A[Dg(P)&&!lT.has(P)?"class":"className"]=q,A.ref=S,O.createElement(P,A)}(b,w,E)}y.displayName=d;var b=we.forwardRef(y);return b.attrs=h,b.componentStyle=v,b.displayName=d,b.shouldForwardProp=p,b.foldedComponentIds=r?as(i.foldedComponentIds,i.styledComponentId):"",b.styledComponentId=f,b.target=r?i.target:e,Object.defineProperty(b,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(w){this._foldedDefaultProps=r?function(E){for(var x=[],R=1;R<arguments.length;R++)x[R-1]=arguments[R];for(var S=0,_=x;S<_.length;S++)c1(E,_[S],!0);return E}({},i.defaultProps,w):w}}),yw(b,function(){return".".concat(b.styledComponentId)}),o&&gT(b,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),b}function iC(e,t){for(var n=[e[0]],r=0,i=t.length;r<i;r+=1)n.push(t[r],e[r+1]);return n}var oC=function(e){return Object.assign(e,{isCss:!0})};function ui(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(sc(e)||ld(e))return oC(gs(iC(Gv,cd([e],t,!0))));var r=e;return t.length===0&&r.length===1&&typeof r[0]=="string"?gs(r):oC(gs(iC(r,t)))}function d1(e,t,n){if(n===void 0&&(n=ac),!t)throw Od(1,t);var r=function(i){for(var o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];return e(t,n,ui.apply(void 0,cd([i],o,!1)))};return r.attrs=function(i){return d1(e,t,wr(wr({},n),{attrs:Array.prototype.concat(n.attrs,i).filter(Boolean)}))},r.withConfig=function(i){return d1(e,t,wr(wr({},n),i))},r}var kT=function(e){return d1(RB,e)},J=kT;lT.forEach(function(e){J[e]=kT(e)});function RT(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=u1(ui.apply(void 0,cd([e],t,!1))),i=hT(r);return new ET(i,r)}var IT={},TT={},qv={},OT={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t={animating:!1,autoplaying:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,dragging:!1,edgeDragged:!1,initialized:!1,lazyLoadedList:[],listHeight:null,listWidth:null,scrolling:!1,slideCount:null,slideHeight:null,slideWidth:null,swipeLeft:null,swiped:!1,swiping:!1,touchObject:{startX:0,startY:0,curX:0,curY:0},trackStyle:{},trackWidth:0,targetSlide:0};e.default=t})(OT);var IB="Expected a function",aC=NaN,TB="[object Symbol]",OB=/^\s+|\s+$/g,PB=/^[-+]0x[0-9a-f]+$/i,NB=/^0b[01]+$/i,DB=/^0o[0-7]+$/i,AB=parseInt,MB=typeof me=="object"&&me&&me.Object===Object&&me,LB=typeof self=="object"&&self&&self.Object===Object&&self,FB=MB||LB||Function("return this")(),BB=Object.prototype,jB=BB.toString,$B=Math.max,VB=Math.min,Mg=function(){return FB.Date.now()};function WB(e,t,n){var r,i,o,a,s,u,c=0,l=!1,d=!1,f=!0;if(typeof e!="function")throw new TypeError(IB);t=sC(t)||0,f1(n)&&(l=!!n.leading,d="maxWait"in n,o=d?$B(sC(n.maxWait)||0,t):o,f="trailing"in n?!!n.trailing:f);function h(x){var R=r,S=i;return r=i=void 0,c=x,a=e.apply(S,R),a}function p(x){return c=x,s=setTimeout(v,t),l?h(x):a}function m(x){var R=x-u,S=x-c,_=t-R;return d?VB(_,o-S):_}function g(x){var R=x-u,S=x-c;return u===void 0||R>=t||R<0||d&&S>=o}function v(){var x=Mg();if(g(x))return y(x);s=setTimeout(v,m(x))}function y(x){return s=void 0,f&&r?h(x):(r=i=void 0,a)}function b(){s!==void 0&&clearTimeout(s),c=0,r=u=i=s=void 0}function w(){return s===void 0?a:y(Mg())}function E(){var x=Mg(),R=g(x);if(r=arguments,i=this,u=x,R){if(s===void 0)return p(u);if(d)return s=setTimeout(v,t),h(u)}return s===void 0&&(s=setTimeout(v,t)),a}return E.cancel=b,E.flush=w,E}function f1(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function UB(e){return!!e&&typeof e=="object"}function zB(e){return typeof e=="symbol"||UB(e)&&jB.call(e)==TB}function sC(e){if(typeof e=="number")return e;if(zB(e))return aC;if(f1(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=f1(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(OB,"");var n=NB.test(e);return n||DB.test(e)?AB(e.slice(2),n?2:8):PB.test(e)?aC:+e}var PT=WB;const HB=Ms(PT);var NT={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function n(){for(var o="",a=0;a<arguments.length;a++){var s=arguments[a];s&&(o=i(o,r(s)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return n.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var a="";for(var s in o)t.call(o,s)&&o[s]&&(a=i(a,s));return a}function i(o,a){return a?o?o+" "+a:o+a:o}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(NT);var Pd=NT.exports;const DT=Ms(Pd);var ge={},bw={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=n(O);function n(i){return i&&i.__esModule?i:{default:i}}var r={accessibility:!0,adaptiveHeight:!1,afterChange:null,appendDots:function(o){return t.default.createElement("ul",{style:{display:"block"}},o)},arrows:!0,autoplay:!1,autoplaySpeed:3e3,beforeChange:null,centerMode:!1,centerPadding:"50px",className:"",cssEase:"ease",customPaging:function(o){return t.default.createElement("button",null,o+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,infinite:!0,initialSlide:0,lazyLoad:null,nextArrow:null,onEdge:null,onInit:null,onLazyLoadError:null,onReInit:null,pauseOnDotsHover:!1,pauseOnFocus:!1,pauseOnHover:!0,prevArrow:null,responsive:null,rows:1,rtl:!1,slide:"div",slidesPerRow:1,slidesToScroll:1,slidesToShow:1,speed:500,swipe:!0,swipeEvent:null,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,waitForAnimate:!0,asNavFor:null};e.default=r})(bw);Object.defineProperty(ge,"__esModule",{value:!0});ge.checkSpecKeys=ge.checkNavigable=ge.changeSlide=ge.canUseDOM=ge.canGoNext=void 0;ge.clamp=MT;ge.extractObject=void 0;ge.filterSettings=aj;ge.validSettings=ge.swipeStart=ge.swipeMove=ge.swipeEnd=ge.slidesOnRight=ge.slidesOnLeft=ge.slideHandler=ge.siblingDirection=ge.safePreventDefault=ge.lazyStartIndex=ge.lazySlidesOnRight=ge.lazySlidesOnLeft=ge.lazyEndIndex=ge.keyHandler=ge.initializedState=ge.getWidth=ge.getTrackLeft=ge.getTrackCSS=ge.getTrackAnimateCSS=ge.getTotalSlides=ge.getSwipeDirection=ge.getSlideCount=ge.getRequiredLazySlides=ge.getPreClones=ge.getPostClones=ge.getOnDemandLazySlides=ge.getNavigableIndexes=ge.getHeight=void 0;var GB=AT(O),qB=AT(bw);function AT(e){return e&&e.__esModule?e:{default:e}}function dd(e){"@babel/helpers - typeof";return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dd(e)}function uC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Ot(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?uC(Object(n),!0).forEach(function(r){XB(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uC(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function XB(e,t,n){return t=KB(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KB(e){var t=YB(e,"string");return dd(t)=="symbol"?t:String(t)}function YB(e,t){if(dd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(dd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MT(e,t,n){return Math.max(t,Math.min(e,n))}var Bu=ge.safePreventDefault=function(t){var n=["onTouchStart","onTouchMove","onWheel"];n.includes(t._reactName)||t.preventDefault()},LT=ge.getOnDemandLazySlides=function(t){for(var n=[],r=FT(t),i=BT(t),o=r;o<i;o++)t.lazyLoadedList.indexOf(o)<0&&n.push(o);return n};ge.getRequiredLazySlides=function(t){for(var n=[],r=FT(t),i=BT(t),o=r;o<i;o++)n.push(o);return n};var FT=ge.lazyStartIndex=function(t){return t.currentSlide-QB(t)},BT=ge.lazyEndIndex=function(t){return t.currentSlide+JB(t)},QB=ge.lazySlidesOnLeft=function(t){return t.centerMode?Math.floor(t.slidesToShow/2)+(parseInt(t.centerPadding)>0?1:0):0},JB=ge.lazySlidesOnRight=function(t){return t.centerMode?Math.floor((t.slidesToShow-1)/2)+1+(parseInt(t.centerPadding)>0?1:0):t.slidesToShow},h1=ge.getWidth=function(t){return t&&t.offsetWidth||0},jT=ge.getHeight=function(t){return t&&t.offsetHeight||0},$T=ge.getSwipeDirection=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r,i,o,a;return r=t.startX-t.curX,i=t.startY-t.curY,o=Math.atan2(i,r),a=Math.round(o*180/Math.PI),a<0&&(a=360-Math.abs(a)),a<=45&&a>=0||a<=360&&a>=315?"left":a>=135&&a<=225?"right":n===!0?a>=35&&a<=135?"up":"down":"vertical"},VT=ge.canGoNext=function(t){var n=!0;return t.infinite||(t.centerMode&&t.currentSlide>=t.slideCount-1||t.slideCount<=t.slidesToShow||t.currentSlide>=t.slideCount-t.slidesToShow)&&(n=!1),n};ge.extractObject=function(t,n){var r={};return n.forEach(function(i){return r[i]=t[i]}),r};ge.initializedState=function(t){var n=GB.default.Children.count(t.children),r=t.listRef,i=Math.ceil(h1(r)),o=t.trackRef&&t.trackRef.node,a=Math.ceil(h1(o)),s;if(t.vertical)s=i;else{var u=t.centerMode&&parseInt(t.centerPadding)*2;typeof t.centerPadding=="string"&&t.centerPadding.slice(-1)==="%"&&(u*=i/100),s=Math.ceil((i-u)/t.slidesToShow)}var c=r&&jT(r.querySelector('[data-index="0"]')),l=c*t.slidesToShow,d=t.currentSlide===void 0?t.initialSlide:t.currentSlide;t.rtl&&t.currentSlide===void 0&&(d=n-1-t.initialSlide);var f=t.lazyLoadedList||[],h=LT(Ot(Ot({},t),{},{currentSlide:d,lazyLoadedList:f}));f=f.concat(h);var p={slideCount:n,slideWidth:s,listWidth:i,trackWidth:a,currentSlide:d,slideHeight:c,listHeight:l,lazyLoadedList:f};return t.autoplaying===null&&t.autoplay&&(p.autoplaying="playing"),p};ge.slideHandler=function(t){var n=t.waitForAnimate,r=t.animating,i=t.fade,o=t.infinite,a=t.index,s=t.slideCount,u=t.lazyLoad,c=t.currentSlide,l=t.centerMode,d=t.slidesToScroll,f=t.slidesToShow,h=t.useCSS,p=t.lazyLoadedList;if(n&&r)return{};var m=a,g,v,y,b={},w={},E=o?a:MT(a,0,s-1);if(i){if(!o&&(a<0||a>=s))return{};a<0?m=a+s:a>=s&&(m=a-s),u&&p.indexOf(m)<0&&(p=p.concat(m)),b={animating:!0,currentSlide:m,lazyLoadedList:p,targetSlide:m},w={animating:!1,targetSlide:m}}else g=m,m<0?(g=m+s,o?s%d!==0&&(g=s-s%d):g=0):!VT(t)&&m>c?m=g=c:l&&m>=s?(m=o?s:s-1,g=o?0:s-1):m>=s&&(g=m-s,o?s%d!==0&&(g=0):g=s-f),!o&&m+f>=s&&(g=s-f),v=Ep(Ot(Ot({},t),{},{slideIndex:m})),y=Ep(Ot(Ot({},t),{},{slideIndex:g})),o||(v===y&&(m=g),v=y),u&&(p=p.concat(LT(Ot(Ot({},t),{},{currentSlide:m})))),h?(b={animating:!0,currentSlide:g,trackStyle:WT(Ot(Ot({},t),{},{left:v})),lazyLoadedList:p,targetSlide:E},w={animating:!1,currentSlide:g,trackStyle:xp(Ot(Ot({},t),{},{left:y})),swipeLeft:null,targetSlide:E}):b={currentSlide:g,trackStyle:xp(Ot(Ot({},t),{},{left:y})),lazyLoadedList:p,targetSlide:E};return{state:b,nextState:w}};ge.changeSlide=function(t,n){var r,i,o,a,s,u=t.slidesToScroll,c=t.slidesToShow,l=t.slideCount,d=t.currentSlide,f=t.targetSlide,h=t.lazyLoad,p=t.infinite;if(a=l%u!==0,r=a?0:(l-d)%u,n.message==="previous")o=r===0?u:c-r,s=d-o,h&&!p&&(i=d-o,s=i===-1?l-1:i),p||(s=f-u);else if(n.message==="next")o=r===0?u:r,s=d+o,h&&!p&&(s=(d+u)%l+r),p||(s=f+u);else if(n.message==="dots")s=n.index*n.slidesToScroll;else if(n.message==="children"){if(s=n.index,p){var m=nj(Ot(Ot({},t),{},{targetSlide:s}));s>n.currentSlide&&m==="left"?s=s-l:s<n.currentSlide&&m==="right"&&(s=s+l)}}else n.message==="index"&&(s=Number(n.index));return s};ge.keyHandler=function(t,n,r){return t.target.tagName.match("TEXTAREA|INPUT|SELECT")||!n?"":t.keyCode===37?r?"next":"previous":t.keyCode===39?r?"previous":"next":""};ge.swipeStart=function(t,n,r){return t.target.tagName==="IMG"&&Bu(t),!n||!r&&t.type.indexOf("mouse")!==-1?"":{dragging:!0,touchObject:{startX:t.touches?t.touches[0].pageX:t.clientX,startY:t.touches?t.touches[0].pageY:t.clientY,curX:t.touches?t.touches[0].pageX:t.clientX,curY:t.touches?t.touches[0].pageY:t.clientY}}};ge.swipeMove=function(t,n){var r=n.scrolling,i=n.animating,o=n.vertical,a=n.swipeToSlide,s=n.verticalSwiping,u=n.rtl,c=n.currentSlide,l=n.edgeFriction,d=n.edgeDragged,f=n.onEdge,h=n.swiped,p=n.swiping,m=n.slideCount,g=n.slidesToScroll,v=n.infinite,y=n.touchObject,b=n.swipeEvent,w=n.listHeight,E=n.listWidth;if(!r){if(i)return Bu(t);o&&a&&s&&Bu(t);var x,R={},S=Ep(n);y.curX=t.touches?t.touches[0].pageX:t.clientX,y.curY=t.touches?t.touches[0].pageY:t.clientY,y.swipeLength=Math.round(Math.sqrt(Math.pow(y.curX-y.startX,2)));var _=Math.round(Math.sqrt(Math.pow(y.curY-y.startY,2)));if(!s&&!p&&_>10)return{scrolling:!0};s&&(y.swipeLength=_);var T=(u?-1:1)*(y.curX>y.startX?1:-1);s&&(T=y.curY>y.startY?1:-1);var B=Math.ceil(m/g),L=$T(n.touchObject,s),k=y.swipeLength;return v||(c===0&&(L==="right"||L==="down")||c+1>=B&&(L==="left"||L==="up")||!VT(n)&&(L==="left"||L==="up"))&&(k=y.swipeLength*l,d===!1&&f&&(f(L),R.edgeDragged=!0)),!h&&b&&(b(L),R.swiped=!0),o?x=S+k*(w/E)*T:u?x=S-k*T:x=S+k*T,s&&(x=S+k*T),R=Ot(Ot({},R),{},{touchObject:y,swipeLeft:x,trackStyle:xp(Ot(Ot({},n),{},{left:x}))}),Math.abs(y.curX-y.startX)<Math.abs(y.curY-y.startY)*.8||y.swipeLength>10&&(R.swiping=!0,Bu(t)),R}};ge.swipeEnd=function(t,n){var r=n.dragging,i=n.swipe,o=n.touchObject,a=n.listWidth,s=n.touchThreshold,u=n.verticalSwiping,c=n.listHeight,l=n.swipeToSlide,d=n.scrolling,f=n.onSwipe,h=n.targetSlide,p=n.currentSlide,m=n.infinite;if(!r)return i&&Bu(t),{};var g=u?c/s:a/s,v=$T(o,u),y={dragging:!1,edgeDragged:!1,scrolling:!1,swiping:!1,swiped:!1,swipeLeft:null,touchObject:{}};if(d||!o.swipeLength)return y;if(o.swipeLength>g){Bu(t),f&&f(v);var b,w,E=m?p:h;switch(v){case"left":case"up":w=E+lC(n),b=l?cC(n,w):w,y.currentDirection=0;break;case"right":case"down":w=E-lC(n),b=l?cC(n,w):w,y.currentDirection=1;break;default:b=E}y.triggerSlideHandler=b}else{var x=Ep(n);y.trackStyle=WT(Ot(Ot({},n),{},{left:x}))}return y};var ZB=ge.getNavigableIndexes=function(t){for(var n=t.infinite?t.slideCount*2:t.slideCount,r=t.infinite?t.slidesToShow*-1:0,i=t.infinite?t.slidesToShow*-1:0,o=[];r<n;)o.push(r),r=i+t.slidesToScroll,i+=Math.min(t.slidesToScroll,t.slidesToShow);return o},cC=ge.checkNavigable=function(t,n){var r=ZB(t),i=0;if(n>r[r.length-1])n=r[r.length-1];else for(var o in r){if(n<r[o]){n=i;break}i=r[o]}return n},lC=ge.getSlideCount=function(t){var n=t.centerMode?t.slideWidth*Math.floor(t.slidesToShow/2):0;if(t.swipeToSlide){var r,i=t.listRef,o=i.querySelectorAll&&i.querySelectorAll(".slick-slide")||[];if(Array.from(o).every(function(u){if(t.vertical){if(u.offsetTop+jT(u)/2>t.swipeLeft*-1)return r=u,!1}else if(u.offsetLeft-n+h1(u)/2>t.swipeLeft*-1)return r=u,!1;return!0}),!r)return 0;var a=t.rtl===!0?t.slideCount-t.currentSlide:t.currentSlide,s=Math.abs(r.dataset.index-a)||1;return s}else return t.slidesToScroll},ww=ge.checkSpecKeys=function(t,n){return n.reduce(function(r,i){return r&&t.hasOwnProperty(i)},!0)?null:console.error("Keys Missing:",t)},xp=ge.getTrackCSS=function(t){ww(t,["left","variableWidth","slideCount","slidesToShow","slideWidth"]);var n,r,i=t.slideCount+2*t.slidesToShow;t.vertical?r=i*t.slideHeight:n=tj(t)*t.slideWidth;var o={opacity:1,transition:"",WebkitTransition:""};if(t.useTransform){var a=t.vertical?"translate3d(0px, "+t.left+"px, 0px)":"translate3d("+t.left+"px, 0px, 0px)",s=t.vertical?"translate3d(0px, "+t.left+"px, 0px)":"translate3d("+t.left+"px, 0px, 0px)",u=t.vertical?"translateY("+t.left+"px)":"translateX("+t.left+"px)";o=Ot(Ot({},o),{},{WebkitTransform:a,transform:s,msTransform:u})}else t.vertical?o.top=t.left:o.left=t.left;return t.fade&&(o={opacity:1}),n&&(o.width=n),r&&(o.height=r),window&&!window.addEventListener&&window.attachEvent&&(t.vertical?o.marginTop=t.left+"px":o.marginLeft=t.left+"px"),o},WT=ge.getTrackAnimateCSS=function(t){ww(t,["left","variableWidth","slideCount","slidesToShow","slideWidth","speed","cssEase"]);var n=xp(t);return t.useTransform?(n.WebkitTransition="-webkit-transform "+t.speed+"ms "+t.cssEase,n.transition="transform "+t.speed+"ms "+t.cssEase):t.vertical?n.transition="top "+t.speed+"ms "+t.cssEase:n.transition="left "+t.speed+"ms "+t.cssEase,n},Ep=ge.getTrackLeft=function(t){if(t.unslick)return 0;ww(t,["slideIndex","trackRef","infinite","centerMode","slideCount","slidesToShow","slidesToScroll","slideWidth","listWidth","variableWidth","slideHeight"]);var n=t.slideIndex,r=t.trackRef,i=t.infinite,o=t.centerMode,a=t.slideCount,s=t.slidesToShow,u=t.slidesToScroll,c=t.slideWidth,l=t.listWidth,d=t.variableWidth,f=t.slideHeight,h=t.fade,p=t.vertical,m=0,g,v,y=0;if(h||t.slideCount===1)return 0;var b=0;if(i?(b=-Bh(t),a%u!==0&&n+u>a&&(b=-(n>a?s-(n-a):a%u)),o&&(b+=parseInt(s/2))):(a%u!==0&&n+u>a&&(b=s-a%u),o&&(b=parseInt(s/2))),m=b*c,y=b*f,p?g=n*f*-1+y:g=n*c*-1+m,d===!0){var w,E=r&&r.node;if(w=n+Bh(t),v=E&&E.childNodes[w],g=v?v.offsetLeft*-1:0,o===!0){w=i?n+Bh(t):n,v=E&&E.children[w],g=0;for(var x=0;x<w;x++)g-=E&&E.children[x]&&E.children[x].offsetWidth;g-=parseInt(t.centerPadding),g+=v&&(l-v.offsetWidth)/2}}return g},Bh=ge.getPreClones=function(t){return t.unslick||!t.infinite?0:t.variableWidth?t.slideCount:t.slidesToShow+(t.centerMode?1:0)},ej=ge.getPostClones=function(t){return t.unslick||!t.infinite?0:t.slideCount},tj=ge.getTotalSlides=function(t){return t.slideCount===1?1:Bh(t)+t.slideCount+ej(t)},nj=ge.siblingDirection=function(t){return t.targetSlide>t.currentSlide?t.targetSlide>t.currentSlide+rj(t)?"left":"right":t.targetSlide<t.currentSlide-ij(t)?"right":"left"},rj=ge.slidesOnRight=function(t){var n=t.slidesToShow,r=t.centerMode,i=t.rtl,o=t.centerPadding;if(r){var a=(n-1)/2+1;return parseInt(o)>0&&(a+=1),i&&n%2===0&&(a+=1),a}return i?0:n-1},ij=ge.slidesOnLeft=function(t){var n=t.slidesToShow,r=t.centerMode,i=t.rtl,o=t.centerPadding;if(r){var a=(n-1)/2+1;return parseInt(o)>0&&(a+=1),!i&&n%2===0&&(a+=1),a}return i?n-1:0};ge.canUseDOM=function(){return!!(typeof window<"u"&&window.document&&window.document.createElement)};var oj=ge.validSettings=Object.keys(qB.default);function aj(e){return oj.reduce(function(t,n){return e.hasOwnProperty(n)&&(t[n]=e[n]),t},{})}var Xv={};Object.defineProperty(Xv,"__esModule",{value:!0});Xv.Track=void 0;var ta=UT(O),Lg=UT(Pd),Fg=ge;function UT(e){return e&&e.__esModule?e:{default:e}}function uc(e){"@babel/helpers - typeof";return uc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uc(e)}function p1(){return p1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p1.apply(this,arguments)}function sj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,HT(r.key),r)}}function cj(e,t,n){return t&&uj(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function lj(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v1(e,t)}function v1(e,t){return v1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},v1(e,t)}function dj(e){var t=zT();return function(){var r=Sp(e),i;if(t){var o=Sp(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return fj(this,i)}}function fj(e,t){if(t&&(uc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return m1(e)}function m1(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zT(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zT=function(){return!!e})()}function Sp(e){return Sp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Sp(e)}function dC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function pr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?dC(Object(n),!0).forEach(function(r){g1(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dC(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function g1(e,t,n){return t=HT(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function HT(e){var t=hj(e,"string");return uc(t)=="symbol"?t:String(t)}function hj(e,t){if(uc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(uc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bg=function(t){var n,r,i,o,a;t.rtl?a=t.slideCount-1-t.index:a=t.index,i=a<0||a>=t.slideCount,t.centerMode?(o=Math.floor(t.slidesToShow/2),r=(a-t.currentSlide)%t.slideCount===0,a>t.currentSlide-o-1&&a<=t.currentSlide+o&&(n=!0)):n=t.currentSlide<=a&&a<t.currentSlide+t.slidesToShow;var s;t.targetSlide<0?s=t.targetSlide+t.slideCount:t.targetSlide>=t.slideCount?s=t.targetSlide-t.slideCount:s=t.targetSlide;var u=a===s;return{"slick-slide":!0,"slick-active":n,"slick-center":r,"slick-cloned":i,"slick-current":u}},pj=function(t){var n={};return(t.variableWidth===void 0||t.variableWidth===!1)&&(n.width=t.slideWidth),t.fade&&(n.position="relative",t.vertical?n.top=-t.index*parseInt(t.slideHeight):n.left=-t.index*parseInt(t.slideWidth),n.opacity=t.currentSlide===t.index?1:0,n.zIndex=t.currentSlide===t.index?999:998,t.useCSS&&(n.transition="opacity "+t.speed+"ms "+t.cssEase+", visibility "+t.speed+"ms "+t.cssEase)),n},jg=function(t,n){return t.key||n},vj=function(t){var n,r=[],i=[],o=[],a=ta.default.Children.count(t.children),s=(0,Fg.lazyStartIndex)(t),u=(0,Fg.lazyEndIndex)(t);return ta.default.Children.forEach(t.children,function(c,l){var d,f={message:"children",index:l,slidesToScroll:t.slidesToScroll,currentSlide:t.currentSlide};!t.lazyLoad||t.lazyLoad&&t.lazyLoadedList.indexOf(l)>=0?d=c:d=ta.default.createElement("div",null);var h=pj(pr(pr({},t),{},{index:l})),p=d.props.className||"",m=Bg(pr(pr({},t),{},{index:l}));if(r.push(ta.default.cloneElement(d,{key:"original"+jg(d,l),"data-index":l,className:(0,Lg.default)(m,p),tabIndex:"-1","aria-hidden":!m["slick-active"],style:pr(pr({outline:"none"},d.props.style||{}),h),onClick:function(y){d.props&&d.props.onClick&&d.props.onClick(y),t.focusOnSelect&&t.focusOnSelect(f)}})),t.infinite&&t.fade===!1){var g=a-l;g<=(0,Fg.getPreClones)(t)&&(n=-g,n>=s&&(d=c),m=Bg(pr(pr({},t),{},{index:n})),i.push(ta.default.cloneElement(d,{key:"precloned"+jg(d,n),"data-index":n,tabIndex:"-1",className:(0,Lg.default)(m,p),"aria-hidden":!m["slick-active"],style:pr(pr({},d.props.style||{}),h),onClick:function(y){d.props&&d.props.onClick&&d.props.onClick(y),t.focusOnSelect&&t.focusOnSelect(f)}}))),n=a+l,n<u&&(d=c),m=Bg(pr(pr({},t),{},{index:n})),o.push(ta.default.cloneElement(d,{key:"postcloned"+jg(d,n),"data-index":n,tabIndex:"-1",className:(0,Lg.default)(m,p),"aria-hidden":!m["slick-active"],style:pr(pr({},d.props.style||{}),h),onClick:function(y){d.props&&d.props.onClick&&d.props.onClick(y),t.focusOnSelect&&t.focusOnSelect(f)}}))}}),t.rtl?i.concat(r,o).reverse():i.concat(r,o)};Xv.Track=function(e){lj(n,e);var t=dj(n);function n(){var r;sj(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=t.call.apply(t,[this].concat(o)),g1(m1(r),"node",null),g1(m1(r),"handleRef",function(s){r.node=s}),r}return cj(n,[{key:"render",value:function(){var i=vj(this.props),o=this.props,a=o.onMouseEnter,s=o.onMouseOver,u=o.onMouseLeave,c={onMouseEnter:a,onMouseOver:s,onMouseLeave:u};return ta.default.createElement("div",p1({ref:this.handleRef,className:"slick-track",style:this.props.trackStyle},c),i)}}]),n}(ta.default.PureComponent);var Kv={};function cc(e){"@babel/helpers - typeof";return cc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cc(e)}Object.defineProperty(Kv,"__esModule",{value:!0});Kv.Dots=void 0;var $f=GT(O),mj=GT(Pd),fC=ge;function GT(e){return e&&e.__esModule?e:{default:e}}function hC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function gj(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hC(Object(n),!0).forEach(function(r){yj(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hC(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function yj(e,t,n){return t=qT(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,qT(r.key),r)}}function xj(e,t,n){return t&&wj(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qT(e){var t=Ej(e,"string");return cc(t)=="symbol"?t:String(t)}function Ej(e,t){if(cc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(cc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sj(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y1(e,t)}function y1(e,t){return y1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},y1(e,t)}function Cj(e){var t=XT();return function(){var r=Cp(e),i;if(t){var o=Cp(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return _j(this,i)}}function _j(e,t){if(t&&(cc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kj(e)}function kj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XT(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(XT=function(){return!!e})()}function Cp(e){return Cp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Cp(e)}var Rj=function(t){var n;return t.infinite?n=Math.ceil(t.slideCount/t.slidesToScroll):n=Math.ceil((t.slideCount-t.slidesToShow)/t.slidesToScroll)+1,n};Kv.Dots=function(e){Sj(n,e);var t=Cj(n);function n(){return bj(this,n),t.apply(this,arguments)}return xj(n,[{key:"clickHandler",value:function(i,o){o.preventDefault(),this.props.clickHandler(i)}},{key:"render",value:function(){for(var i=this.props,o=i.onMouseEnter,a=i.onMouseOver,s=i.onMouseLeave,u=i.infinite,c=i.slidesToScroll,l=i.slidesToShow,d=i.slideCount,f=i.currentSlide,h=Rj({slideCount:d,slidesToScroll:c,slidesToShow:l,infinite:u}),p={onMouseEnter:o,onMouseOver:a,onMouseLeave:s},m=[],g=0;g<h;g++){var v=(g+1)*c-1,y=u?v:(0,fC.clamp)(v,0,d-1),b=y-(c-1),w=u?b:(0,fC.clamp)(b,0,d-1),E=(0,mj.default)({"slick-active":u?f>=w&&f<=y:f===w}),x={message:"dots",index:g,slidesToScroll:c,currentSlide:f},R=this.clickHandler.bind(this,x);m=m.concat($f.default.createElement("li",{key:g,className:E},$f.default.cloneElement(this.props.customPaging(g),{onClick:R})))}return $f.default.cloneElement(this.props.appendDots(m),gj({className:this.props.dotsClass},p))}}]),n}($f.default.PureComponent);var lc={};function dc(e){"@babel/helpers - typeof";return dc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dc(e)}Object.defineProperty(lc,"__esModule",{value:!0});lc.PrevArrow=lc.NextArrow=void 0;var ju=YT(O),KT=YT(Pd),Ij=ge;function YT(e){return e&&e.__esModule?e:{default:e}}function _p(){return _p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_p.apply(this,arguments)}function pC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function kp(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pC(Object(n),!0).forEach(function(r){Tj(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pC(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Tj(e,t,n){return t=ZT(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QT(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ZT(r.key),r)}}function JT(e,t,n){return t&&Oj(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZT(e){var t=Pj(e,"string");return dc(t)=="symbol"?t:String(t)}function Pj(e,t){if(dc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(dc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eO(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b1(e,t)}function b1(e,t){return b1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},b1(e,t)}function tO(e){var t=nO();return function(){var r=Rp(e),i;if(t){var o=Rp(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return Nj(this,i)}}function Nj(e,t){if(t&&(dc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dj(e)}function Dj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nO=function(){return!!e})()}function Rp(e){return Rp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Rp(e)}lc.PrevArrow=function(e){eO(n,e);var t=tO(n);function n(){return QT(this,n),t.apply(this,arguments)}return JT(n,[{key:"clickHandler",value:function(i,o){o&&o.preventDefault(),this.props.clickHandler(i,o)}},{key:"render",value:function(){var i={"slick-arrow":!0,"slick-prev":!0},o=this.clickHandler.bind(this,{message:"previous"});!this.props.infinite&&(this.props.currentSlide===0||this.props.slideCount<=this.props.slidesToShow)&&(i["slick-disabled"]=!0,o=null);var a={key:"0","data-role":"none",className:(0,KT.default)(i),style:{display:"block"},onClick:o},s={currentSlide:this.props.currentSlide,slideCount:this.props.slideCount},u;return this.props.prevArrow?u=ju.default.cloneElement(this.props.prevArrow,kp(kp({},a),s)):u=ju.default.createElement("button",_p({key:"0",type:"button"},a)," ","Previous"),u}}]),n}(ju.default.PureComponent);lc.NextArrow=function(e){eO(n,e);var t=tO(n);function n(){return QT(this,n),t.apply(this,arguments)}return JT(n,[{key:"clickHandler",value:function(i,o){o&&o.preventDefault(),this.props.clickHandler(i,o)}},{key:"render",value:function(){var i={"slick-arrow":!0,"slick-next":!0},o=this.clickHandler.bind(this,{message:"next"});(0,Ij.canGoNext)(this.props)||(i["slick-disabled"]=!0,o=null);var a={key:"1","data-role":"none",className:(0,KT.default)(i),style:{display:"block"},onClick:o},s={currentSlide:this.props.currentSlide,slideCount:this.props.slideCount},u;return this.props.nextArrow?u=ju.default.cloneElement(this.props.nextArrow,kp(kp({},a),s)):u=ju.default.createElement("button",_p({key:"1",type:"button"},a)," ","Next"),u}}]),n}(ju.default.PureComponent);var rO=function(){if(typeof Map<"u")return Map;function e(t,n){var r=-1;return t.some(function(i,o){return i[0]===n?(r=o,!0):!1}),r}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(n){var r=e(this.__entries__,n),i=this.__entries__[r];return i&&i[1]},t.prototype.set=function(n,r){var i=e(this.__entries__,n);~i?this.__entries__[i][1]=r:this.__entries__.push([n,r])},t.prototype.delete=function(n){var r=this.__entries__,i=e(r,n);~i&&r.splice(i,1)},t.prototype.has=function(n){return!!~e(this.__entries__,n)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(n,r){r===void 0&&(r=null);for(var i=0,o=this.__entries__;i<o.length;i++){var a=o[i];n.call(r,a[1],a[0])}},t}()}(),w1=typeof window<"u"&&typeof document<"u"&&window.document===document,Ip=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),Aj=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Ip):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),Mj=2;function Lj(e,t){var n=!1,r=!1,i=0;function o(){n&&(n=!1,e()),r&&s()}function a(){Aj(o)}function s(){var u=Date.now();if(n){if(u-i<Mj)return;r=!0}else n=!0,r=!1,setTimeout(a,t);i=u}return s}var Fj=20,Bj=["top","right","bottom","left","width","height","size","weight"],jj=typeof MutationObserver<"u",$j=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=Lj(this.refresh.bind(this),Fj)}return e.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},e.prototype.removeObserver=function(t){var n=this.observers_,r=n.indexOf(t);~r&&n.splice(r,1),!n.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var t=this.updateObservers_();t&&this.refresh()},e.prototype.updateObservers_=function(){var t=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return t.forEach(function(n){return n.broadcastActive()}),t.length>0},e.prototype.connect_=function(){!w1||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),jj?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!w1||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(t){var n=t.propertyName,r=n===void 0?"":n,i=Bj.some(function(o){return!!~r.indexOf(o)});i&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),iO=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},fc=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView;return t||Ip},oO=Yv(0,0,0,0);function Tp(e){return parseFloat(e)||0}function vC(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce(function(r,i){var o=e["border-"+i+"-width"];return r+Tp(o)},0)}function Vj(e){for(var t=["top","right","bottom","left"],n={},r=0,i=t;r<i.length;r++){var o=i[r],a=e["padding-"+o];n[o]=Tp(a)}return n}function Wj(e){var t=e.getBBox();return Yv(0,0,t.width,t.height)}function Uj(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return oO;var r=fc(e).getComputedStyle(e),i=Vj(r),o=i.left+i.right,a=i.top+i.bottom,s=Tp(r.width),u=Tp(r.height);if(r.boxSizing==="border-box"&&(Math.round(s+o)!==t&&(s-=vC(r,"left","right")+o),Math.round(u+a)!==n&&(u-=vC(r,"top","bottom")+a)),!Hj(e)){var c=Math.round(s+o)-t,l=Math.round(u+a)-n;Math.abs(c)!==1&&(s-=c),Math.abs(l)!==1&&(u-=l)}return Yv(i.left,i.top,s,u)}var zj=function(){return typeof SVGGraphicsElement<"u"?function(e){return e instanceof fc(e).SVGGraphicsElement}:function(e){return e instanceof fc(e).SVGElement&&typeof e.getBBox=="function"}}();function Hj(e){return e===fc(e).document.documentElement}function Gj(e){return w1?zj(e)?Wj(e):Uj(e):oO}function qj(e){var t=e.x,n=e.y,r=e.width,i=e.height,o=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(o.prototype);return iO(a,{x:t,y:n,width:r,height:i,top:n,right:t+r,bottom:i+n,left:t}),a}function Yv(e,t,n,r){return{x:e,y:t,width:n,height:r}}var Xj=function(){function e(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Yv(0,0,0,0),this.target=t}return e.prototype.isActive=function(){var t=Gj(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},e}(),Kj=function(){function e(t,n){var r=qj(n);iO(this,{target:t,contentRect:r})}return e}(),Yj=function(){function e(t,n,r){if(this.activeObservations_=[],this.observations_=new rO,typeof t!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=n,this.callbackCtx_=r}return e.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof fc(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(t)||(n.set(t,new Xj(t)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof fc(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(t)&&(n.delete(t),n.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&t.activeObservations_.push(n)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,n=this.activeObservations_.map(function(r){return new Kj(r.target,r.broadcastRect())});this.callback_.call(t,n,t),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),aO=typeof WeakMap<"u"?new WeakMap:new rO,sO=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=$j.getInstance(),r=new Yj(t,n,this);aO.set(this,r)}return e}();["observe","unobserve","disconnect"].forEach(function(e){sO.prototype[e]=function(){var t;return(t=aO.get(this))[e].apply(t,arguments)}});var Qj=function(){return typeof Ip.ResizeObserver<"u"?Ip.ResizeObserver:sO}();const Jj=Object.freeze(Object.defineProperty({__proto__:null,default:Qj},Symbol.toStringTag,{value:"Module"})),Zj=sM(Jj);Object.defineProperty(qv,"__esModule",{value:!0});qv.InnerSlider=void 0;var nr=Nd(O),e5=Nd(OT),t5=Nd(PT),n5=Nd(Pd),Nt=ge,r5=Xv,i5=Kv,mC=lc,o5=Nd(Zj);function Nd(e){return e&&e.__esModule?e:{default:e}}function Is(e){"@babel/helpers - typeof";return Is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Is(e)}function Op(){return Op=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Op.apply(this,arguments)}function a5(e,t){if(e==null)return{};var n=s5(e,t),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function s5(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,o;for(o=0;o<r.length;o++)i=r[o],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function gC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gC(Object(n),!0).forEach(function(r){Ze(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gC(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function u5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c5(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,cO(r.key),r)}}function l5(e,t,n){return t&&c5(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function d5(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x1(e,t)}function x1(e,t){return x1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},x1(e,t)}function f5(e){var t=uO();return function(){var r=Pp(e),i;if(t){var o=Pp(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return h5(this,i)}}function h5(e,t){if(t&&(Is(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Je(e)}function Je(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uO=function(){return!!e})()}function Pp(e){return Pp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Pp(e)}function Ze(e,t,n){return t=cO(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cO(e){var t=p5(e,"string");return Is(t)=="symbol"?t:String(t)}function p5(e,t){if(Is(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Is(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}qv.InnerSlider=function(e){d5(n,e);var t=f5(n);function n(r){var i;u5(this,n),i=t.call(this,r),Ze(Je(i),"listRefHandler",function(a){return i.list=a}),Ze(Je(i),"trackRefHandler",function(a){return i.track=a}),Ze(Je(i),"adaptHeight",function(){if(i.props.adaptiveHeight&&i.list){var a=i.list.querySelector('[data-index="'.concat(i.state.currentSlide,'"]'));i.list.style.height=(0,Nt.getHeight)(a)+"px"}}),Ze(Je(i),"componentDidMount",function(){if(i.props.onInit&&i.props.onInit(),i.props.lazyLoad){var a=(0,Nt.getOnDemandLazySlides)(Me(Me({},i.props),i.state));a.length>0&&(i.setState(function(u){return{lazyLoadedList:u.lazyLoadedList.concat(a)}}),i.props.onLazyLoad&&i.props.onLazyLoad(a))}var s=Me({listRef:i.list,trackRef:i.track},i.props);i.updateState(s,!0,function(){i.adaptHeight(),i.props.autoplay&&i.autoPlay("update")}),i.props.lazyLoad==="progressive"&&(i.lazyLoadTimer=setInterval(i.progressiveLazyLoad,1e3)),i.ro=new o5.default(function(){i.state.animating?(i.onWindowResized(!1),i.callbackTimers.push(setTimeout(function(){return i.onWindowResized()},i.props.speed))):i.onWindowResized()}),i.ro.observe(i.list),document.querySelectorAll&&Array.prototype.forEach.call(document.querySelectorAll(".slick-slide"),function(u){u.onfocus=i.props.pauseOnFocus?i.onSlideFocus:null,u.onblur=i.props.pauseOnFocus?i.onSlideBlur:null}),window.addEventListener?window.addEventListener("resize",i.onWindowResized):window.attachEvent("onresize",i.onWindowResized)}),Ze(Je(i),"componentWillUnmount",function(){i.animationEndCallback&&clearTimeout(i.animationEndCallback),i.lazyLoadTimer&&clearInterval(i.lazyLoadTimer),i.callbackTimers.length&&(i.callbackTimers.forEach(function(a){return clearTimeout(a)}),i.callbackTimers=[]),window.addEventListener?window.removeEventListener("resize",i.onWindowResized):window.detachEvent("onresize",i.onWindowResized),i.autoplayTimer&&clearInterval(i.autoplayTimer),i.ro.disconnect()}),Ze(Je(i),"componentDidUpdate",function(a){if(i.checkImagesLoad(),i.props.onReInit&&i.props.onReInit(),i.props.lazyLoad){var s=(0,Nt.getOnDemandLazySlides)(Me(Me({},i.props),i.state));s.length>0&&(i.setState(function(l){return{lazyLoadedList:l.lazyLoadedList.concat(s)}}),i.props.onLazyLoad&&i.props.onLazyLoad(s))}i.adaptHeight();var u=Me(Me({listRef:i.list,trackRef:i.track},i.props),i.state),c=i.didPropsChange(a);c&&i.updateState(u,c,function(){i.state.currentSlide>=nr.default.Children.count(i.props.children)&&i.changeSlide({message:"index",index:nr.default.Children.count(i.props.children)-i.props.slidesToShow,currentSlide:i.state.currentSlide}),i.props.autoplay?i.autoPlay("update"):i.pause("paused")})}),Ze(Je(i),"onWindowResized",function(a){i.debouncedResize&&i.debouncedResize.cancel(),i.debouncedResize=(0,t5.default)(function(){return i.resizeWindow(a)},50),i.debouncedResize()}),Ze(Je(i),"resizeWindow",function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,s=!!(i.track&&i.track.node);if(s){var u=Me(Me({listRef:i.list,trackRef:i.track},i.props),i.state);i.updateState(u,a,function(){i.props.autoplay?i.autoPlay("update"):i.pause("paused")}),i.setState({animating:!1}),clearTimeout(i.animationEndCallback),delete i.animationEndCallback}}),Ze(Je(i),"updateState",function(a,s,u){var c=(0,Nt.initializedState)(a);a=Me(Me(Me({},a),c),{},{slideIndex:c.currentSlide});var l=(0,Nt.getTrackLeft)(a);a=Me(Me({},a),{},{left:l});var d=(0,Nt.getTrackCSS)(a);(s||nr.default.Children.count(i.props.children)!==nr.default.Children.count(a.children))&&(c.trackStyle=d),i.setState(c,u)}),Ze(Je(i),"ssrInit",function(){if(i.props.variableWidth){var a=0,s=0,u=[],c=(0,Nt.getPreClones)(Me(Me(Me({},i.props),i.state),{},{slideCount:i.props.children.length})),l=(0,Nt.getPostClones)(Me(Me(Me({},i.props),i.state),{},{slideCount:i.props.children.length}));i.props.children.forEach(function(R){u.push(R.props.style.width),a+=R.props.style.width});for(var d=0;d<c;d++)s+=u[u.length-1-d],a+=u[u.length-1-d];for(var f=0;f<l;f++)a+=u[f];for(var h=0;h<i.state.currentSlide;h++)s+=u[h];var p={width:a+"px",left:-s+"px"};if(i.props.centerMode){var m="".concat(u[i.state.currentSlide],"px");p.left="calc(".concat(p.left," + (100% - ").concat(m,") / 2 ) ")}return{trackStyle:p}}var g=nr.default.Children.count(i.props.children),v=Me(Me(Me({},i.props),i.state),{},{slideCount:g}),y=(0,Nt.getPreClones)(v)+(0,Nt.getPostClones)(v)+g,b=100/i.props.slidesToShow*y,w=100/y,E=-w*((0,Nt.getPreClones)(v)+i.state.currentSlide)*b/100;i.props.centerMode&&(E+=(100-w*b/100)/2);var x={width:b+"%",left:E+"%"};return{slideWidth:w+"%",trackStyle:x}}),Ze(Je(i),"checkImagesLoad",function(){var a=i.list&&i.list.querySelectorAll&&i.list.querySelectorAll(".slick-slide img")||[],s=a.length,u=0;Array.prototype.forEach.call(a,function(c){var l=function(){return++u&&u>=s&&i.onWindowResized()};if(!c.onclick)c.onclick=function(){return c.parentNode.focus()};else{var d=c.onclick;c.onclick=function(f){d(f),c.parentNode.focus()}}c.onload||(i.props.lazyLoad?c.onload=function(){i.adaptHeight(),i.callbackTimers.push(setTimeout(i.onWindowResized,i.props.speed))}:(c.onload=l,c.onerror=function(){l(),i.props.onLazyLoadError&&i.props.onLazyLoadError()}))})}),Ze(Je(i),"progressiveLazyLoad",function(){for(var a=[],s=Me(Me({},i.props),i.state),u=i.state.currentSlide;u<i.state.slideCount+(0,Nt.getPostClones)(s);u++)if(i.state.lazyLoadedList.indexOf(u)<0){a.push(u);break}for(var c=i.state.currentSlide-1;c>=-(0,Nt.getPreClones)(s);c--)if(i.state.lazyLoadedList.indexOf(c)<0){a.push(c);break}a.length>0?(i.setState(function(l){return{lazyLoadedList:l.lazyLoadedList.concat(a)}}),i.props.onLazyLoad&&i.props.onLazyLoad(a)):i.lazyLoadTimer&&(clearInterval(i.lazyLoadTimer),delete i.lazyLoadTimer)}),Ze(Je(i),"slideHandler",function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,u=i.props,c=u.asNavFor,l=u.beforeChange,d=u.onLazyLoad,f=u.speed,h=u.afterChange,p=i.state.currentSlide,m=(0,Nt.slideHandler)(Me(Me(Me({index:a},i.props),i.state),{},{trackRef:i.track,useCSS:i.props.useCSS&&!s})),g=m.state,v=m.nextState;if(g){l&&l(p,g.currentSlide);var y=g.lazyLoadedList.filter(function(b){return i.state.lazyLoadedList.indexOf(b)<0});d&&y.length>0&&d(y),!i.props.waitForAnimate&&i.animationEndCallback&&(clearTimeout(i.animationEndCallback),h&&h(p),delete i.animationEndCallback),i.setState(g,function(){c&&i.asNavForIndex!==a&&(i.asNavForIndex=a,c.innerSlider.slideHandler(a)),v&&(i.animationEndCallback=setTimeout(function(){var b=v.animating,w=a5(v,["animating"]);i.setState(w,function(){i.callbackTimers.push(setTimeout(function(){return i.setState({animating:b})},10)),h&&h(g.currentSlide),delete i.animationEndCallback})},f))})}}),Ze(Je(i),"changeSlide",function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,u=Me(Me({},i.props),i.state),c=(0,Nt.changeSlide)(u,a);if(!(c!==0&&!c)&&(s===!0?i.slideHandler(c,s):i.slideHandler(c),i.props.autoplay&&i.autoPlay("update"),i.props.focusOnSelect)){var l=i.list.querySelectorAll(".slick-current");l[0]&&l[0].focus()}}),Ze(Je(i),"clickHandler",function(a){i.clickable===!1&&(a.stopPropagation(),a.preventDefault()),i.clickable=!0}),Ze(Je(i),"keyHandler",function(a){var s=(0,Nt.keyHandler)(a,i.props.accessibility,i.props.rtl);s!==""&&i.changeSlide({message:s})}),Ze(Je(i),"selectHandler",function(a){i.changeSlide(a)}),Ze(Je(i),"disableBodyScroll",function(){var a=function(u){u=u||window.event,u.preventDefault&&u.preventDefault(),u.returnValue=!1};window.ontouchmove=a}),Ze(Je(i),"enableBodyScroll",function(){window.ontouchmove=null}),Ze(Je(i),"swipeStart",function(a){i.props.verticalSwiping&&i.disableBodyScroll();var s=(0,Nt.swipeStart)(a,i.props.swipe,i.props.draggable);s!==""&&i.setState(s)}),Ze(Je(i),"swipeMove",function(a){var s=(0,Nt.swipeMove)(a,Me(Me(Me({},i.props),i.state),{},{trackRef:i.track,listRef:i.list,slideIndex:i.state.currentSlide}));s&&(s.swiping&&(i.clickable=!1),i.setState(s))}),Ze(Je(i),"swipeEnd",function(a){var s=(0,Nt.swipeEnd)(a,Me(Me(Me({},i.props),i.state),{},{trackRef:i.track,listRef:i.list,slideIndex:i.state.currentSlide}));if(s){var u=s.triggerSlideHandler;delete s.triggerSlideHandler,i.setState(s),u!==void 0&&(i.slideHandler(u),i.props.verticalSwiping&&i.enableBodyScroll())}}),Ze(Je(i),"touchEnd",function(a){i.swipeEnd(a),i.clickable=!0}),Ze(Je(i),"slickPrev",function(){i.callbackTimers.push(setTimeout(function(){return i.changeSlide({message:"previous"})},0))}),Ze(Je(i),"slickNext",function(){i.callbackTimers.push(setTimeout(function(){return i.changeSlide({message:"next"})},0))}),Ze(Je(i),"slickGoTo",function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(a=Number(a),isNaN(a))return"";i.callbackTimers.push(setTimeout(function(){return i.changeSlide({message:"index",index:a,currentSlide:i.state.currentSlide},s)},0))}),Ze(Je(i),"play",function(){var a;if(i.props.rtl)a=i.state.currentSlide-i.props.slidesToScroll;else if((0,Nt.canGoNext)(Me(Me({},i.props),i.state)))a=i.state.currentSlide+i.props.slidesToScroll;else return!1;i.slideHandler(a)}),Ze(Je(i),"autoPlay",function(a){i.autoplayTimer&&clearInterval(i.autoplayTimer);var s=i.state.autoplaying;if(a==="update"){if(s==="hovered"||s==="focused"||s==="paused")return}else if(a==="leave"){if(s==="paused"||s==="focused")return}else if(a==="blur"&&(s==="paused"||s==="hovered"))return;i.autoplayTimer=setInterval(i.play,i.props.autoplaySpeed+50),i.setState({autoplaying:"playing"})}),Ze(Je(i),"pause",function(a){i.autoplayTimer&&(clearInterval(i.autoplayTimer),i.autoplayTimer=null);var s=i.state.autoplaying;a==="paused"?i.setState({autoplaying:"paused"}):a==="focused"?(s==="hovered"||s==="playing")&&i.setState({autoplaying:"focused"}):s==="playing"&&i.setState({autoplaying:"hovered"})}),Ze(Je(i),"onDotsOver",function(){return i.props.autoplay&&i.pause("hovered")}),Ze(Je(i),"onDotsLeave",function(){return i.props.autoplay&&i.state.autoplaying==="hovered"&&i.autoPlay("leave")}),Ze(Je(i),"onTrackOver",function(){return i.props.autoplay&&i.pause("hovered")}),Ze(Je(i),"onTrackLeave",function(){return i.props.autoplay&&i.state.autoplaying==="hovered"&&i.autoPlay("leave")}),Ze(Je(i),"onSlideFocus",function(){return i.props.autoplay&&i.pause("focused")}),Ze(Je(i),"onSlideBlur",function(){return i.props.autoplay&&i.state.autoplaying==="focused"&&i.autoPlay("blur")}),Ze(Je(i),"render",function(){var a=(0,n5.default)("slick-slider",i.props.className,{"slick-vertical":i.props.vertical,"slick-initialized":!0}),s=Me(Me({},i.props),i.state),u=(0,Nt.extractObject)(s,["fade","cssEase","speed","infinite","centerMode","focusOnSelect","currentSlide","lazyLoad","lazyLoadedList","rtl","slideWidth","slideHeight","listHeight","vertical","slidesToShow","slidesToScroll","slideCount","trackStyle","variableWidth","unslick","centerPadding","targetSlide","useCSS"]),c=i.props.pauseOnHover;u=Me(Me({},u),{},{onMouseEnter:c?i.onTrackOver:null,onMouseLeave:c?i.onTrackLeave:null,onMouseOver:c?i.onTrackOver:null,focusOnSelect:i.props.focusOnSelect&&i.clickable?i.selectHandler:null});var l;if(i.props.dots===!0&&i.state.slideCount>=i.props.slidesToShow){var d=(0,Nt.extractObject)(s,["dotsClass","slideCount","slidesToShow","currentSlide","slidesToScroll","clickHandler","children","customPaging","infinite","appendDots"]),f=i.props.pauseOnDotsHover;d=Me(Me({},d),{},{clickHandler:i.changeSlide,onMouseEnter:f?i.onDotsLeave:null,onMouseOver:f?i.onDotsOver:null,onMouseLeave:f?i.onDotsLeave:null}),l=nr.default.createElement(i5.Dots,d)}var h,p,m=(0,Nt.extractObject)(s,["infinite","centerMode","currentSlide","slideCount","slidesToShow","prevArrow","nextArrow"]);m.clickHandler=i.changeSlide,i.props.arrows&&(h=nr.default.createElement(mC.PrevArrow,m),p=nr.default.createElement(mC.NextArrow,m));var g=null;i.props.vertical&&(g={height:i.state.listHeight});var v=null;i.props.vertical===!1?i.props.centerMode===!0&&(v={padding:"0px "+i.props.centerPadding}):i.props.centerMode===!0&&(v={padding:i.props.centerPadding+" 0px"});var y=Me(Me({},g),v),b=i.props.touchMove,w={className:"slick-list",style:y,onClick:i.clickHandler,onMouseDown:b?i.swipeStart:null,onMouseMove:i.state.dragging&&b?i.swipeMove:null,onMouseUp:b?i.swipeEnd:null,onMouseLeave:i.state.dragging&&b?i.swipeEnd:null,onTouchStart:b?i.swipeStart:null,onTouchMove:i.state.dragging&&b?i.swipeMove:null,onTouchEnd:b?i.touchEnd:null,onTouchCancel:i.state.dragging&&b?i.swipeEnd:null,onKeyDown:i.props.accessibility?i.keyHandler:null},E={className:a,dir:"ltr",style:i.props.style};return i.props.unslick&&(w={className:"slick-list"},E={className:a}),nr.default.createElement("div",E,i.props.unslick?"":h,nr.default.createElement("div",Op({ref:i.listRefHandler},w),nr.default.createElement(r5.Track,Op({ref:i.trackRefHandler},u),i.props.children)),i.props.unslick?"":p,i.props.unslick?"":l)}),i.list=null,i.track=null,i.state=Me(Me({},e5.default),{},{currentSlide:i.props.initialSlide,targetSlide:i.props.initialSlide?i.props.initialSlide:0,slideCount:nr.default.Children.count(i.props.children)}),i.callbackTimers=[],i.clickable=!0,i.debouncedResize=null;var o=i.ssrInit();return i.state=Me(Me({},i.state),o),i}return l5(n,[{key:"didPropsChange",value:function(i){for(var o=!1,a=0,s=Object.keys(this.props);a<s.length;a++){var u=s[a];if(!i.hasOwnProperty(u)){o=!0;break}if(!(Is(i[u])==="object"||typeof i[u]=="function"||isNaN(i[u]))&&i[u]!==this.props[u]){o=!0;break}}return o||nr.default.Children.count(this.props.children)!==nr.default.Children.count(i.children)}}]),n}(nr.default.Component);var v5=function(e){return e.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()}).toLowerCase()},m5=v5,g5=m5,y5=function(e){var t=/[height|width]$/;return t.test(e)},yC=function(e){var t="",n=Object.keys(e);return n.forEach(function(r,i){var o=e[r];r=g5(r),y5(r)&&typeof o=="number"&&(o=o+"px"),o===!0?t+=r:o===!1?t+="not "+r:t+="("+r+": "+o+")",i<n.length-1&&(t+=" and ")}),t},b5=function(e){var t="";return typeof e=="string"?e:e instanceof Array?(e.forEach(function(n,r){t+=yC(n),r<e.length-1&&(t+=", ")}),t):yC(e)},w5=b5,$g,bC;function x5(){if(bC)return $g;bC=1;function e(t){this.options=t,!t.deferSetup&&this.setup()}return e.prototype={constructor:e,setup:function(){this.options.setup&&this.options.setup(),this.initialised=!0},on:function(){!this.initialised&&this.setup(),this.options.match&&this.options.match()},off:function(){this.options.unmatch&&this.options.unmatch()},destroy:function(){this.options.destroy?this.options.destroy():this.off()},equals:function(t){return this.options===t||this.options.match===t}},$g=e,$g}var Vg,wC;function lO(){if(wC)return Vg;wC=1;function e(r,i){var o=0,a=r.length,s;for(o;o<a&&(s=i(r[o],o),s!==!1);o++);}function t(r){return Object.prototype.toString.apply(r)==="[object Array]"}function n(r){return typeof r=="function"}return Vg={isFunction:n,isArray:t,each:e},Vg}var Wg,xC;function E5(){if(xC)return Wg;xC=1;var e=x5(),t=lO().each;function n(r,i){this.query=r,this.isUnconditional=i,this.handlers=[],this.mql=window.matchMedia(r);var o=this;this.listener=function(a){o.mql=a.currentTarget||a,o.assess()},this.mql.addListener(this.listener)}return n.prototype={constuctor:n,addHandler:function(r){var i=new e(r);this.handlers.push(i),this.matches()&&i.on()},removeHandler:function(r){var i=this.handlers;t(i,function(o,a){if(o.equals(r))return o.destroy(),!i.splice(a,1)})},matches:function(){return this.mql.matches||this.isUnconditional},clear:function(){t(this.handlers,function(r){r.destroy()}),this.mql.removeListener(this.listener),this.handlers.length=0},assess:function(){var r=this.matches()?"on":"off";t(this.handlers,function(i){i[r]()})}},Wg=n,Wg}var Ug,EC;function S5(){if(EC)return Ug;EC=1;var e=E5(),t=lO(),n=t.each,r=t.isFunction,i=t.isArray;function o(){if(!window.matchMedia)throw new Error("matchMedia not present, legacy browsers require a polyfill");this.queries={},this.browserIsIncapable=!window.matchMedia("only all").matches}return o.prototype={constructor:o,register:function(a,s,u){var c=this.queries,l=u&&this.browserIsIncapable;return c[a]||(c[a]=new e(a,l)),r(s)&&(s={match:s}),i(s)||(s=[s]),n(s,function(d){r(d)&&(d={match:d}),c[a].addHandler(d)}),this},unregister:function(a,s){var u=this.queries[a];return u&&(s?u.removeHandler(s):(u.clear(),delete this.queries[a])),this}},Ug=o,Ug}var zg,SC;function C5(){if(SC)return zg;SC=1;var e=S5();return zg=new e,zg}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=a(O),n=qv,r=a(w5),i=a(bw),o=ge;function a(_){return _&&_.__esModule?_:{default:_}}function s(_){"@babel/helpers - typeof";return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},s(_)}function u(){return u=Object.assign?Object.assign.bind():function(_){for(var T=1;T<arguments.length;T++){var B=arguments[T];for(var L in B)Object.prototype.hasOwnProperty.call(B,L)&&(_[L]=B[L])}return _},u.apply(this,arguments)}function c(_,T){var B=Object.keys(_);if(Object.getOwnPropertySymbols){var L=Object.getOwnPropertySymbols(_);T&&(L=L.filter(function(k){return Object.getOwnPropertyDescriptor(_,k).enumerable})),B.push.apply(B,L)}return B}function l(_){for(var T=1;T<arguments.length;T++){var B=arguments[T]!=null?arguments[T]:{};T%2?c(Object(B),!0).forEach(function(L){E(_,L,B[L])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(B)):c(Object(B)).forEach(function(L){Object.defineProperty(_,L,Object.getOwnPropertyDescriptor(B,L))})}return _}function d(_,T){if(!(_ instanceof T))throw new TypeError("Cannot call a class as a function")}function f(_,T){for(var B=0;B<T.length;B++){var L=T[B];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(_,x(L.key),L)}}function h(_,T,B){return T&&f(_.prototype,T),Object.defineProperty(_,"prototype",{writable:!1}),_}function p(_,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(T&&T.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),Object.defineProperty(_,"prototype",{writable:!1}),T&&m(_,T)}function m(_,T){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(L,k){return L.__proto__=k,L},m(_,T)}function g(_){var T=b();return function(){var L=w(_),k;if(T){var D=w(this).constructor;k=Reflect.construct(L,arguments,D)}else k=L.apply(this,arguments);return v(this,k)}}function v(_,T){if(T&&(s(T)==="object"||typeof T=="function"))return T;if(T!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y(_)}function y(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}function b(){try{var _=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(b=function(){return!!_})()}function w(_){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(B){return B.__proto__||Object.getPrototypeOf(B)},w(_)}function E(_,T,B){return T=x(T),T in _?Object.defineProperty(_,T,{value:B,enumerable:!0,configurable:!0,writable:!0}):_[T]=B,_}function x(_){var T=R(_,"string");return s(T)=="symbol"?T:String(T)}function R(_,T){if(s(_)!="object"||!_)return _;var B=_[Symbol.toPrimitive];if(B!==void 0){var L=B.call(_,T||"default");if(s(L)!="object")return L;throw new TypeError("@@toPrimitive must return a primitive value.")}return(T==="string"?String:Number)(_)}var S=(0,o.canUseDOM)()&&C5();e.default=function(_){p(B,_);var T=g(B);function B(L){var k;return d(this,B),k=T.call(this,L),E(y(k),"innerSliderRefHandler",function(D){return k.innerSlider=D}),E(y(k),"slickPrev",function(){return k.innerSlider.slickPrev()}),E(y(k),"slickNext",function(){return k.innerSlider.slickNext()}),E(y(k),"slickGoTo",function(D){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return k.innerSlider.slickGoTo(D,F)}),E(y(k),"slickPause",function(){return k.innerSlider.pause("paused")}),E(y(k),"slickPlay",function(){return k.innerSlider.autoPlay("play")}),k.state={breakpoint:null},k._responsiveMediaHandlers=[],k}return h(B,[{key:"media",value:function(k,D){S.register(k,D),this._responsiveMediaHandlers.push({query:k,handler:D})}},{key:"componentDidMount",value:function(){var k=this;if(this.props.responsive){var D=this.props.responsive.map(function(M){return M.breakpoint});D.sort(function(M,I){return M-I}),D.forEach(function(M,I){var N;I===0?N=(0,r.default)({minWidth:0,maxWidth:M}):N=(0,r.default)({minWidth:D[I-1]+1,maxWidth:M}),(0,o.canUseDOM)()&&k.media(N,function(){k.setState({breakpoint:M})})});var F=(0,r.default)({minWidth:D.slice(-1)[0]});(0,o.canUseDOM)()&&this.media(F,function(){k.setState({breakpoint:null})})}}},{key:"componentWillUnmount",value:function(){this._responsiveMediaHandlers.forEach(function(k){S.unregister(k.query,k.handler)})}},{key:"render",value:function(){var k=this,D,F;this.state.breakpoint?(F=this.props.responsive.filter(function(Q){return Q.breakpoint===k.state.breakpoint}),D=F[0].settings==="unslick"?"unslick":l(l(l({},i.default),this.props),F[0].settings)):D=l(l({},i.default),this.props),D.centerMode&&(D.slidesToScroll>1,D.slidesToScroll=1),D.fade&&(D.slidesToShow>1,D.slidesToScroll>1,D.slidesToShow=1,D.slidesToScroll=1);var M=t.default.Children.toArray(this.props.children);M=M.filter(function(Q){return typeof Q=="string"?!!Q.trim():!!Q}),D.variableWidth&&(D.rows>1||D.slidesPerRow>1)&&(console.warn("variableWidth is not supported in case of rows > 1 or slidesPerRow > 1"),D.variableWidth=!1);for(var I=[],N=null,j=0;j<M.length;j+=D.rows*D.slidesPerRow){for(var P=[],A=j;A<j+D.rows*D.slidesPerRow;A+=D.slidesPerRow){for(var U=[],H=A;H<A+D.slidesPerRow&&(D.variableWidth&&M[H].props.style&&(N=M[H].props.style.width),!(H>=M.length));H+=1)U.push(t.default.cloneElement(M[H],{key:100*j+10*A+H,tabIndex:-1,style:{width:"".concat(100/D.slidesPerRow,"%"),display:"inline-block"}}));P.push(t.default.createElement("div",{key:10*j+A},U))}D.variableWidth?I.push(t.default.createElement("div",{key:j,style:{width:N}},P)):I.push(t.default.createElement("div",{key:j},P))}if(D==="unslick"){var q="regular slider "+(this.props.className||"");return t.default.createElement("div",{className:q},M)}else I.length<=D.slidesToShow&&!D.infinite&&(D.unslick=!0);return t.default.createElement(n.InnerSlider,u({style:this.props.style,ref:this.innerSliderRefHandler},(0,o.filterSettings)(D)),I)}}]),B}(t.default.Component)})(TT);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=n(TT);function n(r){return r&&r.__esModule?r:{default:r}}e.default=t.default})(IT);const dO=Ms(IT),fO=J.div`
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	display: flex;
	align-items: center;
	justify-content: center;
	background-color: rgba(0, 0, 0, 0.5);
	z-index: 50;
`,_5=J.div`
	background-color: white;
	padding: 16px;
	border-radius: 20px;
	box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
	max-width: 800px;
	width: 100%;
	border: 8px solid ${({borderColor:e})=>e};
`,k5=J.div`
	background-color: white;
	padding: 16px;
	border-radius: 20px;
	box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
	height: 550px;
	max-width: 800px;
	width: 100%;
	border: 8px solid ${({borderColor:e})=>e};
`,hO=J.div`
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding-bottom: 8px;
	padding-left: 15px;
	padding-top: 15px;
	position: relative;
`,pO=J.h2`
	font-size: 1.5rem;
	flex: 1;
`;J.h2`
	font-size: 1.5rem;
	flex: 1;
`;const vO=J.button`
	font-size: 1.5rem;
	background: none;
	border: none;
	cursor: pointer;
	position: absolute;
	top: 0;
	right: 0;
	color: ${({borderColor:e})=>e};
`,mO=J.div`
	display: flex;
	flex-direction: column;
	gap: 16px;
	padding: 8px;
`,R5=J.p`
	font-size: 1.1rem;
	font-weight: 600;
	color: #4b5563;
	border-radius: 15px;
	padding: 20px;
	height: 150px;
	overflow-y: auto; /* Enable vertical scrolling */
	overflow-x: hidden; /* Prevent horizontal scrolling */
	background-color: #f9fafb;
	border: 3px solid ${({borderColor:e})=>e};
	text-align: center;
	box-sizing: border-box;
	word-wrap: break-word;
	max-width: 100%; /* Ensure no overflow */
`,gO=J.span`
	font-weight: 400;
	color: #6b7280;
	display: block;
`,I5=J.p`
	font-size: 1.1rem;
	color: #4b5563;
	border-radius: 15px;
	padding: 10px;
	padding-left: 20px;
	height: 50px;
	background-color: #f9fafb;
	border: 3px solid ${({borderColor:e})=>e};
`,T5=J.div`
	display: flex;
	justify-content: space-around;
	align-items: center;
	width: 100%;
	position: relative;
	margin-top: 10px;
	margin-bottom: 10px;
`,O5=J.div`
	display: flex;
	flex-direction: column;
	align-items: center;
	margin: 0 30px;
`,P5=J.img`
	width: 65px;
	height: 65px;
	border-radius: 50%;
	margin-bottom: 8px;
	margin-top: 8px;
	border: 4px solid ${({borderColor:e})=>e};
`,N5=J.div`
	position: relative;
	border-radius: 10px;
	padding: 10px;
	width: 150px;
	margin-bottom: 8px;
	color: #ffffff;
	display: flex;
	align-items: center;
	justify-content: center;
	text-align: center;
	word-break: break-word;
	word-wrap: break-word;
	&:after {
		content: "";
		position: absolute;
		top: 100%;
		left: 50%;
		border: solid transparent;
		height: 0;
		width: 0;
		pointer-events: none;
		border-color: rgba(255, 255, 255, 0);
		border-top-color: inherit;
		border-width: 10px;
		margin-left: -10px;
	}
`;J.div`
	display: flex;
	flex-direction: column;
	align-items: center;
	width: 100%;
`;const D5=J.div`
	display: flex;
	flex-direction: column;
	align-items: center;
	width: 100%;
`,A5=J.div`
	width: 100%;
	margin-bottom: 0px;
	position: relative;
	height: 24px;
	border-radius: 12px;
	overflow: hidden;
	background-color: #f0f0f0;
`,CC=J.div`
	width: ${({percentage:e})=>e}%;
	height: 24px;
	background-color: ${({color:e})=>e};
	position: absolute;
	top: 0;
	left: 0;
`,M5=J.div`
	display: flex;
	justify-content: space-between;
	width: 100%;
	padding: 8px;
`,Hg=J.p`
	font-size: 1rem;
	margin-bottom: 5px;
`;J.div`
	display: flex;
	flex-direction: column;
	align-items: center;
	flex-grow: 1;
`;const L5=J.div`
	font-size: 2rem;
	font-weight: bold;
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
`,ss="/assets/default-CUdnyLkq.png",F5=J(N5)`
	background: ${({color:e})=>e};

	&:after {
		border-top-color: ${({color:e})=>e};
	}
`;function _C({nickname:e,imgUrl:t,opinion:n,speechBubbleColor:r}){const i=o=>{o.currentTarget.src=ss};return C.jsxs(O5,{children:[C.jsx(F5,{color:r,children:n}),C.jsx(P5,{src:t,alt:e,borderColor:r,onError:i}),C.jsx(gO,{children:e})]})}function Gg({title:e,percentageRegisterOpinion:t,percentageOppositeOpinion:n,countRegisterOpinion:r=0,countOppositeOpinion:i=0,registerColor:o,oppositeColor:a}){return C.jsxs(D5,{style:{width:"100%"},children:[C.jsx(Hg,{children:e}),C.jsxs(A5,{children:[C.jsx(CC,{percentage:t,color:o}),C.jsx(CC,{percentage:n,color:a,style:{left:`${t}%`}})]}),C.jsxs(M5,{children:[C.jsxs(Hg,{children:[t,"%(",r,"명)"]}),C.jsxs(Hg,{children:[n,"%(",i,"명)"]})]})]})}function Qv({registerUser:e,oppositeUser:t,speechBubbleColor:n,status:r,preResult:i,finalResult:o,preResultCount:a,finalResultCount:s,opinions:u=[]}){const c=r==="balance"&&u.length>=2?u[1].opinion:t.opinion,l=r==="balance"&&u.length>=2?u[0].opinion:e.opinion;return C.jsxs(T5,{children:[C.jsx(_C,{nickname:e.nickname,imgUrl:e.imgUrl,opinion:l,speechBubbleColor:n}),r==="upcoming"&&C.jsx(L5,{children:"VS"}),r==="ended"&&i&&o&&C.jsxs("div",{style:{width:"100%"},children:[C.jsx(Gg,{title:"사전 투표",percentageRegisterOpinion:i.percentageRegisterOpinion,percentageOppositeOpinion:i.percentageOppositeOpinion,countRegisterOpinion:a==null?void 0:a.percentageRegisterOpinion,countOppositeOpinion:a==null?void 0:a.percentageOppositeOpinion,registerColor:"#FFC7C2",oppositeColor:"#BDE3FF"}),C.jsx(Gg,{title:"최종 투표",percentageRegisterOpinion:o.percentageRegisterOpinion,percentageOppositeOpinion:o.percentageOppositeOpinion,countRegisterOpinion:s==null?void 0:s.percentageRegisterOpinion,countOppositeOpinion:s==null?void 0:s.percentageOppositeOpinion,registerColor:"#FFC7C2",oppositeColor:"#BDE3FF"})]}),r==="balance"&&u.length>=2&&C.jsx("div",{style:{width:"100%"},children:C.jsx(Gg,{title:"투표 결과",percentageRegisterOpinion:u[0].percentage,percentageOppositeOpinion:u[1].percentage,countRegisterOpinion:u[0].count,countOppositeOpinion:u[1].count,registerColor:"#F66C23",oppositeColor:"#0B68EC"})}),C.jsx(_C,{nickname:t.nickname,imgUrl:t.imgUrl,opinion:c,speechBubbleColor:n})]})}Qv.defaultProps={preResult:{percentageRegisterOpinion:50,percentageOppositeOpinion:50},finalResult:{percentageRegisterOpinion:50,percentageOppositeOpinion:50}};const B5=J(_5)`
	border: 8px solid ${({borderColor:e})=>e};
`;function xw({title:e,infoText:t,summary:n,onClose:r,children:i,borderColor:o}){const a=s=>{s.target===s.currentTarget&&r()};return C.jsx(fO,{onClick:a,children:C.jsxs(B5,{borderColor:o,children:[C.jsxs(hO,{children:[C.jsx(pO,{children:e}),C.jsx(vO,{type:"button",onClick:r,borderColor:o,children:"X"})]}),C.jsxs(mO,{children:[C.jsx(I5,{borderColor:o,children:t}),i,C.jsx(R5,{borderColor:o,className:"custom-scrollbar",children:C.jsx(gO,{children:n})})]})]})})}var j5={VITE_API_BASE_URL:"/battle-people",VITE_APP_WEBSOCKET_URL:"wss://i11a706.p.ssafy.io/battle-people/ws",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const kC=e=>{let t;const n=new Set,r=(l,d)=>{const f=typeof l=="function"?l(t):l;if(!Object.is(f,t)){const h=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(p=>p(t,h))}},i=()=>t,u={setState:r,getState:i,getInitialState:()=>c,subscribe:l=>(n.add(l),()=>n.delete(l)),destroy:()=>{(j5?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=t=e(r,i,u);return u},$5=e=>e?kC(e):kC;var yO={exports:{}},bO={},wO={exports:{}},xO={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hc=O;function V5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var W5=typeof Object.is=="function"?Object.is:V5,U5=hc.useState,z5=hc.useEffect,H5=hc.useLayoutEffect,G5=hc.useDebugValue;function q5(e,t){var n=t(),r=U5({inst:{value:n,getSnapshot:t}}),i=r[0].inst,o=r[1];return H5(function(){i.value=n,i.getSnapshot=t,qg(i)&&o({inst:i})},[e,n,t]),z5(function(){return qg(i)&&o({inst:i}),e(function(){qg(i)&&o({inst:i})})},[e]),G5(n),n}function qg(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!W5(e,n)}catch{return!0}}function X5(e,t){return t()}var K5=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?X5:q5;xO.useSyncExternalStore=hc.useSyncExternalStore!==void 0?hc.useSyncExternalStore:K5;wO.exports=xO;var Y5=wO.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jv=O,Q5=Y5;function J5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Z5=typeof Object.is=="function"?Object.is:J5,e$=Q5.useSyncExternalStore,t$=Jv.useRef,n$=Jv.useEffect,r$=Jv.useMemo,i$=Jv.useDebugValue;bO.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var o=t$(null);if(o.current===null){var a={hasValue:!1,value:null};o.current=a}else a=o.current;o=r$(function(){function u(h){if(!c){if(c=!0,l=h,h=r(h),i!==void 0&&a.hasValue){var p=a.value;if(i(p,h))return d=p}return d=h}if(p=d,Z5(l,h))return p;var m=r(h);return i!==void 0&&i(p,m)?p:(l=h,d=m)}var c=!1,l,d,f=n===void 0?null:n;return[function(){return u(t())},f===null?void 0:function(){return u(f())}]},[t,n,r,i]);var s=e$(e,o[0],o[1]);return n$(function(){a.hasValue=!0,a.value=s},[s]),i$(s),s};yO.exports=bO;var o$=yO.exports;const a$=Ms(o$);var EO={VITE_API_BASE_URL:"/battle-people",VITE_APP_WEBSOCKET_URL:"wss://i11a706.p.ssafy.io/battle-people/ws",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{useDebugValue:s$}=we,{useSyncExternalStoreWithSelector:u$}=a$;let RC=!1;const c$=e=>e;function l$(e,t=c$,n){(EO?"production":void 0)!=="production"&&n&&!RC&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),RC=!0);const r=u$(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return s$(r),r}const IC=e=>{(EO?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?$5(e):e,n=(r,i)=>l$(t,r,i);return Object.assign(n,t),n},d$=e=>e?IC(e):IC,Pn=d$(e=>({isLogin:!1,user:null,login:t=>{e({isLogin:!0,user:t}),localStorage.setItem("user",JSON.stringify({user:t}))},logout:()=>{e({isLogin:!1,user:null}),localStorage.removeItem("user")},setUser:t=>{e({user:t});const n=localStorage.getItem("user");let r=new Date(Date.now()+3600).toISOString();n&&(r=JSON.parse(n).expireAt),localStorage.setItem("user",JSON.stringify({user:t,expireAt:r}))}})),TC=localStorage.getItem("user");if(TC){const{user:e}=JSON.parse(TC);new Date<new Date(e.accessExpiration)?Pn.getState().login(e):localStorage.removeItem("user")}function SO(e,t){return function(){return e.apply(t,arguments)}}const{toString:f$}=Object.prototype,{getPrototypeOf:Ew}=Object,Zv=(e=>t=>{const n=f$.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Ti=e=>(e=e.toLowerCase(),t=>Zv(t)===e),em=e=>t=>typeof t===e,{isArray:kc}=Array,fd=em("undefined");function h$(e){return e!==null&&!fd(e)&&e.constructor!==null&&!fd(e.constructor)&&ii(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const CO=Ti("ArrayBuffer");function p$(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&CO(e.buffer),t}const v$=em("string"),ii=em("function"),_O=em("number"),tm=e=>e!==null&&typeof e=="object",m$=e=>e===!0||e===!1,jh=e=>{if(Zv(e)!=="object")return!1;const t=Ew(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},g$=Ti("Date"),y$=Ti("File"),b$=Ti("Blob"),w$=Ti("FileList"),x$=e=>tm(e)&&ii(e.pipe),E$=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ii(e.append)&&((t=Zv(e))==="formdata"||t==="object"&&ii(e.toString)&&e.toString()==="[object FormData]"))},S$=Ti("URLSearchParams"),[C$,_$,k$,R$]=["ReadableStream","Request","Response","Headers"].map(Ti),I$=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Dd(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),kc(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const o=n?Object.getOwnPropertyNames(e):Object.keys(e),a=o.length;let s;for(r=0;r<a;r++)s=o[r],t.call(null,e[s],s,e)}}function kO(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,i;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const RO=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,IO=e=>!fd(e)&&e!==RO;function E1(){const{caseless:e}=IO(this)&&this||{},t={},n=(r,i)=>{const o=e&&kO(t,i)||i;jh(t[o])&&jh(r)?t[o]=E1(t[o],r):jh(r)?t[o]=E1({},r):kc(r)?t[o]=r.slice():t[o]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Dd(arguments[r],n);return t}const T$=(e,t,n,{allOwnKeys:r}={})=>(Dd(t,(i,o)=>{n&&ii(i)?e[o]=SO(i,n):e[o]=i},{allOwnKeys:r}),e),O$=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),P$=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},N$=(e,t,n,r)=>{let i,o,a;const s={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),o=i.length;o-- >0;)a=i[o],(!r||r(a,e,t))&&!s[a]&&(t[a]=e[a],s[a]=!0);e=n!==!1&&Ew(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},D$=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},A$=e=>{if(!e)return null;if(kc(e))return e;let t=e.length;if(!_O(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},M$=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Ew(Uint8Array)),L$=(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let i;for(;(i=r.next())&&!i.done;){const o=i.value;t.call(e,o[0],o[1])}},F$=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},B$=Ti("HTMLFormElement"),j$=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),OC=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),$$=Ti("RegExp"),TO=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Dd(n,(i,o)=>{let a;(a=t(i,o,e))!==!1&&(r[o]=a||i)}),Object.defineProperties(e,r)},V$=e=>{TO(e,(t,n)=>{if(ii(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(ii(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},W$=(e,t)=>{const n={},r=i=>{i.forEach(o=>{n[o]=!0})};return kc(e)?r(e):r(String(e).split(t)),n},U$=()=>{},z$=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t,Xg="abcdefghijklmnopqrstuvwxyz",PC="0123456789",OO={DIGIT:PC,ALPHA:Xg,ALPHA_DIGIT:Xg+Xg.toUpperCase()+PC},H$=(e=16,t=OO.ALPHA_DIGIT)=>{let n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n};function G$(e){return!!(e&&ii(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const q$=e=>{const t=new Array(10),n=(r,i)=>{if(tm(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[i]=r;const o=kc(r)?[]:{};return Dd(r,(a,s)=>{const u=n(a,i+1);!fd(u)&&(o[s]=u)}),t[i]=void 0,o}}return r};return n(e,0)},X$=Ti("AsyncFunction"),K$=e=>e&&(tm(e)||ii(e))&&ii(e.then)&&ii(e.catch),oe={isArray:kc,isArrayBuffer:CO,isBuffer:h$,isFormData:E$,isArrayBufferView:p$,isString:v$,isNumber:_O,isBoolean:m$,isObject:tm,isPlainObject:jh,isReadableStream:C$,isRequest:_$,isResponse:k$,isHeaders:R$,isUndefined:fd,isDate:g$,isFile:y$,isBlob:b$,isRegExp:$$,isFunction:ii,isStream:x$,isURLSearchParams:S$,isTypedArray:M$,isFileList:w$,forEach:Dd,merge:E1,extend:T$,trim:I$,stripBOM:O$,inherits:P$,toFlatObject:N$,kindOf:Zv,kindOfTest:Ti,endsWith:D$,toArray:A$,forEachEntry:L$,matchAll:F$,isHTMLForm:B$,hasOwnProperty:OC,hasOwnProp:OC,reduceDescriptors:TO,freezeMethods:V$,toObjectSet:W$,toCamelCase:j$,noop:U$,toFiniteNumber:z$,findKey:kO,global:RO,isContextDefined:IO,ALPHABET:OO,generateString:H$,isSpecCompliantForm:G$,toJSONObject:q$,isAsyncFn:X$,isThenable:K$};function Ue(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i)}oe.inherits(Ue,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:oe.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const PO=Ue.prototype,NO={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{NO[e]={value:e}});Object.defineProperties(Ue,NO);Object.defineProperty(PO,"isAxiosError",{value:!0});Ue.from=(e,t,n,r,i,o)=>{const a=Object.create(PO);return oe.toFlatObject(e,a,function(u){return u!==Error.prototype},s=>s!=="isAxiosError"),Ue.call(a,e.message,t,n,r,i),a.cause=e,a.name=e.name,o&&Object.assign(a,o),a};const Y$=null;function S1(e){return oe.isPlainObject(e)||oe.isArray(e)}function DO(e){return oe.endsWith(e,"[]")?e.slice(0,-2):e}function NC(e,t,n){return e?e.concat(t).map(function(i,o){return i=DO(i),!n&&o?"["+i+"]":i}).join(n?".":""):t}function Q$(e){return oe.isArray(e)&&!e.some(S1)}const J$=oe.toFlatObject(oe,{},null,function(t){return/^is[A-Z]/.test(t)});function nm(e,t,n){if(!oe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=oe.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,g){return!oe.isUndefined(g[m])});const r=n.metaTokens,i=n.visitor||l,o=n.dots,a=n.indexes,u=(n.Blob||typeof Blob<"u"&&Blob)&&oe.isSpecCompliantForm(t);if(!oe.isFunction(i))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(oe.isDate(p))return p.toISOString();if(!u&&oe.isBlob(p))throw new Ue("Blob is not supported. Use a Buffer instead.");return oe.isArrayBuffer(p)||oe.isTypedArray(p)?u&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function l(p,m,g){let v=p;if(p&&!g&&typeof p=="object"){if(oe.endsWith(m,"{}"))m=r?m:m.slice(0,-2),p=JSON.stringify(p);else if(oe.isArray(p)&&Q$(p)||(oe.isFileList(p)||oe.endsWith(m,"[]"))&&(v=oe.toArray(p)))return m=DO(m),v.forEach(function(b,w){!(oe.isUndefined(b)||b===null)&&t.append(a===!0?NC([m],w,o):a===null?m:m+"[]",c(b))}),!1}return S1(p)?!0:(t.append(NC(g,m,o),c(p)),!1)}const d=[],f=Object.assign(J$,{defaultVisitor:l,convertValue:c,isVisitable:S1});function h(p,m){if(!oe.isUndefined(p)){if(d.indexOf(p)!==-1)throw Error("Circular reference detected in "+m.join("."));d.push(p),oe.forEach(p,function(v,y){(!(oe.isUndefined(v)||v===null)&&i.call(t,v,oe.isString(y)?y.trim():y,m,f))===!0&&h(v,m?m.concat(y):[y])}),d.pop()}}if(!oe.isObject(e))throw new TypeError("data must be an object");return h(e),t}function DC(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function Sw(e,t){this._pairs=[],e&&nm(e,this,t)}const AO=Sw.prototype;AO.append=function(t,n){this._pairs.push([t,n])};AO.toString=function(t){const n=t?function(r){return t.call(this,r,DC)}:DC;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function Z$(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function MO(e,t,n){if(!t)return e;const r=n&&n.encode||Z$,i=n&&n.serialize;let o;if(i?o=i(t,n):o=oe.isURLSearchParams(t)?t.toString():new Sw(t,n).toString(r),o){const a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class AC{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){oe.forEach(this.handlers,function(r){r!==null&&t(r)})}}const LO={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},e6=typeof URLSearchParams<"u"?URLSearchParams:Sw,t6=typeof FormData<"u"?FormData:null,n6=typeof Blob<"u"?Blob:null,r6={isBrowser:!0,classes:{URLSearchParams:e6,FormData:t6,Blob:n6},protocols:["http","https","file","blob","url","data"]},Cw=typeof window<"u"&&typeof document<"u",i6=(e=>Cw&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),o6=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",a6=Cw&&window.location.href||"http://localhost",s6=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Cw,hasStandardBrowserEnv:i6,hasStandardBrowserWebWorkerEnv:o6,origin:a6},Symbol.toStringTag,{value:"Module"})),_i={...s6,...r6};function u6(e,t){return nm(e,new _i.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,o){return _i.isNode&&oe.isBuffer(n)?(this.append(r,n.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},t))}function c6(e){return oe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function l6(e){const t={},n=Object.keys(e);let r;const i=n.length;let o;for(r=0;r<i;r++)o=n[r],t[o]=e[o];return t}function FO(e){function t(n,r,i,o){let a=n[o++];if(a==="__proto__")return!0;const s=Number.isFinite(+a),u=o>=n.length;return a=!a&&oe.isArray(i)?i.length:a,u?(oe.hasOwnProp(i,a)?i[a]=[i[a],r]:i[a]=r,!s):((!i[a]||!oe.isObject(i[a]))&&(i[a]=[]),t(n,r,i[a],o)&&oe.isArray(i[a])&&(i[a]=l6(i[a])),!s)}if(oe.isFormData(e)&&oe.isFunction(e.entries)){const n={};return oe.forEachEntry(e,(r,i)=>{t(c6(r),i,n,0)}),n}return null}function d6(e,t,n){if(oe.isString(e))try{return(t||JSON.parse)(e),oe.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const Ad={transitional:LO,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,o=oe.isObject(t);if(o&&oe.isHTMLForm(t)&&(t=new FormData(t)),oe.isFormData(t))return i?JSON.stringify(FO(t)):t;if(oe.isArrayBuffer(t)||oe.isBuffer(t)||oe.isStream(t)||oe.isFile(t)||oe.isBlob(t)||oe.isReadableStream(t))return t;if(oe.isArrayBufferView(t))return t.buffer;if(oe.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return u6(t,this.formSerializer).toString();if((s=oe.isFileList(t))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return nm(s?{"files[]":t}:t,u&&new u,this.formSerializer)}}return o||i?(n.setContentType("application/json",!1),d6(t)):t}],transformResponse:[function(t){const n=this.transitional||Ad.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(oe.isResponse(t)||oe.isReadableStream(t))return t;if(t&&oe.isString(t)&&(r&&!this.responseType||i)){const a=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(s){if(a)throw s.name==="SyntaxError"?Ue.from(s,Ue.ERR_BAD_RESPONSE,this,null,this.response):s}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:_i.classes.FormData,Blob:_i.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};oe.forEach(["delete","get","head","post","put","patch"],e=>{Ad.headers[e]={}});const f6=oe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),h6=e=>{const t={};let n,r,i;return e&&e.split(`
`).forEach(function(a){i=a.indexOf(":"),n=a.substring(0,i).trim().toLowerCase(),r=a.substring(i+1).trim(),!(!n||t[n]&&f6[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},MC=Symbol("internals");function nl(e){return e&&String(e).trim().toLowerCase()}function $h(e){return e===!1||e==null?e:oe.isArray(e)?e.map($h):String(e)}function p6(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const v6=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Kg(e,t,n,r,i){if(oe.isFunction(r))return r.call(this,t,n);if(i&&(t=n),!!oe.isString(t)){if(oe.isString(r))return t.indexOf(r)!==-1;if(oe.isRegExp(r))return r.test(t)}}function m6(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function g6(e,t){const n=oe.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(i,o,a){return this[r].call(this,t,i,o,a)},configurable:!0})})}class kr{constructor(t){t&&this.set(t)}set(t,n,r){const i=this;function o(s,u,c){const l=nl(u);if(!l)throw new Error("header name must be a non-empty string");const d=oe.findKey(i,l);(!d||i[d]===void 0||c===!0||c===void 0&&i[d]!==!1)&&(i[d||u]=$h(s))}const a=(s,u)=>oe.forEach(s,(c,l)=>o(c,l,u));if(oe.isPlainObject(t)||t instanceof this.constructor)a(t,n);else if(oe.isString(t)&&(t=t.trim())&&!v6(t))a(h6(t),n);else if(oe.isHeaders(t))for(const[s,u]of t.entries())o(u,s,r);else t!=null&&o(n,t,r);return this}get(t,n){if(t=nl(t),t){const r=oe.findKey(this,t);if(r){const i=this[r];if(!n)return i;if(n===!0)return p6(i);if(oe.isFunction(n))return n.call(this,i,r);if(oe.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=nl(t),t){const r=oe.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||Kg(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let i=!1;function o(a){if(a=nl(a),a){const s=oe.findKey(r,a);s&&(!n||Kg(r,r[s],s,n))&&(delete r[s],i=!0)}}return oe.isArray(t)?t.forEach(o):o(t),i}clear(t){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const o=n[r];(!t||Kg(this,this[o],o,t,!0))&&(delete this[o],i=!0)}return i}normalize(t){const n=this,r={};return oe.forEach(this,(i,o)=>{const a=oe.findKey(r,o);if(a){n[a]=$h(i),delete n[o];return}const s=t?m6(o):String(o).trim();s!==o&&delete n[o],n[s]=$h(i),r[s]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return oe.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=t&&oe.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(i=>r.set(i)),r}static accessor(t){const r=(this[MC]=this[MC]={accessors:{}}).accessors,i=this.prototype;function o(a){const s=nl(a);r[s]||(g6(i,a),r[s]=!0)}return oe.isArray(t)?t.forEach(o):o(t),this}}kr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);oe.reduceDescriptors(kr.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});oe.freezeMethods(kr);function Yg(e,t){const n=this||Ad,r=t||n,i=kr.from(r.headers);let o=r.data;return oe.forEach(e,function(s){o=s.call(n,o,i.normalize(),t?t.status:void 0)}),i.normalize(),o}function BO(e){return!!(e&&e.__CANCEL__)}function Rc(e,t,n){Ue.call(this,e??"canceled",Ue.ERR_CANCELED,t,n),this.name="CanceledError"}oe.inherits(Rc,Ue,{__CANCEL__:!0});function jO(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new Ue("Request failed with status code "+n.status,[Ue.ERR_BAD_REQUEST,Ue.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function y6(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function b6(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i=0,o=0,a;return t=t!==void 0?t:1e3,function(u){const c=Date.now(),l=r[o];a||(a=c),n[i]=u,r[i]=c;let d=o,f=0;for(;d!==i;)f+=n[d++],d=d%e;if(i=(i+1)%e,i===o&&(o=(o+1)%e),c-a<t)return;const h=l&&c-l;return h?Math.round(f*1e3/h):void 0}}function w6(e,t){let n=0;const r=1e3/t;let i=null;return function(){const a=this===!0,s=Date.now();if(a||s-n>r)return i&&(clearTimeout(i),i=null),n=s,e.apply(null,arguments);i||(i=setTimeout(()=>(i=null,n=Date.now(),e.apply(null,arguments)),r-(s-n)))}}const Np=(e,t,n=3)=>{let r=0;const i=b6(50,250);return w6(o=>{const a=o.loaded,s=o.lengthComputable?o.total:void 0,u=a-r,c=i(u),l=a<=s;r=a;const d={loaded:a,total:s,progress:s?a/s:void 0,bytes:u,rate:c||void 0,estimated:c&&s&&l?(s-a)/c:void 0,event:o,lengthComputable:s!=null};d[t?"download":"upload"]=!0,e(d)},n)},x6=_i.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function i(o){let a=o;return t&&(n.setAttribute("href",a),a=n.href),n.setAttribute("href",a),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=i(window.location.href),function(a){const s=oe.isString(a)?i(a):a;return s.protocol===r.protocol&&s.host===r.host}}():function(){return function(){return!0}}(),E6=_i.hasStandardBrowserEnv?{write(e,t,n,r,i,o){const a=[e+"="+encodeURIComponent(t)];oe.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),oe.isString(r)&&a.push("path="+r),oe.isString(i)&&a.push("domain="+i),o===!0&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function S6(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function C6(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function $O(e,t){return e&&!S6(t)?C6(e,t):t}const LC=e=>e instanceof kr?{...e}:e;function Ts(e,t){t=t||{};const n={};function r(c,l,d){return oe.isPlainObject(c)&&oe.isPlainObject(l)?oe.merge.call({caseless:d},c,l):oe.isPlainObject(l)?oe.merge({},l):oe.isArray(l)?l.slice():l}function i(c,l,d){if(oe.isUndefined(l)){if(!oe.isUndefined(c))return r(void 0,c,d)}else return r(c,l,d)}function o(c,l){if(!oe.isUndefined(l))return r(void 0,l)}function a(c,l){if(oe.isUndefined(l)){if(!oe.isUndefined(c))return r(void 0,c)}else return r(void 0,l)}function s(c,l,d){if(d in t)return r(c,l);if(d in e)return r(void 0,c)}const u={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:(c,l)=>i(LC(c),LC(l),!0)};return oe.forEach(Object.keys(Object.assign({},e,t)),function(l){const d=u[l]||i,f=d(e[l],t[l],l);oe.isUndefined(f)&&d!==s||(n[l]=f)}),n}const VO=e=>{const t=Ts({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:o,headers:a,auth:s}=t;t.headers=a=kr.from(a),t.url=MO($O(t.baseURL,t.url),e.params,e.paramsSerializer),s&&a.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):"")));let u;if(oe.isFormData(n)){if(_i.hasStandardBrowserEnv||_i.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((u=a.getContentType())!==!1){const[c,...l]=u?u.split(";").map(d=>d.trim()).filter(Boolean):[];a.setContentType([c||"multipart/form-data",...l].join("; "))}}if(_i.hasStandardBrowserEnv&&(r&&oe.isFunction(r)&&(r=r(t)),r||r!==!1&&x6(t.url))){const c=i&&o&&E6.read(o);c&&a.set(i,c)}return t},_6=typeof XMLHttpRequest<"u",k6=_6&&function(e){return new Promise(function(n,r){const i=VO(e);let o=i.data;const a=kr.from(i.headers).normalize();let{responseType:s}=i,u;function c(){i.cancelToken&&i.cancelToken.unsubscribe(u),i.signal&&i.signal.removeEventListener("abort",u)}let l=new XMLHttpRequest;l.open(i.method.toUpperCase(),i.url,!0),l.timeout=i.timeout;function d(){if(!l)return;const h=kr.from("getAllResponseHeaders"in l&&l.getAllResponseHeaders()),m={data:!s||s==="text"||s==="json"?l.responseText:l.response,status:l.status,statusText:l.statusText,headers:h,config:e,request:l};jO(function(v){n(v),c()},function(v){r(v),c()},m),l=null}"onloadend"in l?l.onloadend=d:l.onreadystatechange=function(){!l||l.readyState!==4||l.status===0&&!(l.responseURL&&l.responseURL.indexOf("file:")===0)||setTimeout(d)},l.onabort=function(){l&&(r(new Ue("Request aborted",Ue.ECONNABORTED,i,l)),l=null)},l.onerror=function(){r(new Ue("Network Error",Ue.ERR_NETWORK,i,l)),l=null},l.ontimeout=function(){let p=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const m=i.transitional||LO;i.timeoutErrorMessage&&(p=i.timeoutErrorMessage),r(new Ue(p,m.clarifyTimeoutError?Ue.ETIMEDOUT:Ue.ECONNABORTED,i,l)),l=null},o===void 0&&a.setContentType(null),"setRequestHeader"in l&&oe.forEach(a.toJSON(),function(p,m){l.setRequestHeader(m,p)}),oe.isUndefined(i.withCredentials)||(l.withCredentials=!!i.withCredentials),s&&s!=="json"&&(l.responseType=i.responseType),typeof i.onDownloadProgress=="function"&&l.addEventListener("progress",Np(i.onDownloadProgress,!0)),typeof i.onUploadProgress=="function"&&l.upload&&l.upload.addEventListener("progress",Np(i.onUploadProgress)),(i.cancelToken||i.signal)&&(u=h=>{l&&(r(!h||h.type?new Rc(null,e,l):h),l.abort(),l=null)},i.cancelToken&&i.cancelToken.subscribe(u),i.signal&&(i.signal.aborted?u():i.signal.addEventListener("abort",u)));const f=y6(i.url);if(f&&_i.protocols.indexOf(f)===-1){r(new Ue("Unsupported protocol "+f+":",Ue.ERR_BAD_REQUEST,e));return}l.send(o||null)})},R6=(e,t)=>{let n=new AbortController,r;const i=function(u){if(!r){r=!0,a();const c=u instanceof Error?u:this.reason;n.abort(c instanceof Ue?c:new Rc(c instanceof Error?c.message:c))}};let o=t&&setTimeout(()=>{i(new Ue(`timeout ${t} of ms exceeded`,Ue.ETIMEDOUT))},t);const a=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u&&(u.removeEventListener?u.removeEventListener("abort",i):u.unsubscribe(i))}),e=null)};e.forEach(u=>u&&u.addEventListener&&u.addEventListener("abort",i));const{signal:s}=n;return s.unsubscribe=a,[s,()=>{o&&clearTimeout(o),o=null}]},I6=function*(e,t){let n=e.byteLength;if(!t||n<t){yield e;return}let r=0,i;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},T6=async function*(e,t,n){for await(const r of e)yield*I6(ArrayBuffer.isView(r)?r:await n(String(r)),t)},FC=(e,t,n,r,i)=>{const o=T6(e,t,i);let a=0;return new ReadableStream({type:"bytes",async pull(s){const{done:u,value:c}=await o.next();if(u){s.close(),r();return}let l=c.byteLength;n&&n(a+=l),s.enqueue(new Uint8Array(c))},cancel(s){return r(s),o.return()}},{highWaterMark:2})},BC=(e,t)=>{const n=e!=null;return r=>setTimeout(()=>t({lengthComputable:n,total:e,loaded:r}))},rm=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",WO=rm&&typeof ReadableStream=="function",C1=rm&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),O6=WO&&(()=>{let e=!1;const t=new Request(_i.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})(),jC=64*1024,_1=WO&&!!(()=>{try{return oe.isReadableStream(new Response("").body)}catch{}})(),Dp={stream:_1&&(e=>e.body)};rm&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Dp[t]&&(Dp[t]=oe.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new Ue(`Response type '${t}' is not supported`,Ue.ERR_NOT_SUPPORT,r)})})})(new Response);const P6=async e=>{if(e==null)return 0;if(oe.isBlob(e))return e.size;if(oe.isSpecCompliantForm(e))return(await new Request(e).arrayBuffer()).byteLength;if(oe.isArrayBufferView(e))return e.byteLength;if(oe.isURLSearchParams(e)&&(e=e+""),oe.isString(e))return(await C1(e)).byteLength},N6=async(e,t)=>{const n=oe.toFiniteNumber(e.getContentLength());return n??P6(t)},D6=rm&&(async e=>{let{url:t,method:n,data:r,signal:i,cancelToken:o,timeout:a,onDownloadProgress:s,onUploadProgress:u,responseType:c,headers:l,withCredentials:d="same-origin",fetchOptions:f}=VO(e);c=c?(c+"").toLowerCase():"text";let[h,p]=i||o||a?R6([i,o],a):[],m,g;const v=()=>{!m&&setTimeout(()=>{h&&h.unsubscribe()}),m=!0};let y;try{if(u&&O6&&n!=="get"&&n!=="head"&&(y=await N6(l,r))!==0){let x=new Request(t,{method:"POST",body:r,duplex:"half"}),R;oe.isFormData(r)&&(R=x.headers.get("content-type"))&&l.setContentType(R),x.body&&(r=FC(x.body,jC,BC(y,Np(u)),null,C1))}oe.isString(d)||(d=d?"cors":"omit"),g=new Request(t,{...f,signal:h,method:n.toUpperCase(),headers:l.normalize().toJSON(),body:r,duplex:"half",withCredentials:d});let b=await fetch(g);const w=_1&&(c==="stream"||c==="response");if(_1&&(s||w)){const x={};["status","statusText","headers"].forEach(S=>{x[S]=b[S]});const R=oe.toFiniteNumber(b.headers.get("content-length"));b=new Response(FC(b.body,jC,s&&BC(R,Np(s,!0)),w&&v,C1),x)}c=c||"text";let E=await Dp[oe.findKey(Dp,c)||"text"](b,e);return!w&&v(),p&&p(),await new Promise((x,R)=>{jO(x,R,{data:E,headers:kr.from(b.headers),status:b.status,statusText:b.statusText,config:e,request:g})})}catch(b){throw v(),b&&b.name==="TypeError"&&/fetch/i.test(b.message)?Object.assign(new Ue("Network Error",Ue.ERR_NETWORK,e,g),{cause:b.cause||b}):Ue.from(b,b&&b.code,e,g)}}),k1={http:Y$,xhr:k6,fetch:D6};oe.forEach(k1,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const $C=e=>`- ${e}`,A6=e=>oe.isFunction(e)||e===null||e===!1,UO={getAdapter:e=>{e=oe.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let o=0;o<t;o++){n=e[o];let a;if(r=n,!A6(n)&&(r=k1[(a=String(n)).toLowerCase()],r===void 0))throw new Ue(`Unknown adapter '${a}'`);if(r)break;i[a||"#"+o]=r}if(!r){const o=Object.entries(i).map(([s,u])=>`adapter ${s} `+(u===!1?"is not supported by the environment":"is not available in the build"));let a=t?o.length>1?`since :
`+o.map($C).join(`
`):" "+$C(o[0]):"as no adapter specified";throw new Ue("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:k1};function Qg(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Rc(null,e)}function VC(e){return Qg(e),e.headers=kr.from(e.headers),e.data=Yg.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),UO.getAdapter(e.adapter||Ad.adapter)(e).then(function(r){return Qg(e),r.data=Yg.call(e,e.transformResponse,r),r.headers=kr.from(r.headers),r},function(r){return BO(r)||(Qg(e),r&&r.response&&(r.response.data=Yg.call(e,e.transformResponse,r.response),r.response.headers=kr.from(r.response.headers))),Promise.reject(r)})}const zO="1.7.2",_w={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{_w[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const WC={};_w.transitional=function(t,n,r){function i(o,a){return"[Axios v"+zO+"] Transitional option '"+o+"'"+a+(r?". "+r:"")}return(o,a,s)=>{if(t===!1)throw new Ue(i(a," has been removed"+(n?" in "+n:"")),Ue.ERR_DEPRECATED);return n&&!WC[a]&&(WC[a]=!0,console.warn(i(a," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(o,a,s):!0}};function M6(e,t,n){if(typeof e!="object")throw new Ue("options must be an object",Ue.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const o=r[i],a=t[o];if(a){const s=e[o],u=s===void 0||a(s,o,e);if(u!==!0)throw new Ue("option "+o+" must be "+u,Ue.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Ue("Unknown option "+o,Ue.ERR_BAD_OPTION)}}const R1={assertOptions:M6,validators:_w},Uo=R1.validators;class ys{constructor(t){this.defaults=t,this.interceptors={request:new AC,response:new AC}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let i;Error.captureStackTrace?Error.captureStackTrace(i={}):i=new Error;const o=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Ts(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:o}=n;r!==void 0&&R1.assertOptions(r,{silentJSONParsing:Uo.transitional(Uo.boolean),forcedJSONParsing:Uo.transitional(Uo.boolean),clarifyTimeoutError:Uo.transitional(Uo.boolean)},!1),i!=null&&(oe.isFunction(i)?n.paramsSerializer={serialize:i}:R1.assertOptions(i,{encode:Uo.function,serialize:Uo.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let a=o&&oe.merge(o.common,o[n.method]);o&&oe.forEach(["delete","get","head","post","put","patch","common"],p=>{delete o[p]}),n.headers=kr.concat(a,o);const s=[];let u=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(u=u&&m.synchronous,s.unshift(m.fulfilled,m.rejected))});const c=[];this.interceptors.response.forEach(function(m){c.push(m.fulfilled,m.rejected)});let l,d=0,f;if(!u){const p=[VC.bind(this),void 0];for(p.unshift.apply(p,s),p.push.apply(p,c),f=p.length,l=Promise.resolve(n);d<f;)l=l.then(p[d++],p[d++]);return l}f=s.length;let h=n;for(d=0;d<f;){const p=s[d++],m=s[d++];try{h=p(h)}catch(g){m.call(this,g);break}}try{l=VC.call(this,h)}catch(p){return Promise.reject(p)}for(d=0,f=c.length;d<f;)l=l.then(c[d++],c[d++]);return l}getUri(t){t=Ts(this.defaults,t);const n=$O(t.baseURL,t.url);return MO(n,t.params,t.paramsSerializer)}}oe.forEach(["delete","get","head","options"],function(t){ys.prototype[t]=function(n,r){return this.request(Ts(r||{},{method:t,url:n,data:(r||{}).data}))}});oe.forEach(["post","put","patch"],function(t){function n(r){return function(o,a,s){return this.request(Ts(s||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:a}))}}ys.prototype[t]=n(),ys.prototype[t+"Form"]=n(!0)});class kw{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(o){n=o});const r=this;this.promise.then(i=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](i);r._listeners=null}),this.promise.then=i=>{let o;const a=new Promise(s=>{r.subscribe(s),o=s}).then(i);return a.cancel=function(){r.unsubscribe(o)},a},t(function(o,a,s){r.reason||(r.reason=new Rc(o,a,s),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}static source(){let t;return{token:new kw(function(i){t=i}),cancel:t}}}function L6(e){return function(n){return e.apply(null,n)}}function F6(e){return oe.isObject(e)&&e.isAxiosError===!0}const I1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(I1).forEach(([e,t])=>{I1[t]=e});function HO(e){const t=new ys(e),n=SO(ys.prototype.request,t);return oe.extend(n,ys.prototype,t,{allOwnKeys:!0}),oe.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return HO(Ts(e,i))},n}const Yt=HO(Ad);Yt.Axios=ys;Yt.CanceledError=Rc;Yt.CancelToken=kw;Yt.isCancel=BO;Yt.VERSION=zO;Yt.toFormData=nm;Yt.AxiosError=Ue;Yt.Cancel=Yt.CanceledError;Yt.all=function(t){return Promise.all(t)};Yt.spread=L6;Yt.isAxiosError=F6;Yt.mergeConfig=Ts;Yt.AxiosHeaders=kr;Yt.formToJSON=e=>FO(oe.isHTMLForm(e)?new FormData(e):e);Yt.getAdapter=UO.getAdapter;Yt.HttpStatusCode=I1;Yt.default=Yt;const B6="/battle-people",We=Yt.create({baseURL:B6,timeout:3e3,headers:{"Content-Type":"application/json"},withCredentials:!0}),j6=e=>e;We.interceptors.request.use(j6);let Jg=!1,T1=[];const UC=e=>{T1.forEach(t=>{e?t.reject(e):t.resolve(void 0)}),T1=[]},$6=e=>{var n,r;const{logout:t}=Pn.getState();if(Yt.isAxiosError(e)){const i=e.config;if(((n=e.response)==null?void 0:n.status)===401&&i.url&&i.url.includes("/auth/refresh"))return We.delete("/auth/logout").finally(()=>{t(),$e.error("세션이 만료되어 로그아웃 되었습니다.",{autoClose:1e3})}),Promise.reject(new Error("세션이 만료되어 로그아웃되었습니다"));if(((r=e.response)==null?void 0:r.status)===401&&!i.retry)return i.retry=!0,Jg?new Promise((o,a)=>{T1.push({resolve:o,reject:a})}).then(()=>We(i)).catch(o=>Promise.reject(o)):(Jg=!0,new Promise((o,a)=>{We.post("/auth/refresh").then(()=>{UC(),o(We(i))}).catch(s=>{UC(s),t(),a(s)}).finally(()=>{Jg=!1})}))}return console.log(`🚨 [API] | Error ${e.message}`),Promise.reject(e)};We.interceptors.response.use(e=>e,$6);const _o={getWaitList:async(e,t=0,n=10)=>{try{return(await We.get("/live/wait/list",{params:{page:t,size:n,category:e}})).data}catch(r){throw console.error("Failed to fetch wait list:",r),r}},getActiveList:async(e,t=0,n=10)=>{try{return(await We.get("/live/active/list",{params:{page:t,size:n,category:e}})).data}catch(r){throw console.error("Failed to fetch active list:",r),r}},getEndList:async(e,t=0,n=10)=>{try{return(await We.get("/live/end/list",{params:{page:t,size:n,category:e}})).data}catch(r){throw console.error("Failed to fetch end list:",r),r}},getEndDetail:async e=>{try{return(await We.get(`/live/end/detail/${e}`)).data}catch(t){throw console.error(`Failed to fetch end detail for battle ${e}:`,t),t}},getWaitDetail:async e=>{try{return(await We.get(`/live/wait/detail/${e}`)).data}catch(t){throw console.error(`Failed to fetch wait detail for battle ${e}:`,t),t}}};function V6({battleId:e,onClose:t}){const[n,r]=O.useState(null),[i,o]=O.useState(!0);return O.useEffect(()=>{(async()=>{try{const s=await _o.getWaitDetail(e.toString());r(s.data)}catch(s){console.error("Failed to fetch waiting live battle detail:",s)}finally{o(!1)}})()},[e]),i?C.jsx("div",{children:"Loading..."}):n?C.jsx(xw,{title:"예정된 라이브 미리보기",infoText:n.title,onClose:t,borderColor:"#0b68ec",summary:n.summary||"상세정보가 없습니다.",children:C.jsx(Qv,{registerUser:{nickname:n.registerUser.nickname,imgUrl:n.registerUser.imgUrl||"",opinion:n.registerUser.opinion||""},oppositeUser:{nickname:n.oppositeUser.nickname,imgUrl:n.oppositeUser.imgUrl||"",opinion:n.oppositeUser.opinion||""},speechBubbleColor:"#0b68ec",status:"upcoming"})}):C.jsx("div",{children:"데이터를 불러오지 못했습니다."})}function W6({battleId:e,onClose:t}){const[n,r]=O.useState(null),[i,o]=O.useState(!0);if(O.useEffect(()=>{(async()=>{try{const m=await _o.getEndDetail(e.toString());r(m.data)}catch(m){console.error("Failed to fetch ended live battle detail:",m)}finally{o(!1)}})()},[e]),i)return C.jsx("div",{children:"Loading..."});if(!n)return C.jsx("div",{children:"데이터를 불러오지 못했습니다."});const{title:a,registerUser:s,oppositeUser:u,preResult:c,finalResult:l,summary:d,preResultCount:f,finalResultCount:h}=n;return C.jsx(xw,{title:"라이브 상세보기",infoText:a,summary:d||"상세정보가 없습니다.",onClose:t,borderColor:"#8bc34a",children:C.jsx(Qv,{registerUser:{nickname:s.nickname,imgUrl:s.imgUrl||ss,opinion:s.opinion||""},oppositeUser:{nickname:u.nickname,imgUrl:u.imgUrl||ss,opinion:u.opinion||""},speechBubbleColor:"#8bc34a",status:"ended",preResult:c,preResultCount:f,finalResult:l,finalResultCount:h})})}const Ic=(e,t)=>({textShadow:`${-t}px ${-t}px 0 ${e}, ${t}px ${-t}px 0 ${e}, ${-t}px ${t}px 0 ${e}, ${t}px ${t}px 0 ${e}`}),U6={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},z6=(e,t,n)=>{let r;const i=U6[e];return typeof i=="string"?r=i:t===1?r=i.one:r=i.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function Zg(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const H6={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},G6={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},q6={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},X6={date:Zg({formats:H6,defaultWidth:"full"}),time:Zg({formats:G6,defaultWidth:"full"}),dateTime:Zg({formats:q6,defaultWidth:"full"})},K6={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Y6=(e,t,n,r)=>K6[e];function rl(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let i;if(r==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,s=n!=null&&n.width?String(n.width):a;i=e.formattingValues[s]||e.formattingValues[a]}else{const a=e.defaultWidth,s=n!=null&&n.width?String(n.width):e.defaultWidth;i=e.values[s]||e.values[a]}const o=e.argumentCallback?e.argumentCallback(t):t;return i[o]}}const Q6={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},J6={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Z6={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},eV={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},tV={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},nV={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},rV=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},iV={ordinalNumber:rV,era:rl({values:Q6,defaultWidth:"wide"}),quarter:rl({values:J6,defaultWidth:"wide",argumentCallback:e=>e-1}),month:rl({values:Z6,defaultWidth:"wide"}),day:rl({values:eV,defaultWidth:"wide"}),dayPeriod:rl({values:tV,defaultWidth:"wide",formattingValues:nV,defaultFormattingWidth:"wide"})};function il(e){return(t,n={})=>{const r=n.width,i=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=t.match(i);if(!o)return null;const a=o[0],s=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(s)?aV(s,d=>d.test(a)):oV(s,d=>d.test(a));let c;c=e.valueCallback?e.valueCallback(u):u,c=n.valueCallback?n.valueCallback(c):c;const l=t.slice(a.length);return{value:c,rest:l}}}function oV(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function aV(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function sV(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const i=r[0],o=t.match(e.parsePattern);if(!o)return null;let a=e.valueCallback?e.valueCallback(o[0]):o[0];a=n.valueCallback?n.valueCallback(a):a;const s=t.slice(i.length);return{value:a,rest:s}}}const uV=/^(\d+)(th|st|nd|rd)?/i,cV=/\d+/i,lV={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},dV={any:[/^b/i,/^(a|c)/i]},fV={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},hV={any:[/1/i,/2/i,/3/i,/4/i]},pV={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},vV={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},mV={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},gV={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},yV={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},bV={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},wV={ordinalNumber:sV({matchPattern:uV,parsePattern:cV,valueCallback:e=>parseInt(e,10)}),era:il({matchPatterns:lV,defaultMatchWidth:"wide",parsePatterns:dV,defaultParseWidth:"any"}),quarter:il({matchPatterns:fV,defaultMatchWidth:"wide",parsePatterns:hV,defaultParseWidth:"any",valueCallback:e=>e+1}),month:il({matchPatterns:pV,defaultMatchWidth:"wide",parsePatterns:vV,defaultParseWidth:"any"}),day:il({matchPatterns:mV,defaultMatchWidth:"wide",parsePatterns:gV,defaultParseWidth:"any"}),dayPeriod:il({matchPatterns:yV,defaultMatchWidth:"any",parsePatterns:bV,defaultParseWidth:"any"})},xV={code:"en-US",formatDistance:z6,formatLong:X6,formatRelative:Y6,localize:iV,match:wV,options:{weekStartsOn:0,firstWeekContainsDate:1}};let EV={};function im(){return EV}const GO=6048e5,SV=864e5;function Oi(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function zC(e){const t=Oi(e);return t.setHours(0,0,0,0),t}function HC(e){const t=Oi(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function CV(e,t){const n=zC(e),r=zC(t),i=+n-HC(n),o=+r-HC(r);return Math.round((i-o)/SV)}function Os(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function _V(e){const t=Oi(e),n=Os(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}function kV(e){const t=Oi(e);return CV(t,_V(t))+1}function hd(e,t){var s,u,c,l;const n=im(),r=(t==null?void 0:t.weekStartsOn)??((u=(s=t==null?void 0:t.locale)==null?void 0:s.options)==null?void 0:u.weekStartsOn)??n.weekStartsOn??((l=(c=n.locale)==null?void 0:c.options)==null?void 0:l.weekStartsOn)??0,i=Oi(e),o=i.getDay(),a=(o<r?7:0)+o-r;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}function Ap(e){return hd(e,{weekStartsOn:1})}function qO(e){const t=Oi(e),n=t.getFullYear(),r=Os(e,0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);const i=Ap(r),o=Os(e,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const a=Ap(o);return t.getTime()>=i.getTime()?n+1:t.getTime()>=a.getTime()?n:n-1}function RV(e){const t=qO(e),n=Os(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),Ap(n)}function IV(e){const t=Oi(e),n=+Ap(t)-+RV(t);return Math.round(n/GO)+1}function XO(e,t){var l,d,f,h;const n=Oi(e),r=n.getFullYear(),i=im(),o=(t==null?void 0:t.firstWeekContainsDate)??((d=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:d.firstWeekContainsDate)??i.firstWeekContainsDate??((h=(f=i.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,a=Os(e,0);a.setFullYear(r+1,0,o),a.setHours(0,0,0,0);const s=hd(a,t),u=Os(e,0);u.setFullYear(r,0,o),u.setHours(0,0,0,0);const c=hd(u,t);return n.getTime()>=s.getTime()?r+1:n.getTime()>=c.getTime()?r:r-1}function TV(e,t){var s,u,c,l;const n=im(),r=(t==null?void 0:t.firstWeekContainsDate)??((u=(s=t==null?void 0:t.locale)==null?void 0:s.options)==null?void 0:u.firstWeekContainsDate)??n.firstWeekContainsDate??((l=(c=n.locale)==null?void 0:c.options)==null?void 0:l.firstWeekContainsDate)??1,i=XO(e,t),o=Os(e,0);return o.setFullYear(i,0,r),o.setHours(0,0,0,0),hd(o,t)}function OV(e,t){const n=Oi(e),r=+hd(n,t)-+TV(n,t);return Math.round(r/GO)+1}function ft(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const zo={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return ft(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):ft(n+1,2)},d(e,t){return ft(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return ft(e.getHours()%12||12,t.length)},H(e,t){return ft(e.getHours(),t.length)},m(e,t){return ft(e.getMinutes(),t.length)},s(e,t){return ft(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),i=Math.trunc(r*Math.pow(10,n-3));return ft(i,t.length)}},tu={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},GC={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),i=r>0?r:1-r;return n.ordinalNumber(i,{unit:"year"})}return zo.y(e,t)},Y:function(e,t,n,r){const i=XO(e,r),o=i>0?i:1-i;if(t==="YY"){const a=o%100;return ft(a,2)}return t==="Yo"?n.ordinalNumber(o,{unit:"year"}):ft(o,t.length)},R:function(e,t){const n=qO(e);return ft(n,t.length)},u:function(e,t){const n=e.getFullYear();return ft(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return ft(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return ft(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return zo.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return ft(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const i=OV(e,r);return t==="wo"?n.ordinalNumber(i,{unit:"week"}):ft(i,t.length)},I:function(e,t,n){const r=IV(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):ft(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):zo.d(e,t)},D:function(e,t,n){const r=kV(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):ft(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const i=e.getDay(),o=(i-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(o);case"ee":return ft(o,2);case"eo":return n.ordinalNumber(o,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});case"eeee":default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const i=e.getDay(),o=(i-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(o);case"cc":return ft(o,t.length);case"co":return n.ordinalNumber(o,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});case"cccc":default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),i=r===0?7:r;switch(t){case"i":return String(i);case"ii":return ft(i,t.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let i;switch(r===12?i=tu.noon:r===0?i=tu.midnight:i=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let i;switch(r>=17?i=tu.evening:r>=12?i=tu.afternoon:r>=4?i=tu.morning:i=tu.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return zo.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):zo.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):ft(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):ft(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):zo.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):zo.s(e,t)},S:function(e,t){return zo.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return XC(r);case"XXXX":case"XX":return Ya(r);case"XXXXX":case"XXX":default:return Ya(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return XC(r);case"xxxx":case"xx":return Ya(r);case"xxxxx":case"xxx":default:return Ya(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+qC(r,":");case"OOOO":default:return"GMT"+Ya(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+qC(r,":");case"zzzz":default:return"GMT"+Ya(r,":")}},t:function(e,t,n){const r=Math.trunc(e.getTime()/1e3);return ft(r,t.length)},T:function(e,t,n){const r=e.getTime();return ft(r,t.length)}};function qC(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),i=Math.trunc(r/60),o=r%60;return o===0?n+String(i):n+String(i)+t+ft(o,2)}function XC(e,t){return e%60===0?(e>0?"-":"+")+ft(Math.abs(e)/60,2):Ya(e,t)}function Ya(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),i=ft(Math.trunc(r/60),2),o=ft(r%60,2);return n+i+t+o}const KC=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},KO=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},PV=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],i=n[2];if(!i)return KC(e,t);let o;switch(r){case"P":o=t.dateTime({width:"short"});break;case"PP":o=t.dateTime({width:"medium"});break;case"PPP":o=t.dateTime({width:"long"});break;case"PPPP":default:o=t.dateTime({width:"full"});break}return o.replace("{{date}}",KC(r,t)).replace("{{time}}",KO(i,t))},NV={p:KO,P:PV},DV=/^D+$/,AV=/^Y+$/,MV=["D","DD","YY","YYYY"];function LV(e){return DV.test(e)}function FV(e){return AV.test(e)}function BV(e,t,n){const r=jV(e,t,n);if(console.warn(r),MV.includes(e))throw new RangeError(r)}function jV(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}function $V(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function VV(e){if(!$V(e)&&typeof e!="number")return!1;const t=Oi(e);return!isNaN(Number(t))}const WV=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,UV=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,zV=/^'([^]*?)'?$/,HV=/''/g,GV=/[a-zA-Z]/;function qV(e,t,n){var l,d,f,h,p,m,g,v;const r=im(),i=(n==null?void 0:n.locale)??r.locale??xV,o=(n==null?void 0:n.firstWeekContainsDate)??((d=(l=n==null?void 0:n.locale)==null?void 0:l.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((h=(f=r.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,a=(n==null?void 0:n.weekStartsOn)??((m=(p=n==null?void 0:n.locale)==null?void 0:p.options)==null?void 0:m.weekStartsOn)??r.weekStartsOn??((v=(g=r.locale)==null?void 0:g.options)==null?void 0:v.weekStartsOn)??0,s=Oi(e);if(!VV(s))throw new RangeError("Invalid time value");let u=t.match(UV).map(y=>{const b=y[0];if(b==="p"||b==="P"){const w=NV[b];return w(y,i.formatLong)}return y}).join("").match(WV).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const b=y[0];if(b==="'")return{isToken:!1,value:XV(y)};if(GC[b])return{isToken:!0,value:y};if(b.match(GV))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:y}});i.localize.preprocessor&&(u=i.localize.preprocessor(s,u));const c={firstWeekContainsDate:o,weekStartsOn:a,locale:i};return u.map(y=>{if(!y.isToken)return y.value;const b=y.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&FV(b)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&LV(b))&&BV(b,t,String(e));const w=GC[b[0]];return w(s,b,i.localize,c)}).join("")}function XV(e){const t=e.match(zV);return t?t[1].replace(HV,"'"):e}function YC(e,t,n){const r=QV(e,n.timeZone,n.locale);return"formatToParts"in r?KV(r,t):YV(r,t)}function KV(e,t){const n=e.formatToParts(t);for(let r=n.length-1;r>=0;--r)if(n[r].type==="timeZoneName")return n[r].value}function YV(e,t){const n=e.format(t).replace(/\u200E/g,""),r=/ [\w-+ ]+$/.exec(n);return r?r[0].substr(1):""}function QV(e,t,n){return new Intl.DateTimeFormat(n?[n.code,"en-US"]:void 0,{timeZone:t,timeZoneName:e})}function JV(e,t){const n=nW(t);return"formatToParts"in n?eW(n,e):tW(n,e)}const ZV={year:0,month:1,day:2,hour:3,minute:4,second:5};function eW(e,t){try{const n=e.formatToParts(t),r=[];for(let i=0;i<n.length;i++){const o=ZV[n[i].type];o!==void 0&&(r[o]=parseInt(n[i].value,10))}return r}catch(n){if(n instanceof RangeError)return[NaN];throw n}}function tW(e,t){const n=e.format(t),r=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(n);return[parseInt(r[3],10),parseInt(r[1],10),parseInt(r[2],10),parseInt(r[4],10),parseInt(r[5],10),parseInt(r[6],10)]}const e0={};function nW(e){if(!e0[e]){const t=new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:"America/New_York",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),n=t==="06/25/2014, 00:00:00"||t==="‎06‎/‎25‎/‎2014‎ ‎00‎:‎00‎:‎00";e0[e]=n?new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return e0[e]}function YO(e,t,n,r,i,o,a){const s=new Date(0);return s.setUTCFullYear(e,t,n),s.setUTCHours(r,i,o,a),s}const QC=36e5,rW=6e4,t0={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-])(\d{2}):?(\d{2})$/};function Rw(e,t,n){if(!e)return 0;let r=t0.timezoneZ.exec(e);if(r)return 0;let i,o;if(r=t0.timezoneHH.exec(e),r)return i=parseInt(r[1],10),JC(i)?-(i*QC):NaN;if(r=t0.timezoneHHMM.exec(e),r){i=parseInt(r[2],10);const a=parseInt(r[3],10);return JC(i,a)?(o=Math.abs(i)*QC+a*rW,r[1]==="+"?-o:o):NaN}if(aW(e)){t=new Date(t||Date.now());const a=n?t:iW(t),s=O1(a,e);return-(n?s:oW(t,s,e))}return NaN}function iW(e){return YO(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function O1(e,t){const n=JV(e,t),r=YO(n[0],n[1]-1,n[2],n[3]%24,n[4],n[5],0).getTime();let i=e.getTime();const o=i%1e3;return i-=o>=0?o:1e3+o,r-i}function oW(e,t,n){let i=e.getTime()-t;const o=O1(new Date(i),n);if(t===o)return t;i-=o-t;const a=O1(new Date(i),n);return o===a?o:Math.max(o,a)}function JC(e,t){return-23<=e&&e<=23&&(t==null||0<=t&&t<=59)}const ZC={};function aW(e){if(ZC[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),ZC[e]=!0,!0}catch{return!1}}const sW=60*1e3,uW={X:function(e,t,n){const r=n0(n.timeZone,e);if(r===0)return"Z";switch(t){case"X":return e2(r);case"XXXX":case"XX":return fu(r);case"XXXXX":case"XXX":default:return fu(r,":")}},x:function(e,t,n){const r=n0(n.timeZone,e);switch(t){case"x":return e2(r);case"xxxx":case"xx":return fu(r);case"xxxxx":case"xxx":default:return fu(r,":")}},O:function(e,t,n){const r=n0(n.timeZone,e);switch(t){case"O":case"OO":case"OOO":return"GMT"+cW(r,":");case"OOOO":default:return"GMT"+fu(r,":")}},z:function(e,t,n){switch(t){case"z":case"zz":case"zzz":return YC("short",e,n);case"zzzz":default:return YC("long",e,n)}}};function n0(e,t){const n=e?Rw(e,t,!0)/sW:(t==null?void 0:t.getTimezoneOffset())??0;if(Number.isNaN(n))throw new RangeError("Invalid time zone specified: "+e);return n}function Mp(e,t){const n=e<0?"-":"";let r=Math.abs(e).toString();for(;r.length<t;)r="0"+r;return n+r}function fu(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),i=Mp(Math.floor(r/60),2),o=Mp(Math.floor(r%60),2);return n+i+t+o}function e2(e,t){return e%60===0?(e>0?"-":"+")+Mp(Math.abs(e)/60,2):fu(e,t)}function cW(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),i=Math.floor(r/60),o=r%60;return o===0?n+String(i):n+String(i)+t+Mp(o,2)}function t2(e){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+e-+t}const lW=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,r0=36e5,n2=6e4,dW=2,cr={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:lW};function QO(e,t={}){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(e===null)return new Date(NaN);const n=t.additionalDigits==null?dW:Number(t.additionalDigits);if(n!==2&&n!==1&&n!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]")return new Date(e.getTime());if(typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]")return new Date(e);if(Object.prototype.toString.call(e)!=="[object String]")return new Date(NaN);const r=fW(e),{year:i,restDateString:o}=hW(r.date,n),a=pW(o,i);if(a===null||isNaN(a.getTime()))return new Date(NaN);if(a){const s=a.getTime();let u=0,c;if(r.time&&(u=vW(r.time),u===null||isNaN(u)))return new Date(NaN);if(r.timeZone||t.timeZone){if(c=Rw(r.timeZone||t.timeZone,new Date(s+u)),isNaN(c))return new Date(NaN)}else c=t2(new Date(s+u)),c=t2(new Date(s+u+c));return new Date(s+u+c)}else return new Date(NaN)}function fW(e){const t={};let n=cr.dateTimePattern.exec(e),r;if(n?(t.date=n[1],r=n[3]):(n=cr.datePattern.exec(e),n?(t.date=n[1],r=n[2]):(t.date=null,r=e)),r){const i=cr.timeZone.exec(r);i?(t.time=r.replace(i[1],""),t.timeZone=i[1].trim()):t.time=r}return t}function hW(e,t){if(e){const n=cr.YYY[t],r=cr.YYYYY[t];let i=cr.YYYY.exec(e)||r.exec(e);if(i){const o=i[1];return{year:parseInt(o,10),restDateString:e.slice(o.length)}}if(i=cr.YY.exec(e)||n.exec(e),i){const o=i[1];return{year:parseInt(o,10)*100,restDateString:e.slice(o.length)}}}return{year:null}}function pW(e,t){if(t===null)return null;let n,r,i;if(!e||!e.length)return n=new Date(0),n.setUTCFullYear(t),n;let o=cr.MM.exec(e);if(o)return n=new Date(0),r=parseInt(o[1],10)-1,i2(t,r)?(n.setUTCFullYear(t,r),n):new Date(NaN);if(o=cr.DDD.exec(e),o){n=new Date(0);const a=parseInt(o[1],10);return yW(t,a)?(n.setUTCFullYear(t,0,a),n):new Date(NaN)}if(o=cr.MMDD.exec(e),o){n=new Date(0),r=parseInt(o[1],10)-1;const a=parseInt(o[2],10);return i2(t,r,a)?(n.setUTCFullYear(t,r,a),n):new Date(NaN)}if(o=cr.Www.exec(e),o)return i=parseInt(o[1],10)-1,o2(i)?r2(t,i):new Date(NaN);if(o=cr.WwwD.exec(e),o){i=parseInt(o[1],10)-1;const a=parseInt(o[2],10)-1;return o2(i,a)?r2(t,i,a):new Date(NaN)}return null}function vW(e){let t,n,r=cr.HH.exec(e);if(r)return t=parseFloat(r[1].replace(",",".")),i0(t)?t%24*r0:NaN;if(r=cr.HHMM.exec(e),r)return t=parseInt(r[1],10),n=parseFloat(r[2].replace(",",".")),i0(t,n)?t%24*r0+n*n2:NaN;if(r=cr.HHMMSS.exec(e),r){t=parseInt(r[1],10),n=parseInt(r[2],10);const i=parseFloat(r[3].replace(",","."));return i0(t,n,i)?t%24*r0+n*n2+i*1e3:NaN}return null}function r2(e,t,n){t=t||0,n=n||0;const r=new Date(0);r.setUTCFullYear(e,0,4);const i=r.getUTCDay()||7,o=t*7+n+1-i;return r.setUTCDate(r.getUTCDate()+o),r}const mW=[31,28,31,30,31,30,31,31,30,31,30,31],gW=[31,29,31,30,31,30,31,31,30,31,30,31];function JO(e){return e%400===0||e%4===0&&e%100!==0}function i2(e,t,n){if(t<0||t>11)return!1;if(n!=null){if(n<1)return!1;const r=JO(e);if(r&&n>gW[t]||!r&&n>mW[t])return!1}return!0}function yW(e,t){if(t<1)return!1;const n=JO(e);return!(n&&t>366||!n&&t>365)}function o2(e,t){return!(e<0||e>52||t!=null&&(t<0||t>6))}function i0(e,t,n){return!(e<0||e>=25||t!=null&&(t<0||t>=60)||n!=null&&(n<0||n>=60))}const bW=/([xXOz]+)|''|'(''|[^'])+('|$)/g;function wW(e,t,n={}){t=String(t);const r=t.match(bW);if(r){const i=QO(n.originalDate||e,n);t=r.reduce(function(o,a){if(a[0]==="'")return o;const s=o.indexOf(a),u=o[s-1]==="'",c=o.replace(a,"'"+uW[a[0]](i,a,n)+"'");return u?c.substring(0,s-1)+c.substring(s+1):c},t)}return qV(e,t,n)}function xW(e,t,n){e=QO(e,n);const r=Rw(t,e,!0),i=new Date(e.getTime()-r),o=new Date(0);return o.setFullYear(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()),o.setHours(i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds(),i.getUTCMilliseconds()),o}const pc=(e,t)=>{const n=xW(e,t);return wW(n,"yyyy-MM-dd HH:mm",{timeZone:t})},Lp="/assets/noImage-Cv4PHiYO.png",EW=e=>{const t=O.useRef(null),[n,r]=O.useState(!1),i=O.useRef(!1);return O.useEffect(()=>{const o=new IntersectionObserver(([a])=>{!i.current&&a.isIntersecting&&(r(a.isIntersecting),i.current=!0)},e);return t.current&&o.observe(t.current),()=>{t.current&&o.unobserve(t.current)}},[e]),{ref:t,isIntersecting:n}},SW=(e,t)=>{if(e==="live")return"bg-transparent";if(e==="ended")return"bg-gray-500";const n=["bg-orange","bg-blue","bg-yellow","bg-olive"];return n[t%n.length]},CW=e=>{switch(e){case"live":return"라이브";case"upcoming":return"예정된 라이브";case"ended":return"종료된 라이브";default:return""}};function ZO({card:e}){const[t,n]=O.useState(!1),{ref:r,isIntersecting:i}=EW({threshold:.1}),o=xn(),a=()=>{e.status!=="live"&&n(!0),e.status==="live"&&o(`/live/${e.id}`,{state:{...e}})},s=()=>{n(!1)},u=l=>{(l.key==="Enter"||l.key===" ")&&a()},c=()=>{if(e.status==="live")return C.jsx("div",{className:"absolute top-2 left-2 bg-red-600 text-white px-2 py-1 rounded z-10",children:"라이브"});const l=Ic("black",3);return C.jsxs(C.Fragment,{children:[C.jsx("div",{className:`absolute inset-0 ${SW(e.status,e.id)} opacity-75 flex items-center justify-center`}),C.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white text-3xl",style:l,children:CW(e.status)})]})};return C.jsxs(C.Fragment,{children:[C.jsxs("div",{className:"relative flex flex-col border-solid border-black border-4 shadow-md rounded-xl overflow-hidden focus:shadow-lg focus:-translate-y-1 hover:shadow-lg hover:-translate-y-1 transition-all duration-300 max-w-sm",style:{height:"18.75rem"},onClick:a,onKeyDown:u,tabIndex:0,role:"button","aria-pressed":"false",children:[C.jsxs("div",{ref:r,className:"live-card-image h-44 relative overflow-hidden",children:[i?C.jsx("img",{src:e.image_uri||Lp,alt:e.title,className:"w-full h-full object-cover"}):C.jsx("div",{children:"Loading..."}),c()]}),C.jsxs("div",{className:"live-card-info bg-white py-4 px-3 border-t-4 border-solid",children:[C.jsx("h3",{className:"text-xl mb-2 font-medium",children:e.title}),C.jsxs("div",{className:"flex justify-between items-center",children:[C.jsx("p",{className:"text-base text-black",children:e.regist_user_id}),e.status==="upcoming"&&e.start_date&&C.jsx("div",{className:"text-sm text-black",children:pc(e.start_date,"Asia/Seoul")}),e.status==="live"&&C.jsxs("div",{className:"text-sm text-black",children:["조회수 ",e.currentPeopleCount]})]})]})]}),t&&e.status==="upcoming"&&C.jsx(V6,{battleId:e.id,onClose:s}),t&&e.status==="ended"&&C.jsx(W6,{battleId:e.id,onClose:s})]})}const _W=J.div`
	margin: 0 auto;
`,kW=J(dO)`
	.slick-prev,
	.slick-next {
		z-index: 1;
		width: 40px;
		height: 40px;
		color: black;
		&:before {
			font-size: 40px;
			color: black;
		}
	}

	.slick-slide > div {
		margin: 0 15px; /* 각 슬라이드에 양옆 마진 추가 */
		padding-top: 20px;
	}
`;function Vf({cards:e}){const t={infinite:!1,centerPadding:"60px",slidesToShow:4,swipeToSlide:!0,draggable:!1,afterChange:n=>{console.log(`Slider Changed to: ${n+1}, background: #222; color: #bada55`)}};return C.jsx(_W,{children:C.jsx(kW,{infinite:t.infinite,centerPadding:t.centerPadding,slidesToShow:t.slidesToShow,swipeToSlide:t.swipeToSlide,draggable:t.draggable,afterChange:t.afterChange,children:e.map(n=>C.jsx("div",{children:C.jsx(ZO,{card:n})},n.id))})})}const eP=typeof document<"u"?we.useLayoutEffect:()=>{};function RW(e){const t=O.useRef(null);return eP(()=>{t.current=e},[e]),O.useCallback((...n)=>{const r=t.current;return r==null?void 0:r(...n)},[])}const Md=e=>{var t;return(t=e==null?void 0:e.ownerDocument)!==null&&t!==void 0?t:document},us=e=>e&&"window"in e&&e.window===e?e:Md(e).defaultView||window;function IW(e){var t;return typeof window>"u"||window.navigator==null?!1:((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.brands.some(n=>e.test(n.brand)))||e.test(window.navigator.userAgent)}function TW(e){var t;return typeof window<"u"&&window.navigator!=null?e.test(((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.platform)||window.navigator.platform):!1}function OW(){return TW(/^Mac/i)}function PW(){return IW(/Android/i)}function NW(e){return e.mozInputSource===0&&e.isTrusted?!0:PW()&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}class DW{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(t,n){this.nativeEvent=n,this.target=n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget,this.bubbles=n.bubbles,this.cancelable=n.cancelable,this.defaultPrevented=n.defaultPrevented,this.eventPhase=n.eventPhase,this.isTrusted=n.isTrusted,this.timeStamp=n.timeStamp,this.type=t}}function tP(e){let t=O.useRef({isFocused:!1,observer:null});eP(()=>{const r=t.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let n=RW(r=>{e==null||e(r)});return O.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){t.current.isFocused=!0;let i=r.target,o=a=>{t.current.isFocused=!1,i.disabled&&n(new DW("blur",a)),t.current.observer&&(t.current.observer.disconnect(),t.current.observer=null)};i.addEventListener("focusout",o,{once:!0}),t.current.observer=new MutationObserver(()=>{if(t.current.isFocused&&i.disabled){var a;(a=t.current.observer)===null||a===void 0||a.disconnect();let s=i===document.activeElement?null:document.activeElement;i.dispatchEvent(new FocusEvent("blur",{relatedTarget:s})),i.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:s}))}}),t.current.observer.observe(i,{attributes:!0,attributeFilter:["disabled"]})}},[n])}function AW(e){let{isDisabled:t,onFocus:n,onBlur:r,onFocusChange:i}=e;const o=O.useCallback(u=>{if(u.target===u.currentTarget)return r&&r(u),i&&i(!1),!0},[r,i]),a=tP(o),s=O.useCallback(u=>{const c=Md(u.target);u.target===u.currentTarget&&c.activeElement===u.target&&(n&&n(u),i&&i(!0),a(u))},[i,n,a]);return{focusProps:{onFocus:!t&&(n||i||r)?s:void 0,onBlur:!t&&(r||i)?o:void 0}}}let Ld=null,P1=new Set,Ml=new Map,Ps=!1,N1=!1;const MW={Tab:!0,Escape:!0};function Iw(e,t){for(let n of P1)n(e,t)}function LW(e){return!(e.metaKey||!OW()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}function Fp(e){Ps=!0,LW(e)&&(Ld="keyboard",Iw("keyboard",e))}function Jr(e){Ld="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&(Ps=!0,Iw("pointer",e))}function nP(e){NW(e)&&(Ps=!0,Ld="virtual")}function rP(e){e.target===window||e.target===document||(!Ps&&!N1&&(Ld="virtual",Iw("virtual",e)),Ps=!1,N1=!1)}function iP(){Ps=!1,N1=!0}function D1(e){if(typeof window>"u"||Ml.get(us(e)))return;const t=us(e),n=Md(e);let r=t.HTMLElement.prototype.focus;t.HTMLElement.prototype.focus=function(){Ps=!0,r.apply(this,arguments)},n.addEventListener("keydown",Fp,!0),n.addEventListener("keyup",Fp,!0),n.addEventListener("click",nP,!0),t.addEventListener("focus",rP,!0),t.addEventListener("blur",iP,!1),typeof PointerEvent<"u"?(n.addEventListener("pointerdown",Jr,!0),n.addEventListener("pointermove",Jr,!0),n.addEventListener("pointerup",Jr,!0)):(n.addEventListener("mousedown",Jr,!0),n.addEventListener("mousemove",Jr,!0),n.addEventListener("mouseup",Jr,!0)),t.addEventListener("beforeunload",()=>{oP(e)},{once:!0}),Ml.set(t,{focus:r})}const oP=(e,t)=>{const n=us(e),r=Md(e);t&&r.removeEventListener("DOMContentLoaded",t),Ml.has(n)&&(n.HTMLElement.prototype.focus=Ml.get(n).focus,r.removeEventListener("keydown",Fp,!0),r.removeEventListener("keyup",Fp,!0),r.removeEventListener("click",nP,!0),n.removeEventListener("focus",rP,!0),n.removeEventListener("blur",iP,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",Jr,!0),r.removeEventListener("pointermove",Jr,!0),r.removeEventListener("pointerup",Jr,!0)):(r.removeEventListener("mousedown",Jr,!0),r.removeEventListener("mousemove",Jr,!0),r.removeEventListener("mouseup",Jr,!0)),Ml.delete(n))};function FW(e){const t=Md(e);let n;return t.readyState!=="loading"?D1(e):(n=()=>{D1(e)},t.addEventListener("DOMContentLoaded",n)),()=>oP(e,n)}typeof document<"u"&&FW();function aP(){return Ld!=="pointer"}const BW=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function jW(e,t,n){var r;const i=typeof window<"u"?us(n==null?void 0:n.target).HTMLInputElement:HTMLInputElement,o=typeof window<"u"?us(n==null?void 0:n.target).HTMLTextAreaElement:HTMLTextAreaElement,a=typeof window<"u"?us(n==null?void 0:n.target).HTMLElement:HTMLElement,s=typeof window<"u"?us(n==null?void 0:n.target).KeyboardEvent:KeyboardEvent;return e=e||(n==null?void 0:n.target)instanceof i&&!BW.has(n==null||(r=n.target)===null||r===void 0?void 0:r.type)||(n==null?void 0:n.target)instanceof o||(n==null?void 0:n.target)instanceof a&&(n==null?void 0:n.target.isContentEditable),!(e&&t==="keyboard"&&n instanceof s&&!MW[n.key])}function $W(e,t,n){D1(),O.useEffect(()=>{let r=(i,o)=>{jW(!!(n!=null&&n.isTextInput),i,o)&&e(aP())};return P1.add(r),()=>{P1.delete(r)}},t)}function VW(e){let{isDisabled:t,onBlurWithin:n,onFocusWithin:r,onFocusWithinChange:i}=e,o=O.useRef({isFocusWithin:!1}),a=O.useCallback(c=>{o.current.isFocusWithin&&!c.currentTarget.contains(c.relatedTarget)&&(o.current.isFocusWithin=!1,n&&n(c),i&&i(!1))},[n,i,o]),s=tP(a),u=O.useCallback(c=>{!o.current.isFocusWithin&&document.activeElement===c.target&&(r&&r(c),i&&i(!0),o.current.isFocusWithin=!0,s(c))},[r,i,s]);return t?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:u,onBlur:a}}}let Bp=!1,o0=0;function A1(){Bp=!0,setTimeout(()=>{Bp=!1},50)}function a2(e){e.pointerType==="touch"&&A1()}function WW(){if(!(typeof document>"u"))return typeof PointerEvent<"u"?document.addEventListener("pointerup",a2):document.addEventListener("touchend",A1),o0++,()=>{o0--,!(o0>0)&&(typeof PointerEvent<"u"?document.removeEventListener("pointerup",a2):document.removeEventListener("touchend",A1))}}function UW(e){let{onHoverStart:t,onHoverChange:n,onHoverEnd:r,isDisabled:i}=e,[o,a]=O.useState(!1),s=O.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;O.useEffect(WW,[]);let{hoverProps:u,triggerHoverEnd:c}=O.useMemo(()=>{let l=(h,p)=>{if(s.pointerType=p,i||p==="touch"||s.isHovered||!h.currentTarget.contains(h.target))return;s.isHovered=!0;let m=h.currentTarget;s.target=m,t&&t({type:"hoverstart",target:m,pointerType:p}),n&&n(!0),a(!0)},d=(h,p)=>{if(s.pointerType="",s.target=null,p==="touch"||!s.isHovered)return;s.isHovered=!1;let m=h.currentTarget;r&&r({type:"hoverend",target:m,pointerType:p}),n&&n(!1),a(!1)},f={};return typeof PointerEvent<"u"?(f.onPointerEnter=h=>{Bp&&h.pointerType==="mouse"||l(h,h.pointerType)},f.onPointerLeave=h=>{!i&&h.currentTarget.contains(h.target)&&d(h,h.pointerType)}):(f.onTouchStart=()=>{s.ignoreEmulatedMouseEvents=!0},f.onMouseEnter=h=>{!s.ignoreEmulatedMouseEvents&&!Bp&&l(h,"mouse"),s.ignoreEmulatedMouseEvents=!1},f.onMouseLeave=h=>{!i&&h.currentTarget.contains(h.target)&&d(h,"mouse")}),{hoverProps:f,triggerHoverEnd:d}},[t,n,r,i,s]);return O.useEffect(()=>{i&&c({currentTarget:s.target},s.pointerType)},[i]),{hoverProps:u,isHovered:o}}function zW(e={}){let{autoFocus:t=!1,isTextInput:n,within:r}=e,i=O.useRef({isFocused:!1,isFocusVisible:t||aP()}),[o,a]=O.useState(!1),[s,u]=O.useState(()=>i.current.isFocused&&i.current.isFocusVisible),c=O.useCallback(()=>u(i.current.isFocused&&i.current.isFocusVisible),[]),l=O.useCallback(h=>{i.current.isFocused=h,a(h),c()},[c]);$W(h=>{i.current.isFocusVisible=h,c()},[],{isTextInput:n});let{focusProps:d}=AW({isDisabled:r,onFocusChange:l}),{focusWithinProps:f}=VW({isDisabled:!r,onFocusWithinChange:l});return{isFocused:o,isFocusVisible:s,focusProps:r?f:d}}var HW=Object.defineProperty,GW=(e,t,n)=>t in e?HW(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,a0=(e,t,n)=>(GW(e,typeof t!="symbol"?t+"":t,n),n);let qW=class{constructor(){a0(this,"current",this.detect()),a0(this,"handoffState","pending"),a0(this,"currentId",0)}set(t){this.current!==t&&(this.handoffState="pending",this.currentId=0,this.current=t)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},bs=new qW;function Tc(e){return bs.isServer?null:e instanceof Node?e.ownerDocument:e!=null&&e.hasOwnProperty("current")&&e.current instanceof Node?e.current.ownerDocument:document}function sP(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(t=>setTimeout(()=>{throw t}))}function so(){let e=[],t={addEventListener(n,r,i,o){return n.addEventListener(r,i,o),t.add(()=>n.removeEventListener(r,i,o))},requestAnimationFrame(...n){let r=requestAnimationFrame(...n);return t.add(()=>cancelAnimationFrame(r))},nextFrame(...n){return t.requestAnimationFrame(()=>t.requestAnimationFrame(...n))},setTimeout(...n){let r=setTimeout(...n);return t.add(()=>clearTimeout(r))},microTask(...n){let r={current:!0};return sP(()=>{r.current&&n[0]()}),t.add(()=>{r.current=!1})},style(n,r,i){let o=n.style.getPropertyValue(r);return Object.assign(n.style,{[r]:i}),this.add(()=>{Object.assign(n.style,{[r]:o})})},group(n){let r=so();return n(r),this.add(()=>r.dispose())},add(n){return e.includes(n)||e.push(n),()=>{let r=e.indexOf(n);if(r>=0)for(let i of e.splice(r,1))i()}},dispose(){for(let n of e.splice(0))n()}};return t}function om(){let[e]=O.useState(so);return O.useEffect(()=>()=>e.dispose(),[e]),e}let Ht=(e,t)=>{bs.isServer?O.useEffect(e,t):O.useLayoutEffect(e,t)};function Fd(e){let t=O.useRef(e);return Ht(()=>{t.current=e},[e]),t}let Mt=function(e){let t=Fd(e);return we.useCallback((...n)=>t.current(...n),[t])};function XW(e){let t=e.width/2,n=e.height/2;return{top:e.clientY-n,right:e.clientX+t,bottom:e.clientY+n,left:e.clientX-t}}function KW(e,t){return!(!e||!t||e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom)}function YW({disabled:e=!1}={}){let t=O.useRef(null),[n,r]=O.useState(!1),i=om(),o=Mt(()=>{t.current=null,r(!1),i.dispose()}),a=Mt(s=>{if(i.dispose(),t.current===null){t.current=s.currentTarget,r(!0);{let u=Tc(s.currentTarget);i.addEventListener(u,"pointerup",o,!1),i.addEventListener(u,"pointermove",c=>{if(t.current){let l=XW(c);r(KW(l,t.current.getBoundingClientRect()))}},!1),i.addEventListener(u,"pointercancel",o,!1)}}});return{pressed:n,pressProps:e?{}:{onPointerDown:a,onPointerUp:o,onClick:o}}}let QW=O.createContext(void 0);function uP(){return O.useContext(QW)}function s2(...e){return Array.from(new Set(e.flatMap(t=>typeof t=="string"?t.split(" "):[]))).filter(Boolean).join(" ")}function Bd(e,t,...n){if(e in t){let i=t[e];return typeof i=="function"?i(...n):i}let r=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(i=>`"${i}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Bd),r}var M1=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(M1||{}),JW=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(JW||{});function ci({ourProps:e,theirProps:t,slot:n,defaultTag:r,features:i,visible:o=!0,name:a,mergeRefs:s}){s=s??ZW;let u=cP(t,e);if(o)return Wf(u,n,r,a,s);let c=i??0;if(c&2){let{static:l=!1,...d}=u;if(l)return Wf(d,n,r,a,s)}if(c&1){let{unmount:l=!0,...d}=u;return Bd(l?0:1,{0(){return null},1(){return Wf({...d,hidden:!0,style:{display:"none"}},n,r,a,s)}})}return Wf(u,n,r,a,s)}function Wf(e,t={},n,r,i){let{as:o=n,children:a,refName:s="ref",...u}=s0(e,["unmount","static"]),c=e.ref!==void 0?{[s]:e.ref}:{},l=typeof a=="function"?a(t):a;"className"in u&&u.className&&typeof u.className=="function"&&(u.className=u.className(t)),u["aria-labelledby"]&&u["aria-labelledby"]===u.id&&(u["aria-labelledby"]=void 0);let d={};if(t){let f=!1,h=[];for(let[p,m]of Object.entries(t))typeof m=="boolean"&&(f=!0),m===!0&&h.push(p.replace(/([A-Z])/g,g=>`-${g.toLowerCase()}`));if(f){d["data-headlessui-state"]=h.join(" ");for(let p of h)d[`data-${p}`]=""}}if(o===O.Fragment&&(Object.keys(nu(u)).length>0||Object.keys(nu(d)).length>0))if(!O.isValidElement(l)||Array.isArray(l)&&l.length>1){if(Object.keys(nu(u)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${r} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(nu(u)).concat(Object.keys(nu(d))).map(f=>`  - ${f}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(f=>`  - ${f}`).join(`
`)].join(`
`))}else{let f=l.props,h=f==null?void 0:f.className,p=typeof h=="function"?(...v)=>s2(h(...v),u.className):s2(h,u.className),m=p?{className:p}:{},g=cP(l.props,nu(s0(u,["ref"])));for(let v in d)v in g&&delete d[v];return O.cloneElement(l,Object.assign({},g,d,c,{ref:i(l.ref,c.ref)},m))}return O.createElement(o,Object.assign({},s0(u,["ref"]),o!==O.Fragment&&c,o!==O.Fragment&&d),l)}function ZW(...e){return e.every(t=>t==null)?void 0:t=>{for(let n of e)n!=null&&(typeof n=="function"?n(t):n.current=t)}}function cP(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},n={};for(let r of e)for(let i in r)i.startsWith("on")&&typeof r[i]=="function"?(n[i]!=null||(n[i]=[]),n[i].push(r[i])):t[i]=r[i];if(t.disabled||t["aria-disabled"])for(let r in n)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(r)&&(n[r]=[i=>{var o;return(o=i==null?void 0:i.preventDefault)==null?void 0:o.call(i)}]);for(let r in n)Object.assign(t,{[r](i,...o){let a=n[r];for(let s of a){if((i instanceof Event||(i==null?void 0:i.nativeEvent)instanceof Event)&&i.defaultPrevented)return;s(i,...o)}}});return t}function lP(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},n={};for(let r of e)for(let i in r)i.startsWith("on")&&typeof r[i]=="function"?(n[i]!=null||(n[i]=[]),n[i].push(r[i])):t[i]=r[i];for(let r in n)Object.assign(t,{[r](...i){let o=n[r];for(let a of o)a==null||a(...i)}});return t}function li(e){var t;return Object.assign(O.forwardRef(e),{displayName:(t=e.displayName)!=null?t:e.name})}function nu(e){let t=Object.assign({},e);for(let n in t)t[n]===void 0&&delete t[n];return t}function s0(e,t=[]){let n=Object.assign({},e);for(let r of t)r in n&&delete n[r];return n}let eU=O.createContext(void 0);function tU(){return O.useContext(eU)}function nU(e){let t=e.parentElement,n=null;for(;t&&!(t instanceof HTMLFieldSetElement);)t instanceof HTMLLegendElement&&(n=t),t=t.parentElement;let r=(t==null?void 0:t.getAttribute("disabled"))==="";return r&&rU(n)?!1:r}function rU(e){if(!e)return!1;let t=e.previousElementSibling;for(;t!==null;){if(t instanceof HTMLLegendElement)return!1;t=t.previousElementSibling}return!0}let dP=Symbol();function iU(e,t=!0){return Object.assign(e,{[dP]:t})}function No(...e){let t=O.useRef(e);O.useEffect(()=>{t.current=e},[e]);let n=Mt(r=>{for(let i of t.current)i!=null&&(typeof i=="function"?i(r):i.current=r)});return e.every(r=>r==null||(r==null?void 0:r[dP]))?void 0:n}let Tw=O.createContext(null);Tw.displayName="DescriptionContext";function fP(){let e=O.useContext(Tw);if(e===null){let t=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(t,fP),t}return e}function oU(){let[e,t]=O.useState([]);return[e.length>0?e.join(" "):void 0,O.useMemo(()=>function(n){let r=Mt(o=>(t(a=>[...a,o]),()=>t(a=>{let s=a.slice(),u=s.indexOf(o);return u!==-1&&s.splice(u,1),s}))),i=O.useMemo(()=>({register:r,slot:n.slot,name:n.name,props:n.props,value:n.value}),[r,n.slot,n.name,n.props,n.value]);return we.createElement(Tw.Provider,{value:i},n.children)},[t])]}let aU="p";function sU(e,t){let n=O.useId(),r=uP(),{id:i=`headlessui-description-${n}`,...o}=e,a=fP(),s=No(t);Ht(()=>a.register(i),[i,a.register]);let u=r||!1,c=O.useMemo(()=>({...a.slot,disabled:u}),[a.slot,u]),l={ref:s,...a.props,id:i};return ci({ourProps:l,theirProps:o,slot:c,defaultTag:aU,name:a.name||"Description"})}let uU=li(sU);Object.assign(uU,{});var Rn=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(Rn||{});let am=O.createContext(null);am.displayName="LabelContext";function Ow(){let e=O.useContext(am);if(e===null){let t=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(t,Ow),t}return e}function cU(e){var t,n,r;let i=(n=(t=O.useContext(am))==null?void 0:t.value)!=null?n:void 0;return((r=void 0)!=null?r:0)>0?[i,...e].filter(Boolean).join(" "):i}function hP({inherit:e=!1}={}){let t=cU(),[n,r]=O.useState([]),i=e?[t,...n].filter(Boolean):n;return[i.length>0?i.join(" "):void 0,O.useMemo(()=>function(o){let a=Mt(u=>(r(c=>[...c,u]),()=>r(c=>{let l=c.slice(),d=l.indexOf(u);return d!==-1&&l.splice(d,1),l}))),s=O.useMemo(()=>({register:a,slot:o.slot,name:o.name,props:o.props,value:o.value}),[a,o.slot,o.name,o.props,o.value]);return we.createElement(am.Provider,{value:s},o.children)},[r])]}let lU="label";function dU(e,t){var n;let r=O.useId(),i=Ow(),o=tU(),a=uP(),{id:s=`headlessui-label-${r}`,htmlFor:u=o??((n=i.props)==null?void 0:n.htmlFor),passive:c=!1,...l}=e,d=No(t);Ht(()=>i.register(s),[s,i.register]);let f=Mt(g=>{let v=g.currentTarget;if(v instanceof HTMLLabelElement&&g.preventDefault(),i.props&&"onClick"in i.props&&typeof i.props.onClick=="function"&&i.props.onClick(g),v instanceof HTMLLabelElement){let y=document.getElementById(v.htmlFor);if(y){let b=y.getAttribute("disabled");if(b==="true"||b==="")return;let w=y.getAttribute("aria-disabled");if(w==="true"||w==="")return;(y instanceof HTMLInputElement&&(y.type==="radio"||y.type==="checkbox")||y.role==="radio"||y.role==="checkbox"||y.role==="switch")&&y.click(),y.focus({preventScroll:!0})}}}),h=a||!1,p=O.useMemo(()=>({...i.slot,disabled:h}),[i.slot,h]),m={ref:d,...i.props,id:s,htmlFor:u,onClick:f};return c&&("onClick"in m&&(delete m.htmlFor,delete m.onClick),"onClick"in l&&delete l.onClick),ci({ourProps:m,theirProps:l,slot:p,defaultTag:u?lU:"div",name:i.name||"Label"})}let fU=li(dU);Object.assign(fU,{});function hU(e){if(e===null)return{width:0,height:0};let{width:t,height:n}=e.getBoundingClientRect();return{width:t,height:n}}function pU(e,t=!1){let n=e===null?null:"current"in e?e.current:e,[r,i]=O.useReducer(()=>({}),{}),o=O.useMemo(()=>hU(n),[n,r]);return Ht(()=>{if(!n)return;let a=new ResizeObserver(i);return a.observe(n),()=>{a.disconnect()}},[n]),t?{width:`${o.width}px`,height:`${o.height}px`}:o}let vU=class extends Map{constructor(t){super(),this.factory=t}get(t){let n=super.get(t);return n===void 0&&(n=this.factory(t),this.set(t,n)),n}};function pP(e,t){let n=e(),r=new Set;return{getSnapshot(){return n},subscribe(i){return r.add(i),()=>r.delete(i)},dispatch(i,...o){let a=t[i].call(n,...o);a&&(n=a,r.forEach(s=>s()))}}}function vP(e){return O.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getSnapshot)}let mU=new vU(()=>pP(()=>[],{ADD(e){return this.includes(e)?this:[...this,e]},REMOVE(e){let t=this.indexOf(e);if(t===-1)return this;let n=this.slice();return n.splice(t,1),n}}));function Pw(e,t){let n=mU.get(t),r=O.useId(),i=vP(n);if(Ht(()=>{if(e)return n.dispatch("ADD",r),()=>n.dispatch("REMOVE",r)},[n,e]),!e)return!1;let o=i.indexOf(r),a=i.length;return o===-1&&(o=a,a+=1),o===a-1}let L1=new Map,Ll=new Map;function u2(e){var t;let n=(t=Ll.get(e))!=null?t:0;return Ll.set(e,n+1),n!==0?()=>c2(e):(L1.set(e,{"aria-hidden":e.getAttribute("aria-hidden"),inert:e.inert}),e.setAttribute("aria-hidden","true"),e.inert=!0,()=>c2(e))}function c2(e){var t;let n=(t=Ll.get(e))!=null?t:1;if(n===1?Ll.delete(e):Ll.set(e,n-1),n!==1)return;let r=L1.get(e);r&&(r["aria-hidden"]===null?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden",r["aria-hidden"]),e.inert=r.inert,L1.delete(e))}function gU(e,{allowed:t,disallowed:n}={}){let r=Pw(e,"inert-others");Ht(()=>{var i,o;if(!r)return;let a=so();for(let u of(i=n==null?void 0:n())!=null?i:[])u&&a.add(u2(u));let s=(o=t==null?void 0:t())!=null?o:[];for(let u of s){if(!u)continue;let c=Tc(u);if(!c)continue;let l=u.parentElement;for(;l&&l!==c.body;){for(let d of l.children)s.some(f=>d.contains(f))||a.add(u2(d));l=l.parentElement}}return a.dispose},[r,t,n])}function yU(e,t,n){let r=Fd(i=>{let o=i.getBoundingClientRect();o.x===0&&o.y===0&&o.width===0&&o.height===0&&n()});O.useEffect(()=>{if(!e)return;let i=t===null?null:t instanceof HTMLElement?t:t.current;if(!i)return;let o=so();if(typeof ResizeObserver<"u"){let a=new ResizeObserver(()=>r.current(i));a.observe(i),o.add(()=>a.disconnect())}if(typeof IntersectionObserver<"u"){let a=new IntersectionObserver(()=>r.current(i));a.observe(i),o.add(()=>a.disconnect())}return()=>o.dispose()},[t,r,e])}let F1=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(","),bU=["[data-autofocus]"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var B1=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e[e.AutoFocus=64]="AutoFocus",e))(B1||{}),wU=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(wU||{}),xU=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(xU||{});function mP(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(F1)).sort((t,n)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}function EU(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(bU)).sort((t,n)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}var Nw=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Nw||{});function Dw(e,t=0){var n;return e===((n=Tc(e))==null?void 0:n.body)?!1:Bd(t,{0(){return e.matches(F1)},1(){let r=e;for(;r!==null;){if(r.matches(F1))return!0;r=r.parentElement}return!1}})}function gP(e){let t=Tc(e);so().nextFrame(()=>{t&&!Dw(t.activeElement,0)&&CU(e)})}var SU=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(SU||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function CU(e){e==null||e.focus({preventScroll:!0})}let _U=["textarea","input"].join(",");function kU(e){var t,n;return(n=(t=e==null?void 0:e.matches)==null?void 0:t.call(e,_U))!=null?n:!1}function yP(e,t=n=>n){return e.slice().sort((n,r)=>{let i=t(n),o=t(r);if(i===null||o===null)return 0;let a=i.compareDocumentPosition(o);return a&Node.DOCUMENT_POSITION_FOLLOWING?-1:a&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function RU(e,t){return IU(mP(),t,{relativeTo:e})}function IU(e,t,{sorted:n=!0,relativeTo:r=null,skipElements:i=[]}={}){let o=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,a=Array.isArray(e)?n?yP(e):e:t&64?EU(e):mP(e);i.length>0&&a.length>1&&(a=a.filter(h=>!i.some(p=>p!=null&&"current"in p?(p==null?void 0:p.current)===h:p===h))),r=r??o.activeElement;let s=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,a.indexOf(r))-1;if(t&4)return Math.max(0,a.indexOf(r))+1;if(t&8)return a.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=t&32?{preventScroll:!0}:{},l=0,d=a.length,f;do{if(l>=d||l+d<=0)return 0;let h=u+l;if(t&16)h=(h+d)%d;else{if(h<0)return 3;if(h>=d)return 1}f=a[h],f==null||f.focus(c),l+=s}while(f!==o.activeElement);return t&6&&kU(f)&&f.select(),2}function bP(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function TU(){return/Android/gi.test(window.navigator.userAgent)}function OU(){return bP()||TU()}function ol(e,t,n,r){let i=Fd(n);O.useEffect(()=>{if(!e)return;function o(a){i.current(a)}return document.addEventListener(t,o,r),()=>document.removeEventListener(t,o,r)},[e,t,r])}function PU(e,t,n,r){let i=Fd(n);O.useEffect(()=>{if(!e)return;function o(a){i.current(a)}return window.addEventListener(t,o,r),()=>window.removeEventListener(t,o,r)},[e,t,r])}const l2=30;function NU(e,t,n){let r=Pw(e,"outside-click"),i=Fd(n),o=O.useCallback(function(u,c){if(u.defaultPrevented)return;let l=c(u);if(l===null||!l.getRootNode().contains(l)||!l.isConnected)return;let d=function f(h){return typeof h=="function"?f(h()):Array.isArray(h)||h instanceof Set?h:[h]}(t);for(let f of d){if(f===null)continue;let h=f instanceof HTMLElement?f:f.current;if(h!=null&&h.contains(l)||u.composed&&u.composedPath().includes(h))return}return!Dw(l,Nw.Loose)&&l.tabIndex!==-1&&u.preventDefault(),i.current(u,l)},[i]),a=O.useRef(null);ol(r,"pointerdown",u=>{var c,l;a.current=((l=(c=u.composedPath)==null?void 0:c.call(u))==null?void 0:l[0])||u.target},!0),ol(r,"mousedown",u=>{var c,l;a.current=((l=(c=u.composedPath)==null?void 0:c.call(u))==null?void 0:l[0])||u.target},!0),ol(r,"click",u=>{OU()||a.current&&(o(u,()=>a.current),a.current=null)},!0);let s=O.useRef({x:0,y:0});ol(r,"touchstart",u=>{s.current.x=u.touches[0].clientX,s.current.y=u.touches[0].clientY},!0),ol(r,"touchend",u=>{let c={x:u.changedTouches[0].clientX,y:u.changedTouches[0].clientY};if(!(Math.abs(c.x-s.current.x)>=l2||Math.abs(c.y-s.current.y)>=l2))return o(u,()=>u.target instanceof HTMLElement?u.target:null)},!0),PU(r,"blur",u=>o(u,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function Aw(...e){return O.useMemo(()=>Tc(...e),[...e])}function d2(e){var t;if(e.type)return e.type;let n=(t=e.as)!=null?t:"button";if(typeof n=="string"&&n.toLowerCase()==="button")return"button"}function DU(e,t){let[n,r]=O.useState(()=>d2(e));return Ht(()=>{r(d2(e))},[e.type,e.as]),Ht(()=>{n||t.current&&t.current instanceof HTMLButtonElement&&!t.current.hasAttribute("type")&&r("button")},[n,t]),n}function AU(){let e;return{before({doc:t}){var n;let r=t.documentElement,i=(n=t.defaultView)!=null?n:window;e=Math.max(0,i.innerWidth-r.clientWidth)},after({doc:t,d:n}){let r=t.documentElement,i=Math.max(0,r.clientWidth-r.offsetWidth),o=Math.max(0,e-i);n.style(r,"paddingRight",`${o}px`)}}}function MU(){return bP()?{before({doc:e,d:t,meta:n}){function r(i){return n.containers.flatMap(o=>o()).some(o=>o.contains(i))}t.microTask(()=>{var i;if(window.getComputedStyle(e.documentElement).scrollBehavior!=="auto"){let s=so();s.style(e.documentElement,"scrollBehavior","auto"),t.add(()=>t.microTask(()=>s.dispose()))}let o=(i=window.scrollY)!=null?i:window.pageYOffset,a=null;t.addEventListener(e,"click",s=>{if(s.target instanceof HTMLElement)try{let u=s.target.closest("a");if(!u)return;let{hash:c}=new URL(u.href),l=e.querySelector(c);l&&!r(l)&&(a=l)}catch{}},!0),t.addEventListener(e,"touchstart",s=>{if(s.target instanceof HTMLElement)if(r(s.target)){let u=s.target;for(;u.parentElement&&r(u.parentElement);)u=u.parentElement;t.style(u,"overscrollBehavior","contain")}else t.style(s.target,"touchAction","none")}),t.addEventListener(e,"touchmove",s=>{if(s.target instanceof HTMLElement){if(s.target.tagName==="INPUT")return;if(r(s.target)){let u=s.target;for(;u.parentElement&&u.dataset.headlessuiPortal!==""&&!(u.scrollHeight>u.clientHeight||u.scrollWidth>u.clientWidth);)u=u.parentElement;u.dataset.headlessuiPortal===""&&s.preventDefault()}else s.preventDefault()}},{passive:!1}),t.add(()=>{var s;let u=(s=window.scrollY)!=null?s:window.pageYOffset;o!==u&&window.scrollTo(0,o),a&&a.isConnected&&(a.scrollIntoView({block:"nearest"}),a=null)})})}}:{}}function LU(){return{before({doc:e,d:t}){t.style(e.documentElement,"overflow","hidden")}}}function FU(e){let t={};for(let n of e)Object.assign(t,n(t));return t}let cs=pP(()=>new Map,{PUSH(e,t){var n;let r=(n=this.get(e))!=null?n:{doc:e,count:0,d:so(),meta:new Set};return r.count++,r.meta.add(t),this.set(e,r),this},POP(e,t){let n=this.get(e);return n&&(n.count--,n.meta.delete(t)),this},SCROLL_PREVENT({doc:e,d:t,meta:n}){let r={doc:e,d:t,meta:FU(n)},i=[MU(),AU(),LU()];i.forEach(({before:o})=>o==null?void 0:o(r)),i.forEach(({after:o})=>o==null?void 0:o(r))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});cs.subscribe(()=>{let e=cs.getSnapshot(),t=new Map;for(let[n]of e)t.set(n,n.documentElement.style.overflow);for(let n of e.values()){let r=t.get(n.doc)==="hidden",i=n.count!==0;(i&&!r||!i&&r)&&cs.dispatch(n.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",n),n.count===0&&cs.dispatch("TEARDOWN",n)}});function BU(e,t,n=()=>({containers:[]})){let r=vP(cs),i=t?r.get(t):void 0,o=i?i.count>0:!1;return Ht(()=>{if(!(!t||!e))return cs.dispatch("PUSH",t,n),()=>cs.dispatch("POP",t,n)},[e,t]),o}function jU(e,t,n=()=>[document.body]){let r=Pw(e,"scroll-lock");BU(r,t,i=>{var o;return{containers:[...(o=i.containers)!=null?o:[],n]}})}function f2(e){return[e.screenX,e.screenY]}function $U(){let e=O.useRef([-1,-1]);return{wasMoved(t){let n=f2(t);return e.current[0]===n[0]&&e.current[1]===n[1]?!1:(e.current=n,!0)},update(t){e.current=f2(t)}}}function VU(e){let t={called:!1};return(...n)=>{if(!t.called)return t.called=!0,e(...n)}}function WU(e=0){let[t,n]=O.useState(e),r=O.useCallback(u=>n(u),[t]),i=O.useCallback(u=>n(c=>c|u),[t]),o=O.useCallback(u=>(t&u)===u,[t]),a=O.useCallback(u=>n(c=>c&~u),[n]),s=O.useCallback(u=>n(c=>c^u),[n]);return{flags:t,setFlag:r,addFlag:i,hasFlag:o,removeFlag:a,toggleFlag:s}}var UU=(e=>(e[e.None=0]="None",e[e.Closed=1]="Closed",e[e.Enter=2]="Enter",e[e.Leave=4]="Leave",e))(UU||{});function zU(e){let t={};for(let n in e)e[n]===!0&&(t[`data-${n}`]="");return t}function HU(e,t,n,r){let[i,o]=O.useState(n),{hasFlag:a,addFlag:s,removeFlag:u}=WU(e&&i?3:0),c=O.useRef(!1),l=O.useRef(!1),d=om();return Ht(function f(){var h;if(!e)return;n&&o(!0);let p=t.current;return p?((h=void 0)==null||h.call(r,n),GU(p,{inFlight:c,prepare(){l.current?l.current=!1:l.current=c.current,c.current=!0,!l.current&&(n?(s(3),u(4)):(s(4),u(2)))},run(){l.current?n?(u(3),s(4)):(u(4),s(3)):n?u(1):s(1)},done(){var m;l.current&&typeof p.getAnimations=="function"&&p.getAnimations().length>0||(c.current=!1,u(7),n||o(!1),(m=void 0)==null||m.call(r,n))}})):n?(s(3),d.nextFrame(()=>f())):void 0},[e,n,t,d]),e?[i,{closed:a(1),enter:a(2),leave:a(4),transition:a(2)||a(4)}]:[n,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function GU(e,{prepare:t,run:n,done:r,inFlight:i}){let o=so();return XU(e,{prepare:t,inFlight:i}),o.nextFrame(()=>{o.add(qU(e,r)),n()}),o.dispose}function qU(e,t){let n=VU(t),r=so();if(!e)return r.dispose;let{transitionDuration:i,transitionDelay:o}=getComputedStyle(e),[a,s]=[i,o].map(c=>{let[l=0]=c.split(",").filter(Boolean).map(d=>d.includes("ms")?parseFloat(d):parseFloat(d)*1e3).sort((d,f)=>f-d);return l}),u=a+s;if(u!==0){let c=r.group(l=>{let d=l.setTimeout(()=>{n(),l.dispose()},u);l.addEventListener(e,"transitionrun",f=>{f.target===f.currentTarget&&(d(),l.addEventListener(e,"transitioncancel",h=>{h.target===h.currentTarget&&(n(),c())}))})});r.addEventListener(e,"transitionend",l=>{l.target===l.currentTarget&&(n(),r.dispose())})}else n();return r.dispose}function XU(e,{inFlight:t,prepare:n}){if(t!=null&&t.current){n();return}let r=e.style.transition;e.style.transition="none",n(),e.offsetHeight,e.style.transition=r}function KU(e,{container:t,accept:n,walk:r}){let i=O.useRef(n),o=O.useRef(r);O.useEffect(()=>{i.current=n,o.current=r},[n,r]),Ht(()=>{if(!t||!e)return;let a=Tc(t);if(!a)return;let s=i.current,u=o.current,c=Object.assign(d=>s(d),{acceptNode:s}),l=a.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,c,!1);for(;l.nextNode();)u(l.currentNode)},[t,e,i,o])}function Oc(e){return wP(e)?(e.nodeName||"").toLowerCase():"#document"}function Ur(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Do(e){var t;return(t=(wP(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function wP(e){return e instanceof Node||e instanceof Ur(e).Node}function xr(e){return e instanceof Element||e instanceof Ur(e).Element}function io(e){return e instanceof HTMLElement||e instanceof Ur(e).HTMLElement}function h2(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ur(e).ShadowRoot}function jd(e){const{overflow:t,overflowX:n,overflowY:r,display:i}=Ii(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(i)}function YU(e){return["table","td","th"].includes(Oc(e))}function sm(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function Mw(e){const t=Lw(),n=Ii(e);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function QU(e){let t=Ra(e);for(;io(t)&&!vc(t);){if(sm(t))return null;if(Mw(t))return t;t=Ra(t)}return null}function Lw(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function vc(e){return["html","body","#document"].includes(Oc(e))}function Ii(e){return Ur(e).getComputedStyle(e)}function um(e){return xr(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ra(e){if(Oc(e)==="html")return e;const t=e.assignedSlot||e.parentNode||h2(e)&&e.host||Do(e);return h2(t)?t.host:t}function xP(e){const t=Ra(e);return vc(t)?e.ownerDocument?e.ownerDocument.body:e.body:io(t)&&jd(t)?t:xP(t)}function pd(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const i=xP(e),o=i===((r=e.ownerDocument)==null?void 0:r.body),a=Ur(i);return o?t.concat(a,a.visualViewport||[],jd(i)?i:[],a.frameElement&&n?pd(a.frameElement):[]):t.concat(i,pd(i,[],n))}function JU(){const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map(t=>{let{brand:n,version:r}=t;return n+"/"+r}).join(" "):navigator.userAgent}const ua=Math.min,Mr=Math.max,jp=Math.round,Uf=Math.floor,Ia=e=>({x:e,y:e}),ZU={left:"right",right:"left",bottom:"top",top:"bottom"},ez={start:"end",end:"start"};function p2(e,t,n){return Mr(e,ua(t,n))}function $d(e,t){return typeof e=="function"?e(t):e}function Ta(e){return e.split("-")[0]}function Vd(e){return e.split("-")[1]}function EP(e){return e==="x"?"y":"x"}function SP(e){return e==="y"?"height":"width"}function Wd(e){return["top","bottom"].includes(Ta(e))?"y":"x"}function CP(e){return EP(Wd(e))}function tz(e,t,n){n===void 0&&(n=!1);const r=Vd(e),i=CP(e),o=SP(i);let a=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(a=$p(a)),[a,$p(a)]}function nz(e){const t=$p(e);return[j1(e),t,j1(t)]}function j1(e){return e.replace(/start|end/g,t=>ez[t])}function rz(e,t,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:r:t?r:i;case"left":case"right":return t?o:a;default:return[]}}function iz(e,t,n,r){const i=Vd(e);let o=rz(Ta(e),n==="start",r);return i&&(o=o.map(a=>a+"-"+i),t&&(o=o.concat(o.map(j1)))),o}function $p(e){return e.replace(/left|right|bottom|top/g,t=>ZU[t])}function oz(e){return{top:0,right:0,bottom:0,left:0,...e}}function az(e){return typeof e!="number"?oz(e):{top:e,right:e,bottom:e,left:e}}function Vp(e){const{x:t,y:n,width:r,height:i}=e;return{width:r,height:i,top:n,left:t,right:t+r,bottom:n+i,x:t,y:n}}function v2(e,t,n){let{reference:r,floating:i}=e;const o=Wd(t),a=CP(t),s=SP(a),u=Ta(t),c=o==="y",l=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,f=r[s]/2-i[s]/2;let h;switch(u){case"top":h={x:l,y:r.y-i.height};break;case"bottom":h={x:l,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-i.width,y:d};break;default:h={x:r.x,y:r.y}}switch(Vd(t)){case"start":h[a]-=f*(n&&c?-1:1);break;case"end":h[a]+=f*(n&&c?-1:1);break}return h}const sz=async(e,t,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:a}=n,s=o.filter(Boolean),u=await(a.isRTL==null?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:i}),{x:l,y:d}=v2(c,r,u),f=r,h={},p=0;for(let m=0;m<s.length;m++){const{name:g,fn:v}=s[m],{x:y,y:b,data:w,reset:E}=await v({x:l,y:d,initialPlacement:r,placement:f,strategy:i,middlewareData:h,rects:c,platform:a,elements:{reference:e,floating:t}});l=y??l,d=b??d,h={...h,[g]:{...h[g],...w}},E&&p<=50&&(p++,typeof E=="object"&&(E.placement&&(f=E.placement),E.rects&&(c=E.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:i}):E.rects),{x:l,y:d}=v2(c,f,u)),m=-1)}return{x:l,y:d,placement:f,strategy:i,middlewareData:h}};async function cm(e,t){var n;t===void 0&&(t={});const{x:r,y:i,platform:o,rects:a,elements:s,strategy:u}=e,{boundary:c="clippingAncestors",rootBoundary:l="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=$d(t,e),p=az(h),g=s[f?d==="floating"?"reference":"floating":d],v=Vp(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(g)))==null||n?g:g.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(s.floating)),boundary:c,rootBoundary:l,strategy:u})),y=d==="floating"?{x:r,y:i,width:a.floating.width,height:a.floating.height}:a.reference,b=await(o.getOffsetParent==null?void 0:o.getOffsetParent(s.floating)),w=await(o.isElement==null?void 0:o.isElement(b))?await(o.getScale==null?void 0:o.getScale(b))||{x:1,y:1}:{x:1,y:1},E=Vp(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:y,offsetParent:b,strategy:u}):y);return{top:(v.top-E.top+p.top)/w.y,bottom:(E.bottom-v.bottom+p.bottom)/w.y,left:(v.left-E.left+p.left)/w.x,right:(E.right-v.right+p.right)/w.x}}const uz=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:i,middlewareData:o,rects:a,initialPlacement:s,platform:u,elements:c}=t,{mainAxis:l=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=$d(e,t);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const v=Ta(i),y=Ta(s)===s,b=await(u.isRTL==null?void 0:u.isRTL(c.floating)),w=f||(y||!m?[$p(s)]:nz(s));!f&&p!=="none"&&w.push(...iz(s,m,p,b));const E=[s,...w],x=await cm(t,g),R=[];let S=((r=o.flip)==null?void 0:r.overflows)||[];if(l&&R.push(x[v]),d){const L=tz(i,a,b);R.push(x[L[0]],x[L[1]])}if(S=[...S,{placement:i,overflows:R}],!R.every(L=>L<=0)){var _,T;const L=(((_=o.flip)==null?void 0:_.index)||0)+1,k=E[L];if(k)return{data:{index:L,overflows:S},reset:{placement:k}};let D=(T=S.filter(F=>F.overflows[0]<=0).sort((F,M)=>F.overflows[1]-M.overflows[1])[0])==null?void 0:T.placement;if(!D)switch(h){case"bestFit":{var B;const F=(B=S.map(M=>[M.placement,M.overflows.filter(I=>I>0).reduce((I,N)=>I+N,0)]).sort((M,I)=>M[1]-I[1])[0])==null?void 0:B[0];F&&(D=F);break}case"initialPlacement":D=s;break}if(i!==D)return{reset:{placement:D}}}return{}}}};async function cz(e,t){const{placement:n,platform:r,elements:i}=e,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),a=Ta(n),s=Vd(n),u=Wd(n)==="y",c=["left","top"].includes(a)?-1:1,l=o&&u?-1:1,d=$d(t,e);let{mainAxis:f,crossAxis:h,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&typeof p=="number"&&(h=s==="end"?p*-1:p),u?{x:h*l,y:f*c}:{x:f*c,y:h*l}}const lz=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:i,y:o,placement:a,middlewareData:s}=t,u=await cz(t,e);return a===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:i+u.x,y:o+u.y,data:{...u,placement:a}}}}},dz=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:i}=t,{mainAxis:o=!0,crossAxis:a=!1,limiter:s={fn:g=>{let{x:v,y}=g;return{x:v,y}}},...u}=$d(e,t),c={x:n,y:r},l=await cm(t,u),d=Wd(Ta(i)),f=EP(d);let h=c[f],p=c[d];if(o){const g=f==="y"?"top":"left",v=f==="y"?"bottom":"right",y=h+l[g],b=h-l[v];h=p2(y,h,b)}if(a){const g=d==="y"?"top":"left",v=d==="y"?"bottom":"right",y=p+l[g],b=p-l[v];p=p2(y,p,b)}const m=s.fn({...t,[f]:h,[d]:p});return{...m,data:{x:m.x-n,y:m.y-r}}}}},fz=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:i,elements:o}=t,{apply:a=()=>{},...s}=$d(e,t),u=await cm(t,s),c=Ta(n),l=Vd(n),d=Wd(n)==="y",{width:f,height:h}=r.floating;let p,m;c==="top"||c==="bottom"?(p=c,m=l===(await(i.isRTL==null?void 0:i.isRTL(o.floating))?"start":"end")?"left":"right"):(m=c,p=l==="end"?"top":"bottom");const g=h-u.top-u.bottom,v=f-u.left-u.right,y=ua(h-u[p],g),b=ua(f-u[m],v),w=!t.middlewareData.shift;let E=y,x=b;if(d?x=l||w?ua(b,v):v:E=l||w?ua(y,g):g,w&&!l){const S=Mr(u.left,0),_=Mr(u.right,0),T=Mr(u.top,0),B=Mr(u.bottom,0);d?x=f-2*(S!==0||_!==0?S+_:Mr(u.left,u.right)):E=h-2*(T!==0||B!==0?T+B:Mr(u.top,u.bottom))}await a({...t,availableWidth:x,availableHeight:E});const R=await i.getDimensions(o.floating);return f!==R.width||h!==R.height?{reset:{rects:!0}}:{}}}};function _P(e){const t=Ii(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const i=io(e),o=i?e.offsetWidth:n,a=i?e.offsetHeight:r,s=jp(n)!==o||jp(r)!==a;return s&&(n=o,r=a),{width:n,height:r,$:s}}function Fw(e){return xr(e)?e:e.contextElement}function $u(e){const t=Fw(e);if(!io(t))return Ia(1);const n=t.getBoundingClientRect(),{width:r,height:i,$:o}=_P(t);let a=(o?jp(n.width):n.width)/r,s=(o?jp(n.height):n.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!s||!Number.isFinite(s))&&(s=1),{x:a,y:s}}const hz=Ia(0);function kP(e){const t=Ur(e);return!Lw()||!t.visualViewport?hz:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function pz(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Ur(e)?!1:t}function Ns(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const i=e.getBoundingClientRect(),o=Fw(e);let a=Ia(1);t&&(r?xr(r)&&(a=$u(r)):a=$u(e));const s=pz(o,n,r)?kP(o):Ia(0);let u=(i.left+s.x)/a.x,c=(i.top+s.y)/a.y,l=i.width/a.x,d=i.height/a.y;if(o){const f=Ur(o),h=r&&xr(r)?Ur(r):r;let p=f,m=p.frameElement;for(;m&&r&&h!==p;){const g=$u(m),v=m.getBoundingClientRect(),y=Ii(m),b=v.left+(m.clientLeft+parseFloat(y.paddingLeft))*g.x,w=v.top+(m.clientTop+parseFloat(y.paddingTop))*g.y;u*=g.x,c*=g.y,l*=g.x,d*=g.y,u+=b,c+=w,p=Ur(m),m=p.frameElement}}return Vp({width:l,height:d,x:u,y:c})}function vz(e){let{elements:t,rect:n,offsetParent:r,strategy:i}=e;const o=i==="fixed",a=Do(r),s=t?sm(t.floating):!1;if(r===a||s&&o)return n;let u={scrollLeft:0,scrollTop:0},c=Ia(1);const l=Ia(0),d=io(r);if((d||!d&&!o)&&((Oc(r)!=="body"||jd(a))&&(u=um(r)),io(r))){const f=Ns(r);c=$u(r),l.x=f.x+r.clientLeft,l.y=f.y+r.clientTop}return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-u.scrollLeft*c.x+l.x,y:n.y*c.y-u.scrollTop*c.y+l.y}}function mz(e){return Array.from(e.getClientRects())}function RP(e){return Ns(Do(e)).left+um(e).scrollLeft}function gz(e){const t=Do(e),n=um(e),r=e.ownerDocument.body,i=Mr(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=Mr(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+RP(e);const s=-n.scrollTop;return Ii(r).direction==="rtl"&&(a+=Mr(t.clientWidth,r.clientWidth)-i),{width:i,height:o,x:a,y:s}}function yz(e,t){const n=Ur(e),r=Do(e),i=n.visualViewport;let o=r.clientWidth,a=r.clientHeight,s=0,u=0;if(i){o=i.width,a=i.height;const c=Lw();(!c||c&&t==="fixed")&&(s=i.offsetLeft,u=i.offsetTop)}return{width:o,height:a,x:s,y:u}}function bz(e,t){const n=Ns(e,!0,t==="fixed"),r=n.top+e.clientTop,i=n.left+e.clientLeft,o=io(e)?$u(e):Ia(1),a=e.clientWidth*o.x,s=e.clientHeight*o.y,u=i*o.x,c=r*o.y;return{width:a,height:s,x:u,y:c}}function m2(e,t,n){let r;if(t==="viewport")r=yz(e,n);else if(t==="document")r=gz(Do(e));else if(xr(t))r=bz(t,n);else{const i=kP(e);r={...t,x:t.x-i.x,y:t.y-i.y}}return Vp(r)}function IP(e,t){const n=Ra(e);return n===t||!xr(n)||vc(n)?!1:Ii(n).position==="fixed"||IP(n,t)}function wz(e,t){const n=t.get(e);if(n)return n;let r=pd(e,[],!1).filter(s=>xr(s)&&Oc(s)!=="body"),i=null;const o=Ii(e).position==="fixed";let a=o?Ra(e):e;for(;xr(a)&&!vc(a);){const s=Ii(a),u=Mw(a);!u&&s.position==="fixed"&&(i=null),(o?!u&&!i:!u&&s.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||jd(a)&&!u&&IP(e,a))?r=r.filter(l=>l!==a):i=s,a=Ra(a)}return t.set(e,r),r}function xz(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e;const a=[...n==="clippingAncestors"?sm(t)?[]:wz(t,this._c):[].concat(n),r],s=a[0],u=a.reduce((c,l)=>{const d=m2(t,l,i);return c.top=Mr(d.top,c.top),c.right=ua(d.right,c.right),c.bottom=ua(d.bottom,c.bottom),c.left=Mr(d.left,c.left),c},m2(t,s,i));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function Ez(e){const{width:t,height:n}=_P(e);return{width:t,height:n}}function Sz(e,t,n){const r=io(t),i=Do(t),o=n==="fixed",a=Ns(e,!0,o,t);let s={scrollLeft:0,scrollTop:0};const u=Ia(0);if(r||!r&&!o)if((Oc(t)!=="body"||jd(i))&&(s=um(t)),r){const d=Ns(t,!0,o,t);u.x=d.x+t.clientLeft,u.y=d.y+t.clientTop}else i&&(u.x=RP(i));const c=a.left+s.scrollLeft-u.x,l=a.top+s.scrollTop-u.y;return{x:c,y:l,width:a.width,height:a.height}}function u0(e){return Ii(e).position==="static"}function g2(e,t){return!io(e)||Ii(e).position==="fixed"?null:t?t(e):e.offsetParent}function TP(e,t){const n=Ur(e);if(sm(e))return n;if(!io(e)){let i=Ra(e);for(;i&&!vc(i);){if(xr(i)&&!u0(i))return i;i=Ra(i)}return n}let r=g2(e,t);for(;r&&YU(r)&&u0(r);)r=g2(r,t);return r&&vc(r)&&u0(r)&&!Mw(r)?n:r||QU(e)||n}const Cz=async function(e){const t=this.getOffsetParent||TP,n=this.getDimensions,r=await n(e.floating);return{reference:Sz(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function _z(e){return Ii(e).direction==="rtl"}const kz={convertOffsetParentRelativeRectToViewportRelativeRect:vz,getDocumentElement:Do,getClippingRect:xz,getOffsetParent:TP,getElementRects:Cz,getClientRects:mz,getDimensions:Ez,getScale:$u,isElement:xr,isRTL:_z};function Rz(e,t){let n=null,r;const i=Do(e);function o(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function a(s,u){s===void 0&&(s=!1),u===void 0&&(u=1),o();const{left:c,top:l,width:d,height:f}=e.getBoundingClientRect();if(s||t(),!d||!f)return;const h=Uf(l),p=Uf(i.clientWidth-(c+d)),m=Uf(i.clientHeight-(l+f)),g=Uf(c),y={rootMargin:-h+"px "+-p+"px "+-m+"px "+-g+"px",threshold:Mr(0,ua(1,u))||1};let b=!0;function w(E){const x=E[0].intersectionRatio;if(x!==u){if(!b)return a();x?a(!1,x):r=setTimeout(()=>{a(!1,1e-7)},1e3)}b=!1}try{n=new IntersectionObserver(w,{...y,root:i.ownerDocument})}catch{n=new IntersectionObserver(w,y)}n.observe(e)}return a(!0),o}function Iz(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,c=Fw(e),l=i||o?[...c?pd(c):[],...pd(t)]:[];l.forEach(v=>{i&&v.addEventListener("scroll",n,{passive:!0}),o&&v.addEventListener("resize",n)});const d=c&&s?Rz(c,n):null;let f=-1,h=null;a&&(h=new ResizeObserver(v=>{let[y]=v;y&&y.target===c&&h&&(h.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var b;(b=h)==null||b.observe(t)})),n()}),c&&!u&&h.observe(c),h.observe(t));let p,m=u?Ns(e):null;u&&g();function g(){const v=Ns(e);m&&(v.x!==m.x||v.y!==m.y||v.width!==m.width||v.height!==m.height)&&n(),m=v,p=requestAnimationFrame(g)}return n(),()=>{var v;l.forEach(y=>{i&&y.removeEventListener("scroll",n),o&&y.removeEventListener("resize",n)}),d==null||d(),(v=h)==null||v.disconnect(),h=null,u&&cancelAnimationFrame(p)}}const c0=cm,Tz=lz,Oz=dz,Pz=uz,Nz=fz,Dz=(e,t,n)=>{const r=new Map,i={platform:kz,...n},o={...i.platform,_c:r};return sz(e,t,{...i,platform:o})};var Vh=typeof document<"u"?O.useLayoutEffect:O.useEffect;function Wp(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!Wp(e[r],t[r]))return!1;return!0}if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,i[r]))return!1;for(r=n;r--!==0;){const o=i[r];if(!(o==="_owner"&&e.$$typeof)&&!Wp(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function OP(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function y2(e,t){const n=OP(e);return Math.round(t*n)/n}function b2(e){const t=O.useRef(e);return Vh(()=>{t.current=e}),t}function Az(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:o,floating:a}={},transform:s=!0,whileElementsMounted:u,open:c}=e,[l,d]=O.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,h]=O.useState(r);Wp(f,r)||h(r);const[p,m]=O.useState(null),[g,v]=O.useState(null),y=O.useCallback(I=>{I!==x.current&&(x.current=I,m(I))},[]),b=O.useCallback(I=>{I!==R.current&&(R.current=I,v(I))},[]),w=o||p,E=a||g,x=O.useRef(null),R=O.useRef(null),S=O.useRef(l),_=u!=null,T=b2(u),B=b2(i),L=O.useCallback(()=>{if(!x.current||!R.current)return;const I={placement:t,strategy:n,middleware:f};B.current&&(I.platform=B.current),Dz(x.current,R.current,I).then(N=>{const j={...N,isPositioned:!0};k.current&&!Wp(S.current,j)&&(S.current=j,_r.flushSync(()=>{d(j)}))})},[f,t,n,B]);Vh(()=>{c===!1&&S.current.isPositioned&&(S.current.isPositioned=!1,d(I=>({...I,isPositioned:!1})))},[c]);const k=O.useRef(!1);Vh(()=>(k.current=!0,()=>{k.current=!1}),[]),Vh(()=>{if(w&&(x.current=w),E&&(R.current=E),w&&E){if(T.current)return T.current(w,E,L);L()}},[w,E,L,T,_]);const D=O.useMemo(()=>({reference:x,floating:R,setReference:y,setFloating:b}),[y,b]),F=O.useMemo(()=>({reference:w,floating:E}),[w,E]),M=O.useMemo(()=>{const I={position:n,left:0,top:0};if(!F.floating)return I;const N=y2(F.floating,l.x),j=y2(F.floating,l.y);return s?{...I,transform:"translate("+N+"px, "+j+"px)",...OP(F.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:N,top:j}},[n,s,F.floating,l.x,l.y]);return O.useMemo(()=>({...l,update:L,refs:D,elements:F,floatingStyles:M}),[l,L,D,F,M])}const PP=(e,t)=>({...Tz(e),options:[e,t]}),Mz=(e,t)=>({...Oz(e),options:[e,t]}),Lz=(e,t)=>({...Pz(e),options:[e,t]}),Fz=(e,t)=>({...Nz(e),options:[e,t]}),NP={...zh},Bz=NP.useInsertionEffect,jz=Bz||(e=>e());function DP(e){const t=O.useRef(()=>{});return jz(()=>{t.current=e}),O.useCallback(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.current==null?void 0:t.current(...r)},[])}var $1=typeof document<"u"?O.useLayoutEffect:O.useEffect;let w2=!1,$z=0;const x2=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+$z++;function Vz(){const[e,t]=O.useState(()=>w2?x2():void 0);return $1(()=>{e==null&&t(x2())},[]),O.useEffect(()=>{w2=!0},[]),e}const Wz=NP.useId,Uz=Wz||Vz;function zz(){const e=new Map;return{emit(t,n){var r;(r=e.get(t))==null||r.forEach(i=>i(n))},on(t,n){e.set(t,[...e.get(t)||[],n])},off(t,n){var r;e.set(t,((r=e.get(t))==null?void 0:r.filter(i=>i!==n))||[])}}}const Hz=O.createContext(null),Gz=O.createContext(null),qz=()=>{var e;return((e=O.useContext(Hz))==null?void 0:e.id)||null},Xz=()=>O.useContext(Gz);function Kz(e){const{open:t=!1,onOpenChange:n,elements:r}=e,i=Uz(),o=O.useRef({}),[a]=O.useState(()=>zz()),s=qz()!=null,[u,c]=O.useState(r.reference),l=DP((h,p,m)=>{o.current.openEvent=h?p:void 0,a.emit("openchange",{open:h,event:p,reason:m,nested:s}),n==null||n(h,p,m)}),d=O.useMemo(()=>({setPositionReference:c}),[]),f=O.useMemo(()=>({reference:u||r.reference||null,floating:r.floating||null,domReference:r.reference}),[u,r.reference,r.floating]);return O.useMemo(()=>({dataRef:o,open:t,onOpenChange:l,elements:f,events:a,floatingId:i,refs:d}),[t,l,f,a,i,d])}function Yz(e){e===void 0&&(e={});const{nodeId:t}=e,n=Kz({...e,elements:{reference:null,floating:null,...e.elements}}),r=e.rootContext||n,i=r.elements,[o,a]=O.useState(null),[s,u]=O.useState(null),l=(i==null?void 0:i.reference)||o,d=O.useRef(null),f=Xz();$1(()=>{l&&(d.current=l)},[l]);const h=Az({...e,elements:{...i,...s&&{reference:s}}}),p=O.useCallback(b=>{const w=xr(b)?{getBoundingClientRect:()=>b.getBoundingClientRect(),contextElement:b}:b;u(w),h.refs.setReference(w)},[h.refs]),m=O.useCallback(b=>{(xr(b)||b===null)&&(d.current=b,a(b)),(xr(h.refs.reference.current)||h.refs.reference.current===null||b!==null&&!xr(b))&&h.refs.setReference(b)},[h.refs]),g=O.useMemo(()=>({...h.refs,setReference:m,setPositionReference:p,domReference:d}),[h.refs,m,p]),v=O.useMemo(()=>({...h.elements,domReference:l}),[h.elements,l]),y=O.useMemo(()=>({...h,...r,refs:g,elements:v,nodeId:t}),[h,g,v,t,r]);return $1(()=>{r.dataRef.current.floatingContext=y;const b=f==null?void 0:f.nodesRef.current.find(w=>w.id===t);b&&(b.context=y)}),O.useMemo(()=>({...h,context:y,refs:g,elements:v}),[h,g,v,y])}const E2="active",S2="selected";function l0(e,t,n){const r=new Map,i=n==="item";let o=e;if(i&&e){const{[E2]:a,[S2]:s,...u}=e;o=u}return{...n==="floating"&&{tabIndex:-1},...o,...t.map(a=>{const s=a?a[n]:null;return typeof s=="function"?e?s(e):null:s}).concat(e).reduce((a,s)=>(s&&Object.entries(s).forEach(u=>{let[c,l]=u;if(!(i&&[E2,S2].includes(c)))if(c.indexOf("on")===0){if(r.has(c)||r.set(c,[]),typeof l=="function"){var d;(d=r.get(c))==null||d.push(l),a[c]=function(){for(var f,h=arguments.length,p=new Array(h),m=0;m<h;m++)p[m]=arguments[m];return(f=r.get(c))==null?void 0:f.map(g=>g(...p)).find(g=>g!==void 0)}}}else a[c]=l}),a),{})}}function Qz(e){e===void 0&&(e=[]);const t=e,n=O.useCallback(o=>l0(o,e,"reference"),t),r=O.useCallback(o=>l0(o,e,"floating"),t),i=O.useCallback(o=>l0(o,e,"item"),e.map(o=>o==null?void 0:o.item));return O.useMemo(()=>({getReferenceProps:n,getFloatingProps:r,getItemProps:i}),[n,r,i])}function C2(e,t){return{...e,rects:{...e.rects,floating:{...e.rects.floating,height:t}}}}const Jz=e=>({name:"inner",options:e,async fn(t){const{listRef:n,overflowRef:r,onFallbackChange:i,offset:o=0,index:a=0,minItemsVisible:s=4,referenceOverflowThreshold:u=0,scrollRef:c,...l}=e,{rects:d,elements:{floating:f}}=t,h=n.current[a];if(!h)return{};const p={...t,...await PP(-h.offsetTop-f.clientTop-d.reference.height/2-h.offsetHeight/2-o).fn(t)},m=(c==null?void 0:c.current)||f,g=await c0(C2(p,m.scrollHeight),l),v=await c0(p,{...l,elementContext:"reference"}),y=Math.max(0,g.top),b=p.y+y,w=Math.max(0,m.scrollHeight-y-Math.max(0,g.bottom));return m.style.maxHeight=w+"px",m.scrollTop=y,i&&(m.offsetHeight<h.offsetHeight*Math.min(s,n.current.length-1)-1||v.top>=-u||v.bottom>=-u?_r.flushSync(()=>i(!0)):_r.flushSync(()=>i(!1))),r&&(r.current=await c0(C2({...p,y:b},m.offsetHeight),l)),{y:b}}});function Zz(e,t){const{open:n,elements:r}=e,{enabled:i=!0,overflowRef:o,scrollRef:a,onChange:s}=t,u=DP(s),c=O.useRef(!1),l=O.useRef(null),d=O.useRef(null);return O.useEffect(()=>{if(!i)return;function f(p){if(p.ctrlKey||!h||o.current==null)return;const m=p.deltaY,g=o.current.top>=-.5,v=o.current.bottom>=-.5,y=h.scrollHeight-h.clientHeight,b=m<0?-1:1,w=m<0?"max":"min";h.scrollHeight<=h.clientHeight||(!g&&m>0||!v&&m<0?(p.preventDefault(),_r.flushSync(()=>{u(E=>E+Math[w](m,y*b))})):/firefox/i.test(JU())&&(h.scrollTop+=m))}const h=(a==null?void 0:a.current)||r.floating;if(n&&h)return h.addEventListener("wheel",f),requestAnimationFrame(()=>{l.current=h.scrollTop,o.current!=null&&(d.current={...o.current})}),()=>{l.current=null,d.current=null,h.removeEventListener("wheel",f)}},[i,n,r.floating,o,a,u]),O.useMemo(()=>i?{floating:{onKeyDown(){c.current=!0},onWheel(){c.current=!1},onPointerMove(){c.current=!1},onScroll(){const f=(a==null?void 0:a.current)||r.floating;if(!(!o.current||!f||!c.current)){if(l.current!==null){const h=f.scrollTop-l.current;(o.current.bottom<-.5&&h<-1||o.current.top<-.5&&h>1)&&_r.flushSync(()=>u(p=>p+h))}requestAnimationFrame(()=>{l.current=f.scrollTop})}}}}:{},[i,o,r.floating,a,u])}let Pc=O.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});Pc.displayName="FloatingContext";let Bw=O.createContext(null);Bw.displayName="PlacementContext";function e8(e){return O.useMemo(()=>e?typeof e=="string"?{to:e}:e:null,[e])}function t8(){return O.useContext(Pc).setReference}function n8(){return O.useContext(Pc).getReferenceProps}function r8(){let{getFloatingProps:e,slot:t}=O.useContext(Pc);return O.useCallback((...n)=>Object.assign({},e(...n),{"data-anchor":t.anchor}),[e,t])}function i8(e=null){e===!1&&(e=null),typeof e=="string"&&(e={to:e});let t=O.useContext(Bw),n=O.useMemo(()=>e,[JSON.stringify(e,typeof HTMLElement<"u"?(i,o)=>o instanceof HTMLElement?o.outerHTML:o:void 0)]);Ht(()=>{t==null||t(n??null)},[t,n]);let r=O.useContext(Pc);return O.useMemo(()=>[r.setFloating,e?r.styles:{}],[r.setFloating,e,r.styles])}let _2=4;function o8({children:e,enabled:t=!0}){let[n,r]=O.useState(null),[i,o]=O.useState(0),a=O.useRef(null),[s,u]=O.useState(null);a8(s);let c=t&&n!==null&&s!==null,{to:l="bottom",gap:d=0,offset:f=0,padding:h=0,inner:p}=s8(n,s),[m,g="center"]=l.split(" ");Ht(()=>{c&&o(0)},[c]);let{refs:v,floatingStyles:y,context:b}=Yz({open:c,placement:m==="selection"?g==="center"?"bottom":`bottom-${g}`:g==="center"?`${m}`:`${m}-${g}`,strategy:"absolute",transform:!1,middleware:[PP({mainAxis:m==="selection"?0:d,crossAxis:f}),Mz({padding:h}),m!=="selection"&&Lz({padding:h}),m==="selection"&&p?Jz({...p,padding:h,overflowRef:a,offset:i,minItemsVisible:_2,referenceOverflowThreshold:h,onFallbackChange(B){var L,k;if(!B)return;let D=b.elements.floating;if(!D)return;let F=parseFloat(getComputedStyle(D).scrollPaddingBottom)||0,M=Math.min(_2,D.childElementCount),I=0,N=0;for(let j of(k=(L=b.elements.floating)==null?void 0:L.childNodes)!=null?k:[])if(j instanceof HTMLElement){let P=j.offsetTop,A=P+j.clientHeight+F,U=D.scrollTop,H=U+D.clientHeight;if(P>=U&&A<=H)M--;else{N=Math.max(0,Math.min(A,H)-Math.max(P,U)),I=j.clientHeight;break}}M>=1&&o(j=>{let P=I*M-N+F;return j>=P?j:P})}}):null,Fz({padding:h,apply({availableWidth:B,availableHeight:L,elements:k}){Object.assign(k.floating.style,{overflow:"auto",maxWidth:`${B}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${L}px)`})}})].filter(Boolean),whileElementsMounted:Iz}),[w=m,E=g]=b.placement.split("-");m==="selection"&&(w="selection");let x=O.useMemo(()=>({anchor:[w,E].filter(Boolean).join(" ")}),[w,E]),R=Zz(b,{overflowRef:a,onChange:o}),{getReferenceProps:S,getFloatingProps:_}=Qz([R]),T=Mt(B=>{u(B),v.setFloating(B)});return O.createElement(Bw.Provider,{value:r},O.createElement(Pc.Provider,{value:{setFloating:T,setReference:v.setReference,styles:y,getReferenceProps:S,getFloatingProps:_,slot:x}},e))}function a8(e){Ht(()=>{if(!e)return;let t=new MutationObserver(()=>{let n=window.getComputedStyle(e).maxHeight,r=parseFloat(n);if(isNaN(r))return;let i=parseInt(n);isNaN(i)||r!==i&&(e.style.maxHeight=`${Math.ceil(r)}px`)});return t.observe(e,{attributes:!0,attributeFilter:["style"]}),()=>{t.disconnect()}},[e])}function s8(e,t){var n,r,i;let o=d0((n=e==null?void 0:e.gap)!=null?n:"var(--anchor-gap, 0)",t),a=d0((r=e==null?void 0:e.offset)!=null?r:"var(--anchor-offset, 0)",t),s=d0((i=e==null?void 0:e.padding)!=null?i:"var(--anchor-padding, 0)",t);return{...e,gap:o,offset:a,padding:s}}function d0(e,t,n=void 0){let r=om(),i=Mt((u,c)=>{if(u==null)return[n,null];if(typeof u=="number")return[u,null];if(typeof u=="string"){if(!c)return[n,null];let l=k2(u,c);return[l,d=>{let f=AP(u);{let h=f.map(p=>window.getComputedStyle(c).getPropertyValue(p));r.requestAnimationFrame(function p(){r.nextFrame(p);let m=!1;for(let[v,y]of f.entries()){let b=window.getComputedStyle(c).getPropertyValue(y);if(h[v]!==b){h[v]=b,m=!0;break}}if(!m)return;let g=k2(u,c);l!==g&&(d(g),l=g)})}return r.dispose}]}return[n,null]}),o=O.useMemo(()=>i(e,t)[0],[e,t]),[a=o,s]=O.useState();return Ht(()=>{let[u,c]=i(e,t);if(s(u),!!c)return c(s)},[e,t]),a}function AP(e){let t=/var\((.*)\)/.exec(e);if(t){let n=t[1].indexOf(",");if(n===-1)return[t[1]];let r=t[1].slice(0,n).trim(),i=t[1].slice(n+1).trim();return i?[r,...AP(i)]:[r]}return[]}function k2(e,t){let n=document.createElement("div");t.appendChild(n),n.style.setProperty("margin-top","0px","important"),n.style.setProperty("margin-top",e,"important");let r=parseFloat(window.getComputedStyle(n).marginTop)||0;return t.removeChild(n),r}let jw=O.createContext(null);jw.displayName="OpenClosedContext";var vd=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(vd||{});function u8(){return O.useContext(jw)}function c8({value:e,children:t}){return we.createElement(jw.Provider,{value:e},t)}function l8(e){throw new Error("Unexpected object: "+e)}var Gn=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(Gn||{});function f0(e,t){let n=t.resolveItems();if(n.length<=0)return null;let r=t.resolveActiveIndex(),i=r??-1;switch(e.focus){case 0:{for(let o=0;o<n.length;++o)if(!t.resolveDisabled(n[o],o,n))return o;return r}case 1:{i===-1&&(i=n.length);for(let o=i-1;o>=0;--o)if(!t.resolveDisabled(n[o],o,n))return o;return r}case 2:{for(let o=i+1;o<n.length;++o)if(!t.resolveDisabled(n[o],o,n))return o;return r}case 3:{for(let o=n.length-1;o>=0;--o)if(!t.resolveDisabled(n[o],o,n))return o;return r}case 4:{for(let o=0;o<n.length;++o)if(t.resolveId(n[o],o,n)===e.id)return o;return r}case 5:return null;default:l8(e)}}function d8(e){let t=Mt(e),n=O.useRef(!1);O.useEffect(()=>(n.current=!1,()=>{n.current=!0,sP(()=>{n.current&&t()})}),[t])}function f8(){let e=typeof document>"u";return"useSyncExternalStore"in zh?(t=>t.useSyncExternalStore)(zh)(()=>()=>{},()=>!1,()=>!e):!1}function h8(){let e=f8(),[t,n]=O.useState(bs.isHandoffComplete);return t&&bs.isHandoffComplete===!1&&n(!1),O.useEffect(()=>{t!==!0&&n(!0)},[t]),O.useEffect(()=>bs.handoff(),[]),e?!1:t}let p8=O.createContext(!1);function v8(){return O.useContext(p8)}function m8(e){let t=v8(),n=O.useContext(LP),r=Aw(e),[i,o]=O.useState(()=>{var a;if(!t&&n!==null)return(a=n.current)!=null?a:null;if(bs.isServer)return null;let s=r==null?void 0:r.getElementById("headlessui-portal-root");if(s)return s;if(r===null)return null;let u=r.createElement("div");return u.setAttribute("id","headlessui-portal-root"),r.body.appendChild(u)});return O.useEffect(()=>{i!==null&&(r!=null&&r.body.contains(i)||r==null||r.body.appendChild(i))},[i,r]),O.useEffect(()=>{t||n!==null&&o(n.current)},[n,o,t]),i}let MP=O.Fragment,g8=li(function(e,t){let n=e,r=O.useRef(null),i=No(iU(l=>{r.current=l}),t),o=Aw(r),a=m8(r),[s]=O.useState(()=>{var l;return bs.isServer?null:(l=o==null?void 0:o.createElement("div"))!=null?l:null}),u=O.useContext(x8),c=h8();return Ht(()=>{!a||!s||a.contains(s)||(s.setAttribute("data-headlessui-portal",""),a.appendChild(s))},[a,s]),Ht(()=>{if(s&&u)return u.register(s)},[u,s]),d8(()=>{var l;!a||!s||(s instanceof Node&&a.contains(s)&&a.removeChild(s),a.childNodes.length<=0&&((l=a.parentElement)==null||l.removeChild(a)))}),c?!a||!s?null:_r.createPortal(ci({ourProps:{ref:i},theirProps:n,slot:{},defaultTag:MP,name:"Portal"}),s):null});function y8(e,t){let n=No(t),{enabled:r=!0,...i}=e;return r?we.createElement(g8,{...i,ref:n}):ci({ourProps:{ref:n},theirProps:i,slot:{},defaultTag:MP,name:"Portal"})}let b8=O.Fragment,LP=O.createContext(null);function w8(e,t){let{target:n,...r}=e,i={ref:No(t)};return we.createElement(LP.Provider,{value:n},ci({ourProps:i,theirProps:r,defaultTag:b8,name:"Popover.Group"}))}let x8=O.createContext(null),E8=li(y8),S8=li(w8),C8=Object.assign(E8,{Group:S8});function _8(e,t){let n=O.useRef({left:0,top:0});if(Ht(()=>{let i=t.current;if(!i)return;let o=i.getBoundingClientRect();o&&(n.current=o)},[e]),t.current==null||!e||t.current===document.activeElement)return!1;let r=t.current.getBoundingClientRect();return r.top!==n.current.top||r.left!==n.current.left}let R2=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function I2(e){var t,n;let r=(t=e.innerText)!=null?t:"",i=e.cloneNode(!0);if(!(i instanceof HTMLElement))return r;let o=!1;for(let s of i.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))s.remove(),o=!0;let a=o?(n=i.innerText)!=null?n:"":r;return R2.test(a)&&(a=a.replace(R2,"")),a}function k8(e){let t=e.getAttribute("aria-label");if(typeof t=="string")return t.trim();let n=e.getAttribute("aria-labelledby");if(n){let r=n.split(" ").map(i=>{let o=document.getElementById(i);if(o){let a=o.getAttribute("aria-label");return typeof a=="string"?a.trim():I2(o).trim()}return null}).filter(Boolean);if(r.length>0)return r.join(", ")}return I2(e).trim()}function R8(e){let t=O.useRef(""),n=O.useRef("");return Mt(()=>{let r=e.current;if(!r)return"";let i=r.innerText;if(t.current===i)return n.current;let o=k8(r).trim().toLowerCase();return t.current=i,n.current=o,o})}var I8=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(I8||{}),T8=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(T8||{}),O8=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItem=5]="RegisterItem",e[e.UnregisterItem=6]="UnregisterItem",e))(O8||{});function h0(e,t=n=>n){let n=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,r=yP(t(e.items.slice()),o=>o.dataRef.current.domRef.current),i=n?r.indexOf(n):null;return i===-1&&(i=null),{items:r,activeItemIndex:i}}let P8={1(e){return e.menuState===1?e:{...e,activeItemIndex:null,menuState:1}},0(e){return e.menuState===0?e:{...e,__demoMode:!1,menuState:0}},2:(e,t)=>{var n,r,i,o,a;if(e.menuState===1)return e;let s={...e,searchQuery:"",activationTrigger:(n=t.trigger)!=null?n:1,__demoMode:!1};if(t.focus===Gn.Nothing)return{...s,activeItemIndex:null};if(t.focus===Gn.Specific)return{...s,activeItemIndex:e.items.findIndex(l=>l.id===t.id)};if(t.focus===Gn.Previous){let l=e.activeItemIndex;if(l!==null){let d=e.items[l].dataRef.current.domRef,f=f0(t,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:h=>h.id,resolveDisabled:h=>h.dataRef.current.disabled});if(f!==null){let h=e.items[f].dataRef.current.domRef;if(((r=d.current)==null?void 0:r.previousElementSibling)===h.current||((i=h.current)==null?void 0:i.previousElementSibling)===null)return{...s,activeItemIndex:f}}}}else if(t.focus===Gn.Next){let l=e.activeItemIndex;if(l!==null){let d=e.items[l].dataRef.current.domRef,f=f0(t,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:h=>h.id,resolveDisabled:h=>h.dataRef.current.disabled});if(f!==null){let h=e.items[f].dataRef.current.domRef;if(((o=d.current)==null?void 0:o.nextElementSibling)===h.current||((a=h.current)==null?void 0:a.nextElementSibling)===null)return{...s,activeItemIndex:f}}}}let u=h0(e),c=f0(t,{resolveItems:()=>u.items,resolveActiveIndex:()=>u.activeItemIndex,resolveId:l=>l.id,resolveDisabled:l=>l.dataRef.current.disabled});return{...s,...u,activeItemIndex:c}},3:(e,t)=>{let n=e.searchQuery!==""?0:1,r=e.searchQuery+t.value.toLowerCase(),i=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+n).concat(e.items.slice(0,e.activeItemIndex+n)):e.items).find(a=>{var s;return((s=a.dataRef.current.textValue)==null?void 0:s.startsWith(r))&&!a.dataRef.current.disabled}),o=i?e.items.indexOf(i):-1;return o===-1||o===e.activeItemIndex?{...e,searchQuery:r}:{...e,searchQuery:r,activeItemIndex:o,activationTrigger:1}},4(e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},5:(e,t)=>{let n=h0(e,r=>[...r,{id:t.id,dataRef:t.dataRef}]);return{...e,...n}},6:(e,t)=>{let n=h0(e,r=>{let i=r.findIndex(o=>o.id===t.id);return i!==-1&&r.splice(i,1),r});return{...e,...n,activationTrigger:1}}},$w=O.createContext(null);$w.displayName="MenuContext";function lm(e){let t=O.useContext($w);if(t===null){let n=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,lm),n}return t}function N8(e,t){return Bd(t.type,P8,e,t)}let D8=O.Fragment;function A8(e,t){let{__demoMode:n=!1,...r}=e,i=O.useReducer(N8,{__demoMode:n,menuState:n?0:1,buttonRef:O.createRef(),itemsRef:O.createRef(),items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:o,itemsRef:a,buttonRef:s},u]=i,c=No(t);NU(o===0,[s,a],(h,p)=>{var m;u({type:1}),Dw(p,Nw.Loose)||(h.preventDefault(),(m=s.current)==null||m.focus())});let l=Mt(()=>{u({type:1})}),d=O.useMemo(()=>({open:o===0,close:l}),[o,l]),f={ref:c};return we.createElement(o8,null,we.createElement($w.Provider,{value:i},we.createElement(c8,{value:Bd(o,{0:vd.Open,1:vd.Closed})},ci({ourProps:f,theirProps:r,slot:d,defaultTag:D8,name:"Menu"}))))}let M8="button";function L8(e,t){var n;let r=O.useId(),{id:i=`headlessui-menu-button-${r}`,disabled:o=!1,autoFocus:a=!1,...s}=e,[u,c]=lm("Menu.Button"),l=n8(),d=No(u.buttonRef,t,t8()),f=Mt(R=>{switch(R.key){case Rn.Space:case Rn.Enter:case Rn.ArrowDown:R.preventDefault(),R.stopPropagation(),_r.flushSync(()=>c({type:0})),c({type:2,focus:Gn.First});break;case Rn.ArrowUp:R.preventDefault(),R.stopPropagation(),_r.flushSync(()=>c({type:0})),c({type:2,focus:Gn.Last});break}}),h=Mt(R=>{switch(R.key){case Rn.Space:R.preventDefault();break}}),p=Mt(R=>{var S;if(nU(R.currentTarget))return R.preventDefault();o||(u.menuState===0?(_r.flushSync(()=>c({type:1})),(S=u.buttonRef.current)==null||S.focus({preventScroll:!0})):(R.preventDefault(),c({type:0})))}),{isFocusVisible:m,focusProps:g}=zW({autoFocus:a}),{isHovered:v,hoverProps:y}=UW({isDisabled:o}),{pressed:b,pressProps:w}=YW({disabled:o}),E=O.useMemo(()=>({open:u.menuState===0,active:b||u.menuState===0,disabled:o,hover:v,focus:m,autofocus:a}),[u,v,m,b,o,a]),x=lP(l(),{ref:d,id:i,type:DU(e,u.buttonRef),"aria-haspopup":"menu","aria-controls":(n=u.itemsRef.current)==null?void 0:n.id,"aria-expanded":u.menuState===0,disabled:o||void 0,autoFocus:a,onKeyDown:f,onKeyUp:h,onClick:p},g,y,w);return ci({ourProps:x,theirProps:s,slot:E,defaultTag:M8,name:"Menu.Button"})}let F8="div",B8=M1.RenderStrategy|M1.Static;function j8(e,t){var n,r;let i=O.useId(),{id:o=`headlessui-menu-items-${i}`,anchor:a,portal:s=!1,modal:u=!0,transition:c=!1,...l}=e,d=e8(a),[f,h]=lm("Menu.Items"),[p,m]=i8(d),g=r8(),v=No(f.itemsRef,t,d?p:null),y=Aw(f.itemsRef);d&&(s=!0);let b=u8(),[w,E]=HU(c,f.itemsRef,b!==null?(b&vd.Open)===vd.Open:f.menuState===0);yU(w,f.buttonRef,()=>{h({type:1})});let x=f.__demoMode?!1:u&&f.menuState===0;jU(x,y);let R=f.__demoMode?!1:u&&f.menuState===0;gU(R,{allowed:Mt(()=>[f.buttonRef.current,f.itemsRef.current])});let S=f.menuState!==0,_=_8(S,f.buttonRef)?!1:w;O.useEffect(()=>{let F=f.itemsRef.current;F&&f.menuState===0&&F!==(y==null?void 0:y.activeElement)&&F.focus({preventScroll:!0})},[f.menuState,f.itemsRef,y,f.itemsRef.current]),KU(f.menuState===0,{container:f.itemsRef.current,accept(F){return F.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:F.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(F){F.setAttribute("role","none")}});let T=om(),B=Mt(F=>{var M,I,N;switch(T.dispose(),F.key){case Rn.Space:if(f.searchQuery!=="")return F.preventDefault(),F.stopPropagation(),h({type:3,value:F.key});case Rn.Enter:if(F.preventDefault(),F.stopPropagation(),h({type:1}),f.activeItemIndex!==null){let{dataRef:j}=f.items[f.activeItemIndex];(I=(M=j.current)==null?void 0:M.domRef.current)==null||I.click()}gP(f.buttonRef.current);break;case Rn.ArrowDown:return F.preventDefault(),F.stopPropagation(),h({type:2,focus:Gn.Next});case Rn.ArrowUp:return F.preventDefault(),F.stopPropagation(),h({type:2,focus:Gn.Previous});case Rn.Home:case Rn.PageUp:return F.preventDefault(),F.stopPropagation(),h({type:2,focus:Gn.First});case Rn.End:case Rn.PageDown:return F.preventDefault(),F.stopPropagation(),h({type:2,focus:Gn.Last});case Rn.Escape:F.preventDefault(),F.stopPropagation(),_r.flushSync(()=>h({type:1})),(N=f.buttonRef.current)==null||N.focus({preventScroll:!0});break;case Rn.Tab:F.preventDefault(),F.stopPropagation(),_r.flushSync(()=>h({type:1})),RU(f.buttonRef.current,F.shiftKey?B1.Previous:B1.Next);break;default:F.key.length===1&&(h({type:3,value:F.key}),T.setTimeout(()=>h({type:4}),350));break}}),L=Mt(F=>{switch(F.key){case Rn.Space:F.preventDefault();break}}),k=O.useMemo(()=>({open:f.menuState===0}),[f.menuState]),D=lP(d?g():{},{"aria-activedescendant":f.activeItemIndex===null||(n=f.items[f.activeItemIndex])==null?void 0:n.id,"aria-labelledby":(r=f.buttonRef.current)==null?void 0:r.id,id:o,onKeyDown:B,onKeyUp:L,role:"menu",tabIndex:f.menuState===0?0:void 0,ref:v,style:{...l.style,...m,"--button-width":pU(f.buttonRef,!0).width},...zU(E)});return we.createElement(C8,{enabled:s?e.static||w:!1},ci({ourProps:D,theirProps:l,slot:k,defaultTag:F8,features:B8,visible:_,name:"Menu.Items"}))}let $8=O.Fragment;function V8(e,t){let n=O.useId(),{id:r=`headlessui-menu-item-${n}`,disabled:i=!1,...o}=e,[a,s]=lm("Menu.Item"),u=a.activeItemIndex!==null?a.items[a.activeItemIndex].id===r:!1,c=O.useRef(null),l=No(t,c);Ht(()=>{if(!a.__demoMode&&a.menuState===0&&u&&a.activationTrigger!==0)return so().requestAnimationFrame(()=>{var _,T;(T=(_=c.current)==null?void 0:_.scrollIntoView)==null||T.call(_,{block:"nearest"})})},[a.__demoMode,c,u,a.menuState,a.activationTrigger,a.activeItemIndex]);let d=R8(c),f=O.useRef({disabled:i,domRef:c,get textValue(){return d()}});Ht(()=>{f.current.disabled=i},[f,i]),Ht(()=>(s({type:5,id:r,dataRef:f}),()=>s({type:6,id:r})),[f,r]);let h=Mt(()=>{s({type:1})}),p=Mt(_=>{if(i)return _.preventDefault();s({type:1}),gP(a.buttonRef.current)}),m=Mt(()=>{if(i)return s({type:2,focus:Gn.Nothing});s({type:2,focus:Gn.Specific,id:r})}),g=$U(),v=Mt(_=>{g.update(_),!i&&(u||s({type:2,focus:Gn.Specific,id:r,trigger:0}))}),y=Mt(_=>{g.wasMoved(_)&&(i||u||s({type:2,focus:Gn.Specific,id:r,trigger:0}))}),b=Mt(_=>{g.wasMoved(_)&&(i||u&&s({type:2,focus:Gn.Nothing}))}),[w,E]=hP(),[x,R]=oU(),S=O.useMemo(()=>({active:u,focus:u,disabled:i,close:h}),[u,i,h]);return we.createElement(E,null,we.createElement(R,null,ci({ourProps:{id:r,ref:l,role:"menuitem",tabIndex:i===!0?void 0:-1,"aria-disabled":i===!0?!0:void 0,"aria-labelledby":w,"aria-describedby":x,disabled:void 0,onClick:p,onFocus:m,onPointerEnter:v,onMouseEnter:v,onPointerMove:y,onMouseMove:y,onPointerLeave:b,onMouseLeave:b},theirProps:o,slot:S,defaultTag:$8,name:"Menu.Item"})))}let W8="div";function U8(e,t){let[n,r]=hP();return we.createElement(r,null,ci({ourProps:{ref:t,"aria-labelledby":n,role:"group"},theirProps:e,slot:{},defaultTag:W8,name:"Menu.Section"}))}let z8="header";function H8(e,t){let n=O.useId(),{id:r=`headlessui-menu-heading-${n}`,...i}=e,o=Ow();Ht(()=>o.register(r),[r,o.register]);let a={id:r,ref:t,role:"presentation",...o.props};return ci({ourProps:a,theirProps:i,slot:{},defaultTag:z8,name:"Menu.Heading"})}let G8="div";function q8(e,t){return ci({ourProps:{ref:t,role:"separator"},theirProps:e,slot:{},defaultTag:G8,name:"Menu.Separator"})}let X8=li(A8),FP=li(L8),BP=li(j8),jP=li(V8),K8=li(U8),Y8=li(H8),Q8=li(q8),J8=Object.assign(X8,{Button:FP,Items:BP,Item:jP,Section:K8,Heading:Y8,Separator:Q8});const Z8="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFwAAABYCAYAAAB4fpBOAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAcASURBVHgB7Z3/dds2EMfPfvm/3sDMBHUmEDtB0gnsTOB0ArkTxJ1AygRyJ6A6gZUJyEwQd4JvcAZo00qEA8gDQcn6vHePzyYIAsfj8fBTJzQxAJyZw7mRCydnnWMrXR6cNJ0jy8bI15OTkweaECeUGafg92SV+sFIQbpsnNzx0TyAb/TaYCUbuTZSYXwqI5dGzunQMZWcIY+Sd7EyMqNDA9aiKkyX2sgl7Tuwiq6xP9TYR8Vjeq4jltrI75QA1SgFNuKYG/lEw+BQro0uGiPf6Dnse2hDPXe/rrCSCnoZUg5haeRmkpENrFXX6Md32DeCI5cLUoLzwvBoqDbynqaEKdAc/aiMXMFaauoycih6if7Kn1NuXCUqxMHW/BmKltyj3IWRBeKpkCt+d4WuIwrLip5jBGsOpafi69GV3kPZK0y4ZddD8fVo9YlUNqcraU9AXLuB39gkoWO3QDHKXmBC7iMUxFl7OqVHKvua9hyER141tN0LbDRSB9ycn3hJBwJbb2C9OU3Q2xzU0jSZrcj2VftojJSpWmV4OTDR0g4+JBtoMPctzKEiuZ9+bcrwBynccB74hNW/2u7N4vtXAWW4h21VpihHqDsd5krdjUZXNuyrXKE/iwRlClV6//71gBuof6VhW6FaqDbHYQ3hu3DPGn2iM4S5ErVoBNaC7qEP56lm7bCxukTcg0aYK1GzHsS3XGOpoav0kLcw/H6QA/+alEB4yDmUGkoNMVdm6W2sQjMLsW5Na1lgPFakBKw/l5A/oLAdTT40XcklxkdtMAGya6mkDCTrrqFr3TXGR9sdSlHLzJfBQrhYbUQbeay7RdPK58K9VrsuFK2bFEHeUf2wD1pYPSQr53NPH+vTzrWSg78hxUKaQ0n5KKEUsbg+nFtPEr7Pk2foKvyK/KxJj7Qd92FoluEfsp1ou3jq+HtUOGyPWOm5YKncC5htAJkSlMFZ+Z0nydMb1Vq45E6+kC5TGAnSLsNSOP/oVlqF+/q6eabTmo54MTr6j/xu5fGNOu3+sYM1HQnF51YejfrU+e+iZyZ9STI6E0mKMmw85zh8PGcLl77WX0mfDeUnRb3+Fc6XrHCfO2H/nUI5XNmsVp7iu2TybMhfr0JSeBJLdGFUTitP4SZbGs+5R4X7wqOUVnhD+VhSOnyGJCo8mRW6MGpN49OYe0u+dgiiSyl6XqzBDY3PR0pL4zuZ06W0Vn5L43E7QiPuf8+54pQyYxTwF43zAd24e2Ulu8IdPEUspdI37h7ZmYTCXZjIClmSPkvOeyqbHLDCG8/50Xr1WCFG+IP2iYQPTyCs4E+c58jK/s1z7kGy8NG7UY1yuDO/tfY+iuJrboy8dXmNjT8IgX9scUEZwfNSv1XAuCGnudYaOhtQZt80k+oN+V/frCMzzhV8cdKOhf40P9z1YUwFr4Wzwr1NUZoQ7gGsadp4+6bEjyZew0YuSsAu9vV2lbCFS/3CJemPafai8/DbzQwa/mNCmw9IYwvf3rD/MxXhV3XXkylpZIU7Xz1z9y7IvqaFJz0fGnreXGxNefa3+uA51zyNLcA/xe07jQDS7INVIdG6nx118EVSq27CK6HgyfaFwnib2STd38rVw8dlN/GZkFg9Hke+XYNqJNj/BPJE2PPtCypP4hcTEgcWjCeNSnPQx2ABJVcDeSLs0+TRbtP+zpMnK3vwAirYRVj3JC+yHYMrIxvoLAyTXNXyp/8gctptDC7vBabLAgPeYMgLC853XSgtoYheboJ0ywG1qdHDxUBeWLDwXTwTLo6ycqRfDqhNjQilI6x+F1ImlZDBZ8XCTJEagUrH0EVVLpMZZGZ0mMpuqSEoHWHLK0sKfHJVQIHOBly/D9x76heymDe87QL79KTlcJ93XDvH4bCrjrpLvyMUd/2LB3VozLbqeB1wzc5ozrsjEOxSwYL8lG5CT2j6faMx8o4HP5zy11J6k/btrpPSIHJIi/AOdt05W3tBh0dhhK2a+7pDZt2WvpPinldOkbdCsgcnBR0m7ewBqQ3COzH/7UsQuskYf3Gv6IiPO6PsP6VEoQrnJ8thUkFHfkVDgTvaBU1160xFa+jINg1FbB8YtUM+wvfwey2wIV7EjJ1GTeZ0E26Olm5hZUdvjBk9e/ao9EcassqOXnrY+0c3XrF7aWjAlq+954c7S39HaZfgTY012VZn7/kugybkuzndHHve0OHD64MGT+zv7VK2cf0MSzrMvpSPWoux1JacuA4sdjFSN8A+wXV5dzL17Uuw/yM+FfZx43kcf/wuD5i+4nkax/4rehtTqRLTmhBU4YB+s2InsD7+Evl+ojfb4iu1sLAveN40sv0hau2FXA3Zxhk3w+9yL5DNrvBt8LxSrf1tTJazznHbMh/o5U+tt8IK3kxlBXLLD9iR3EYLXTuXAAAAAElFTkSuQmCC",eH="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAABYCAYAAABbJcGbAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAATYSURBVHgB7Z2LcdQwEIb3UsF1gDtIqCBHBUkHpIPQwdEBdJCjAqACmwoCFdhUcKGCH20sQx7n1VqSz5bO34zmMiM/pN+SvJZWmxVNCIC1+bk06cKkwv6u7d9PaWx6MOmnTT9Wq9UDnQpGrHOTtiaVCOfepE8mvaFcMZV7H0msPkq+B+WCFazG8aiTFtAU/hJtV5qK2qRzSgVT2DXacWcucFnWFJkVRcQUsDA/Jb1+K05NY9LGvIV/UySiCWdEuzI/O2rNiaE8NTMak/68yH9jr3tB/00Wn3vcGPG+01wwot1iOHu0ZsmGBsLn2C5YYzi3NAds5YdQ+ogl3P8aw82cLU0JWlNjEsEOlIVbYT2gPNOYLGi/ADRwlzxa98CwHnBcc8XcsFA+3RoT2FIDy3e8zzXoxpR7TPgNacXTGOAlHQPo3qBc4OhGp0dZ19CJN+5QYp/i3lGIeg6idSjF249aZnPxO4Vos5vigW7Mu6MxsDd3MduParSTDi4uKTZwt7ZpjUoFcE8+xH1RwN3aakoAtONd7ahLvLFO0dqSmTiEu8vG6zmOp5REa3sKZDt0TzFQPKHkpqlNma8cdQp/SUAeUJNrbQzasU6yRz+5rnGmuM9GyKsoQex67E445JpCsE9GYkOJAvcQ5P92dV2cEkbRXa+k811d9ULIqyhhbHf9KRxSCHlBwkk3TQWpDlLdncIVQl5D6dMIeeIY5xJOOvkXpU8j5BVCXpBwOSC5iQW1ON+bpsIf8iREuDjfdNPi/fBDhDtpFuE8WYTzZBHOk0U4TxbhPFmE82QRzpNFOE8W4TxZhPMkZD4udwops1c4xWKF98zCjBA/8iF4XkktTlqUfchhy6Otg1SP3ulzSThpbTGH9YYOqS6bvowzn5PodIS76RuyDgqH1h+koH7ms60nnG9CHoum8w+G2+0zSX8RCcfC9EH/4EMtjv3DCuqnovz4LOSxaLITDnS7UrLb/65wh2C2fSdr9i843Z9SRdlobl+epPEor5FxtAXoWt3+mQZw+/gy+URY6AFuT02m7A7WtLbZu+LHArp4Aueavj3OjpMZA82eDsge2NnZbFog7/8qXcZf9uNaH5DHuz1BJt+YRQ7gGPuXGeB+nG5ejZAf5raeNtJOyIab5FehRe5PsbvCPdFRcourhGtwc63QhsnI3Tuz+3pgN31XmKPdygrCZkf2wkSkOLPz7p9pQcuOg1s9BqWyre6eTns5UENDNirYozliWx2/QXNwiB6LR426UGrPwqChDUZQ0TLevYRF45b2b2/HMwPYZrylvFaxQqlMungqGvPqy8Ec0JjE4t2QvAKUM9zCKpPeGS3eHYp0qIpYiP/7UgvSwV4AN0L+B4rnQsEG+kchny0G7fYpFqzhNImnAtwbhKNNjMI9n5jWlw8ckRZiVEjxaXRPIzHm7Egl5PFbe0fh8KpbIeSnZ9gjZK1Sd/0t3KQ5QaGs3NchFbQP5E5x3XQXmKCLZQQo4pPba23hbsXd9UZtbVEjTx8CbdSYSnl4Zz91gZSZLnDyNem/aDhQ8hdKHQyPFRxCXmvA0I1LoeS5Boxxo+5n6xD0COJ326MGaJ4UtBZ/iXBKnOLaL9r45CWGU2LigFijmyMa0P4DDTZb2OQobOpMj27Govt/D1/msMfiLzAMVmKYL9spAAAAAElFTkSuQmCC",tH="/assets/Logo-C5MiY7aN.png",nH="/assets/help-CqRzbubt.png",dm="/assets/fire-BqIo3PKR.gif",$P="/assets/Wind-DjlgoHOC.gif",VP="/assets/bonfire-CHQGJO1i.gif",zf="/assets/loveMessage-BMWrjg3W.gif",rH="/assets/user-BDhR9gkj.gif",iH=["불구경","부채질","모닥불","마이페이지"],Hf=J.div`
	padding: 30px;
	background-color: #ffffff;
	border-radius: 8px;
	margin-bottom: 1rem;
	border: 4px solid #000000;
	height: 330px;
`,Ho=J.h3`
	display: flex;
	align-items: center;
	font-size: 1.5rem;
	margin-bottom: 1rem;
`,Gf=J.p`
	font-size: 1.1rem;
	margin-bottom: 1rem;
	line-height: 1.5;
`,p0=J.ol`
	margin-left: 1.5rem;
	margin-bottom: 1rem;
	list-style: decimal;
`,hi=J.li`
	margin-bottom: 0.5rem;
	font-size: 1rem;
`;function oH({onClose:e}){const[t,n]=O.useState(0),r=(o,a)=>{(o.key==="Enter"||o.key===" ")&&n(a)},i=o=>{o.target===o.currentTarget&&e()};return C.jsx(fO,{onClick:i,children:C.jsxs(k5,{borderColor:"#000000",children:[C.jsxs(hO,{children:[C.jsx(pO,{children:"배틀의 민족 사용 설명서"}),C.jsx(vO,{borderColor:"#000000",onClick:e,children:"X"})]}),C.jsxs(mO,{children:[C.jsx("ul",{className:"flex justify-center items-center my-4",children:iH.map((o,a)=>C.jsx("li",{style:{listStyle:"none"},children:C.jsx("button",{type:"button",onClick:()=>n(a),onKeyDown:s=>r(s,a),style:{cursor:"pointer",padding:"10px",color:t===a?"#F66C23":"#000",borderBottom:t===a?"2px solid #F66C23":"none",background:"none",border:"none",fontSize:"1.2rem"},"aria-pressed":t===a,children:o})},o))}),C.jsxs("div",{children:[t===0&&C.jsxs(Hf,{children:[C.jsxs(Ho,{children:[C.jsx("img",{src:dm,alt:"불구경 아이콘",style:{width:"35px",marginRight:"8px"}}),"불구경"]}),C.jsx(Gf,{children:"지금 이 순간, 전장 한복판에서 벌어지는 뜨거운 라이브 토론 현장을 실시간으로 구경할 수 있는 게시판입니다."}),C.jsxs(Ho,{children:[C.jsx("img",{src:zf,alt:"이용방법 아이콘",style:{width:"35px",marginRight:"8px"}}),"이용 방법"]}),C.jsxs(p0,{children:[C.jsx(hi,{children:"[불구경] 메뉴를 터치하세요."}),C.jsx(hi,{children:"진행중, 예정된, 종료된 라이브 토론 목록이 뜹니다."}),C.jsx(hi,{children:"구경하고 싶은 라이브를 골라 토론에 참여하거나, 라이브 카드 클릭시 상세 정보를 볼 수 있어요!"})]})]}),t===1&&C.jsxs(Hf,{children:[C.jsxs(Ho,{children:[C.jsx("img",{src:$P,alt:"부채질 아이콘",style:{width:"35px",marginRight:"8px"}}),"부채질"]}),C.jsx(Gf,{children:"토론 대결을 원하는 주제를 미리 확인하고, 사전 투표를 통해 사전 예약을 할 수 있는 게시판입니다."}),C.jsxs(Ho,{children:[C.jsx("img",{src:zf,alt:"이용방법 아이콘",style:{width:"35px",marginRight:"8px"}}),"이용 방법"]}),C.jsxs(p0,{children:[C.jsx(hi,{children:"[부채질] 메뉴를 눌러보세요."}),C.jsx(hi,{children:"곧 펼쳐질 라이브 토론 목록이 쫘르르 펼쳐집니다."}),C.jsx(hi,{children:"마음에 드는 주제를 골라 사전 투표 & 참석 신청을 완료하세요."})]})]}),t===2&&C.jsxs(Hf,{children:[C.jsxs(Ho,{children:[C.jsx("img",{src:VP,alt:"모닥불 아이콘",style:{width:"35px",marginRight:"8px"}}),"모닥불"]}),C.jsx(Gf,{children:"이곳은 각종 밸런스 게임이 벌어지는 장소입니다. 간단한 주제, 진지한 고민 가리지 말고 올려보세요!"}),C.jsxs(Ho,{children:[C.jsx("img",{src:zf,alt:"이용방법 아이콘",style:{width:"35px",marginRight:"8px"}}),"이용 방법"]}),C.jsxs(p0,{children:[C.jsx(hi,{children:"[모닥불] 메뉴를 클릭!"}),C.jsx(hi,{children:"다양한 주제의 밸런스 게임이 등장합니다."}),C.jsx(hi,{children:"투표에 참여하고, 결과를 확인하며 다른 이들의 의견을 들어보세요!"})]})]}),t===3&&C.jsxs(Hf,{children:[C.jsxs(Ho,{children:[C.jsx("img",{src:rH,alt:"마이페이지 아이콘",style:{width:"35px",marginRight:"8px"}}),"마이페이지"]}),C.jsx(Gf,{children:"프로필 이미지를 클릭하여 마이페이지에 접속해보세요. 승률, 개최한 라이브, 참여한 투표를 조회하고, 관심사를 등록할 수 있어요!"}),C.jsxs(Ho,{children:[C.jsx("img",{src:zf,alt:"이용방법 아이콘",style:{width:"35px",marginRight:"8px"}}),"이용 방법"]}),C.jsx(hi,{children:"참여한 투표: 승/패/무를 통해 간편하게 내가 참여한 투표의 결과를 확인하세요."}),C.jsx(hi,{children:"관심사: 관심사를 등록하고 메인에서 먼저 확인 할 수 있어요."})]})]})]})]})})}const Kn={login:async e=>{try{const t=await We.post("/auth/login",e);return t.data.code==="success"&&t.data.data&&Pn.getState().login(t.data.data),t.data}catch(t){throw console.error("Login Error: ",t),t}},join:async e=>{try{return(await We.post("/user/join",e)).data}catch(t){throw console.error("Join Error: ",t),t}},getUserInfo:async e=>{try{const t=e?`/user/profile/${e}`:"/user/profile",n=await We.get(t);return!e&&n.data.code==="success"&&n.data.data&&Pn.getState().setUser(n.data.data),n.data}catch(t){throw console.error("Get User Info Error: ",t),t}},logout:async()=>{try{await We.delete("/auth/logout"),Pn.getState().logout()}catch(e){throw console.error("Logout Error: ",e),e}},checkNicknameAvailability:async e=>{try{return(await We.get(`/user/check/nickname?nickname=${e}`)).data.data??!1}catch(t){throw console.error("Check Nickname Error: ",t),t}},checkEmailAvailability:async e=>{try{return(await We.get(`/user/check/email?email=${e}`)).data.data??!1}catch(t){throw console.error("Check Email Error: ",t),t}},searchUserByNickname:async e=>{try{return(await We.get(`/user?nickname=${encodeURIComponent(e)}`)).data}catch(t){throw console.error("Search User By Nickname Error: ",t),t}},updateUserProfile:async e=>{try{const t=await We.post("/user/profile",e);return t.data.code==="success"&&t.data.data&&Pn.getState().setUser(t.data.data),t.data}catch(t){throw t}},uploadProfileImage:async e=>{try{const t=await We.post("/user/upload",e,{headers:{"Content-Type":"multipart/form-data"}});return console.log(t),t.data}catch(t){throw console.log(t),t}},getProfileImage:async e=>{try{const t=await We.get(`/user/images/${e}`,{responseType:"blob"});return URL.createObjectURL(new Blob([t.data]))}catch(t){return console.error("Error fetching image:",t),null}},getLoginUserWinHistory:async()=>{try{const e=await We.get("/user/profile/win_rate");return console.log(e.data),e.data.data}catch(e){throw console.error("Failed to fetch user win history:",e),e}},getUserInterests:async()=>{try{return(await We.get("/user/interest")).data.data.category}catch(e){throw console.error("Failed to fetch user interests:",e),e}},postUserInterests:async e=>{try{return(await We.post("/user/interest",{category:e})).data}catch(t){throw console.error("Failed to post user interests:",t),t}},getUserCreatedLives:async()=>{try{const e=await We.get("/user/profile/create_lives");if(e.data.code==="success"&&e.data.data)return console.log(e),e.data.data;throw new Error(e.data.msg||"Failed to fetch created lives")}catch(e){throw console.error("Error fetching created lives: ",e),e}},getUserVotes:async()=>{try{const e=await We.get("/user/profile/votes");if(e.data.code==="success"&&e.data.data)return console.log(e),e.data.data;throw new Error(e.data.msg||"Failed to fetch vote infos")}catch(e){throw console.error("Error fetching user votes: ",e),e}},getVoteDetail:async e=>{try{const t=await We.get(`/user/profile/votes/${e}`);if(t.data.code==="success"&&t.data.data)return t.data.data;throw new Error(t.data.msg||"Failed to fetch vote detail")}catch(t){throw console.error("Error fetching vote detail: ",t),t}}},xl={LF:`
`,NULL:"\0"};class ia{constructor(t){const{command:n,headers:r,body:i,binaryBody:o,escapeHeaderValues:a,skipContentLengthHeader:s}=t;this.command=n,this.headers=Object.assign({},r||{}),o?(this._binaryBody=o,this.isBinaryBody=!0):(this._body=i||"",this.isBinaryBody=!1),this.escapeHeaderValues=a||!1,this.skipContentLengthHeader=s||!1}get body(){return!this._body&&this.isBinaryBody&&(this._body=new TextDecoder().decode(this._binaryBody)),this._body||""}get binaryBody(){return!this._binaryBody&&!this.isBinaryBody&&(this._binaryBody=new TextEncoder().encode(this._body)),this._binaryBody}static fromRawFrame(t,n){const r={},i=o=>o.replace(/^\s+|\s+$/g,"");for(const o of t.headers.reverse()){o.indexOf(":");const a=i(o[0]);let s=i(o[1]);n&&t.command!=="CONNECT"&&t.command!=="CONNECTED"&&(s=ia.hdrValueUnEscape(s)),r[a]=s}return new ia({command:t.command,headers:r,binaryBody:t.binaryBody,escapeHeaderValues:n})}toString(){return this.serializeCmdAndHeaders()}serialize(){const t=this.serializeCmdAndHeaders();return this.isBinaryBody?ia.toUnit8Array(t,this._binaryBody).buffer:t+this._body+xl.NULL}serializeCmdAndHeaders(){const t=[this.command];this.skipContentLengthHeader&&delete this.headers["content-length"];for(const n of Object.keys(this.headers||{})){const r=this.headers[n];this.escapeHeaderValues&&this.command!=="CONNECT"&&this.command!=="CONNECTED"?t.push(`${n}:${ia.hdrValueEscape(`${r}`)}`):t.push(`${n}:${r}`)}return(this.isBinaryBody||!this.isBodyEmpty()&&!this.skipContentLengthHeader)&&t.push(`content-length:${this.bodyLength()}`),t.join(xl.LF)+xl.LF+xl.LF}isBodyEmpty(){return this.bodyLength()===0}bodyLength(){const t=this.binaryBody;return t?t.length:0}static sizeOfUTF8(t){return t?new TextEncoder().encode(t).length:0}static toUnit8Array(t,n){const r=new TextEncoder().encode(t),i=new Uint8Array([0]),o=new Uint8Array(r.length+n.length+i.length);return o.set(r),o.set(n,r.length),o.set(i,r.length+n.length),o}static marshall(t){return new ia(t).serialize()}static hdrValueEscape(t){return t.replace(/\\/g,"\\\\").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/:/g,"\\c")}static hdrValueUnEscape(t){return t.replace(/\\r/g,"\r").replace(/\\n/g,`
`).replace(/\\c/g,":").replace(/\\\\/g,"\\")}}const T2=0,qf=10,Xf=13,aH=58;class sH{constructor(t,n){this.onFrame=t,this.onIncomingPing=n,this._encoder=new TextEncoder,this._decoder=new TextDecoder,this._token=[],this._initState()}parseChunk(t,n=!1){let r;if(typeof t=="string"?r=this._encoder.encode(t):r=new Uint8Array(t),n&&r[r.length-1]!==0){const i=new Uint8Array(r.length+1);i.set(r,0),i[r.length]=0,r=i}for(let i=0;i<r.length;i++){const o=r[i];this._onByte(o)}}_collectFrame(t){if(t!==T2&&t!==Xf){if(t===qf){this.onIncomingPing();return}this._onByte=this._collectCommand,this._reinjectByte(t)}}_collectCommand(t){if(t!==Xf){if(t===qf){this._results.command=this._consumeTokenAsUTF8(),this._onByte=this._collectHeaders;return}this._consumeByte(t)}}_collectHeaders(t){if(t!==Xf){if(t===qf){this._setupCollectBody();return}this._onByte=this._collectHeaderKey,this._reinjectByte(t)}}_reinjectByte(t){this._onByte(t)}_collectHeaderKey(t){if(t===aH){this._headerKey=this._consumeTokenAsUTF8(),this._onByte=this._collectHeaderValue;return}this._consumeByte(t)}_collectHeaderValue(t){if(t!==Xf){if(t===qf){this._results.headers.push([this._headerKey,this._consumeTokenAsUTF8()]),this._headerKey=void 0,this._onByte=this._collectHeaders;return}this._consumeByte(t)}}_setupCollectBody(){const t=this._results.headers.filter(n=>n[0]==="content-length")[0];t?(this._bodyBytesRemaining=parseInt(t[1],10),this._onByte=this._collectBodyFixedSize):this._onByte=this._collectBodyNullTerminated}_collectBodyNullTerminated(t){if(t===T2){this._retrievedBody();return}this._consumeByte(t)}_collectBodyFixedSize(t){if(this._bodyBytesRemaining--===0){this._retrievedBody();return}this._consumeByte(t)}_retrievedBody(){this._results.binaryBody=this._consumeTokenAsRaw();try{this.onFrame(this._results)}catch(t){console.log("Ignoring an exception thrown by a frame handler. Original exception: ",t)}this._initState()}_consumeByte(t){this._token.push(t)}_consumeTokenAsUTF8(){return this._decoder.decode(this._consumeTokenAsRaw())}_consumeTokenAsRaw(){const t=new Uint8Array(this._token);return this._token=[],t}_initState(){this._results={command:void 0,headers:[],binaryBody:void 0},this._token=[],this._headerKey=void 0,this._onByte=this._collectFrame}}var bo;(function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"})(bo=bo||(bo={}));var Kr;(function(e){e[e.ACTIVE=0]="ACTIVE",e[e.DEACTIVATING=1]="DEACTIVATING",e[e.INACTIVE=2]="INACTIVE"})(Kr=Kr||(Kr={}));class sr{constructor(t){this.versions=t}supportedVersions(){return this.versions.join(",")}protocolVersions(){return this.versions.map(t=>`v${t.replace(".","")}.stomp`)}}sr.V1_0="1.0";sr.V1_1="1.1";sr.V1_2="1.2";sr.default=new sr([sr.V1_2,sr.V1_1,sr.V1_0]);function uH(e,t){e.terminate=function(){const n=()=>{};this.onerror=n,this.onmessage=n,this.onopen=n;const r=new Date,i=Math.random().toString().substring(2,8),o=this.onclose;this.onclose=a=>{const s=new Date().getTime()-r.getTime();t(`Discarded socket (#${i})  closed after ${s}ms, with code/reason: ${a.code}/${a.reason}`)},this.close(),o==null||o.call(e,{code:4001,reason:`Quick discarding socket (#${i}) without waiting for the shutdown sequence.`,wasClean:!1})}}class cH{constructor(t,n,r){this._client=t,this._webSocket=n,this._connected=!1,this._serverFrameHandlers={CONNECTED:i=>{this.debug(`connected to server ${i.headers.server}`),this._connected=!0,this._connectedVersion=i.headers.version,this._connectedVersion===sr.V1_2&&(this._escapeHeaderValues=!0),this._setupHeartbeat(i.headers),this.onConnect(i)},MESSAGE:i=>{const o=i.headers.subscription,a=this._subscriptions[o]||this.onUnhandledMessage,s=i,u=this,c=this._connectedVersion===sr.V1_2?s.headers.ack:s.headers["message-id"];s.ack=(l={})=>u.ack(c,o,l),s.nack=(l={})=>u.nack(c,o,l),a(s)},RECEIPT:i=>{const o=this._receiptWatchers[i.headers["receipt-id"]];o?(o(i),delete this._receiptWatchers[i.headers["receipt-id"]]):this.onUnhandledReceipt(i)},ERROR:i=>{this.onStompError(i)}},this._counter=0,this._subscriptions={},this._receiptWatchers={},this._partialData="",this._escapeHeaderValues=!1,this._lastServerActivityTS=Date.now(),this.debug=r.debug,this.stompVersions=r.stompVersions,this.connectHeaders=r.connectHeaders,this.disconnectHeaders=r.disconnectHeaders,this.heartbeatIncoming=r.heartbeatIncoming,this.heartbeatOutgoing=r.heartbeatOutgoing,this.splitLargeFrames=r.splitLargeFrames,this.maxWebSocketChunkSize=r.maxWebSocketChunkSize,this.forceBinaryWSFrames=r.forceBinaryWSFrames,this.logRawCommunication=r.logRawCommunication,this.appendMissingNULLonIncoming=r.appendMissingNULLonIncoming,this.discardWebsocketOnCommFailure=r.discardWebsocketOnCommFailure,this.onConnect=r.onConnect,this.onDisconnect=r.onDisconnect,this.onStompError=r.onStompError,this.onWebSocketClose=r.onWebSocketClose,this.onWebSocketError=r.onWebSocketError,this.onUnhandledMessage=r.onUnhandledMessage,this.onUnhandledReceipt=r.onUnhandledReceipt,this.onUnhandledFrame=r.onUnhandledFrame}get connectedVersion(){return this._connectedVersion}get connected(){return this._connected}start(){const t=new sH(n=>{const r=ia.fromRawFrame(n,this._escapeHeaderValues);this.logRawCommunication||this.debug(`<<< ${r}`),(this._serverFrameHandlers[r.command]||this.onUnhandledFrame)(r)},()=>{this.debug("<<< PONG")});this._webSocket.onmessage=n=>{if(this.debug("Received data"),this._lastServerActivityTS=Date.now(),this.logRawCommunication){const r=n.data instanceof ArrayBuffer?new TextDecoder().decode(n.data):n.data;this.debug(`<<< ${r}`)}t.parseChunk(n.data,this.appendMissingNULLonIncoming)},this._webSocket.onclose=n=>{this.debug(`Connection closed to ${this._webSocket.url}`),this._cleanUp(),this.onWebSocketClose(n)},this._webSocket.onerror=n=>{this.onWebSocketError(n)},this._webSocket.onopen=()=>{const n=Object.assign({},this.connectHeaders);this.debug("Web Socket Opened..."),n["accept-version"]=this.stompVersions.supportedVersions(),n["heart-beat"]=[this.heartbeatOutgoing,this.heartbeatIncoming].join(","),this._transmit({command:"CONNECT",headers:n})}}_setupHeartbeat(t){if(t.version!==sr.V1_1&&t.version!==sr.V1_2||!t["heart-beat"])return;const[n,r]=t["heart-beat"].split(",").map(i=>parseInt(i,10));if(this.heartbeatOutgoing!==0&&r!==0){const i=Math.max(this.heartbeatOutgoing,r);this.debug(`send PING every ${i}ms`),this._pinger=setInterval(()=>{this._webSocket.readyState===bo.OPEN&&(this._webSocket.send(xl.LF),this.debug(">>> PING"))},i)}if(this.heartbeatIncoming!==0&&n!==0){const i=Math.max(this.heartbeatIncoming,n);this.debug(`check PONG every ${i}ms`),this._ponger=setInterval(()=>{const o=Date.now()-this._lastServerActivityTS;o>i*2&&(this.debug(`did not receive server activity for the last ${o}ms`),this._closeOrDiscardWebsocket())},i)}}_closeOrDiscardWebsocket(){this.discardWebsocketOnCommFailure?(this.debug("Discarding websocket, the underlying socket may linger for a while"),this.discardWebsocket()):(this.debug("Issuing close on the websocket"),this._closeWebsocket())}forceDisconnect(){this._webSocket&&(this._webSocket.readyState===bo.CONNECTING||this._webSocket.readyState===bo.OPEN)&&this._closeOrDiscardWebsocket()}_closeWebsocket(){this._webSocket.onmessage=()=>{},this._webSocket.close()}discardWebsocket(){typeof this._webSocket.terminate!="function"&&uH(this._webSocket,t=>this.debug(t)),this._webSocket.terminate()}_transmit(t){const{command:n,headers:r,body:i,binaryBody:o,skipContentLengthHeader:a}=t,s=new ia({command:n,headers:r,body:i,binaryBody:o,escapeHeaderValues:this._escapeHeaderValues,skipContentLengthHeader:a});let u=s.serialize();if(this.logRawCommunication?this.debug(`>>> ${u}`):this.debug(`>>> ${s}`),this.forceBinaryWSFrames&&typeof u=="string"&&(u=new TextEncoder().encode(u)),typeof u!="string"||!this.splitLargeFrames)this._webSocket.send(u);else{let c=u;for(;c.length>0;){const l=c.substring(0,this.maxWebSocketChunkSize);c=c.substring(this.maxWebSocketChunkSize),this._webSocket.send(l),this.debug(`chunk sent = ${l.length}, remaining = ${c.length}`)}}}dispose(){if(this.connected)try{const t=Object.assign({},this.disconnectHeaders);t.receipt||(t.receipt=`close-${this._counter++}`),this.watchForReceipt(t.receipt,n=>{this._closeWebsocket(),this._cleanUp(),this.onDisconnect(n)}),this._transmit({command:"DISCONNECT",headers:t})}catch(t){this.debug(`Ignoring error during disconnect ${t}`)}else(this._webSocket.readyState===bo.CONNECTING||this._webSocket.readyState===bo.OPEN)&&this._closeWebsocket()}_cleanUp(){this._connected=!1,this._pinger&&(clearInterval(this._pinger),this._pinger=void 0),this._ponger&&(clearInterval(this._ponger),this._ponger=void 0)}publish(t){const{destination:n,headers:r,body:i,binaryBody:o,skipContentLengthHeader:a}=t,s=Object.assign({destination:n},r);this._transmit({command:"SEND",headers:s,body:i,binaryBody:o,skipContentLengthHeader:a})}watchForReceipt(t,n){this._receiptWatchers[t]=n}subscribe(t,n,r={}){r=Object.assign({},r),r.id||(r.id=`sub-${this._counter++}`),r.destination=t,this._subscriptions[r.id]=n,this._transmit({command:"SUBSCRIBE",headers:r});const i=this;return{id:r.id,unsubscribe(o){return i.unsubscribe(r.id,o)}}}unsubscribe(t,n={}){n=Object.assign({},n),delete this._subscriptions[t],n.id=t,this._transmit({command:"UNSUBSCRIBE",headers:n})}begin(t){const n=t||`tx-${this._counter++}`;this._transmit({command:"BEGIN",headers:{transaction:n}});const r=this;return{id:n,commit(){r.commit(n)},abort(){r.abort(n)}}}commit(t){this._transmit({command:"COMMIT",headers:{transaction:t}})}abort(t){this._transmit({command:"ABORT",headers:{transaction:t}})}ack(t,n,r={}){r=Object.assign({},r),this._connectedVersion===sr.V1_2?r.id=t:r["message-id"]=t,r.subscription=n,this._transmit({command:"ACK",headers:r})}nack(t,n,r={}){return r=Object.assign({},r),this._connectedVersion===sr.V1_2?r.id=t:r["message-id"]=t,r.subscription=n,this._transmit({command:"NACK",headers:r})}}class Vw{constructor(t={}){this.stompVersions=sr.default,this.connectionTimeout=0,this.reconnectDelay=5e3,this.heartbeatIncoming=1e4,this.heartbeatOutgoing=1e4,this.splitLargeFrames=!1,this.maxWebSocketChunkSize=8*1024,this.forceBinaryWSFrames=!1,this.appendMissingNULLonIncoming=!1,this.discardWebsocketOnCommFailure=!1,this.state=Kr.INACTIVE;const n=()=>{};this.debug=n,this.beforeConnect=n,this.onConnect=n,this.onDisconnect=n,this.onUnhandledMessage=n,this.onUnhandledReceipt=n,this.onUnhandledFrame=n,this.onStompError=n,this.onWebSocketClose=n,this.onWebSocketError=n,this.logRawCommunication=!1,this.onChangeState=n,this.connectHeaders={},this._disconnectHeaders={},this.configure(t)}get webSocket(){var t;return(t=this._stompHandler)==null?void 0:t._webSocket}get disconnectHeaders(){return this._disconnectHeaders}set disconnectHeaders(t){this._disconnectHeaders=t,this._stompHandler&&(this._stompHandler.disconnectHeaders=this._disconnectHeaders)}get connected(){return!!this._stompHandler&&this._stompHandler.connected}get connectedVersion(){return this._stompHandler?this._stompHandler.connectedVersion:void 0}get active(){return this.state===Kr.ACTIVE}_changeState(t){this.state=t,this.onChangeState(t)}configure(t){Object.assign(this,t)}activate(){const t=()=>{if(this.active){this.debug("Already ACTIVE, ignoring request to activate");return}this._changeState(Kr.ACTIVE),this._connect()};this.state===Kr.DEACTIVATING?(this.debug("Waiting for deactivation to finish before activating"),this.deactivate().then(()=>{t()})):t()}async _connect(){if(await this.beforeConnect(),this._stompHandler){this.debug("There is already a stompHandler, skipping the call to connect");return}if(!this.active){this.debug("Client has been marked inactive, will not attempt to connect");return}this.connectionTimeout>0&&(this._connectionWatcher&&clearTimeout(this._connectionWatcher),this._connectionWatcher=setTimeout(()=>{this.connected||(this.debug(`Connection not established in ${this.connectionTimeout}ms, closing socket`),this.forceDisconnect())},this.connectionTimeout)),this.debug("Opening Web Socket...");const t=this._createWebSocket();this._stompHandler=new cH(this,t,{debug:this.debug,stompVersions:this.stompVersions,connectHeaders:this.connectHeaders,disconnectHeaders:this._disconnectHeaders,heartbeatIncoming:this.heartbeatIncoming,heartbeatOutgoing:this.heartbeatOutgoing,splitLargeFrames:this.splitLargeFrames,maxWebSocketChunkSize:this.maxWebSocketChunkSize,forceBinaryWSFrames:this.forceBinaryWSFrames,logRawCommunication:this.logRawCommunication,appendMissingNULLonIncoming:this.appendMissingNULLonIncoming,discardWebsocketOnCommFailure:this.discardWebsocketOnCommFailure,onConnect:n=>{if(this._connectionWatcher&&(clearTimeout(this._connectionWatcher),this._connectionWatcher=void 0),!this.active){this.debug("STOMP got connected while deactivate was issued, will disconnect now"),this._disposeStompHandler();return}this.onConnect(n)},onDisconnect:n=>{this.onDisconnect(n)},onStompError:n=>{this.onStompError(n)},onWebSocketClose:n=>{this._stompHandler=void 0,this.state===Kr.DEACTIVATING&&this._changeState(Kr.INACTIVE),this.onWebSocketClose(n),this.active&&this._schedule_reconnect()},onWebSocketError:n=>{this.onWebSocketError(n)},onUnhandledMessage:n=>{this.onUnhandledMessage(n)},onUnhandledReceipt:n=>{this.onUnhandledReceipt(n)},onUnhandledFrame:n=>{this.onUnhandledFrame(n)}}),this._stompHandler.start()}_createWebSocket(){let t;if(this.webSocketFactory)t=this.webSocketFactory();else if(this.brokerURL)t=new WebSocket(this.brokerURL,this.stompVersions.protocolVersions());else throw new Error("Either brokerURL or webSocketFactory must be provided");return t.binaryType="arraybuffer",t}_schedule_reconnect(){this.reconnectDelay>0&&(this.debug(`STOMP: scheduling reconnection in ${this.reconnectDelay}ms`),this._reconnector=setTimeout(()=>{this._connect()},this.reconnectDelay))}async deactivate(t={}){var o;const n=t.force||!1,r=this.active;let i;if(this.state===Kr.INACTIVE)return this.debug("Already INACTIVE, nothing more to do"),Promise.resolve();if(this._changeState(Kr.DEACTIVATING),this._reconnector&&(clearTimeout(this._reconnector),this._reconnector=void 0),this._stompHandler&&this.webSocket.readyState!==bo.CLOSED){const a=this._stompHandler.onWebSocketClose;i=new Promise((s,u)=>{this._stompHandler.onWebSocketClose=c=>{a(c),s()}})}else return this._changeState(Kr.INACTIVE),Promise.resolve();return n?(o=this._stompHandler)==null||o.discardWebsocket():r&&this._disposeStompHandler(),i}forceDisconnect(){this._stompHandler&&this._stompHandler.forceDisconnect()}_disposeStompHandler(){this._stompHandler&&this._stompHandler.dispose()}publish(t){this._checkConnection(),this._stompHandler.publish(t)}_checkConnection(){if(!this.connected)throw new TypeError("There is no underlying STOMP connection")}watchForReceipt(t,n){this._checkConnection(),this._stompHandler.watchForReceipt(t,n)}subscribe(t,n,r={}){return this._checkConnection(),this._stompHandler.subscribe(t,n,r)}unsubscribe(t,n={}){this._checkConnection(),this._stompHandler.unsubscribe(t,n)}begin(t){return this._checkConnection(),this._stompHandler.begin(t)}commit(t){this._checkConnection(),this._stompHandler.commit(t)}abort(t){this._checkConnection(),this._stompHandler.abort(t)}ack(t,n,r={}){this._checkConnection(),this._stompHandler.ack(t,n,r)}nack(t,n,r={}){this._checkConnection(),this._stompHandler.nack(t,n,r)}}const lH=()=>{const e=O.useRef(null),t=O.useRef(!1),{user:n}=Pn();O.useEffect(()=>{if(!n){e.current&&(e.current.deactivate(),e.current=null);return}if(t.current)return;const r=new WebSocket("wss://i11a706.p.ssafy.io/battle-people/ws"),i=new Vw({webSocketFactory:()=>r,debug:o=>console.log(o),reconnectDelay:5e3,heartbeatIncoming:4e3,heartbeatOutgoing:4e3,onConnect:()=>{console.log("Connected to notify server"),i.subscribe(`/topic/${n.id}`,o=>{console.log(o.body),$e.info(`${o.body}`,{autoClose:2e3})}),t.current=!0,e.current=i},onStompError:o=>{console.error("STOMP error",o)}});return i.activate(),()=>{e.current&&e.current.deactivate()}},[n])};function dH(){const{isLogin:e,user:t}=Pn(),n=xn(),a=e?[{link:"/my-page",text:"마이페이지"},{link:"/",text:"로그아웃",onClick:async s=>{s.preventDefault(),n("/");try{await Kn.logout()}catch{console.error("로그아웃 실패")}}}]:[{link:"/login",text:"로그인"},{link:"/join",text:"회원가입"}];return C.jsxs(J8,{as:"div",className:"relative inline-block text-left",children:[C.jsx(FP,{className:"inline-flex justify-center text-sm font-semibold text-gray-900 shadow-sm hover:scale-105",children:C.jsx("img",{className:"w-8 h-8 rounded-full",src:(t==null?void 0:t.imgUrl)||Z8,alt:"프로필 이미지"})}),C.jsx(BP,{anchor:"bottom end",transition:!0,className:"absolute right-0 z-50 mt-2 w-40 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 transition focus:outline-none data-[closed]:scale-95 data-[closed]:transform data-[closed]:opacity-0 data-[enter]:duration-100 data-[leave]:duration-75 data-[enter]:ease-out data-[leave]:ease-in",children:C.jsx("div",{className:"py-1",children:a.map(s=>C.jsx(jP,{children:C.jsx(eo,{to:s.link,onClick:s.onClick,className:"block px-4 py-2 text-sm text-gray-700 data-[focus]:bg-gray-100 data-[focus]:text-gray-900",children:s.text})},s.link))})})]})}function fH(){return C.jsxs(eo,{to:"/",className:"flex items-center no-underline hover:text-white text-white text-2xl font-[BMHANNA\\\\_11yrs] space-x-2 mr-8 lg:mr-16 whitespace-nowrap",children:[C.jsx("img",{className:"h-[35px]",src:tH,alt:"로고"}),C.jsx("span",{children:"배틀의 민족"})]})}function hH(){return C.jsxs(C.Fragment,{children:[C.jsx(fH,{}),C.jsxs("div",{className:"flex space-x-4 lg:space-x-8 text-white text-lg whitespace-nowrap ml-4",children:[C.jsx(eo,{className:"text-white hover:text-gray-400",to:"/firework",children:"불구경"}),C.jsx(eo,{className:"text-white hover:text-gray-400",to:"/fanning",children:"부채질"}),C.jsx(eo,{className:"text-white hover:text-gray-400",to:"/bonfire",children:"모닥불"})]})]})}function pH({onHelpClick:e}){const{isLogin:t}=Pn();return C.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center sm:justify-end space-x-2 lg:space-x-4 w-full max-w-screen-sm ml-auto",children:[!1,C.jsx("button",{type:"button",onClick:e,className:"block text-sm text-gray-700",children:C.jsx("img",{src:nH,alt:"Help",className:"w-6 h-6 sm:w-8 sm:h-8"})}),C.jsxs("div",{className:"flex items-center justify-center space-x-4 mt-4 sm:mt-1",children:[t&&C.jsx(eo,{to:"/notification",className:"block text-sm text-gray-700 data-[focus]:bg-gray-100 data-[focus]:text-gray-900",children:C.jsx("button",{type:"button",className:"btn hover:scale-105",children:C.jsx("img",{className:"w-8 h-8",src:eH,alt:"알림 버튼"})})}),C.jsx(dH,{})]})]})}function Ba(){lH();const[e,t]=O.useState(!1),n=()=>t(!0),r=()=>t(!1);return C.jsxs("div",{className:"fixed top-0 left-0 w-full h-auto sm:h-[68px] bg-[#000] overflow-hidden z-50 overflow-x-auto",children:[C.jsxs("div",{className:"flex flex-col sm:flex-row items-center h-full px-4 lg:px-8",children:[C.jsx(hH,{}),C.jsx(pH,{onHelpClick:n})]}),e&&C.jsx(oH,{onClose:r})]})}const gn=[{id:7,name:"전체"},{id:0,name:"사랑"},{id:1,name:"일상"},{id:2,name:"음식"},{id:3,name:"연예"},{id:4,name:"게임"},{id:5,name:"스포츠"},{id:6,name:"기타"}],vH=J.div`
	width: 100%;
	margin-top: 120px;
	position: relative;
	box-sizing: border-box;
	background-color: white;
`,mH=J(dO)`
	.slick-prev,
	.slick-next {
		z-index: 1;
		width: 40px;
		height: 40px;
		color: orange;
		position: absolute;
		top: 50%;
		transform: translateY(-50%);
		&:before {
			font-size: 60px;
			color: black;
		}
	}
	.slick-prev {
		left: 280px;
	}
	.slick-next {
		right: 280px;
	}
	.slick-slide > div {
		margin: 0 10px; /* 슬라이더 사이의 공백 설정 */
		background-color: white;
		height: 400px;
		display: flex;
		align-items: center;
		justify-content: center;
		position: relative;
		overflow: hidden;
		box-sizing: border-box;
		width: 80%; /* 슬라이더의 가로 길이를 줄임 */
		margin: 0 auto;
	}
`,gH=J.div`
	max-width: 100%;
	height: 400px;
	position: relative;
	display: flex;
	align-items: center;
	justify-content: center;
	overflow: hidden;
	border-radius: 19px;
	border: 6px solid black;
	cursor: pointer;
	box-sizing: border-box;
	background-color: white;
`,yH=J.img`
	width: 100%;
	height: 100%;
	object-fit: cover;
	position: absolute;
	top: 0;
	left: 0;
	z-index: 1;
`,bH=RT`
	from {
		transform: translateY(20px);
		opacity: 0;
	}
	to {
		transform: translateY(0);
		opacity: 1;
	}
`,wH=J.div`
	position: absolute;
	bottom: 20px;
	left: 20px;
	z-index: 2;
	color: white;
	padding: 10px;
	border-radius: 5px;
	max-width: 80%;
	opacity: 0;
	${({animate:e})=>e&&ui`
			animation: ${bH} 0.9s ease-out;
			opacity: 1;
		`}
`,xH=J.div`
	margin: 0;
	font-size: 2em;
	color: white;
	text-shadow: ${({textShadow:e})=>e||"none"};
`,EH=J.div`
	margin: 5px 0 0;
	font-size: 1.5em;
	line-height: 1.2;
	color: white;
	text-shadow: ${({textShadow:e})=>e||"none"};
`;function SH({cards:e}){const[t,n]=O.useState(0),r=xn(),i=Ic("#000000",3),o={className:"center",centerMode:!0,infinite:!0,centerPadding:"20%",slidesToShow:1,speed:1500,autoplay:!0,autoplaySpeed:4e3,afterChange:s=>n(s)},a=s=>{r(`/live/${s}`)};return C.jsx(vH,{children:C.jsx(mH,{className:o.className,centerMode:o.centerMode,infinite:o.infinite,centerPadding:o.centerPadding,slidesToShow:o.slidesToShow,speed:o.speed,autoplay:o.autoplay,autoplaySpeed:o.autoplaySpeed,afterChange:o.afterChange,children:e.map((s,u)=>C.jsx("div",{children:C.jsxs(gH,{onClick:()=>a(s.id.toString()),children:[C.jsx(yH,{src:s.image_uri||Lp,alt:s.title}),C.jsxs(wH,{animate:t===u,children:[C.jsx(xH,{textShadow:i.textShadow,children:s.title}),C.jsxs(EH,{textShadow:i.textShadow,children:[s.regist_user_id," vs ",s.opposite_user_id]})]})]})},s.id))})})}const CH=J.div`
	padding: 40px;
`,Kf=J.div`
	margin-top: 40px;
`,Yf=J.div`
	margin-top: 60px;
	margin-bottom: 20px;
	font-size: 2em;
	text-align: left;
`,Qf=J.div`
	font-size: 1.8em;
	padding-left: 20px;
`,_H=J.div`
	font-size: 1.2em;
	text-align: center;
	padding: 20px;
`,kH=J.div`
	font-size: 1.5em;
	text-align: center;
	margin-top: 50px;
	background-color: #eeeeee;
	padding: 10px;
`;function RH(){const[e,t]=O.useState([]),[n,r]=O.useState({}),[i,o]=O.useState({}),[a,s]=O.useState(!0),{isLogin:u}=Pn(),[c,l]=O.useState([]);return O.useEffect(()=>{(async()=>{try{s(!0),console.log("Fetching live data...");const[f,h,...p]=await Promise.allSettled([u?Kn.getUserInterests():Promise.reject(),_o.getActiveList(void 0,0,5),...gn.filter(w=>w.id!==7).map(w=>_o.getActiveList(w.id))]),m=f.status==="fulfilled"?f.value:[],g=h.status==="fulfilled"&&h.value.code==="success"?h.value.data.map(w=>({id:w.id,title:w.title,regist_user_id:w.registerUser.nickname.toString(),opposite_user_id:w.oppositeUser.nickname.toString(),start_date:w.startDate,end_date:w.endDate,max_people_count:w.currentPeopleCount||0,currentPeopleCount:w.currentPeopleCount||0,category:w.category,image_uri:w.imageUri||"",live_uri:w.roomId,status:"live"})):[],v=p.map((w,E)=>{const R=(w.status==="fulfilled"&&w.value.code==="success"?w.value.data||[]:[]).map(S=>({id:S.id,title:S.title,regist_user_id:S.registerUser.nickname.toString(),opposite_user_id:S.oppositeUser.id.toString(),start_date:S.startDate,end_date:S.endDate,max_people_count:S.currentPeopleCount||0,currentPeopleCount:S.currentPeopleCount||0,category:S.category,image_uri:S.imageUri||"",live_uri:S.roomId,status:"live"}));return{categoryId:gn.filter(S=>S.id!==7).at(E).id,cards:R}}),y={},b={};v.forEach(({categoryId:w,cards:E})=>{m.includes(w)?y[w]=E:b[w]=E}),m.length&&l(m),t(g),r(y),o(b),console.log("Large Carousel Cards:",g),console.log("Interested Cards:",y),console.log("Other Cards:",b)}catch(f){console.error("Failed to fetch live battles:",f)}finally{s(!1)}})()},[u]),a?C.jsx(_H,{children:"Loading..."}):C.jsxs("div",{children:[C.jsx(Ba,{}),C.jsx(SH,{cards:e}),C.jsxs(CH,{children:[!u&&C.jsxs(C.Fragment,{children:[C.jsx(Yf,{children:"🔍 전체 카테고리 탐색하기"}),Object.keys(i).map(d=>{var f;return C.jsxs(Kf,{children:[C.jsxs(Qf,{children:["#",(f=gn.find(h=>h.id===parseInt(d,10)))==null?void 0:f.name]}),C.jsx(Vf,{cards:i[parseInt(d,10)]},d)]},d)})]}),u&&c.length===0&&C.jsxs(C.Fragment,{children:[C.jsx(kH,{children:"📢 마이페이지에서 관심사를 등록해보세요! 관심사에 맞는 라이브 방송을 먼저 보여드릴게요."}),C.jsx(Yf,{children:"🔍 전체 카테고리 탐색하기"}),Object.keys(i).map(d=>{var f;return C.jsxs(Kf,{children:[C.jsxs(Qf,{children:["#",(f=gn.find(h=>h.id===parseInt(d,10)))==null?void 0:f.name]}),C.jsx(Vf,{cards:i[parseInt(d,10)]},d)]},d)})]}),u&&c.length>0&&C.jsxs(C.Fragment,{children:[C.jsx(Yf,{children:"💘 회원님의 관심사에 맞춘 라이브 방송"}),Object.keys(n).map(d=>{var f;return C.jsxs(Kf,{children:[C.jsxs(Qf,{children:["#",(f=gn.find(h=>h.id===parseInt(d,10)))==null?void 0:f.name]}),C.jsx(Vf,{cards:n[parseInt(d,10)]},d)]},d)}),C.jsx(Yf,{children:"🔍 다른 카테고리 탐색하기"}),Object.keys(i).map(d=>{var f;return C.jsxs(Kf,{children:[C.jsxs(Qf,{children:["#",(f=gn.find(h=>h.id===parseInt(d,10)))==null?void 0:f.name]}),C.jsx(Vf,{cards:i[parseInt(d,10)]},d)]},d)})]})]})]})}function IH(){return C.jsx(RH,{})}function ls({label:e,name:t,type:n,placeholder:r,value:i,onChange:o,className:a,error:s,onKeyDown:u}){return C.jsx("div",{className:"mb-4",children:C.jsxs("label",{htmlFor:t,className:"block text-black mb-2",children:[e,C.jsx("input",{id:t,name:t,type:n,placeholder:r,value:i,onChange:o,onKeyDown:u,className:DT("w-full p-2 border-4 border-black rounded-xl focus:outline-none focus:border-[#F66C23] focus:shadow-[0_0_0_3px_rgba(246,108,35,0.3)]",a)}),s&&C.jsx("p",{className:"text-red-500 text-sm mt-1",children:s})]})})}function Ww({text:e,onClick:t,className:n}){return C.jsx("button",{type:"button",onClick:t,className:DT("w-full h-13 p-2 bg-black text-white text-2xl rounded-2xl mt-4 hover:bg-[#F66C23]",n),children:e})}ls.defaultProps={className:"",error:""};Ww.defaultProps={className:""};function TH(){const e=xn(),[t,n]=O.useState({email:"",password:""}),[r,i]=O.useState({}),[o,a]=O.useState(!1),s=l=>{const{name:d,value:f}=l.target;n({...t,[d]:f}),i(h=>({...h,[d]:"",general:""}))},u=l=>{l.key==="Enter"&&c()},c=async()=>{const l={};if(t.email||(l.email="이메일을 입력해주세요."),t.password||(l.password="비밀번호를 입력해주세요."),Object.keys(l).length>0){i(l),a(!0),setTimeout(()=>{a(!1)},500);return}try{await Kn.login(t),e("/")}catch{i({general:"로그인에 실패했습니다."}),a(!0),setTimeout(()=>{a(!1)},500)}};return C.jsx("div",{className:"flex justify-center items-center h-screen bg-white",children:C.jsxs("div",{className:"bg-white p-8 rounded-3xl shadow-lg scale-100 border-4 border-solid border-black",children:[C.jsx("h1",{className:"text-center text-white text-5xl mb-4",style:Ic("black",4),children:"로그인"}),C.jsxs("div",{className:"mb-4 relative",children:[C.jsx(ls,{label:"이메일",type:"email",name:"email",value:t.email,onChange:s,onKeyDown:u,placeholder:"이메일"}),r.email&&C.jsxs("div",{className:"text-red-500 text-xs absolute right-0 top-0 mt-1 mr-2",children:[r.email," "]})]}),C.jsxs("div",{className:"mb-4 relative",children:[C.jsx(ls,{label:"비밀번호",type:"password",name:"password",value:t.password,onChange:s,onKeyDown:u,placeholder:"비밀번호"}),r.password&&C.jsxs("div",{className:"text-red-500 text-xs absolute right-0 top-0 mt-1 mr-2",children:[r.password," "]})]}),C.jsxs("div",{id:"submit-btn",className:"relative",children:[C.jsx(Ww,{text:"로그인",onClick:c,className:o?"shake":""}),r.general&&C.jsxs("div",{className:"text-red-500 text-xs absolute right-0 -top-1 mt-1 mr-2",children:[r.general," "]})]}),C.jsxs("div",{className:"flex justify-between mt-4",children:[C.jsx(eo,{to:"/join",className:"text-black hover:color hover:text-[#F66C23]",children:"#회원가입"}),C.jsx(eo,{to:"/",className:"text-black hover:text-[#F66C23]",children:"#홈으로 이동"})]})]})})}function OH(){const e=xn(),[t,n]=O.useState({email:"",password:"",nickname:""}),[r,i]=O.useState(""),[o,a]=O.useState({email:"",nickname:"",password:"",passwordConfirm:""}),[s,u]=O.useState(!1),c=p=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(p),l=p=>/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,16}$/.test(p),d=async p=>{const{name:m,value:g}=p.target;if(m==="nickname"&&g.length>12)return;n({...t,[m]:g});let v="";switch(m){case"email":if(!c(g))v="유효한 이메일 형식이 아닙니다.";else try{await Kn.checkEmailAvailability(g)||(v="이미 사용 중인 이메일입니다.")}catch{v="이메일 중복 확인 중 오류가 발생했습니다."}break;case"nickname":if(g)try{await Kn.checkNicknameAvailability(g)||(v="이미 사용 중인 닉네임입니다.")}catch{v="닉네임 중복 확인 중 오류가 발생했습니다."}break;case"password":l(g)||(v="8~16자 영문 대소문자, 숫자를 포함해야 합니다.");break;case"passwordConfirm":g!==t.password&&(v="비밀번호가 일치하지 않습니다.");break}a(y=>({...y,[m]:v}))},f=p=>{const{value:m}=p.target;i(m),m!==t.password?a(g=>({...g,passwordConfirm:"비밀번호가 일치하지 않습니다."})):a(g=>({...g,passwordConfirm:""}))},h=async()=>{const p=Object.values(o).some(g=>g!==""),m=Object.values(t).some(g=>g==="")||r==="";if(p||m){a({email:t.email===""?"이메일을 입력해주세요.":o.email,nickname:t.nickname===""?"닉네임을 입력해주세요.":o.nickname,password:t.password===""?"비밀번호를 입력해주세요.":o.password,passwordConfirm:r===""?"비밀번호 확인을 입력해주세요.":o.passwordConfirm}),u(!0),setTimeout(()=>{u(!1)},500);return}try{await Kn.join(t),e("/")}catch{console.error("회원가입 실패"),u(!0),setTimeout(()=>{u(!1)},500)}};return C.jsx("div",{className:"flex justify-center items-center h-screen bg-white",children:C.jsxs("div",{className:"bg-white p-8 rounded-3xl shadow-lg scale-100",style:{border:"4px solid black"},children:[C.jsx("h1",{className:"text-center text-white text-5xl mb-4",style:Ic("black",4),children:"회원가입"}),C.jsxs("form",{children:[C.jsxs("div",{className:"mb-4 relative",children:[C.jsx(ls,{label:"이메일",type:"email",name:"email",value:t.email,onChange:d,placeholder:"이메일을 입력해주세요."}),o.email&&C.jsx("div",{className:"text-red-500 text-xs absolute right-0 top-0 mt-1 mr-2",children:o.email})]}),C.jsxs("div",{className:"mb-4 relative",children:[C.jsx(ls,{label:"닉네임",type:"text",name:"nickname",value:t.nickname,onChange:d,placeholder:"닉네임을 입력해주세요."}),o.nickname&&C.jsx("div",{className:"text-red-500 text-xs absolute right-0 top-0 mt-1 mr-2",children:o.nickname})]}),C.jsxs("div",{className:"mb-4 relative",children:[C.jsx(ls,{label:"비밀번호",type:"password",name:"password",value:t.password,onChange:d,placeholder:"8~16자 영문 대소문자, 숫자 포함."}),o.password&&C.jsx("div",{className:"text-red-500 text-xs absolute right-0 top-0 mt-1 mr-2",children:o.password})]}),C.jsxs("div",{className:"mb-4 relative",children:[C.jsx(ls,{label:"비밀번호 확인",type:"password",name:"passwordConfirm",value:r,onChange:f,placeholder:"비밀번호 확인"}),o.passwordConfirm&&C.jsx("div",{className:"text-red-500 text-xs absolute right-0 top-0 mt-1 mr-2",children:o.passwordConfirm})]}),C.jsx("div",{id:"submit-btn",children:C.jsx(Ww,{text:"확인",onClick:h,className:s?"shake":""})})]}),C.jsxs("div",{className:"flex justify-between mt-4",children:[C.jsx(eo,{to:"/login",className:"text-black hover:color hover:text-[#F66C23]",children:"#로그인"}),C.jsx(eo,{to:"/",className:"text-black hover:color hover:text-[#F66C23]",children:"#홈으로 이동"})]})]})})}const PH=J.div`
	display: flex;
	align-items: center;
	justify-content: center;
	position: relative;
	width: 650px;
	height: 300px;
	background-color: black;
	border-radius: 25px;
	border: 10px solid black;
	outline: none;
`,NH=J.div`
	display: flex;
	align-items: center;
	justify-content: space-between;
	width: 100%;
	height: 100%;
	overflow-y: hidden;
	position: relative;
`,DH=J.div`
	width: 100px;
	height: 100%;
	display: flex;
	align-items: flex-start;
	justify-content: center;
	background-color: #04b9ce;
	border-radius: 15px 0 0 15px;
	padding-top: 30px;
`,AH=J.div`
	width: 100px;
	height: 100%;
	display: flex;
	align-items: flex-end;
	justify-content: center;
	background-color: #eb5545;
	border-radius: 0 15px 15px 0;
	padding-bottom: 30px;
`,O2=J.button`
	cursor: pointer;
	transition: all 0.15s;
	background-color: #303030;
	color: white;
	padding: 0.5rem 1rem;
	border-radius: 100%;
	border-bottom-width: 4px;
	border-color: #000000;
	border-style: solid;
	font-weight: bold;
	font-size: 1.5rem;
	box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);

	&:hover {
		filter: brightness(110%);
		transform: translateY(-1px);
		border-bottom-width: 6px;
	}

	&:active {
		filter: brightness(90%);
		transform: translateY(2px);
		border-bottom-width: 2px;
	}
`,WP=J.button`
	position: absolute;
	top: 50%;
	transform: translateY(-50%);
	width: 0;
	height: 0;
	border-style: solid;
	cursor: pointer;
	outline: none;
	z-index: 10;
`,MH=J(WP)`
	left: -90px;
	border-width: 30px 45px 30px 0;
	border-color: transparent #000000 transparent transparent;
`,LH=J(WP)`
	right: -90px;
	border-width: 30px 0 30px 45px;
	border-color: transparent transparent transparent #000000;
`,FH=J.div`
	flex: 1;
	display: flex;
	justify-content: center;
	align-items: center;
	position: relative;
	color: white;
	font-size: 1.5rem;
	font-weight: bold;
	cursor: pointer; /* Ensure pointer indicates clickable area */
`,P2=J.div`
	width: 8px;
	height: 100%;
	background-color: black;
`,BH=J.div`
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	display: flex;
	flex-direction: column;
	justify-content: start;
	padding: 10px;
	pointer-events: none;
	align-items: flex-start;
`,jH=J.div`
	background-color: red;
	color: white;
	padding: 5px 10px;
	border-radius: 5px;
	font-size: 0.9rem;
	font-weight: bold;
	margin-top: 10px;
	margin-left: 5px;
`,$H=J.div`
	color: white;
	padding: 5px;
	border-radius: 5px;
	font-size: 1.7rem;
	text-shadow: ${({textShadow:e})=>e||"none"};
	margin-left: 5px;
`;function VH({selectedCategory:e}){const[t,n]=O.useState([]),[r,i]=O.useState([]),[o,a]=O.useState(0),[s,u]=O.useState([]),c=xn();O.useEffect(()=>{(async()=>{var g;try{const v=e==="전체"||(g=gn.find(x=>x.name===e))==null?void 0:g.id,b=(await _o.getActiveList(v,0,5)).data||[],w=b.map(x=>x.imageUri||Lp).filter(Boolean),E=b.map(x=>x.title);n(w),i(E),u(b)}catch(v){console.error("Failed to fetch carousel images:",v)}})()},[e]);const l=()=>{a(m=>(m+1)%t.length)},d=()=>{a(m=>(m-1+t.length)%t.length)},f=m=>{m.key==="ArrowLeft"?d():m.key==="ArrowRight"&&l()},h=()=>{const m=s[o];m&&c(`/live/${m.id}`,{state:{...m}})},p=Ic("#000000",3);return C.jsxs(PH,{tabIndex:0,role:"region","aria-label":"Image Carousel",children:[C.jsx(MH,{onClick:d,onKeyDown:f,"aria-label":"Previous Slide",type:"button"}),C.jsxs(NH,{children:[C.jsx(DH,{onClick:h,children:C.jsx(O2,{children:C.jsx("span",{children:"M"})})}),C.jsx(P2,{}),C.jsx(FH,{onClick:h,children:t.length>0?C.jsxs(C.Fragment,{children:[C.jsx("img",{src:t[o]||Lp,alt:`Slide ${o+1}`,style:{width:"600px",height:"300px",objectFit:"cover"}}),C.jsxs(BH,{children:[C.jsx(jH,{children:"라이브"}),C.jsx($H,{textShadow:p.textShadow,children:r[o]})]})]}):C.jsx("div",{children:"No Images Available"})}),C.jsx(P2,{}),C.jsx(AH,{onClick:h,children:C.jsx(O2,{children:C.jsx("span",{children:"A"})})})]}),C.jsx(LH,{onClick:l,onKeyDown:f,"aria-label":"Next Slide",type:"button"})]})}const WH=J.div`
	display: flex;
	align-items: center;
	gap: 1rem;
	padding: 1rem;
	border-radius: 1rem;
`,UH=J.div`
	position: relative;
	display: inline-block;
	cursor: pointer;
	padding: 0.5rem;
	transition: all 0.3s ease;
`,zH=J.label`
	position: relative;
	display: inline-block;
	padding-left: 2rem;
	margin-bottom: 0;
	font-size: 1rem;
	cursor: pointer;
	transition: all 0.3s ease;
`,HH=J.input`
	position: absolute;
	opacity: 0;
	width: 0;
	height: 0;
	cursor: pointer;
`,UP=J.span`
	position: absolute;
	top: 50%;
	left: 0.5rem;
	transform: translateY(-50%);
	width: 1rem;
	height: 1rem;
	border: 2px solid #333;
	border-radius: 50%;
	transition: all 0.3s ease;
`,GH=J(UP)`
	background-color: #f66c23;
	border-color: #f66c23;

	&::after {
		content: "";
		position: absolute;
		top: 50%;
		left: 50%;
		width: 0.5rem;
		height: 0.5rem;
		background-color: #fff;
		border-radius: 50%;
		transform: translate(-50%, -50%);
	}
`;function qH({statuses:e,selectedStatus:t,onStatusSelect:n}){const r=i=>i==="live"?"실시간":i==="upcoming"?"예정된":"종료된";return C.jsx(WH,{children:e.map(i=>C.jsx(UH,{selected:t===i,onClick:()=>n(i),children:C.jsxs(zH,{htmlFor:i,children:[C.jsx(HH,{id:i,type:"radio",name:"status",value:i,checked:t===i,readOnly:!0}),t===i?C.jsx(GH,{}):C.jsx(UP,{}),r(i)]})},i))})}function XH({categories:e,onCategorySelect:t,selectedCategory:n}){const[r,i]=O.useState(0);O.useEffect(()=>{const a=e.findIndex(s=>s.name===n);a!==-1&&i(a)},[n,e]);const o=(a,s)=>{i(a),t(s)};return C.jsxs("div",{className:"flex w-full relative",children:[e.map((a,s)=>C.jsxs(we.Fragment,{children:[C.jsx("input",{type:"radio",id:`option${s}`,name:"tabs",className:"appearance-none",checked:r===s,onChange:()=>o(s,a.name)}),C.jsx("label",{htmlFor:`option${s}`,className:"cursor-pointer flex-1 flex items-center justify-center truncate uppercase select-none text-lg py-2",children:a.name})]},a.id)),C.jsx("div",{className:"absolute bottom-0 h-1 bg-black transition-transform duration-300",style:{width:`calc(100% / ${e.length})`,transform:`translateX(${r*100}%)`}})]})}const KH=J.div`
	display: flex;
	flex-direction: column;
	width: 100%;
	gap: 1rem;
`,YH=J.div`
	display: flex;
	justify-content: space-between;
	align-items: center;
	gap: 1rem;
`,QH=J.h1`
	font-size: 3rem;
	white-space: nowrap;
`,JH=J.img`
	height: 4rem;
	width: 4rem;
`,ZH=J.div`
	flex-grow: 1;
`,e7=J.div`
	display: flex;
	justify-content: center;
	margin-bottom: 2rem;
`,t7=J.h2`
	font-size: 2rem;
	margin-top: 1rem;
`;function fm({boardName:e,categories:t,selectedCategory:n,onCategorySelect:r,selectedStatus:i,onStatusSelect:o,boardIcon:a=dm}){const s=u=>u==="불구경"?["live","upcoming","ended"]:u==="모닥불"?["live","ended"]:[];return C.jsxs(KH,{children:[C.jsxs(YH,{children:[C.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[C.jsx(QH,{children:e}),C.jsx(JH,{src:a,alt:"Board Icon"})]}),C.jsx(ZH,{children:C.jsx(XH,{categories:t,onCategorySelect:r,selectedCategory:n})})]}),e==="불구경"&&i==="live"&&C.jsx(e7,{children:C.jsx(VH,{selectedCategory:n})}),C.jsxs("div",{className:"flex items-center justify-between mt-4",children:[C.jsxs(t7,{children:["#",n]}),e!=="부채질"&&i&&o&&C.jsx(qH,{statuses:s(e),selectedStatus:i,onStatusSelect:o})]})]})}fm.defaultProps={selectedStatus:void 0,onStatusSelect:void 0,boardIcon:dm};function n7(){const[e,t]=O.useState("전체"),[n,r]=O.useState("live"),[i,o]=O.useState([]),[a,s]=O.useState(!1),[u,c]=O.useState(0),[l,d]=O.useState(!0),f=g=>{t(g),c(0),o([]),d(!0)},h=g=>{n!==g&&(r(g),c(0),o([]),d(!0))},p=async g=>{var v;try{s(!0);const y=e==="전체"||(v=gn.find(x=>x.name===e))==null?void 0:v.id;let b;switch(n){case"live":b=await _o.getActiveList(y,g,12);break;case"upcoming":b=await _o.getWaitList(y,g,12);break;case"ended":b=await _o.getEndList(y,g,12);break;default:return}const w=b.data||[];if(w.length===0){d(!1);return}const E=w.map(x=>({id:x.id,title:x.title,regist_user_id:x.registerUser.nickname.toString(),opposite_user_id:x.oppositeUser.nickname.toString(),start_date:x.startDate,end_date:x.endDate,max_people_count:x.currentPeopleCount||0,category:x.category,image_uri:x.imageUri||"",live_uri:x.roomId,status:n,currentPeopleCount:x.currentPeopleCount||0}));o(x=>[...x,...E])}catch(y){console.error("Failed to fetch live battles:",y)}finally{s(!1)}};O.useEffect(()=>{p(u)},[e,n,u]);const m=O.useCallback(()=>{window.innerHeight+document.documentElement.scrollTop+100>=document.documentElement.scrollHeight&&!a&&l&&c(g=>g+1)},[l,a]);return O.useEffect(()=>(window.addEventListener("scroll",m),()=>{window.removeEventListener("scroll",m)}),[m]),C.jsxs("div",{children:[C.jsx(Ba,{}),C.jsxs("div",{className:"p-10 pt-20",children:[C.jsx(fm,{boardName:"불구경",categories:gn,selectedCategory:e,onCategorySelect:f,selectedStatus:n,onStatusSelect:h}),a&&i.length===0?C.jsx("div",{children:"Loading..."}):C.jsx("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:i.map(g=>C.jsx(ZO,{card:g},g.id))})]})]})}const Fl=new Map([[-1,"Notify"],[0,"Invite"],[1,"Live"],[2,"Live"],[3,"Live"],[4,"Live"]]);function r7({isModalOpen:e,onModalClose:t,onDelete:n,onSendAcceptOrDecline:r,detail:i}){const[o,a]=O.useState(""),[s,u]=O.useState(!0),c=Fl.get(i.notifyCode);if(!e)return null;const l=h=>{h.target===h.currentTarget&&t()},d=h=>{u(h),a("")},f=async(h,p,m)=>{await r(h.specificData.battleId,p,m),n(h.id),t()};return C.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50 flex justify-center items-center z-50",onClick:l,children:C.jsxs("div",{className:"bg-white border border-slate-200 grid grid-cols-6 gap-2 rounded-xl p-2 text-sm",children:[C.jsx("h1",{className:"text-center text-royalBlue text-xl font-bold col-span-6",children:c}),c==="Invite"&&C.jsxs(C.Fragment,{children:[C.jsxs("h2",{className:"col-span-6 break-all w-full pre-wrap",children:["주제: ",i.specificData.title]}),C.jsxs("h2",{className:"col-span-6 break-all w-full pre-wrap",children:["날짜:"," ",pc(i.specificData.startDate,"Asia/Seoul")]}),C.jsxs("h2",{className:"col-span-6 break-all w-full pre-wrap",children:["상대방의 선택지:"," ",i.specificData.opinion]}),C.jsx("textarea",{placeholder:s?"본인의 선택지를 16글자 안으로 적어주세요.":"거절 사유를 적어주세요.",maxLength:s?16:void 0,value:o,onChange:h=>a(h.target.value),className:"bg-slate-100 text-slate-600 h-28 placeholder:text-slate-600 placeholder:opacity-50 border border-slate-200 col-span-6 resize-none outline-none rounded-lg p-2 duration-300 focus:border-slate-600"}),C.jsx("button",{type:"button",className:`fill-slate-600 col-span-1 flex justify-center items-center rounded-lg p-2 duration-300 bg-slate-100 ${s?"border border-royalBlue":"border border-slate-200"} hover:border-slate-600 focus:fill-blue-200 focus:bg-blue-400`,onClick:()=>d(!0),children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20px",viewBox:"0 0 512 512",children:C.jsx("path",{d:"M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm177.6 62.1C192.8 334.5 218.8 352 256 352s63.2-17.5 78.4-33.9c9-9.7 24.2-10.4 33.9-1.4s10.4 24.2 1.4 33.9c-22 23.8-60 49.4-113.6 49.4s-91.7-25.5-113.6-49.4c-9-9.7-8.4-24.9 1.4-33.9s24.9-8.4 33.9 1.4zM144.4 208a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm192-32a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"})})}),C.jsx("button",{type:"button",className:`fill-slate-600 col-span-1 flex justify-center items-center rounded-lg p-2 duration-300 bg-slate-100 ${s?"border border-slate-200":"border border-royalBlue"} hover:border-slate-600 focus:fill-blue-200 focus:bg-blue-400`,onClick:()=>d(!1),children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20px",viewBox:"0 0 512 512",children:C.jsx("path",{d:"M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm174.6 384.1c-4.5 12.5-18.2 18.9-30.7 14.4s-18.9-18.2-14.4-30.7C146.9 319.4 198.9 288 256 288s109.1 31.4 126.6 79.9c4.5 12.5-2 26.2-14.4 30.7s-26.2-2-30.7-14.4C328.2 358.5 297.2 336 256 336s-72.2 22.5-81.4 48.1zM144.4 208a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm192-32a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"})})})]}),c==="Live"&&C.jsxs("div",{className:"bg-slate-100 text-slate-600 h-28 placeholder:text-slate-600 placeholder:opacity-50 border border-slate-200 col-span-6 resize-none outline-none rounded-lg p-2 duration-300 focus:border-slate-600",children:[i.title,i.specificData&&C.jsxs("p",{children:["바로가기:"," ",C.jsx("a",{href:`/live/${i.specificData}`,className:"text-blue",children:`https://i11a706.p.ssafy.io/live/${i.specificData}`})]})]}),C.jsx("span",{className:"col-span-2"}),c==="Invite"&&C.jsx("button",{type:"button",className:"bg-slate-100 stroke-slate-600 border border-slate-200 col-span-2 flex justify-center rounded-lg p-2 duration-300 hover:border-slate-600 hover:text-white focus:stroke-blue-200 focus:bg-blue-400",onClick:()=>f(i,s?"accept":"decline",o),children:C.jsxs("svg",{fill:"none",viewBox:"0 0 24 24",height:"30px",width:"30px",xmlns:"http://www.w3.org/2000/svg",children:[C.jsx("path",{strokeLinejoin:"round",strokeLinecap:"round",strokeWidth:"1.5",d:"M7.39999 6.32003L15.89 3.49003C19.7 2.22003 21.77 4.30003 20.51 8.11003L17.68 16.6C15.78 22.31 12.66 22.31 10.76 16.6L9.91999 14.08L7.39999 13.24C1.68999 11.34 1.68999 8.23003 7.39999 6.32003Z"}),C.jsx("path",{strokeLinejoin:"round",strokeLinecap:"round",strokeWidth:"1.5",d:"M10.11 13.6501L13.69 10.0601"})]})})]})})}function i7({notification:e,onDelete:t,onViewDetail:n,onSendAcceptOrDecline:r}){const[i,o]=O.useState(!1),[a,s]=O.useState(!1),[u,c]=O.useState(null),l=f=>{s(!0),setTimeout(()=>{t(f)},300)},d=async()=>{try{const f=await n(e.id);f&&(c(f),o(!0))}catch(f){console.error("Failed to load notification detail:",f)}};return C.jsxs("div",{children:[C.jsxs("div",{className:`flex justify-between items-center p-4 mx-4
					border-solid border-royalBlue border-b-2 transition-transform 
					duration-300 ease-in-out ${a?"transform -translate-x-full":""} 
					${e.read?"bg-gray-200":"bg-white"}`,children:[C.jsx("div",{className:"cursor-pointer",onClick:d,children:e.title}),C.jsx("button",{type:"button",onClick:()=>l(e.id),className:"text-royalBlue",children:"X"})]}),i&&u&&C.jsx(r7,{isModalOpen:i,onModalClose:()=>o(!1),onDelete:t,onSendAcceptOrDecline:r,detail:u})]})}function o7({selectedMenu:e,onSelectMenu:t}){return C.jsxs("div",{className:"border-solid border-royalBlue border-4 rounded-md text-white",children:[C.jsx("button",{type:"button",className:`block w-full text-left py-2 px-4 pr-12 ${Fl.get(e)==="Notify"?"bg-royalBlue":"bg-white text-royalBlue"}`,onClick:()=>t(-1),children:"Notify"}),C.jsx("button",{type:"button",className:`block w-full text-left py-2 px-4 pr-12 ${Fl.get(e)==="Live"?"bg-royalBlue":"bg-white text-royalBlue"}`,onClick:()=>t(1),children:"Live"}),C.jsx("button",{type:"button",className:`block w-full text-left py-2 px-4 pr-12 ${Fl.get(e)==="Invite"?"bg-royalBlue":"bg-white text-royalBlue"}`,onClick:()=>t(0),children:"Invite"})]})}const Jf={getNotificationList:async()=>{try{return(await We.get("/notify")).data}catch(e){throw console.error("Failed to fetch notifications:",e),e}},getNotificationDetail:async e=>{try{return(await We.get(`/notify/detail/${e}`)).data}catch(t){throw console.error("Failed to fetch notifications:",t),t}},deleteNotification:async e=>{try{return(await We.delete(`/notify/${e}`)).status===204}catch(t){throw console.error("Failed to fetch notifications:",t),t}},sendAcceptOrDecline:async(e,t,n)=>{try{return(await We.put("/battle/accept-or-decline",{battleId:e,respond:t,content:n})).status===204}catch(r){throw console.error("Failed to send accept or decline response:",r),r}}},hm=()=>{const e=xn(),{isLogin:t}=Pn();return O.useEffect(()=>{t||($e.error("로그인이 필요합니다",{autoClose:1e3}),e("/login"))},[t,e]),{isLogin:t}};function a7(){hm();const[e,t]=O.useState(-1),[n,r]=O.useState([]);O.useEffect(()=>{(async()=>{try{const c=await Jf.getNotificationList();r(c.data)}catch(c){console.error("Failed to load notifications:",c)}})()},[]);const i=Fl.get(e)==="Notify"?n:n.filter(u=>u.notifyCode===e),o=async u=>{try{await Jf.deleteNotification(u),r(c=>c.filter(l=>l.id!==u))}catch(c){console.error("Failed to delete notification",c)}},a=async(u,c,l)=>{try{return await Jf.sendAcceptOrDecline(u,c,l)}catch(d){return console.error("Failed to send accept or decline response",d),!1}},s=async u=>{try{const l=(await Jf.getNotificationDetail(u)).data;return l.notifyCode===0,l}catch(c){return console.error("Failed to fetch notification detail:",c),null}};return C.jsxs(C.Fragment,{children:[C.jsx(Ba,{}),C.jsxs("div",{className:"flex flex-col pt-28 px-20",children:[C.jsx("div",{className:"text-4xl text-royalBlue mb-5",children:"알림"}),C.jsx("div",{className:"bg-royalBlue w-1/5 h-2 rounded-lg mb-10"}),C.jsxs("div",{className:"flex flex-row",children:[C.jsx("div",{children:C.jsx(o7,{selectedMenu:e,onSelectMenu:t})}),C.jsx("div",{className:"ml-16 h-128 flex-1 border-solid border-royalBlue border-4 rounded-lg overflow-hidden overflow-y-auto custom-scrollbar",children:i.length>0&&i.map(u=>C.jsx(i7,{notification:u,onDelete:()=>o(u.id),onViewDetail:()=>s(u.id),onSendAcceptOrDecline:a},u.id))})]})]})]})}const s7=J.div`
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background-color: rgba(0, 0, 0, 0.5);
	display: flex;
	justify-content: center;
	align-items: center;
	z-index: 10;
`,u7=J.div`
	background-color: white;
	padding: 20px;
	border-radius: 10px;
	box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
	max-width: 400px;
	width: 100%;
	text-align: center;
	position: relative;
`,c7=J.h2`
	color: #1d3d6b;
	font-size: 25px;
	margin-top: 20px;
	margin-bottom: 10px;
`,l7=J.p`
	color: #1d3d6b;
	font-size: 15px;
	margin-bottom: 20px;
`,N2=J.button`
	background-color: #1d3d6b;
	color: white;
	border: none;
	padding: 10px;
	border-radius: 5px;
	cursor: pointer;
	margin: 5px 0;
	width: 100%;

	&:hover {
		background-color: #fbca27;
		color: #1d3d6b;
	}
`,d7=J.button`
	position: absolute;
	top: 10px;
	right: 10px;
	background: none;
	border: none;
	font-size: 20px;
	cursor: pointer;
	color: #1d3d6b;
`;function f7({showModal:e,setShowModal:t,title:n,opinion1:r,opinion2:i,onVote:o}){if(!e)return null;const a=()=>{t(!1)},s=u=>{u.stopPropagation()};return C.jsx(s7,{onClick:a,children:C.jsxs(u7,{onClick:s,children:[C.jsx(d7,{onClick:()=>t(!1),children:"X"}),C.jsx(c7,{children:n}),C.jsx(l7,{children:"투표할 내용을 선택해주세요."}),C.jsx(N2,{onClick:()=>o(r),children:r}),C.jsx(N2,{onClick:()=>o(i),children:i})]})})}const h7="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAI8AAABBCAYAAADogfdXAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAELSURBVHgB7dLRScRAAEXRwUa0E+1EO0kplpJSthSNsEJYhtlwv8/5CpOXhMAdPxPj7rjcHs/OjuPb/fY2Ljh2X6fPvF7c/ft+8u79cXc621dnT9539rHYv0/2+8XdbbJ7W+3+/nNy/3Os/2llm+y21bMvAyLxkImHTDxk4iETD5l4yMRDJh4y8ZCJh0w8ZOIhEw+ZeMjEQyYeMvGQiYdMPGTiIRMPmXjIxEMmHjLxkImHTDxk4iETD5l4yMRDJh4y8ZCJh0w8ZOIhEw+ZeMjEQyYeMvGQiYdMPGTiIRMPmXjIxEMmHjLxkImHTDxk4iETD5l4yMRDJh4y8ZCJh0w8ZOIhEw+ZeMjEQ/YLTTMkRBab3DMAAAAASUVORK5CYII=",p7="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAI8AAABBCAYAAADogfdXAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAF7SURBVHgB7dJNTiJRFIbhe+neRUtC70P82QnOVBah7kGYqivRBHUbaMBlQAkDTWkKTb7x80wgp04uKe5b+8NxU75ZzCZ1+7m3f35Ra71sz9r6B+N5acqgaZrL5eP0qvzi3/B81Cv1Zvv976oM5s+T19/2Pq2b28XT9GTX2f398X2p5ai99zHbvODDcjY53jX78byWpqnHy8frh679veHZYS29L8+6fqNrb7P5sphN/7cng6PTwWr1Z75rb3Nv2/9n1H66XpfR29Pkrux6p467/jy5dYcfe12ztl6BkHiIiYeYeIiJh5h4iImHmHiIiYeYeIiJh5h4iImHmHiIiYeYeIiJh5h4iImHmHiIiYeYeIiJh5h4iImHmHiIiYeYeIiJh5h4iImHmHiIiYeYeIiJh5h4iImHmHiIiYeYeIiJh5h4iImHmHiIiYeYeIiJh5h4iImHmHiIiYeYeIiJh5h4iImHmHiIiYeYeIiJh5h4iImHmHiIiYeYeIi9A0B1ZUYa3N9HAAAAAElFTkSuQmCC",D2={navy:{backgroundColor:"#1D3D6B",borderColor:"#FBCA27",textColor:"#FBCA27",buttonColor:"#1e3a8a",buttonBackgroundColor:"#ffffff",titleColor:"#ffffff",attendeeCountColor:"#FFFFFF",barcodeImage:h7},yellow:{backgroundColor:"#FBCA27",borderColor:"#1D3D6B",textColor:"#1D3D6B",buttonColor:"#FFFFFF",buttonBackgroundColor:"#1D3D6B",titleColor:"#1D3D6B",attendeeCountColor:"#1D3D6B",barcodeImage:p7}},v7=J.div`
	display: flex;
	align-items: center;
	padding: 16px;
	margin: 8px;
	width: 600px;
	position: relative;
	${({theme:e})=>ui`
		background-color: ${e.backgroundColor};
		color: white;
		box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
	`}
`,m7=J.div`
	flex: 1;
	padding-right: 16px;
`,g7=J.div`
	font-size: 14px;
	margin-bottom: 8px;
	${({theme:e})=>ui`
		color: ${e.titleColor};
	`}
`,y7=J.div`
	padding: 16px;
	margin-bottom: 8px;
	${({theme:e})=>ui`
		border: 3px solid ${e.borderColor};
		background-color: ${e.backgroundColor};
	`}
`,b7=J.div`
	font-size: 24px;
	${({theme:e})=>ui`
		color: ${e.textColor};
	`}
	margin-bottom: 8px;
`,w7=J.div`
	font-size: 18px;
	${({theme:e})=>ui`
		color: ${e.textColor};
	`}
	margin-bottom: 8px;
`,x7=J.div`
	font-size: 14px;
	${({theme:e})=>ui`
		color: ${e.textColor};
	`}
`,E7=J.div`
	display: flex;
	flex-direction: column;
	align-items: center;
	margin-left: 16px;
	margin-top: 18px;
`,S7=J.img`
	height: 40px;
	width: 64px;
	margin-bottom: 20px;
`,C7=J.div`
	border-radius: 9999px;
	padding: 4px 16px;
	margin-bottom: 8px;
	cursor: ${({disabled:e})=>e?"not-allowed":"pointer"};
	${({theme:e})=>ui`
		background-color: ${e.buttonBackgroundColor};
		color: ${e.buttonColor};
	`}
`,_7=J.div`
	font-size: 14px;
	${({theme:e})=>ui`
		color: ${e.attendeeCountColor};
	`}
`,k7=J.div`
	position: absolute;
	top: 0;
	bottom: 0;
	left: calc(100% - 100px);
	width: 2px;
	background: repeating-linear-gradient(
		to bottom,
		transparent,
		transparent 4px,
		#fff 4px,
		#fff 8px
	);
`;function R7({themeData:e,title:t,opinions:n,startDate:r}){return C.jsxs(y7,{theme:e,children:[C.jsx(b7,{theme:e,children:t}),C.jsx(w7,{theme:e,children:`${n[0].opinion} VS ${n[1].opinion}`}),C.jsx(x7,{theme:e,children:r})]})}function I7({themeData:e,barcodeImage:t,isVoted:n,currentPeopleCount:r,maxPeopleCount:i,onAttend:o}){const a=()=>{n||o()};return C.jsxs(E7,{children:[C.jsx(S7,{src:t,alt:"Barcode"}),C.jsx(C7,{theme:e,onClick:a,disabled:n,children:n?"완료":"참석"}),C.jsx(_7,{theme:e,children:`${r}/${i}`})]})}function T7({ticket:e,theme:t="navy",onVote:n}){const r=D2[t]||D2.navy,[i,o]=O.useState(!1),a=async s=>{var c;const u=(c=e.opinions.find(l=>l.opinion===s))==null?void 0:c.index;u!==void 0&&(await n(e.id,u),o(!1))};return C.jsxs(v7,{theme:r,children:[C.jsxs(m7,{children:[C.jsx(g7,{theme:r,children:"Ticket To Live"}),C.jsx(R7,{themeData:r,title:e.title,opinions:e.opinions,startDate:e.startDate})]}),C.jsx(k7,{}),C.jsx(I7,{themeData:r,barcodeImage:r.barcodeImage,isVoted:e.isVoted,currentPeopleCount:e.currentPeopleCount,maxPeopleCount:e.maxPeopleCount,onAttend:()=>o(!0)}),C.jsx(f7,{showModal:i,setShowModal:o,title:e.title,opinion1:e.opinions[0].opinion,opinion2:e.opinions[1].opinion,onVote:a})]})}const O7=J.button`
	position: fixed;
	bottom: 40px;
	right: 30px;
	background: none;
	border: none;
	cursor: pointer;
	outline: none;

	.plus-button-svg {
		width: 50px;
		height: 50px;
		transition:
			transform 0.3s,
			fill 0.3s,
			stroke 0.3s;
	}

	&:hover .plus-button-svg {
		transform: rotate(90deg);
		stroke: ${e=>e.strokeColor};
		fill: ${e=>e.fillColor};
	}

	&:active .plus-button-svg {
		stroke: ${e=>e.strokeColor};
		fill: ${e=>e.fillColor};
		transition-duration: 0s;
	}
`;function Uw({strokeColor:e,fillColor:t,defaultForm:n="general"}){const r=xn(),{isLogin:i,user:o}=Pn(),a=()=>{i&&o?r("/ignition",{state:{user:o,defaultForm:n}}):($e.error("로그인이 필요합니다",{autoClose:1e3}),r("/login"))};return C.jsx(O7,{title:"새로운 토론 주제 작성",className:"plus-button",strokeColor:e,fillColor:t,onClick:a,children:C.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"plus-button-svg stroke-zinc-400 fill-none",children:[C.jsx("path",{d:"M12 22C17.5 22 22 17.5 22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22Z",strokeWidth:"1.5"}),C.jsx("path",{d:"M8 12H16",strokeWidth:"1.5"}),C.jsx("path",{d:"M12 16V8",strokeWidth:"1.5"})]})})}Uw.defaultProps={strokeColor:"#1d3d6b",fillColor:"#fbca27"};const V1={getBattles:async(e,t=0,n=10)=>{try{return(await We.get("/battle",{params:{category:e,page:t,size:n}})).data}catch(r){throw console.error("Failed to fetch battles:",r),r}},inviteBattle:async e=>{try{return(await We.post("/battle/invite",e)).data}catch(t){throw console.error("Failed to invite to battle:",t),t}},respondToBattleInvite:async e=>{try{return(await We.post("/battle/accept-or-decline",e)).data}catch(t){throw console.error(`Failed to ${e.respond} battle invite:`,t),t}},getApplyList:async(e,t=0,n=10)=>{try{return(await We.get("/battle/apply-list",{params:{page:t,size:n,category:e}})).data}catch(r){throw console.error("Failed to fetch apply list:",r),r}},preVoteToBattle:async e=>{try{return(await We.post("/battle/apply",e)).data}catch(t){throw console.error("Failed to apply to battle:",t),t}}},P7=J.div`
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background-color: rgba(0, 0, 0, 0.5);
	display: flex;
	justify-content: center;
	align-items: center;
	z-index: 20;
`,N7=J.div`
	background-color: white;
	padding: 20px;
	border-radius: 10px;
	box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
	max-width: 550px;
	width: 100%;
	text-align: center;
	position: relative;
`,D7=J.p`
	color: #1d3d6b;
	font-size: 18px;
	margin-bottom: 20px;
	padding: 20px;
`,A7=J.button`
	background-color: #1d3d6b;
	color: white;
	border: none;
	padding: 10px;
	border-radius: 5px;
	cursor: pointer;
	width: 90%;

	&:hover {
		background-color: #fbca27;
		color: #1d3d6b;
	}
`,M7=J.button`
	position: absolute;
	top: 10px;
	right: 10px;
	background: none;
	border: none;
	font-size: 20px;
	cursor: pointer;
	color: #1d3d6b;
`;function L7({show:e,onClose:t,message:n}){if(!e)return null;const r=i=>{i.stopPropagation()};return C.jsx(P7,{onClick:t,children:C.jsxs(N7,{onClick:r,children:[C.jsx(M7,{onClick:t,children:"X"}),C.jsx(D7,{children:n}),C.jsx(A7,{onClick:t,children:"확인"})]})})}const F7=J.div`
	display: flex;
	justify-content: center;
	align-items: center;
	padding: 30px 0;
	width: 100%;
`,B7=J.div`
	display: grid;
	grid-template-columns: repeat(1, 1fr);
	gap: 10px;
	width: 100%;
	max-width: 1200px;

	@media (min-width: 640px) {
		grid-template-columns: repeat(2, 1fr);
	}
`;function j7(){const[e,t]=O.useState("전체"),[n,r]=O.useState([]),[i,o]=O.useState(!1),[a,s]=O.useState(0),[u,c]=O.useState(!0),[l,d]=O.useState(!1),[f,h]=O.useState(""),p=xn(),{isLogin:m}=Pn(),g=w=>{t(w),s(0),r([]),c(!0)},v=async(w,E)=>{if(!m){$e.error("로그인이 필요합니다",{autoClose:1e3}),p("/login");return}try{const x={battleId:w,selectedOpinion:E};console.log("requestData",x);const R=await V1.preVoteToBattle(x);if(console.log("사전투표 결과",R),R.data===-1){h("본인이 참여하는 라이브에는 사전투표를 할 수 없습니다."),d(!0);return}if(R.data===-3){h("모집인원이 마감되어 사전 투표를 실패하였습니다."),d(!0);return}if(R.data===-4){h("해당 시간에 본인이 진행하는 라이브가 존재하여 참여할 수 없습니다."),d(!0);return}const S=n.map(_=>_.id===w?{..._,currentPeopleCount:R.data??0,isVoted:!0}:_);r(S)}catch(x){console.error("Failed to submit vote:",x)}},y=O.useCallback(()=>{window.innerHeight+document.documentElement.scrollTop+100>=document.documentElement.scrollHeight&&!i&&u&&s(w=>w+1)},[u,i]);O.useEffect(()=>{(async()=>{var E;if(!(i||!u)){o(!0);try{const x=e==="전체"||(E=gn.find(T=>T.name===e))==null?void 0:E.id,_=((await V1.getApplyList(x,a,5)).data||[]).map(T=>({id:T.id,title:T.title,opinions:T.opinions.map(B=>({index:B.index,opinion:B.opinion})),startDate:pc(T.startDate,"Asia/Seoul"),endDate:pc(T.endDate,"Asia/Seoul"),maxPeopleCount:T.maxPeopleCount,currentPeopleCount:T.currentPeopleCount,isVoted:T.isVoted}));_.length>0?r(T=>[...T,..._]):c(!1)}catch(x){console.error("Failed to fetch battles:",x)}finally{o(!1)}}})()},[e,a]),O.useEffect(()=>(window.addEventListener("scroll",y),()=>{window.removeEventListener("scroll",y)}),[y]);const b=w=>w===1||w===2||w>=5&&(w-1)%4<2?"yellow":"navy";return C.jsxs("div",{children:[C.jsx(Ba,{}),C.jsxs("div",{className:"p-10 pt-20",children:[C.jsx(fm,{boardName:"부채질",categories:gn,selectedCategory:e,onCategorySelect:g,boardIcon:$P}),C.jsx(F7,{children:C.jsx(B7,{children:n.map((w,E)=>C.jsx(T7,{ticket:w,theme:b(E),onVote:v},w.id))})})]}),C.jsx(Uw,{strokeColor:"#1D3D6B",fillColor:"#FBCA27",defaultForm:"live"}),C.jsx(L7,{show:l,onClose:()=>d(!1),message:f})]})}var zP={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},A2=we.createContext&&we.createContext(zP),$7=["attr","size","title"];function V7(e,t){if(e==null)return{};var n=W7(e,t),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function W7(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Up(){return Up=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Up.apply(this,arguments)}function M2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function zp(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?M2(Object(n),!0).forEach(function(r){U7(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M2(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function U7(e,t,n){return t=z7(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z7(e){var t=H7(e,"string");return typeof t=="symbol"?t:t+""}function H7(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HP(e){return e&&e.map((t,n)=>we.createElement(t.tag,zp({key:n},t.attr),HP(t.child)))}function Bs(e){return t=>we.createElement(G7,Up({attr:zp({},e.attr)},t),HP(e.child))}function G7(e){var t=n=>{var{attr:r,size:i,title:o}=e,a=V7(e,$7),s=i||n.size||"1em",u;return n.className&&(u=n.className),e.className&&(u=(u?u+" ":"")+e.className),we.createElement("svg",Up({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,a,{className:u,style:zp(zp({color:e.color||n.color},n.style),e.style),height:s,width:s,xmlns:"http://www.w3.org/2000/svg"}),o&&we.createElement("title",null,o),e.children)};return A2!==void 0?we.createElement(A2.Consumer,null,n=>t(n)):t(zP)}function q7(e){return Bs({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M440.5 88.5l-52 52L415 167c9.4 9.4 9.4 24.6 0 33.9l-17.4 17.4c11.8 26.1 18.4 55.1 18.4 85.6 0 114.9-93.1 208-208 208S0 418.9 0 304 93.1 96 208 96c30.5 0 59.5 6.6 85.6 18.4L311 97c9.4-9.4 24.6-9.4 33.9 0l26.5 26.5 52-52 17.1 17zM500 60h-24c-6.6 0-12 5.4-12 12s5.4 12 12 12h24c6.6 0 12-5.4 12-12s-5.4-12-12-12zM440 0c-6.6 0-12 5.4-12 12v24c0 6.6 5.4 12 12 12s12-5.4 12-12V12c0-6.6-5.4-12-12-12zm33.9 55l17-17c4.7-4.7 4.7-12.3 0-17-4.7-4.7-12.3-4.7-17 0l-17 17c-4.7 4.7-4.7 12.3 0 17 4.8 4.7 12.4 4.7 17 0zm-67.8 0c4.7 4.7 12.3 4.7 17 0 4.7-4.7 4.7-12.3 0-17l-17-17c-4.7-4.7-12.3-4.7-17 0-4.7 4.7-4.7 12.3 0 17l17 17zm67.8 34c-4.7-4.7-12.3-4.7-17 0-4.7 4.7-4.7 12.3 0 17l17 17c4.7 4.7 12.3 4.7 17 0 4.7-4.7 4.7-12.3 0-17l-17-17zM112 272c0-35.3 28.7-64 64-64 8.8 0 16-7.2 16-16s-7.2-16-16-16c-52.9 0-96 43.1-96 96 0 8.8 7.2 16 16 16s16-7.2 16-16z"},child:[]}]})(e)}function X7(e){return Bs({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M633.82 458.1l-157.8-121.96C488.61 312.13 496 285.01 496 256v-48c0-8.84-7.16-16-16-16h-16c-8.84 0-16 7.16-16 16v48c0 17.92-3.96 34.8-10.72 50.2l-26.55-20.52c3.1-9.4 5.28-19.22 5.28-29.67V96c0-53.02-42.98-96-96-96s-96 42.98-96 96v45.36L45.47 3.37C38.49-2.05 28.43-.8 23.01 6.18L3.37 31.45C-2.05 38.42-.8 48.47 6.18 53.9l588.36 454.73c6.98 5.43 17.03 4.17 22.46-2.81l19.64-25.27c5.41-6.97 4.16-17.02-2.82-22.45zM400 464h-56v-33.77c11.66-1.6 22.85-4.54 33.67-8.31l-50.11-38.73c-6.71.4-13.41.87-20.35.2-55.85-5.45-98.74-48.63-111.18-101.85L144 241.31v6.85c0 89.64 63.97 169.55 152 181.69V464h-56c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16z"},child:[]}]})(e)}function K7(e){return Bs({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M176 352c53.02 0 96-42.98 96-96V96c0-53.02-42.98-96-96-96S80 42.98 80 96v160c0 53.02 42.98 96 96 96zm160-160h-16c-8.84 0-16 7.16-16 16v48c0 74.8-64.49 134.82-140.79 127.38C96.71 376.89 48 317.11 48 250.3V208c0-8.84-7.16-16-16-16H16c-8.84 0-16 7.16-16 16v40.16c0 89.64 63.97 169.55 152 181.69V464H96c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16h-56v-33.77C285.71 418.47 352 344.9 352 256v-48c0-8.84-7.16-16-16-16z"},child:[]}]})(e)}function Y7(e){return Bs({tag:"svg",attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zM112 223.4c3.3-42.1 32.2-71.4 56-71.4s52.7 29.3 56 71.4c.7 8.6-10.8 11.9-14.9 4.5l-9.5-17c-7.7-13.7-19.2-21.6-31.5-21.6s-23.8 7.9-31.5 21.6l-9.5 17c-4.3 7.4-15.8 4-15.1-4.5zm250.8 122.8C334.3 380.4 292.5 400 248 400s-86.3-19.6-114.8-53.8c-13.5-16.3 11-36.7 24.6-20.5 22.4 26.9 55.2 42.2 90.2 42.2s67.8-15.4 90.2-42.2c13.6-16.2 38.1 4.3 24.6 20.5zm6.2-118.3l-9.5-17c-7.7-13.7-19.2-21.6-31.5-21.6s-23.8 7.9-31.5 21.6l-9.5 17c-4.1 7.3-15.6 4-14.9-4.5 3.3-42.1 32.2-71.4 56-71.4s52.7 29.3 56 71.4c.6 8.6-11 11.9-15.1 4.5z"},child:[]}]})(e)}function Q7(e){return Bs({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M206.86 245.15c-35.88 10.45-59.95 41.2-57.53 74.1 11.4-12.72 28.81-23.7 49.9-30.92l7.63-43.18zM95.81 295L64.08 115.49c-.29-1.62.28-2.62.24-2.65 57.76-32.06 123.12-49.01 189.01-49.01 1.61 0 3.23.17 4.85.19 13.95-13.47 31.73-22.83 51.59-26 18.89-3.02 38.05-4.55 57.18-5.32-9.99-13.95-24.48-24.23-41.77-27C301.27 1.89 277.24 0 253.32 0 176.66 0 101.02 19.42 33.2 57.06 9.03 70.48-3.92 98.48 1.05 126.58l31.73 179.51c14.23 80.52 136.33 142.08 204.45 142.08 3.59 0 6.75-.46 10.01-.8-13.52-17.08-28.94-40.48-39.5-67.58-47.61-12.98-106.06-51.62-111.93-84.79zm97.55-137.46c-.73-4.12-2.23-7.87-4.07-11.4-8.25 8.91-20.67 15.75-35.32 18.32-14.65 2.58-28.67.4-39.48-5.17-.52 3.94-.64 7.98.09 12.1 3.84 21.7 24.58 36.19 46.34 32.37 21.75-3.82 36.28-24.52 32.44-46.22zM606.8 120.9c-88.98-49.38-191.43-67.41-291.98-51.35-27.31 4.36-49.08 26.26-54.04 54.36l-31.73 179.51c-15.39 87.05 95.28 196.27 158.31 207.35 63.03 11.09 204.47-53.79 219.86-140.84l31.73-179.51c4.97-28.11-7.98-56.11-32.15-69.52zm-273.24 96.8c3.84-21.7 24.58-36.19 46.34-32.36 21.76 3.83 36.28 24.52 32.45 46.22-.73 4.12-2.23 7.87-4.07 11.4-8.25-8.91-20.67-15.75-35.32-18.32-14.65-2.58-28.67-.4-39.48 5.17-.53-3.95-.65-7.99.08-12.11zm70.47 198.76c-55.68-9.79-93.52-59.27-89.04-112.9 20.6 25.54 56.21 46.17 99.49 53.78 43.28 7.61 83.82.37 111.93-16.6-14.18 51.94-66.71 85.51-122.38 75.72zm130.3-151.34c-8.25-8.91-20.68-15.75-35.33-18.32-14.65-2.58-28.67-.4-39.48 5.17-.52-3.94-.64-7.98.09-12.1 3.84-21.7 24.58-36.19 46.34-32.37 21.75 3.83 36.28 24.52 32.45 46.22-.73 4.13-2.23 7.88-4.07 11.4z"},child:[]}]})(e)}function J7(e){return Bs({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M128 160h320v192H128V160zm400 96c0 26.51 21.49 48 48 48v96c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48v-96c26.51 0 48-21.49 48-48s-21.49-48-48-48v-96c0-26.51 21.49-48 48-48h480c26.51 0 48 21.49 48 48v96c-26.51 0-48 21.49-48 48zm-48-104c0-13.255-10.745-24-24-24H120c-13.255 0-24 10.745-24 24v208c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24V152z"},child:[]}]})(e)}function L2({isMicMuted:e,isVideoDisabled:t,onMicClick:n,onVideoClick:r}){return C.jsxs("div",{className:"flex items-center space-x-4 ms-6",children:[C.jsx("div",{className:"flex items-center cursor-pointer me-2","aria-label":"Toggle Video",role:"button",children:t?C.jsx(Q7,{size:36,className:"text-white cursor-pointer transform hover:scale-110",onClick:r,color:"white"}):C.jsx(Y7,{size:36,className:"text-white cursor-pointer transform hover:scale-110",onClick:r,color:"white"})}),C.jsx("div",{className:"flex items-center cursor-pointer","aria-label":"Toggle Microphone",role:"button",children:e?C.jsx(X7,{size:36,className:"text-white cursor-pointer transform hover:scale-110",onClick:n}):C.jsx(K7,{size:34,className:"text-white cursor-pointer transform hover:scale-110",onClick:n})})]})}function Z7(){const[e,t]=O.useState(2),[n,r]=O.useState(1),i=()=>{t(a=>Math.max(a-1,0))},o=()=>{r(a=>Math.max(a-1,0))};return C.jsxs("div",{className:"flex items-center space-x-4 me-4",children:[C.jsxs("div",{className:"flex items-center",children:[C.jsx(q7,{size:36,className:"text-white cursor-pointer transform hover:scale-110 hover:text-orange",onClick:i,"aria-label":"Use Bomb",role:"button"}),C.jsx("span",{className:"text-red-500 text-xl ml-2 me-2",children:e})]}),C.jsxs("div",{className:"flex items-center",children:[C.jsx(J7,{size:36,className:"text-white cursor-pointer transform hover:scale-110 hover:text-blue",onClick:o,"aria-label":"Use Ticket",role:"button"}),C.jsx("span",{className:"text-red-500 text-xl ml-2",children:n})]})]})}function e9({isMicMuted:e,isVideoDisabled:t,canUseItem:n,onMicClick:r,onVideoClick:i}){return console.debug(e,t,r,i,Z7,L2),console.log(n),C.jsx("div",{className:"flex justify-between w-full p-2 mt-6 bg-black rounded-lg h-[52px]",children:n&&C.jsx(L2,{isMicMuted:e,isVideoDisabled:t,onMicClick:r,onVideoClick:i})})}function GP({className:e,streamManager:t,toastId:n}){const r=O.useRef(null),i=O.useRef();return O.useEffect(()=>()=>{i.current&&clearInterval(i.current),n.current&&$e.dismiss(n.current)},[]),O.useEffect(()=>{t&&r.current&&(t.addVideoElement(r.current),t.stream.isLocal()||(r.current.muted=!1),r.current.play().catch(()=>{n.current===void 0&&(n.current=$e.info("브라우저 정책으로 인해 토론을 보려면 클릭이나 키보드 입력을 해주세요",{autoClose:!1})),i.current=setInterval(()=>{var o;(o=r.current)!=null&&o.paused?r.current.play():(clearInterval(i.current),n.current&&$e.dismiss(n.current),n.current=void 0)},200)}))},[t]),C.jsxs("div",{className:e,children:[C.jsx("video",{ref:r,autoPlay:!0,playsInline:!0,preload:"none",className:t?"w-full max-w-[480px] max-h-[240px]":"hidden",children:C.jsx("track",{kind:"captions",default:!0})}),C.jsxs("div",{className:t?"hidden":"flex flex-col items-center justify-center",children:[C.jsx("p",{className:"relative",children:"발언자가 접속하기를 기다리는중"}),C.jsxs("div",{className:"loading",children:[C.jsx("span",{}),C.jsx("span",{}),C.jsx("span",{}),C.jsx("span",{}),C.jsx("span",{})]})]})]})}const t9="/assets/LiveVS-CVT2ikIk.png",qP=Ic("black",4);function n9({userName:e,streamManager:t,toastId:n}){return C.jsxs("div",{className:"w-full h-full flex flex-col items-end",children:[C.jsx(GP,{className:`w-4/5 h-auto aspect-[255/450] mt-5 mb-8 clip-path-left bg-white flex justify-${t?"end":"center"} items-center`,streamManager:t,toastId:n}),C.jsx("div",{className:"w-full flex flex-col text-white p-2 ps-14 mt-2",style:qP,children:C.jsx("div",{className:"font-bold break-normal whitespace-nowrap",style:{fontSize:"clamp(1rem, 3.5vw, 3rem)"},children:e})})]})}function r9({userName:e,streamManager:t,toastId:n}){return C.jsxs("div",{className:"w-full h-full flex flex-col items-start",children:[C.jsx("div",{className:"w-full flex flex-col items-end text-white pe-12 mb-4",style:qP,children:C.jsx("div",{className:"font-bold break-normal whitespace-nowrap",style:{fontSize:"clamp(1rem, 3.5vw, 3rem)"},children:e})}),C.jsx(GP,{className:`w-5/6 h-auto aspect-[255/250] mb-9 mt-6 clip-path-right bg-white flex justify-${t?"start":"center"} items-center`,streamManager:t,toastId:n})]})}function i9({subscribers:e,registerUser:t,oppositeUser:n}){const r=O.useRef();return C.jsxs("div",{className:"relative h-70% w-full",children:[C.jsxs("div",{className:"h-full w-full bg-[url('@/assets/images/LivePlayers.png')] bg-contain bg-center bg-no-repeat flex",children:[C.jsx(n9,{userName:(t==null?void 0:t.nickname)||"익명A",streamManager:e.find(i=>{var o;return((o=i.stream.connection.serverData)==null?void 0:o.index)===0}),toastId:r}),C.jsx(r9,{userName:(n==null?void 0:n.nickname)||"익명B",streamManager:e.find(i=>{var o;return((o=i.stream.connection.serverData)==null?void 0:o.index)===1}),toastId:r})]}),C.jsx("div",{className:"absolute z-10 w-1/3 top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:C.jsx("img",{src:t9,alt:"VS"})})]})}const o9=e=>{const t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=e%60;return`${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}:${String(r).padStart(2,"0")}`};function a9({duration:e,onTimeOver:t}){const[n,r]=O.useState(e),i=O.useRef(null);return O.useEffect(()=>(i.current!==null&&clearInterval(i.current),i.current=window.setInterval(()=>{r(o=>o<=1?(i.current!==null&&clearInterval(i.current),0):o-1)},1e3),()=>{i.current!==null&&clearInterval(i.current)}),[e]),O.useEffect(()=>{n===0&&t()},[n,t]),C.jsx("div",{className:"absolute top-20 left-3",children:C.jsx("div",{className:"ms-3",children:o9(n)})})}function s9({voteState:e}){return C.jsxs("div",{className:"relative w-full h-10 flex items-center border-solid border-4 border-black rounded-lg overflow-hidden",children:[C.jsx("span",{className:"absolute left-0 pl-2 text-black font-bold z-10",children:e.opinions[0].count}),C.jsx("span",{className:"absolute right-0 pr-2 text-black font-bold z-10",children:e.opinions[1].count}),C.jsxs("div",{className:"w-full h-full relative",children:[C.jsx("div",{className:"bg-orange h-full absolute left-0 transition-all duration-500",style:{width:`${e.opinions[0].percentage}%`}}),C.jsx("div",{className:"bg-blue h-full absolute right-0 transition-all duration-500",style:{width:`${e.opinions[1].percentage}%`}})]})]})}function u9({choice:e,setChoice:t,userId:n,role:r,voteState:i,title:o,optionA:a,optionB:s,handleVote:u,onVoteEnd:c}){O.useEffect(()=>{const d=i.opinions[0].count>i.opinions[1].count?a:s;c(d)},[c,a,s,i]);const l=d=>{u(n,d),t(d)};return C.jsxs("div",{className:"flex flex-col items-center mb-2",children:[C.jsx("h1",{className:"text-2xl my-2",children:o}),C.jsxs("div",{className:"flex flex-row items-center justify-between w-3/4",children:[C.jsx("button",{type:"button",className:`bg-gray-800 me-3 mb-4 px-3 py-2 rounded-md text-white tracking-wider shadow-xl animate-bounce hover:animate-none ${e===0?"bg-olive text-white":""}`,onClick:()=>l(0),disabled:r===0||r===1,children:a}),C.jsx(s9,{voteState:i}),C.jsx("button",{type:"button",className:`bg-gray-800 ms-3 mb-4 px-3 py-2 rounded-md text-white tracking-wider shadow-xl animate-bounce hover:animate-none ${e===1?"bg-olive text-white":""}`,onClick:()=>l(1),disabled:r===0||r===1,children:s})]})]})}function c9(e){return Bs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M19.0001 13.9999L19.0002 5L17.0002 4.99997L17.0001 11.9999L6.8283 12L10.778 8.05024L9.36381 6.63603L2.99985 13L9.36381 19.364L10.778 17.9497L6.82825 14L19.0001 13.9999Z"},child:[]}]})(e)}function l9({user:e,message:t,userVote:n}){let r="";return n===0?r="border-orange":n===1&&(r="border-blue"),C.jsx("div",{className:`mb-2 p-2 border-solid border-2 rounded-lg ${r}`,children:C.jsxs("div",{children:[C.jsx("strong",{children:e.nickname}),": ",t]})})}function d9({sendMessage:e}){const[t,n]=O.useState(""),r=O.useRef(null),i=o=>{o.key==="Enter"&&!o.shiftKey&&t.trim()!==""&&(o.preventDefault(),e(t),n(""))};return O.useEffect(()=>{if(r.current){r.current.style.height="auto";const{scrollHeight:o}=r.current;r.current.style.height=`${Math.min(o,100)}px`}},[t]),C.jsxs("div",{className:"flex p-2 border-solid border-4 border-black rounded-lg",children:[C.jsx("textarea",{ref:r,value:t,onChange:o=>n(o.target.value),onKeyDown:i,placeholder:"채팅을 입력해주세요.",className:"flex-1 px-2 py-1 outline-none resize-none overflow-y-auto scrollbar-hide"}),C.jsx(c9,{className:"h-full w-6"})]})}function f9({messages:e,sendMessage:t,userId:n}){return C.jsxs("div",{className:"flex flex-col h-full",children:[C.jsx("div",{className:"flex-1 overflow-y-auto p-2 my-2 border-solid border-4 border-black rounded-lg flex flex-col-reverse scrollbar-hide break-all",children:C.jsx("div",{children:e.map(r=>C.jsx(l9,{idx:r.idx,user:r.user,message:r.message,userVote:r.userVote},r.idx))})}),C.jsx(d9,{sendMessage:r=>t(n,r)})]})}var zw={};(function e(t,n,r,i){var o=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),a=typeof Path2D=="function"&&typeof DOMMatrix=="function",s=function(){if(!t.OffscreenCanvas)return!1;var P=new OffscreenCanvas(1,1),A=P.getContext("2d");A.fillRect(0,0,1,1);var U=P.transferToImageBitmap();try{A.createPattern(U,"no-repeat")}catch{return!1}return!0}();function u(){}function c(P){var A=n.exports.Promise,U=A!==void 0?A:t.Promise;return typeof U=="function"?new U(P):(P(u,u),null)}var l=function(P,A){return{transform:function(U){if(P)return U;if(A.has(U))return A.get(U);var H=new OffscreenCanvas(U.width,U.height),q=H.getContext("2d");return q.drawImage(U,0,0),A.set(U,H),H},clear:function(){A.clear()}}}(s,new Map),d=function(){var P=Math.floor(16.666666666666668),A,U,H={},q=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(A=function(Q){var V=Math.random();return H[V]=requestAnimationFrame(function re(Z){q===Z||q+P-1<Z?(q=Z,delete H[V],Q()):H[V]=requestAnimationFrame(re)}),V},U=function(Q){H[Q]&&cancelAnimationFrame(H[Q])}):(A=function(Q){return setTimeout(Q,P)},U=function(Q){return clearTimeout(Q)}),{frame:A,cancel:U}}(),f=function(){var P,A,U={};function H(q){function Q(V,re){q.postMessage({options:V||{},callback:re})}q.init=function(re){var Z=re.transferControlToOffscreen();q.postMessage({canvas:Z},[Z])},q.fire=function(re,Z,he){if(A)return Q(re,null),A;var xe=Math.random().toString(36).slice(2);return A=c(function(ie){function pe(ce){ce.data.callback===xe&&(delete U[xe],q.removeEventListener("message",pe),A=null,l.clear(),he(),ie())}q.addEventListener("message",pe),Q(re,xe),U[xe]=pe.bind(null,{data:{callback:xe}})}),A},q.reset=function(){q.postMessage({reset:!0});for(var re in U)U[re](),delete U[re]}}return function(){if(P)return P;if(!r&&o){var q=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{P=new Worker(URL.createObjectURL(new Blob([q])))}catch(Q){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("🎊 Could not load worker",Q),null}H(P)}return P}}(),h={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function p(P,A){return A?A(P):P}function m(P){return P!=null}function g(P,A,U){return p(P&&m(P[A])?P[A]:h[A],U)}function v(P){return P<0?0:Math.floor(P)}function y(P,A){return Math.floor(Math.random()*(A-P))+P}function b(P){return parseInt(P,16)}function w(P){return P.map(E)}function E(P){var A=String(P).replace(/[^0-9a-f]/gi,"");return A.length<6&&(A=A[0]+A[0]+A[1]+A[1]+A[2]+A[2]),{r:b(A.substring(0,2)),g:b(A.substring(2,4)),b:b(A.substring(4,6))}}function x(P){var A=g(P,"origin",Object);return A.x=g(A,"x",Number),A.y=g(A,"y",Number),A}function R(P){P.width=document.documentElement.clientWidth,P.height=document.documentElement.clientHeight}function S(P){var A=P.getBoundingClientRect();P.width=A.width,P.height=A.height}function _(P){var A=document.createElement("canvas");return A.style.position="fixed",A.style.top="0px",A.style.left="0px",A.style.pointerEvents="none",A.style.zIndex=P,A}function T(P,A,U,H,q,Q,V,re,Z){P.save(),P.translate(A,U),P.rotate(Q),P.scale(H,q),P.arc(0,0,1,V,re,Z),P.restore()}function B(P){var A=P.angle*(Math.PI/180),U=P.spread*(Math.PI/180);return{x:P.x,y:P.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:P.startVelocity*.5+Math.random()*P.startVelocity,angle2D:-A+(.5*U-Math.random()*U),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:P.color,shape:P.shape,tick:0,totalTicks:P.ticks,decay:P.decay,drift:P.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:P.gravity*3,ovalScalar:.6,scalar:P.scalar,flat:P.flat}}function L(P,A){A.x+=Math.cos(A.angle2D)*A.velocity+A.drift,A.y+=Math.sin(A.angle2D)*A.velocity+A.gravity,A.velocity*=A.decay,A.flat?(A.wobble=0,A.wobbleX=A.x+10*A.scalar,A.wobbleY=A.y+10*A.scalar,A.tiltSin=0,A.tiltCos=0,A.random=1):(A.wobble+=A.wobbleSpeed,A.wobbleX=A.x+10*A.scalar*Math.cos(A.wobble),A.wobbleY=A.y+10*A.scalar*Math.sin(A.wobble),A.tiltAngle+=.1,A.tiltSin=Math.sin(A.tiltAngle),A.tiltCos=Math.cos(A.tiltAngle),A.random=Math.random()+2);var U=A.tick++/A.totalTicks,H=A.x+A.random*A.tiltCos,q=A.y+A.random*A.tiltSin,Q=A.wobbleX+A.random*A.tiltCos,V=A.wobbleY+A.random*A.tiltSin;if(P.fillStyle="rgba("+A.color.r+", "+A.color.g+", "+A.color.b+", "+(1-U)+")",P.beginPath(),a&&A.shape.type==="path"&&typeof A.shape.path=="string"&&Array.isArray(A.shape.matrix))P.fill(I(A.shape.path,A.shape.matrix,A.x,A.y,Math.abs(Q-H)*.1,Math.abs(V-q)*.1,Math.PI/10*A.wobble));else if(A.shape.type==="bitmap"){var re=Math.PI/10*A.wobble,Z=Math.abs(Q-H)*.1,he=Math.abs(V-q)*.1,xe=A.shape.bitmap.width*A.scalar,ie=A.shape.bitmap.height*A.scalar,pe=new DOMMatrix([Math.cos(re)*Z,Math.sin(re)*Z,-Math.sin(re)*he,Math.cos(re)*he,A.x,A.y]);pe.multiplySelf(new DOMMatrix(A.shape.matrix));var ce=P.createPattern(l.transform(A.shape.bitmap),"no-repeat");ce.setTransform(pe),P.globalAlpha=1-U,P.fillStyle=ce,P.fillRect(A.x-xe/2,A.y-ie/2,xe,ie),P.globalAlpha=1}else if(A.shape==="circle")P.ellipse?P.ellipse(A.x,A.y,Math.abs(Q-H)*A.ovalScalar,Math.abs(V-q)*A.ovalScalar,Math.PI/10*A.wobble,0,2*Math.PI):T(P,A.x,A.y,Math.abs(Q-H)*A.ovalScalar,Math.abs(V-q)*A.ovalScalar,Math.PI/10*A.wobble,0,2*Math.PI);else if(A.shape==="star")for(var Y=Math.PI/2*3,de=4*A.scalar,be=8*A.scalar,le=A.x,Tt=A.y,yt=5,Gt=Math.PI/yt;yt--;)le=A.x+Math.cos(Y)*be,Tt=A.y+Math.sin(Y)*be,P.lineTo(le,Tt),Y+=Gt,le=A.x+Math.cos(Y)*de,Tt=A.y+Math.sin(Y)*de,P.lineTo(le,Tt),Y+=Gt;else P.moveTo(Math.floor(A.x),Math.floor(A.y)),P.lineTo(Math.floor(A.wobbleX),Math.floor(q)),P.lineTo(Math.floor(Q),Math.floor(V)),P.lineTo(Math.floor(H),Math.floor(A.wobbleY));return P.closePath(),P.fill(),A.tick<A.totalTicks}function k(P,A,U,H,q){var Q=A.slice(),V=P.getContext("2d"),re,Z,he=c(function(xe){function ie(){re=Z=null,V.clearRect(0,0,H.width,H.height),l.clear(),q(),xe()}function pe(){r&&!(H.width===i.width&&H.height===i.height)&&(H.width=P.width=i.width,H.height=P.height=i.height),!H.width&&!H.height&&(U(P),H.width=P.width,H.height=P.height),V.clearRect(0,0,H.width,H.height),Q=Q.filter(function(ce){return L(V,ce)}),Q.length?re=d.frame(pe):ie()}re=d.frame(pe),Z=ie});return{addFettis:function(xe){return Q=Q.concat(xe),he},canvas:P,promise:he,reset:function(){re&&d.cancel(re),Z&&Z()}}}function D(P,A){var U=!P,H=!!g(A||{},"resize"),q=!1,Q=g(A,"disableForReducedMotion",Boolean),V=o&&!!g(A||{},"useWorker"),re=V?f():null,Z=U?R:S,he=P&&re?!!P.__confetti_initialized:!1,xe=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,ie;function pe(Y,de,be){for(var le=g(Y,"particleCount",v),Tt=g(Y,"angle",Number),yt=g(Y,"spread",Number),Gt=g(Y,"startVelocity",Number),er=g(Y,"decay",Number),tr=g(Y,"gravity",Number),An=g(Y,"drift",Number),Sn=g(Y,"colors",w),it=g(Y,"ticks",Number),bt=g(Y,"shapes"),Ye=g(Y,"scalar"),Ne=!!g(Y,"flat"),pt=x(Y),Ua=le,Mi=[],Uc=P.width*pt.x,hr=P.height*pt.y;Ua--;)Mi.push(B({x:Uc,y:hr,angle:Tt,spread:yt,startVelocity:Gt,color:Sn[Ua%Sn.length],shape:bt[y(0,bt.length)],ticks:it,decay:er,gravity:tr,drift:An,scalar:Ye,flat:Ne}));return ie?ie.addFettis(Mi):(ie=k(P,Mi,Z,de,be),ie.promise)}function ce(Y){var de=Q||g(Y,"disableForReducedMotion",Boolean),be=g(Y,"zIndex",Number);if(de&&xe)return c(function(Gt){Gt()});U&&ie?P=ie.canvas:U&&!P&&(P=_(be),document.body.appendChild(P)),H&&!he&&Z(P);var le={width:P.width,height:P.height};re&&!he&&re.init(P),he=!0,re&&(P.__confetti_initialized=!0);function Tt(){if(re){var Gt={getBoundingClientRect:function(){if(!U)return P.getBoundingClientRect()}};Z(Gt),re.postMessage({resize:{width:Gt.width,height:Gt.height}});return}le.width=le.height=null}function yt(){ie=null,H&&(q=!1,t.removeEventListener("resize",Tt)),U&&P&&(document.body.contains(P)&&document.body.removeChild(P),P=null,he=!1)}return H&&!q&&(q=!0,t.addEventListener("resize",Tt,!1)),re?re.fire(Y,le,yt):pe(Y,le,yt)}return ce.reset=function(){re&&re.reset(),ie&&ie.reset()},ce}var F;function M(){return F||(F=D(null,{useWorker:!0,resize:!0})),F}function I(P,A,U,H,q,Q,V){var re=new Path2D(P),Z=new Path2D;Z.addPath(re,new DOMMatrix(A));var he=new Path2D;return he.addPath(Z,new DOMMatrix([Math.cos(V)*q,Math.sin(V)*q,-Math.sin(V)*Q,Math.cos(V)*Q,U,H])),he}function N(P){if(!a)throw new Error("path confetti are not supported in this browser");var A,U;typeof P=="string"?A=P:(A=P.path,U=P.matrix);var H=new Path2D(A),q=document.createElement("canvas"),Q=q.getContext("2d");if(!U){for(var V=1e3,re=V,Z=V,he=0,xe=0,ie,pe,ce=0;ce<V;ce+=2)for(var Y=0;Y<V;Y+=2)Q.isPointInPath(H,ce,Y,"nonzero")&&(re=Math.min(re,ce),Z=Math.min(Z,Y),he=Math.max(he,ce),xe=Math.max(xe,Y));ie=he-re,pe=xe-Z;var de=10,be=Math.min(de/ie,de/pe);U=[be,0,0,be,-Math.round(ie/2+re)*be,-Math.round(pe/2+Z)*be]}return{type:"path",path:A,matrix:U}}function j(P){var A,U=1,H="#000000",q='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof P=="string"?A=P:(A=P.text,U="scalar"in P?P.scalar:U,q="fontFamily"in P?P.fontFamily:q,H="color"in P?P.color:H);var Q=10*U,V=""+Q+"px "+q,re=new OffscreenCanvas(Q,Q),Z=re.getContext("2d");Z.font=V;var he=Z.measureText(A),xe=Math.ceil(he.actualBoundingBoxRight+he.actualBoundingBoxLeft),ie=Math.ceil(he.actualBoundingBoxAscent+he.actualBoundingBoxDescent),pe=2,ce=he.actualBoundingBoxLeft+pe,Y=he.actualBoundingBoxAscent+pe;xe+=pe+pe,ie+=pe+pe,re=new OffscreenCanvas(xe,ie),Z=re.getContext("2d"),Z.font=V,Z.fillStyle=H,Z.fillText(A,ce,Y);var de=1/U;return{type:"bitmap",bitmap:re.transferToImageBitmap(),matrix:[de,0,0,de,-xe*de/2,-ie*de/2]}}n.exports=function(){return M().apply(this,arguments)},n.exports.reset=function(){M().reset()},n.exports.create=D,n.exports.shapeFromPath=N,n.exports.shapeFromText=j})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),zw,!1);const h9=zw.exports;zw.exports.create;function p9({particleCount:e,spread:t,origin:n}){const r=O.useRef(null);return O.useEffect(()=>{r.current&&h9.create(r.current,{resize:!0,useWorker:!0})({particleCount:e,spread:t,origin:n})},[e,t,n]),C.jsx("canvas",{ref:r,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:9999}})}function v9({winner:e}){return C.jsxs("div",{className:"absolute inset-0 flex items-center justify-center z-20 bg-gray-900 bg-opacity-50",children:[C.jsx(p9,{particleCount:200,spread:150,origin:{x:.5,y:.7}}),C.jsxs("div",{className:"text-6xl font-bold text-white animate-bounce",children:[e," Wins!"]})]})}var XP={},Hw={};(function(e){var t=me&&me.__extends||function(){var r=function(i,o){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,s){a.__proto__=s}||function(a,s){for(var u in s)Object.prototype.hasOwnProperty.call(s,u)&&(a[u]=s[u])},r(i,o)};return function(i,o){r(i,o);function a(){this.constructor=i}i.prototype=o===null?Object.create(o):(a.prototype=o.prototype,new a)}}();function n(r){if(!r)return n.__;Array.prototype.reduce||(Array.prototype.reduce=function(a,s){for(var u=s,c=0;c<this.length;c++)u=a(u,this[c],c,this);return u});var i="",o=("."+r).split(".").reduce(function(a,s,u,c){i?i+="."+s:i=s;var l=a["__"+i];return l===void 0&&(n.Logger.prototype=a,l=new n.Logger(i),a["__"+i]=l),l},n.__);return o}(function(r){r.requestId="",r.entryId=0,r._createXMLHttpRequest=function(){return new XMLHttpRequest},r._getTime=function(){return new Date().getTime()},r._console=console,r._appenderNames=[];function i(M,I,N){if(I[M]!==void 0){if(I[M]===null){delete N[M];return}N[M]=I[M]}}function o(M){if(r.enabled!=null&&!r.enabled)return!1;try{if(M.userAgentRegex&&!new RegExp(M.userAgentRegex).test(navigator.userAgent))return!1}catch{}try{if(M.ipRegex&&r.clientIP&&!new RegExp(M.ipRegex).test(r.clientIP))return!1}catch{}return!0}function a(M,I){try{if(M.disallow&&new RegExp(M.disallow).test(I))return!1}catch{}return!0}function s(M){return typeof M=="function"?M instanceof RegExp?M.toString():M():M}var u=function(){function M(I,N,j){this.msg=I,this.meta=N,this.finalString=j}return M}();function c(M){var I=s(M),N;switch(typeof I){case"string":return new u(I,null,I);case"number":return N=I.toString(),new u(N,null,N);case"boolean":return N=I.toString(),new u(N,null,N);case"undefined":return new u("undefined",null,"undefined");case"object":return I instanceof RegExp||I instanceof String||I instanceof Number||I instanceof Boolean?(N=I.toString(),new u(N,null,N)):(typeof r.serialize=="function"?N=r.serialize.call(this,I):N=JSON.stringify(I),new u("",I,N));default:return new u("unknown",null,"unknown")}}function l(M){return i("enabled",M,this),i("maxMessages",M,this),i("defaultAjaxUrl",M,this),i("clientIP",M,this),i("requestId",M,this),i("defaultBeforeSend",M,this),i("serialize",M,this),this}r.setOptions=l;function d(){return-2147483648}r.getAllLevel=d;function f(){return 1e3}r.getTraceLevel=f;function h(){return 2e3}r.getDebugLevel=h;function p(){return 3e3}r.getInfoLevel=p;function m(){return 4e3}r.getWarnLevel=m;function g(){return 5e3}r.getErrorLevel=g;function v(){return 6e3}r.getFatalLevel=v;function y(){return 2147483647}r.getOffLevel=y;function b(M){return M<=1e3?"trace":M<=2e3?"debug":M<=3e3?"info":M<=4e3?"warn":M<=5e3?"error":"fatal"}var w=function(){function M(I,N){this.inner=N,this.name="JL.Exception",this.message=c(I).finalString}return M}();r.Exception=w,w.prototype=new Error;var E=function(){function M(I,N,j,P,A){this.l=I,this.m=N,this.n=j,this.t=P,this.u=A}return M}();r.LogItem=E;function x(M,I,N){return r.entryId++,new E(M,I,N,r._getTime(),r.entryId)}function R(M){M.id&&(clearTimeout(M.id),M.id=null)}function S(M,I,N){var j=this;M.id||(M.id=setTimeout(function(){N.call(j)},I))}var _=function(){function M(I,N){this.appenderName=I,this.sendLogItems=N,this.level=r.getTraceLevel(),this.sendWithBufferLevel=2147483647,this.storeInBufferLevel=-2147483648,this.bufferSize=0,this.batchSize=1,this.maxBatchSize=20,this.batchTimeout=2147483647,this.sendTimeout=5e3,this.buffer=[],this.batchBuffer=[],this.batchTimeoutTimer={id:null},this.sendTimeoutTimer={id:null},this.nbrLogItemsSkipped=0,this.nbrLogItemsBeingSent=0;var j="Trying to create an appender without a name or with an empty name";if(I==null)throw j;if(r._appenderNames.indexOf(I)!=-1)throw I?"Multiple appenders use the same name "+I:j;r._appenderNames.push(I)}return M.prototype.addLogItemsToBuffer=function(I){if(this.batchBuffer.length>=this.maxBatchSize){this.nbrLogItemsSkipped+=I.length;return}if(r.maxMessages!=null){if(r.maxMessages<1)return;r.maxMessages-=I.length}this.batchBuffer=this.batchBuffer.concat(I);var N=this;S(this.batchTimeoutTimer,this.batchTimeout,function(){N.sendBatch.call(N)})},M.prototype.batchBufferHasOverdueMessages=function(){for(var I=0;I<this.batchBuffer.length;I++){var N=r._getTime()-this.batchBuffer[I].t;if(N>this.batchTimeout)return!0}return!1},M.prototype.batchBufferHasStrandedMessage=function(){return r.maxMessages!=null&&r.maxMessages<1&&this.batchBuffer.length>0},M.prototype.sendBatchIfComplete=function(){(this.batchBuffer.length>=this.batchSize||this.batchBufferHasOverdueMessages()||this.batchBufferHasStrandedMessage())&&this.sendBatch()},M.prototype.onSendingEnded=function(){R(this.sendTimeoutTimer),this.nbrLogItemsBeingSent=0,this.sendBatchIfComplete()},M.prototype.setOptions=function(I){if(i("level",I,this),i("ipRegex",I,this),i("userAgentRegex",I,this),i("disallow",I,this),i("sendWithBufferLevel",I,this),i("storeInBufferLevel",I,this),i("bufferSize",I,this),i("batchSize",I,this),i("maxBatchSize",I,this),i("batchTimeout",I,this),i("sendTimeout",I,this),this.bufferSize<this.buffer.length&&(this.buffer.length=this.bufferSize),this.maxBatchSize<this.batchSize)throw new r.Exception({message:"maxBatchSize cannot be smaller than batchSize",maxBatchSize:this.maxBatchSize,batchSize:this.batchSize});return this},M.prototype.log=function(I,N,j,P,A,U,H){var q;if(o(this)&&a(this,U)&&!(A<this.storeInBufferLevel)){if(q=x(A,U,H),A<this.level){this.bufferSize>0&&(this.buffer.push(q),this.buffer.length>this.bufferSize&&this.buffer.shift());return}this.addLogItemsToBuffer([q]),A>=this.sendWithBufferLevel&&this.buffer.length&&(this.addLogItemsToBuffer(this.buffer),this.buffer.length=0),this.sendBatchIfComplete()}},M.prototype.sendBatch=function(){if(!(this.nbrLogItemsBeingSent>0)&&(R(this.batchTimeoutTimer),this.batchBuffer.length!=0)){this.nbrLogItemsBeingSent=this.batchBuffer.length;var I=this;S(this.sendTimeoutTimer,this.sendTimeout,function(){I.onSendingEnded.call(I)}),this.sendLogItems(this.batchBuffer,function(){I.batchBuffer.splice(0,I.nbrLogItemsBeingSent),I.nbrLogItemsSkipped>0&&(I.batchBuffer.push(x(m(),"Lost "+I.nbrLogItemsSkipped+" messages. Either connection with the server was down or logging was disabled via the enabled option. Reduce lost messages by increasing the ajaxAppender option maxBatchSize.",I.appenderName)),I.nbrLogItemsSkipped=0),I.onSendingEnded.call(I)})}},M}();r.Appender=_;var T=function(M){t(I,M);function I(N){return M.call(this,N,I.prototype.sendLogItemsAjax)||this}return I.prototype.setOptions=function(N){return i("url",N,this),i("beforeSend",N,this),M.prototype.setOptions.call(this,N),this},I.prototype.sendLogItemsAjax=function(N,j){try{if(!o(this))return;this.xhr&&this.xhr.readyState!=0&&this.xhr.readyState!=4&&this.xhr.abort(),this.xhr=r._createXMLHttpRequest();var P="/jsnlog.logger";r.defaultAjaxUrl!=null&&(P=r.defaultAjaxUrl),this.url&&(P=this.url),this.xhr.open("POST",P),this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.setRequestHeader("JSNLog-RequestId",r.requestId);var A=this;this.xhr.onreadystatechange=function(){A.xhr.readyState==4&&A.xhr.status>=200&&A.xhr.status<300&&j()};var U={r:r.requestId,lg:N};typeof this.beforeSend=="function"?this.beforeSend.call(this,this.xhr,U):typeof r.defaultBeforeSend=="function"&&r.defaultBeforeSend.call(this,this.xhr,U);var H=JSON.stringify(U);this.xhr.send(H)}catch{}},I}(_);r.AjaxAppender=T;var B=function(M){t(I,M);function I(N){return M.call(this,N,I.prototype.sendLogItemsConsole)||this}return I.prototype.clog=function(N){r._console.log(N)},I.prototype.cerror=function(N){r._console.error?r._console.error(N):this.clog(N)},I.prototype.cwarn=function(N){r._console.warn?r._console.warn(N):this.clog(N)},I.prototype.cinfo=function(N){r._console.info?r._console.info(N):this.clog(N)},I.prototype.cdebug=function(N){r._console.debug?r._console.debug(N):this.cinfo(N)},I.prototype.sendLogItemsConsole=function(N,j){try{if(!o(this)||!r._console)return;var P;for(P=0;P<N.length;++P){var A=N[P],U=A.n+": "+A.m;typeof window>"u"&&(U=new Date(A.t)+" | "+U),A.l<=r.getDebugLevel()?this.cdebug(U):A.l<=r.getInfoLevel()?this.cinfo(U):A.l<=r.getWarnLevel()?this.cwarn(U):this.cerror(U)}}catch{}j()},I}(_);r.ConsoleAppender=B;var L=function(){function M(I){this.loggerName=I,this.seenRegexes=[]}return M.prototype.setOptions=function(I){return i("level",I,this),i("userAgentRegex",I,this),i("disallow",I,this),i("ipRegex",I,this),i("appenders",I,this),i("onceOnly",I,this),this.seenRegexes=[],this},M.prototype.buildExceptionObject=function(I){var N={};return I.stack?N.stack=I.stack:N.e=I,I.message&&(N.message=I.message),I.name&&(N.name=I.name),I.data&&(N.data=I.data),I.inner&&(N.inner=this.buildExceptionObject(I.inner)),N},M.prototype.log=function(I,N,j){var P=0,A,U;if(!this.appenders)return this;if(I>=this.level&&o(this)&&(j?(U=this.buildExceptionObject(j),U.logData=s(N)):U=N,A=c(U),a(this,A.finalString))){if(this.onceOnly)for(P=this.onceOnly.length-1;P>=0;){if(new RegExp(this.onceOnly[P]).test(A.finalString)){if(this.seenRegexes[P])return this;this.seenRegexes[P]=!0}P--}for(A.meta=A.meta||{},P=this.appenders.length-1;P>=0;)this.appenders[P].log(b(I),A.msg,A.meta,function(){},I,A.finalString,this.loggerName),P--}return this},M.prototype.trace=function(I){return this.log(f(),I)},M.prototype.debug=function(I){return this.log(h(),I)},M.prototype.info=function(I){return this.log(p(),I)},M.prototype.warn=function(I){return this.log(m(),I)},M.prototype.error=function(I){return this.log(g(),I)},M.prototype.fatal=function(I){return this.log(v(),I)},M.prototype.fatalException=function(I,N){return this.log(v(),I,N)},M}();r.Logger=L;function k(M){return new T(M)}r.createAjaxAppender=k;function D(M){return new B(M)}r.createConsoleAppender=D;var F;typeof window<"u"?F=new T(""):F=new B(""),r.__=new r.Logger(""),r.__.setOptions({level:r.getDebugLevel(),appenders:[F]})})(n||(n={})),e.__esModule=!0,e.JL=n,typeof __jsnlog_configure=="function"&&__jsnlog_configure(n),typeof window<"u"&&!window.onerror&&(window.onerror=function(r,i,o,a,s){return n("onerrorLogger").fatalException({msg:"Uncaught Exception",errorMsg:r?r.message||r:"",url:i,"line number":o,column:a},s),!1}),typeof window<"u"&&!window.onunhandledrejection&&(window.onunhandledrejection=function(r){n("onerrorLogger").fatalException({msg:"unhandledrejection",errorMsg:r.reason?r.reason.message:r.message||null},r.reason)})})(Hw);var pm={},Ud={},Gw={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LocalRecorderState=void 0,function(t){t.READY="READY",t.RECORDING="RECORDING",t.PAUSED="PAUSED",t.FINISHED="FINISHED"}(e.LocalRecorderState||(e.LocalRecorderState={}))})(Gw);var ln={},vm={};Object.defineProperty(vm,"__esModule",{value:!0});vm.ConsoleLogger=void 0;var m9=function(){function e(t){this.logger=t,this.log=t.log,this.info=t.info,this.debug=t.debug,this.warn=t.warn,this.error=t.error}return e}();vm.ConsoleLogger=m9;var qw={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OpenViduLoggerConfiguration=void 0,function(t){t.disabled="disabled",t.debug="debug",t.debug_app="debug_app"}(e.OpenViduLoggerConfiguration||(e.OpenViduLoggerConfiguration={}))})(qw);Object.defineProperty(ln,"__esModule",{value:!0});ln.OpenViduLogger=void 0;var Xr=Hw,g9=vm,v0=qw,y9=function(){function e(){this.JSNLOG_URL="/openvidu/elk/openvidu-browser-logs",this.MAX_JSNLOG_BATCH_LOG_MESSAGES=100,this.MAX_MSECONDS_BATCH_MESSAGES=5e3,this.MAX_LENGTH_STRING_JSON=1e3,this.defaultConsoleLogger=new g9.ConsoleLogger(globalThis.console),this.isProdMode=!1,this.isJSNLogSetup=!1}return e.configureJSNLog=function(t,n){var r=this;try{if(globalThis.LOG_JSNLOG_RESULTS||this.instance&&t.isAtLeastPro&&this.instance.isOpenViduBrowserLogsDebugActive(t)&&this.instance.canConfigureJSNLog(t,this.instance)){t.sendBrowserLogs===v0.OpenViduLoggerConfiguration.debug_app&&this.instance.replaceWindowConsole(),this.instance.isJSNLogSetup=!1,this.instance.info("Configuring JSNLogs.");var i=t.finalUserId,o=t.session.sessionId,a=function(u){var c=u.onreadystatechange;u.onreadystatechange=function(){r.isInvalidResponse(u)&&(Object.defineProperty(u,"readyState",{value:4}),Object.defineProperty(u,"status",{value:200}),r.instance.disableLogger()),c()},u.setRequestHeader("Authorization","Basic "+btoa("".concat(i,"%/%").concat(o)+":"+n)),u.setRequestHeader("X-Requested-With","XMLHttpRequest"),u.setRequestHeader("OV-Final-User-Id",i),u.setRequestHeader("OV-Session-Id",o),u.setRequestHeader("OV-Token",n)};this.instance.currentAppender=Xr.JL.createAjaxAppender("appender-".concat(i,"-").concat(o)),this.instance.currentAppender.setOptions({beforeSend:a,maxBatchSize:1e3,batchSize:this.instance.MAX_JSNLOG_BATCH_LOG_MESSAGES,batchTimeout:this.instance.MAX_MSECONDS_BATCH_MESSAGES});var s=function(u){var c=function(){var d=new WeakSet;return function(f,h){if(typeof h=="object"&&h!=null){if(d.has(h)||globalThis.HTMLElement&&h instanceof HTMLElement)return;d.add(h)}return h}},l=JSON.stringify(u,c());return l.length>r.instance.MAX_LENGTH_STRING_JSON&&(l="".concat(l.substring(0,r.instance.MAX_LENGTH_STRING_JSON),"...")),globalThis.LOG_JSNLOG_RESULTS&&console.log(l),l};Xr.JL.setOptions({defaultAjaxUrl:t.httpUri+this.instance.JSNLOG_URL,serialize:s,enabled:!0}),(0,Xr.JL)().setOptions({appenders:[this.instance.currentAppender]}),this.instance.isJSNLogSetup=!0,this.instance.loggingSessionId=o,this.instance.info("JSNLog configured.")}}catch(u){console.error("Error configuring JSNLog: "),console.error(u),this.instance.disableLogger()}},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.isInvalidResponse=function(t){return t.status==401||t.status==403||t.status==404||t.status==0},e.prototype.canConfigureJSNLog=function(t,n){return t.session.sessionId!=n.loggingSessionId},e.prototype.isOpenViduBrowserLogsDebugActive=function(t){return t.sendBrowserLogs===v0.OpenViduLoggerConfiguration.debug||t.sendBrowserLogs===v0.OpenViduLoggerConfiguration.debug_app},e.prototype.getConsoleWithJSNLog=function(){return function(t){return{log:function(){t.defaultConsoleLogger.log.apply(t.defaultConsoleLogger.logger,arguments),t.isJSNLogSetup&&(0,Xr.JL)().info(arguments)},info:function(){t.defaultConsoleLogger.info.apply(t.defaultConsoleLogger.logger,arguments),t.isJSNLogSetup&&(0,Xr.JL)().info(arguments)},debug:function(){t.defaultConsoleLogger.debug.apply(t.defaultConsoleLogger.logger,arguments)},warn:function(){t.defaultConsoleLogger.warn.apply(t.defaultConsoleLogger.logger,arguments),t.isJSNLogSetup&&(0,Xr.JL)().warn(arguments)},error:function(){t.defaultConsoleLogger.error.apply(t.defaultConsoleLogger.logger,arguments),t.isJSNLogSetup&&(0,Xr.JL)().error(arguments)}}}(this)},e.prototype.replaceWindowConsole=function(){globalThis.console=this.defaultConsoleLogger.logger,globalThis.console.log=this.getConsoleWithJSNLog().log,globalThis.console.info=this.getConsoleWithJSNLog().info,globalThis.console.debug=this.getConsoleWithJSNLog().debug,globalThis.console.warn=this.getConsoleWithJSNLog().warn,globalThis.console.error=this.getConsoleWithJSNLog().error},e.prototype.disableLogger=function(){Xr.JL.setOptions({enabled:!1}),this.isJSNLogSetup=!1,this.loggingSessionId=void 0,this.currentAppender=void 0,globalThis.console=this.defaultConsoleLogger.logger,globalThis.console.log=this.defaultConsoleLogger.log,globalThis.console.info=this.defaultConsoleLogger.info,globalThis.console.debug=this.defaultConsoleLogger.debug,globalThis.console.warn=this.defaultConsoleLogger.warn,globalThis.console.error=this.defaultConsoleLogger.error},e.prototype.log=function(){this.isProdMode||this.defaultConsoleLogger.log.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,Xr.JL)().info(arguments)},e.prototype.debug=function(){this.isProdMode||this.defaultConsoleLogger.debug.apply(this.defaultConsoleLogger.logger,arguments)},e.prototype.info=function(){this.isProdMode||this.defaultConsoleLogger.info.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,Xr.JL)().info(arguments)},e.prototype.warn=function(){this.defaultConsoleLogger.warn.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,Xr.JL)().warn(arguments)},e.prototype.error=function(){this.defaultConsoleLogger.error.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,Xr.JL)().error(arguments)},e.prototype.flush=function(){this.isJSNLogSetup&&this.currentAppender!=null&&this.currentAppender.sendBatch()},e.prototype.enableProdMode=function(){this.isProdMode=!0},e}();ln.OpenViduLogger=y9;var Pi={},Hp={exports:{}};/*!
 * Platform.js v1.3.6
 * Copyright 2014-2020 Benjamin Tan
 * Copyright 2011-2013 John-David Dalton
 * Available under MIT license
 */Hp.exports;(function(e,t){(function(){var n={function:!0,object:!0},r=n[typeof window]&&window||this,i=t,o=e&&!e.nodeType&&e,a=i&&o&&typeof me=="object"&&me;a&&(a.global===a||a.window===a||a.self===a)&&(r=a);var s=Math.pow(2,53)-1,u=/\bOpera/,c=Object.prototype,l=c.hasOwnProperty,d=c.toString;function f(S){return S=String(S),S.charAt(0).toUpperCase()+S.slice(1)}function h(S,_,T){var B={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return _&&T&&/^Win/i.test(S)&&!/^Windows Phone /i.test(S)&&(B=B[/[\d.]+$/.exec(S)])&&(S="Windows "+B),S=String(S),_&&T&&(S=S.replace(RegExp(_,"i"),T)),S=m(S.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0]),S}function p(S,_){var T=-1,B=S?S.length:0;if(typeof B=="number"&&B>-1&&B<=s)for(;++T<B;)_(S[T],T,S);else g(S,_)}function m(S){return S=E(S),/^(?:webOS|i(?:OS|P))/.test(S)?S:f(S)}function g(S,_){for(var T in S)l.call(S,T)&&_(S[T],T,S)}function v(S){return S==null?f(S):d.call(S).slice(8,-1)}function y(S,_){var T=S!=null?typeof S[_]:"number";return!/^(?:boolean|number|string|undefined)$/.test(T)&&(T=="object"?!!S[_]:!0)}function b(S){return String(S).replace(/([ -])(?!$)/g,"$1?")}function w(S,_){var T=null;return p(S,function(B,L){T=_(T,B,L,S)}),T}function E(S){return String(S).replace(/^ +| +$/g,"")}function x(S){var _=r,T=S&&typeof S=="object"&&v(S)!="String";T&&(_=S,S=null);var B=_.navigator||{},L=B.userAgent||"";S||(S=L);var k=T?!!B.likeChrome:/\bChrome\b/.test(S)&&!/internal|\n/i.test(d.toString()),D="Object",F=T?D:"ScriptBridgingProxyObject",M=T?D:"Environment",I=T&&_.java?"JavaPackage":v(_.java),N=T?D:"RuntimeObject",j=/\bJava/.test(I)&&_.java,P=j&&v(_.environment)==M,A=j?"a":"α",U=j?"b":"β",H=_.document||{},q=_.operamini||_.opera,Q=u.test(Q=T&&q?q["[[Class]]"]:v(q))?Q:q=null,V,re=S,Z=[],he=null,xe=S==L,ie=xe&&q&&typeof q.version=="function"&&q.version(),pe,ce=Tt([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),Y=Gt(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),de=tr([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),be=yt({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),le=er(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function Tt(bt){return w(bt,function(Ye,Ne){return Ye||RegExp("\\b"+(Ne.pattern||b(Ne))+"\\b","i").exec(S)&&(Ne.label||Ne)})}function yt(bt){return w(bt,function(Ye,Ne,pt){return Ye||(Ne[de]||Ne[/^[a-z]+(?: +[a-z]+\b)*/i.exec(de)]||RegExp("\\b"+b(pt)+"(?:\\b|\\w*\\d)","i").exec(S))&&pt})}function Gt(bt){return w(bt,function(Ye,Ne){return Ye||RegExp("\\b"+(Ne.pattern||b(Ne))+"\\b","i").exec(S)&&(Ne.label||Ne)})}function er(bt){return w(bt,function(Ye,Ne){var pt=Ne.pattern||b(Ne);return!Ye&&(Ye=RegExp("\\b"+pt+"(?:/[\\d.]+|[ \\w.]*)","i").exec(S))&&(Ye=h(Ye,pt,Ne.label||Ne)),Ye})}function tr(bt){return w(bt,function(Ye,Ne){var pt=Ne.pattern||b(Ne);return!Ye&&(Ye=RegExp("\\b"+pt+" *\\d+[.\\w_]*","i").exec(S)||RegExp("\\b"+pt+" *\\w+-[\\w]*","i").exec(S)||RegExp("\\b"+pt+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(S))&&((Ye=String(Ne.label&&!RegExp(pt,"i").test(Ne.label)?Ne.label:Ye).split("/"))[1]&&!/[\d.]+/.test(Ye[0])&&(Ye[0]+=" "+Ye[1]),Ne=Ne.label||Ne,Ye=m(Ye[0].replace(RegExp(pt,"i"),Ne).replace(RegExp("; *(?:"+Ne+"[_-])?","i")," ").replace(RegExp("("+Ne+")[-_.]?(\\w)","i"),"$1 $2"))),Ye})}function An(bt){return w(bt,function(Ye,Ne){return Ye||(RegExp(Ne+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(S)||0)[1]||null})}function Sn(){return this.description||""}if(ce&&(ce=[ce]),/\bAndroid\b/.test(le)&&!de&&(V=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(S))&&(de=E(V[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),be&&!de?de=tr([be]):be&&de&&(de=de.replace(RegExp("^("+b(be)+")[-_.\\s]","i"),be+" ").replace(RegExp("^("+b(be)+")[-_.]?(\\w)","i"),be+" $2")),(V=/\bGoogle TV\b/.exec(de))&&(de=V[0]),/\bSimulator\b/i.test(S)&&(de=(de?de+" ":"")+"Simulator"),Y=="Opera Mini"&&/\bOPiOS\b/.test(S)&&Z.push("running in Turbo/Uncompressed mode"),Y=="IE"&&/\blike iPhone OS\b/.test(S)?(V=x(S.replace(/like iPhone OS/,"")),be=V.manufacturer,de=V.product):/^iP/.test(de)?(Y||(Y="Safari"),le="iOS"+((V=/ OS ([\d_]+)/i.exec(S))?" "+V[1].replace(/_/g,"."):"")):Y=="Konqueror"&&/^Linux\b/i.test(le)?le="Kubuntu":be&&be!="Google"&&(/Chrome/.test(Y)&&!/\bMobile Safari\b/i.test(S)||/\bVita\b/.test(de))||/\bAndroid\b/.test(le)&&/^Chrome/.test(Y)&&/\bVersion\//i.test(S)?(Y="Android Browser",le=/\bAndroid\b/.test(le)?le:"Android"):Y=="Silk"?(/\bMobi/i.test(S)||(le="Android",Z.unshift("desktop mode")),/Accelerated *= *true/i.test(S)&&Z.unshift("accelerated")):Y=="UC Browser"&&/\bUCWEB\b/.test(S)?Z.push("speed mode"):Y=="PaleMoon"&&(V=/\bFirefox\/([\d.]+)\b/.exec(S))?Z.push("identifying as Firefox "+V[1]):Y=="Firefox"&&(V=/\b(Mobile|Tablet|TV)\b/i.exec(S))?(le||(le="Firefox OS"),de||(de=V[1])):!Y||(V=!/\bMinefield\b/i.test(S)&&/\b(?:Firefox|Safari)\b/.exec(Y))?(Y&&!de&&/[\/,]|^[^(]+?\)/.test(S.slice(S.indexOf(V+"/")+8))&&(Y=null),(V=de||be||le)&&(de||be||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(le))&&(Y=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(le)?le:V)+" Browser")):Y=="Electron"&&(V=(/\bChrome\/([\d.]+)\b/.exec(S)||0)[1])&&Z.push("Chromium "+V),ie||(ie=An(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",b(Y),"(?:Firefox|Minefield|NetFront)"])),(V=ce=="iCab"&&parseFloat(ie)>3&&"WebKit"||/\bOpera\b/.test(Y)&&(/\bOPR\b/.test(S)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(S)&&!/^(?:Trident|EdgeHTML)$/.test(ce)&&"WebKit"||!ce&&/\bMSIE\b/i.test(S)&&(le=="Mac OS"?"Tasman":"Trident")||ce=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(Y)&&"NetFront")&&(ce=[V]),Y=="IE"&&(V=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(S)||0)[1])?(Y+=" Mobile",le="Windows Phone "+(/\+$/.test(V)?V:V+".x"),Z.unshift("desktop mode")):/\bWPDesktop\b/i.test(S)?(Y="IE Mobile",le="Windows Phone 8.x",Z.unshift("desktop mode"),ie||(ie=(/\brv:([\d.]+)/.exec(S)||0)[1])):Y!="IE"&&ce=="Trident"&&(V=/\brv:([\d.]+)/.exec(S))&&(Y&&Z.push("identifying as "+Y+(ie?" "+ie:"")),Y="IE",ie=V[1]),xe){if(y(_,"global"))if(j&&(V=j.lang.System,re=V.getProperty("os.arch"),le=le||V.getProperty("os.name")+" "+V.getProperty("os.version")),P){try{ie=_.require("ringo/engine").version.join("."),Y="RingoJS"}catch{(V=_.system)&&V.global.system==_.system&&(Y="Narwhal",le||(le=V[0].os||null))}Y||(Y="Rhino")}else typeof _.process=="object"&&!_.process.browser&&(V=_.process)&&(typeof V.versions=="object"&&(typeof V.versions.electron=="string"?(Z.push("Node "+V.versions.node),Y="Electron",ie=V.versions.electron):typeof V.versions.nw=="string"&&(Z.push("Chromium "+ie,"Node "+V.versions.node),Y="NW.js",ie=V.versions.nw)),Y||(Y="Node.js",re=V.arch,le=V.platform,ie=/[\d.]+/.exec(V.version),ie=ie?ie[0]:null));else v(V=_.runtime)==F?(Y="Adobe AIR",le=V.flash.system.Capabilities.os):v(V=_.phantom)==N?(Y="PhantomJS",ie=(V=V.version||null)&&V.major+"."+V.minor+"."+V.patch):typeof H.documentMode=="number"&&(V=/\bTrident\/(\d+)/i.exec(S))?(ie=[ie,H.documentMode],(V=+V[1]+4)!=ie[1]&&(Z.push("IE "+ie[1]+" mode"),ce&&(ce[1]=""),ie[1]=V),ie=Y=="IE"?String(ie[1].toFixed(1)):ie[0]):typeof H.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(Y)&&(Z.push("masking as "+Y+" "+ie),Y="IE",ie="11.0",ce=["Trident"],le="Windows");le=le&&m(le)}if(ie&&(V=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(ie)||/(?:alpha|beta)(?: ?\d)?/i.exec(S+";"+(xe&&B.appMinorVersion))||/\bMinefield\b/i.test(S)&&"a")&&(he=/b/i.test(V)?"beta":"alpha",ie=ie.replace(RegExp(V+"\\+?$"),"")+(he=="beta"?U:A)+(/\d+\+?/.exec(V)||"")),Y=="Fennec"||Y=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(le))Y="Firefox Mobile";else if(Y=="Maxthon"&&ie)ie=ie.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(de))de=="Xbox 360"&&(le=null),de=="Xbox 360"&&/\bIEMobile\b/.test(S)&&Z.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(Y)||Y&&!de&&!/Browser|Mobi/.test(Y))&&(le=="Windows CE"||/Mobi/i.test(S)))Y+=" Mobile";else if(Y=="IE"&&xe)try{_.external===null&&Z.unshift("platform preview")}catch{Z.unshift("embedded")}else(/\bBlackBerry\b/.test(de)||/\bBB10\b/.test(S))&&(V=(RegExp(de.replace(/ +/g," *")+"/([.\\d]+)","i").exec(S)||0)[1]||ie)?(V=[V,/BB10/.test(S)],le=(V[1]?(de=null,be="BlackBerry"):"Device Software")+" "+V[0],ie=null):this!=g&&de!="Wii"&&(xe&&q||/Opera/.test(Y)&&/\b(?:MSIE|Firefox)\b/i.test(S)||Y=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(le)||Y=="IE"&&(le&&!/^Win/.test(le)&&ie>5.5||/\bWindows XP\b/.test(le)&&ie>8||ie==8&&!/\bTrident\b/.test(S)))&&!u.test(V=x.call(g,S.replace(u,"")+";"))&&V.name&&(V="ing as "+V.name+((V=V.version)?" "+V:""),u.test(Y)?(/\bIE\b/.test(V)&&le=="Mac OS"&&(le=null),V="identify"+V):(V="mask"+V,Q?Y=m(Q.replace(/([a-z])([A-Z])/g,"$1 $2")):Y="Opera",/\bIE\b/.test(V)&&(le=null),xe||(ie=null)),ce=["Presto"],Z.push(V));(V=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(S)||0)[1])&&(V=[parseFloat(V.replace(/\.(\d)$/,".0$1")),V],Y=="Safari"&&V[1].slice(-1)=="+"?(Y="WebKit Nightly",he="alpha",ie=V[1].slice(0,-1)):(ie==V[1]||ie==(V[2]=(/\bSafari\/([\d.]+\+?)/i.exec(S)||0)[1]))&&(ie=null),V[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(S)||0)[1],V[0]==537.36&&V[2]==537.36&&parseFloat(V[1])>=28&&ce=="WebKit"&&(ce=["Blink"]),!xe||!k&&!V[1]?(ce&&(ce[1]="like Safari"),V=(V=V[0],V<400?1:V<500?2:V<526?3:V<533?4:V<534?"4+":V<535?5:V<537?6:V<538?7:V<601?8:V<602?9:V<604?10:V<606?11:V<608?12:"12")):(ce&&(ce[1]="like Chrome"),V=V[1]||(V=V[0],V<530?1:V<532?2:V<532.05?3:V<533?4:V<534.03?5:V<534.07?6:V<534.1?7:V<534.13?8:V<534.16?9:V<534.24?10:V<534.3?11:V<535.01?12:V<535.02?"13+":V<535.07?15:V<535.11?16:V<535.19?17:V<536.05?18:V<536.1?19:V<537.01?20:V<537.11?"21+":V<537.13?23:V<537.18?24:V<537.24?25:V<537.36?26:ce!="Blink"?"27":"28")),ce&&(ce[1]+=" "+(V+=typeof V=="number"?".x":/[.+]/.test(V)?"":"+")),Y=="Safari"&&(!ie||parseInt(ie)>45)?ie=V:Y=="Chrome"&&/\bHeadlessChrome/i.test(S)&&Z.unshift("headless")),Y=="Opera"&&(V=/\bzbov|zvav$/.exec(le))?(Y+=" ",Z.unshift("desktop mode"),V=="zvav"?(Y+="Mini",ie=null):Y+="Mobile",le=le.replace(RegExp(" *"+V+"$"),"")):Y=="Safari"&&/\bChrome\b/.exec(ce&&ce[1])?(Z.unshift("desktop mode"),Y="Chrome Mobile",ie=null,/\bOS X\b/.test(le)?(be="Apple",le="iOS 4.3+"):le=null):/\bSRWare Iron\b/.test(Y)&&!ie&&(ie=An("Chrome")),ie&&ie.indexOf(V=/[\d.]+$/.exec(le))==0&&S.indexOf("/"+V+"-")>-1&&(le=E(le.replace(V,""))),le&&le.indexOf(Y)!=-1&&!RegExp(Y+" OS").test(le)&&(le=le.replace(RegExp(" *"+b(Y)+" *"),"")),ce&&!/\b(?:Avant|Nook)\b/.test(Y)&&(/Browser|Lunascape|Maxthon/.test(Y)||Y!="Safari"&&/^iOS/.test(le)&&/\bSafari\b/.test(ce[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(Y)&&ce[1])&&(V=ce[ce.length-1])&&Z.push(V),Z.length&&(Z=["("+Z.join("; ")+")"]),be&&de&&de.indexOf(be)<0&&Z.push("on "+be),de&&Z.push((/^on /.test(Z[Z.length-1])?"":"on ")+de),le&&(V=/ ([\d.+]+)$/.exec(le),pe=V&&le.charAt(le.length-V[0].length-1)=="/",le={architecture:32,family:V&&!pe?le.replace(V[0],""):le,version:V?V[1]:null,toString:function(){var bt=this.version;return this.family+(bt&&!pe?" "+bt:"")+(this.architecture==64?" 64-bit":"")}}),(V=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(re))&&!/\bi686\b/i.test(re)?(le&&(le.architecture=64,le.family=le.family.replace(RegExp(" *"+V),"")),Y&&(/\bWOW64\b/i.test(S)||xe&&/\w(?:86|32)$/.test(B.cpuClass||B.platform)&&!/\bWin64; x64\b/i.test(S))&&Z.unshift("32-bit")):le&&/^OS X/.test(le.family)&&Y=="Chrome"&&parseFloat(ie)>=39&&(le.architecture=64),S||(S=null);var it={};return it.description=S,it.layout=ce&&ce[0],it.manufacturer=be,it.name=Y,it.prerelease=he,it.product=de,it.ua=S,it.version=Y&&ie,it.os=le||{architecture:null,family:null,version:null,toString:function(){return"null"}},it.parse=x,it.toString=Sn,it.version&&Z.unshift(ie),it.name&&Z.unshift(Y),le&&Y&&!(le==String(le).split(" ")[0]&&(le==Y.split(" ")[0]||de))&&Z.push(de?"("+le+")":"on "+le),Z.length&&(it.description=Z.join(" ")),it}var R=x();i&&o?g(R,function(S,_){i[_]=S}):r.platform=R}).call(me)})(Hp,Hp.exports);var b9=Hp.exports;Object.defineProperty(Pi,"__esModule",{value:!0});Pi.PlatformUtils=void 0;var Ve=b9,w9=function(){function e(){}return e.getInstance=function(){return this.instance||(this.instance=new e),e.instance},e.prototype.isChromeBrowser=function(){return Ve.name==="Chrome"},e.prototype.isSafariBrowser=function(){return Ve.name==="Safari"},e.prototype.isChromeMobileBrowser=function(){return Ve.name==="Chrome Mobile"},e.prototype.isFirefoxBrowser=function(){return Ve.name==="Firefox"},e.prototype.isFirefoxMobileBrowser=function(){return Ve.name==="Firefox Mobile"||Ve.name==="Firefox for iOS"},e.prototype.isOperaBrowser=function(){return Ve.name==="Opera"},e.prototype.isOperaMobileBrowser=function(){return Ve.name==="Opera Mobile"},e.prototype.isEdgeBrowser=function(){var t=Ve!=null&&Ve.version?parseFloat(Ve.version):-1;return Ve.name==="Microsoft Edge"&&t>=80},e.prototype.isEdgeMobileBrowser=function(){var t,n,r=Ve!=null&&Ve.version?parseFloat(Ve.version):-1;return Ve.name==="Microsoft Edge"&&(((t=Ve.os)===null||t===void 0?void 0:t.family)==="Android"||((n=Ve.os)===null||n===void 0?void 0:n.family)==="iOS")&&r>45},e.prototype.isAndroidBrowser=function(){return Ve.name==="Android Browser"},e.prototype.isElectron=function(){return Ve.name==="Electron"},e.prototype.isNodeJs=function(){return Ve.name==="Node.js"},e.prototype.isSamsungBrowser=function(){return Ve.name==="Samsung Internet Mobile"||Ve.name==="Samsung Internet"},e.prototype.isMotorolaEdgeDevice=function(){var t;return((t=Ve.product)===null||t===void 0?void 0:t.toLowerCase().includes("motorola edge"))||!1},e.prototype.isIPhoneOrIPad=function(){var t=Ve.ua?Ve.ua:navigator.userAgent,n="ontouchend"in document,r=/\b(\w*Macintosh\w*)\b/.test(t)&&n,i=/\b(\w*iPhone\w*)\b/.test(t)&&/\b(\w*Mobile\w*)\b/.test(t)&&n;return r||i},e.prototype.isIOSWithSafari=function(){var t=Ve.ua?Ve.ua:navigator.userAgent;return this.isIPhoneOrIPad()&&/\b(\w*Apple\w*)\b/.test(navigator.vendor)&&/\b(\w*Safari\w*)\b/.test(t)&&!/\b(\w*CriOS\w*)\b/.test(t)&&!/\b(\w*FxiOS\w*)\b/.test(t)},e.prototype.isIonicIos=function(){return this.isIPhoneOrIPad()&&Ve.ua.indexOf("Safari")===-1},e.prototype.isIonicAndroid=function(){return Ve.os.family==="Android"&&Ve.name=="Android Browser"},e.prototype.isMobileDevice=function(){return Ve.os.family==="iOS"||Ve.os.family==="Android"},e.prototype.isReactNative=function(){return!1},e.prototype.isChromium=function(){return this.isChromeBrowser()||this.isChromeMobileBrowser()||this.isOperaBrowser()||this.isOperaMobileBrowser()||this.isEdgeBrowser()||this.isEdgeMobileBrowser()||this.isSamsungBrowser()||this.isIonicAndroid()||this.isIonicIos()||this.isElectron()||this.isMotorolaEdgeDevice()},e.prototype.canScreenShare=function(){var t=Ve!=null&&Ve.version?parseFloat(Ve.version):-1;return this.isMobileDevice()?!1:this.isChromeBrowser()||this.isFirefoxBrowser()||this.isOperaBrowser()||this.isElectron()||this.isEdgeBrowser()||this.isSafariBrowser()&&t>=13},e.prototype.getName=function(){return Ve.name||""},e.prototype.getVersion=function(){return Ve.version||""},e.prototype.getFamily=function(){return Ve.os.family||""},e.prototype.getDescription=function(){return Ve.description||""},e}();Pi.PlatformUtils=w9;function mm(){this._types=Object.create(null),this._extensions=Object.create(null);for(let e=0;e<arguments.length;e++)this.define(arguments[e]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}mm.prototype.define=function(e,t){for(let n in e){let r=e[n].map(function(i){return i.toLowerCase()});n=n.toLowerCase();for(let i=0;i<r.length;i++){const o=r[i];if(o[0]!=="*"){if(!t&&o in this._types)throw new Error('Attempt to change mapping for "'+o+'" extension from "'+this._types[o]+'" to "'+n+'". Pass `force=true` to allow this, otherwise remove "'+o+'" from the list of extensions for "'+n+'".');this._types[o]=n}}if(t||!this._extensions[n]){const i=r[0];this._extensions[n]=i[0]!=="*"?i:i.substr(1)}}};mm.prototype.getType=function(e){e=String(e);let t=e.replace(/^.*[/\\]/,"").toLowerCase(),n=t.replace(/^.*\./,"").toLowerCase(),r=t.length<e.length;return(n.length<t.length-1||!r)&&this._types[n]||null};mm.prototype.getExtension=function(e){return e=/^\s*([^;\s]*)/.test(e)&&RegExp.$1,e&&this._extensions[e.toLowerCase()]||null};var x9=mm,E9={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]};let S9=x9;var C9=new S9(E9);Object.defineProperty(Ud,"__esModule",{value:!0});Ud.LocalRecorder=void 0;var fn=Gw,_9=ln,k9=Pi,F2=C9,za=_9.OpenViduLogger.getInstance(),B2,R9=function(){function e(t){this.stream=t,this.chunks=[],B2=k9.PlatformUtils.getInstance(),this.connectionId=this.stream.connection?this.stream.connection.connectionId:"default-connection",this.id=this.stream.streamId+"_"+this.connectionId+"_localrecord",this.state=fn.LocalRecorderState.READY}return e.prototype.record=function(t){var n=this;return new Promise(function(r,i){try{if(typeof t=="string"||t instanceof String)return i(`When calling LocalRecorder.record(options) parameter 'options' cannot be a string. Must be an object like { mimeType: "`.concat(t,'" }'));if(typeof MediaRecorder>"u")throw za.error("MediaRecorder not supported on your device. See compatibility in https://caniuse.com/#search=MediaRecorder"),Error("MediaRecorder not supported on your device. See compatibility in https://caniuse.com/#search=MediaRecorder");if(n.state!==fn.LocalRecorderState.READY)throw Error("'LocalRecord.record()' needs 'LocalRecord.state' to be 'READY' (current value: '"+n.state+"'). Call 'LocalRecorder.clean()' or init a new LocalRecorder before");za.log("Starting local recording of stream '"+n.stream.streamId+"' of connection '"+n.connectionId+"'"),t?t.mimeType||(t.mimeType="video/webm"):t={mimeType:"video/webm"},n.mediaRecorder=new MediaRecorder(n.stream.getMediaStream(),t),n.mediaRecorder.start()}catch(o){return i(o)}return n.mediaRecorder.ondataavailable=function(o){o.data.size>0&&n.chunks.push(o.data)},n.mediaRecorder.onerror=function(o){za.error("MediaRecorder error: ",o)},n.mediaRecorder.onstart=function(){za.log("MediaRecorder started (state="+n.mediaRecorder.state+")")},n.mediaRecorder.onstop=function(){n.onStopDefault()},n.mediaRecorder.onpause=function(){za.log("MediaRecorder paused (state="+n.mediaRecorder.state+")")},n.mediaRecorder.onresume=function(){za.log("MediaRecorder resumed (state="+n.mediaRecorder.state+")")},n.state=fn.LocalRecorderState.RECORDING,r()})},e.prototype.stop=function(){var t=this;return new Promise(function(n,r){try{if(t.state===fn.LocalRecorderState.READY||t.state===fn.LocalRecorderState.FINISHED)throw Error("'LocalRecord.stop()' needs 'LocalRecord.state' to be 'RECORDING' or 'PAUSED' (current value: '"+t.state+"'). Call 'LocalRecorder.start()' before");t.mediaRecorder.onstop=function(){return t.onStopDefault(),n()},t.mediaRecorder.stop()}catch(i){return r(i)}})},e.prototype.pause=function(){var t=this;return new Promise(function(n,r){try{return t.state!==fn.LocalRecorderState.RECORDING?r(Error("'LocalRecord.pause()' needs 'LocalRecord.state' to be 'RECORDING' (current value: '"+t.state+"'). Call 'LocalRecorder.start()' or 'LocalRecorder.resume()' before")):(t.mediaRecorder.pause(),t.state=fn.LocalRecorderState.PAUSED,n())}catch(i){return r(i)}})},e.prototype.resume=function(){var t=this;return new Promise(function(n,r){try{if(t.state!==fn.LocalRecorderState.PAUSED)throw Error("'LocalRecord.resume()' needs 'LocalRecord.state' to be 'PAUSED' (current value: '"+t.state+"'). Call 'LocalRecorder.pause()' before");return t.mediaRecorder.resume(),t.state=fn.LocalRecorderState.RECORDING,n()}catch(i){return r(i)}})},e.prototype.preview=function(t){if(this.state!==fn.LocalRecorderState.FINISHED)throw Error("'LocalRecord.preview()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");if(this.videoPreview=document.createElement("video"),this.videoPreview.id=this.id,this.videoPreview.autoplay=!0,B2.isSafariBrowser()&&(this.videoPreview.playsInline=!0),typeof t=="string"){var n=document.getElementById(t);n&&(this.videoPreview=n.appendChild(this.videoPreview))}else this.videoPreview=t.appendChild(this.videoPreview);return this.videoPreview.src=this.videoPreviewSrc,this.videoPreview},e.prototype.clean=function(){var t=this,n=function(){delete t.blob,t.chunks=[],t.state=fn.LocalRecorderState.READY};this.state===fn.LocalRecorderState.RECORDING||this.state===fn.LocalRecorderState.PAUSED?this.stop().then(function(){return n()}).catch(function(){return n()}):n()},e.prototype.download=function(){if(this.state!==fn.LocalRecorderState.FINISHED)throw Error("'LocalRecord.download()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");var t=document.createElement("a");t.style.display="none",document.body.appendChild(t);var n=globalThis.URL.createObjectURL(this.blob);t.href=n,t.download=this.id+"."+F2.getExtension(this.blob.type),t.click(),globalThis.URL.revokeObjectURL(n),document.body.removeChild(t)},e.prototype.getBlob=function(){if(this.state!==fn.LocalRecorderState.FINISHED)throw Error("Call 'LocalRecord.stop()' before getting Blob file");return this.blob},e.prototype.uploadAsBinary=function(t,n){var r=this;return new Promise(function(i,o){if(r.state!==fn.LocalRecorderState.FINISHED)return o(Error("'LocalRecord.uploadAsBinary()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+r.state+"'). Call 'LocalRecorder.stop()' before"));var a=new XMLHttpRequest;if(a.open("POST",t,!0),typeof n=="object")for(var s=0,u=Object.keys(n);s<u.length;s++){var c=u[s];a.setRequestHeader(c,n[c])}a.onreadystatechange=function(){if(a.readyState===4)return a.status.toString().charAt(0)==="2"?i(a.responseText):o(a.status)},a.send(r.blob)})},e.prototype.uploadAsMultipartfile=function(t,n){var r=this;return new Promise(function(i,o){if(r.state!==fn.LocalRecorderState.FINISHED)return o(Error("'LocalRecord.uploadAsMultipartfile()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+r.state+"'). Call 'LocalRecorder.stop()' before"));var a=new XMLHttpRequest;if(a.open("POST",t,!0),typeof n=="object")for(var s=0,u=Object.keys(n);s<u.length;s++){var c=u[s];a.setRequestHeader(c,n[c])}var l=new FormData;l.append("file",r.blob,r.id+"."+F2.getExtension(r.blob.type)),a.onreadystatechange=function(){if(a.readyState===4)return a.status.toString().charAt(0)==="2"?i(a.responseText):o(a.status)},a.send(l)})},e.prototype.onStopDefault=function(){za.log("MediaRecorder stopped  (state="+this.mediaRecorder.state+")"),this.blob=new Blob(this.chunks,{type:this.mediaRecorder.mimeType}),this.chunks=[],this.videoPreviewSrc=globalThis.URL.createObjectURL(this.blob),this.state=fn.LocalRecorderState.FINISHED},e}();Ud.LocalRecorder=R9;var al={},sl={},zd={},Nc={},Dc={},Ao={},En={};Object.defineProperty(En,"__esModule",{value:!0});En.Event=void 0;var I9=function(){function e(t,n,r){this.hasBeenPrevented=!1,this.cancelable=t,this.target=n,this.type=r}return e.prototype.isDefaultPrevented=function(){return this.hasBeenPrevented},e.prototype.preventDefault=function(){this.callDefaultBehavior=function(){},this.hasBeenPrevented=!0},e}();En.Event=I9;var T9=me&&me.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Ao,"__esModule",{value:!0});Ao.StreamPropertyChangedEvent=void 0;var O9=En,P9=function(e){T9(t,e);function t(n,r,i,o,a,s){var u=e.call(this,!1,n,"streamPropertyChanged")||this;return u.stream=r,u.changedProperty=i,u.newValue=o,u.oldValue=a,u.reason=s,u}return t.prototype.callDefaultBehavior=function(){},t}(O9.Event);Ao.StreamPropertyChangedEvent=P9;var js={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OpenViduError=e.OpenViduErrorName=void 0,function(n){n.BROWSER_NOT_SUPPORTED="BROWSER_NOT_SUPPORTED",n.DEVICE_ACCESS_DENIED="DEVICE_ACCESS_DENIED",n.DEVICE_ALREADY_IN_USE="DEVICE_ALREADY_IN_USE",n.SCREEN_CAPTURE_DENIED="SCREEN_CAPTURE_DENIED",n.SCREEN_SHARING_NOT_SUPPORTED="SCREEN_SHARING_NOT_SUPPORTED",n.SCREEN_EXTENSION_NOT_INSTALLED="SCREEN_EXTENSION_NOT_INSTALLED",n.SCREEN_EXTENSION_DISABLED="SCREEN_EXTENSION_DISABLED",n.INPUT_VIDEO_DEVICE_NOT_FOUND="INPUT_VIDEO_DEVICE_NOT_FOUND",n.INPUT_AUDIO_DEVICE_NOT_FOUND="INPUT_AUDIO_DEVICE_NOT_FOUND",n.INPUT_AUDIO_DEVICE_GENERIC_ERROR="INPUT_AUDIO_DEVICE_GENERIC_ERROR",n.NO_INPUT_SOURCE_SET="NO_INPUT_SOURCE_SET",n.PUBLISHER_PROPERTIES_ERROR="PUBLISHER_PROPERTIES_ERROR",n.OPENVIDU_PERMISSION_DENIED="OPENVIDU_PERMISSION_DENIED",n.OPENVIDU_NOT_CONNECTED="OPENVIDU_NOT_CONNECTED",n.VIRTUAL_BACKGROUND_ERROR="VIRTUAL_BACKGROUND_ERROR",n.GENERIC_ERROR="GENERIC_ERROR"}(e.OpenViduErrorName||(e.OpenViduErrorName={}));var t=function(){function n(r,i){this.name=r,this.message=i}return n}();e.OpenViduError=t})(js);Object.defineProperty(Dc,"__esModule",{value:!0});Dc.Filter=void 0;var j2=Ao,Fn=js,N9=ln,Bi=N9.OpenViduLogger.getInstance(),D9=function(){function e(t,n){this.handlers=new Map,this.type=t,this.options=n}return e.prototype.execMethod=function(t,n){var r=this;return new Promise(function(i,o){var a;Bi.info("Executing filter method to stream "+r.stream.streamId);var s,u=function(d){Bi.info("Filter method successfully executed on Stream "+r.stream.streamId);var f=Object.assign({},r.stream.filter);return r.stream.filter.lastExecMethod={method:t,params:s},d&&(r.stream.session.emitEvent("streamPropertyChanged",[new j2.StreamPropertyChangedEvent(r.stream.session,r.stream,"filter",r.stream.filter,f,"execFilterMethod")]),r.stream.streamManager.emitEvent("streamPropertyChanged",[new j2.StreamPropertyChangedEvent(r.stream.streamManager,r.stream,"filter",r.stream.filter,f,"execFilterMethod")])),i()};if(r.type.startsWith("VB:")){if(typeof n=="string")try{n=JSON.parse(n)}catch(d){return o(new Fn.OpenViduError(Fn.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"Wrong params syntax: "+d))}if(s=n,t==="update")if(!((a=r.stream.virtualBackgroundSinkElements)===null||a===void 0)&&a.VB)r.stream.virtualBackgroundSinkElements.VB.updateValues(n).then(function(){return u(!1)}).catch(function(d){return d.name===Fn.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR?o(new Fn.OpenViduError(d.name,d.message)):o(new Fn.OpenViduError(Fn.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"Error updating values on Virtual Background filter: "+d))});else return o(new Fn.OpenViduError(Fn.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"There is no Virtual Background filter applied"));else return o(new Fn.OpenViduError(Fn.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,'Unknown Virtual Background method "'.concat(t,'"')))}else{var c=void 0;if(typeof n!="string")try{c=JSON.stringify(n)}catch{var l="'params' property must be a JSON formatted object";return Bi.error(l),o(l)}else c=n;s=c,r.stream.session.openvidu.sendRequest("execFilterMethod",{streamId:r.stream.streamId,method:t,params:c},function(d,f){return d?(Bi.error("Error executing filter method for Stream "+r.stream.streamId,d),d.code===401?o(new Fn.OpenViduError(Fn.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to execute a filter method")):o(d)):u(!0)})}})},e.prototype.addEventListener=function(t,n){var r=this;return new Promise(function(i,o){Bi.info("Adding filter event listener to event "+t+" to stream "+r.stream.streamId),r.stream.session.openvidu.sendRequest("addFilterEventListener",{streamId:r.stream.streamId,eventType:t},function(a,s){return a?(Bi.error("Error adding filter event listener to event "+t+"for Stream "+r.stream.streamId,a),a.code===401?o(new Fn.OpenViduError(Fn.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):o(a)):(r.handlers.set(t,n),Bi.info("Filter event listener to event "+t+" successfully applied on Stream "+r.stream.streamId),i())})})},e.prototype.removeEventListener=function(t){var n=this;return new Promise(function(r,i){Bi.info("Removing filter event listener to event "+t+" to stream "+n.stream.streamId),n.stream.session.openvidu.sendRequest("removeFilterEventListener",{streamId:n.stream.streamId,eventType:t},function(o,a){return o?(Bi.error("Error removing filter event listener to event "+t+"for Stream "+n.stream.streamId,o),o.code===401?i(new Fn.OpenViduError(Fn.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):i(o)):(n.handlers.delete(t),Bi.info("Filter event listener to event "+t+" successfully removed on Stream "+n.stream.streamId),r())})})},e}();Dc.Filter=D9;var Ac={},Mc={},Lc={},KP={exports:{}};/*!
 * EventEmitter v5.2.9 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */(function(e){(function(t){function n(){}var r=n.prototype,i=t.EventEmitter;function o(u,c){for(var l=u.length;l--;)if(u[l].listener===c)return l;return-1}function a(u){return function(){return this[u].apply(this,arguments)}}r.getListeners=function(c){var l=this._getEvents(),d,f;if(c instanceof RegExp){d={};for(f in l)l.hasOwnProperty(f)&&c.test(f)&&(d[f]=l[f])}else d=l[c]||(l[c]=[]);return d},r.flattenListeners=function(c){var l=[],d;for(d=0;d<c.length;d+=1)l.push(c[d].listener);return l},r.getListenersAsObject=function(c){var l=this.getListeners(c),d;return l instanceof Array&&(d={},d[c]=l),d||l};function s(u){return typeof u=="function"||u instanceof RegExp?!0:u&&typeof u=="object"?s(u.listener):!1}r.addListener=function(c,l){if(!s(l))throw new TypeError("listener must be a function");var d=this.getListenersAsObject(c),f=typeof l=="object",h;for(h in d)d.hasOwnProperty(h)&&o(d[h],l)===-1&&d[h].push(f?l:{listener:l,once:!1});return this},r.on=a("addListener"),r.addOnceListener=function(c,l){return this.addListener(c,{listener:l,once:!0})},r.once=a("addOnceListener"),r.defineEvent=function(c){return this.getListeners(c),this},r.defineEvents=function(c){for(var l=0;l<c.length;l+=1)this.defineEvent(c[l]);return this},r.removeListener=function(c,l){var d=this.getListenersAsObject(c),f,h;for(h in d)d.hasOwnProperty(h)&&(f=o(d[h],l),f!==-1&&d[h].splice(f,1));return this},r.off=a("removeListener"),r.addListeners=function(c,l){return this.manipulateListeners(!1,c,l)},r.removeListeners=function(c,l){return this.manipulateListeners(!0,c,l)},r.manipulateListeners=function(c,l,d){var f,h,p=c?this.removeListener:this.addListener,m=c?this.removeListeners:this.addListeners;if(typeof l=="object"&&!(l instanceof RegExp))for(f in l)l.hasOwnProperty(f)&&(h=l[f])&&(typeof h=="function"?p.call(this,f,h):m.call(this,f,h));else for(f=d.length;f--;)p.call(this,l,d[f]);return this},r.removeEvent=function(c){var l=typeof c,d=this._getEvents(),f;if(l==="string")delete d[c];else if(c instanceof RegExp)for(f in d)d.hasOwnProperty(f)&&c.test(f)&&delete d[f];else delete this._events;return this},r.removeAllListeners=a("removeEvent"),r.emitEvent=function(c,l){var d=this.getListenersAsObject(c),f,h,p,m,g;for(m in d)if(d.hasOwnProperty(m))for(f=d[m].slice(0),p=0;p<f.length;p++)h=f[p],h.once===!0&&this.removeListener(c,h.listener),g=h.listener.apply(this,l||[]),g===this._getOnceReturnValue()&&this.removeListener(c,h.listener);return this},r.trigger=a("emitEvent"),r.emit=function(c){var l=Array.prototype.slice.call(arguments,1);return this.emitEvent(c,l)},r.setOnceReturnValue=function(c){return this._onceReturnValue=c,this},r._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},r._getEvents=function(){return this._events||(this._events={})},n.noConflict=function(){return t.EventEmitter=i,n},e.exports?e.exports=n:t.EventEmitter=n})(typeof window<"u"?window:me||{})})(KP);var Xw=KP.exports;Object.defineProperty(Lc,"__esModule",{value:!0});Lc.EventDispatcher=void 0;var A9=ln,M9=Xw,Zf=A9.OpenViduLogger.getInstance(),L9=function(){function e(){this.userHandlerArrowHandler=new WeakMap,this.ee=new M9}return e.prototype.onAux=function(t,n,r){var i=function(o){o?Zf.debug(n,o):Zf.debug(n),r(o)};return this.userHandlerArrowHandler.set(r,i),this.ee.on(t,i),this},e.prototype.onceAux=function(t,n,r){var i=this,o=function(a){a?Zf.debug(n,a):Zf.debug(n),r(a),i.userHandlerArrowHandler.delete(r)};return this.userHandlerArrowHandler.set(r,o),this.ee.once(t,o),this},e.prototype.offAux=function(t,n){if(!n)this.ee.removeAllListeners(t);else{var r=this.userHandlerArrowHandler.get(n);r&&this.ee.off(t,r),this.userHandlerArrowHandler.delete(n)}return this},e}();Lc.EventDispatcher=L9;var Fc={},F9=me&&me.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Fc,"__esModule",{value:!0});Fc.StreamManagerEvent=void 0;var B9=En,j9=function(e){F9(t,e);function t(n,r,i){var o=e.call(this,!1,n,r)||this;return o.value=i,o}return t.prototype.callDefaultBehavior=function(){},t}(B9.Event);Fc.StreamManagerEvent=j9;var Hd={},$9=me&&me.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Hd,"__esModule",{value:!0});Hd.VideoElementEvent=void 0;var V9=En,W9=function(e){$9(t,e);function t(n,r,i){var o=e.call(this,!1,r,i)||this;return o.element=n,o}return t.prototype.callDefaultBehavior=function(){},t}(V9.Event);Hd.VideoElementEvent=W9;var $s={};(function(e){var t=me&&me.__extends||function(){var i=function(o,a){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,u){s.__proto__=u}||function(s,u){for(var c in u)Object.prototype.hasOwnProperty.call(u,c)&&(s[c]=u[c])},i(o,a)};return function(o,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");i(o,a);function s(){this.constructor=o}o.prototype=a===null?Object.create(a):(s.prototype=a.prototype,new s)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ExceptionEvent=e.ExceptionEventName=void 0;var n=En;(function(i){i.ICE_CANDIDATE_ERROR="ICE_CANDIDATE_ERROR",i.ICE_CONNECTION_FAILED="ICE_CONNECTION_FAILED",i.ICE_CONNECTION_DISCONNECTED="ICE_CONNECTION_DISCONNECTED",i.NO_STREAM_PLAYING_EVENT="NO_STREAM_PLAYING_EVENT",i.SPEECH_TO_TEXT_DISCONNECTED="SPEECH_TO_TEXT_DISCONNECTED"})(e.ExceptionEventName||(e.ExceptionEventName={}));var r=function(i){t(o,i);function o(a,s,u,c,l){var d=i.call(this,!1,a,"exception")||this;return d.name=s,d.origin=u,d.message=c,d.data=l,d}return o.prototype.callDefaultBehavior=function(){},o}(n.Event);e.ExceptionEvent=r})($s);var Gd={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.VideoInsertMode=void 0,function(t){t.AFTER="AFTER",t.APPEND="APPEND",t.BEFORE="BEFORE",t.PREPEND="PREPEND",t.REPLACE="REPLACE"}(e.VideoInsertMode||(e.VideoInsertMode={}))})(Gd);var U9=me&&me.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Mc,"__esModule",{value:!0});Mc.StreamManager=void 0;var z9=Lc,m0=Fc,eh=Hd,$2=$s,Ha=Gd,H9=ln,G9=Pi,g0=H9.OpenViduLogger.getInstance(),rr,q9=function(e){U9(t,e);function t(n,r){var i=e.call(this)||this;if(i.videos=[],i.lazyLaunchVideoElementCreatedEvent=!1,rr=G9.PlatformUtils.getInstance(),i.stream=n,i.stream.streamManager=i,i.remote=!i.stream.isLocal(),r){var o=void 0;typeof r=="string"?o=document.getElementById(r):r instanceof HTMLElement&&(o=r),o&&(i.firstVideoElement={targetElement:o,video:document.createElement("video"),id:"",canplayListenerAdded:!1},(rr.isSafariBrowser()||rr.isIPhoneOrIPad()&&(rr.isChromeMobileBrowser()||rr.isEdgeMobileBrowser()||rr.isOperaMobileBrowser()||rr.isFirefoxMobileBrowser()))&&(i.firstVideoElement.video.playsInline=!0),i.targetElement=o,i.element=o)}return i.canPlayListener=function(){i.deactivateStreamPlayingEventExceptionTimeout(),i.ee.emitEvent("streamPlaying",[new m0.StreamManagerEvent(i,"streamPlaying",void 0)])},i}return t.prototype.on=function(n,r){return e.prototype.onAux.call(this,n,"Event '"+n+"' triggered by '"+(this.remote?"Subscriber":"Publisher")+"'",r),n==="videoElementCreated"&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&(this.ee.emitEvent("videoElementCreated",[new eh.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!1),n==="streamPlaying"&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&this.videos[0].video.paused===!1&&this.videos[0].video.ended===!1&&this.videos[0].video.readyState===4&&this.ee.emitEvent("streamPlaying",[new m0.StreamManagerEvent(this,"streamPlaying",void 0)]),this.stream.hasAudio&&(n==="publisherStartSpeaking"&&this.stream.enableHarkSpeakingEvent(),n==="publisherStopSpeaking"&&this.stream.enableHarkStoppedSpeakingEvent(),n==="streamAudioVolumeChange"&&this.stream.enableHarkVolumeChangeEvent(!1)),this},t.prototype.once=function(n,r){return e.prototype.onceAux.call(this,n,"Event '"+n+"' triggered once by '"+(this.remote?"Subscriber":"Publisher")+"'",r),n==="videoElementCreated"&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&this.ee.emitEvent("videoElementCreated",[new eh.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),n==="streamPlaying"&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&this.videos[0].video.paused===!1&&this.videos[0].video.ended===!1&&this.videos[0].video.readyState===4&&this.ee.emitEvent("streamPlaying",[new m0.StreamManagerEvent(this,"streamPlaying",void 0)]),this.stream.hasAudio&&(n==="publisherStartSpeaking"&&this.stream.enableOnceHarkSpeakingEvent(),n==="publisherStopSpeaking"&&this.stream.enableOnceHarkStoppedSpeakingEvent(),n==="streamAudioVolumeChange"&&this.stream.enableOnceHarkVolumeChangeEvent(!1)),this},t.prototype.off=function(n,r){if(e.prototype.offAux.call(this,n,r),n==="publisherStartSpeaking"){var i=this.ee.getListeners(n).length+this.stream.session.ee.getListeners(n).length;i===0&&this.stream.disableHarkSpeakingEvent(!1)}if(n==="publisherStopSpeaking"){var o=this.ee.getListeners(n).length+this.stream.session.ee.getListeners(n).length;o===0&&this.stream.disableHarkStoppedSpeakingEvent(!1)}if(n==="streamAudioVolumeChange"){var a=this.ee.getListeners(n).length;a===0&&this.stream.disableHarkVolumeChangeEvent(!1)}return this},t.prototype.addVideoElement=function(n){this.initializeVideoProperties(n),!this.remote&&this.stream.displayMyRemote()&&n.srcObject!==this.stream.getMediaStream()&&(n.srcObject=this.stream.getMediaStream());for(var r=0,i=this.videos;r<i.length;r++){var o=i[r];if(o.video===n)return 0}for(var a=1,s=0,u=this.stream.session.streamManagers;s<u.length;s++){var c=u[s];if(c.disassociateVideo(n)){a=-1;break}}return this.stream.session.streamManagers.forEach(function(l){l.disassociateVideo(n)}),this.pushNewStreamManagerVideo({video:n,id:n.id,canplayListenerAdded:!1}),g0.info("New video element associated to ",this),a},t.prototype.createVideoElement=function(n,r){var i;if(typeof n=="string"){if(i=document.getElementById(n),!i)throw new Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+n)}else if(n instanceof HTMLElement)i=n;else throw new Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+n);var o=this.createVideo();this.initializeVideoProperties(o);var a=r||Ha.VideoInsertMode.APPEND;switch(a){case Ha.VideoInsertMode.AFTER:i.parentNode.insertBefore(o,i.nextSibling);break;case Ha.VideoInsertMode.APPEND:i.appendChild(o);break;case Ha.VideoInsertMode.BEFORE:i.parentNode.insertBefore(o,i);break;case Ha.VideoInsertMode.PREPEND:i.insertBefore(o,i.childNodes[0]);break;case Ha.VideoInsertMode.REPLACE:i.parentNode.replaceChild(o,i);break;default:a=Ha.VideoInsertMode.APPEND,i.appendChild(o);break}var s={targetElement:i,video:o,insertMode:a,id:o.id,canplayListenerAdded:!1};return this.pushNewStreamManagerVideo(s),this.ee.emitEvent("videoElementCreated",[new eh.VideoElementEvent(s.video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!!this.firstVideoElement,o},t.prototype.updatePublisherSpeakingEventsOptions=function(n){var r=this.stream.harkOptions?this.stream.harkOptions:this.stream.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{},i=typeof n.interval=="number"?n.interval:typeof r.interval=="number"?r.interval:100,o=typeof n.threshold=="number"?n.threshold:typeof r.threshold=="number"?r.threshold:-50;this.stream.harkOptions={interval:i,threshold:o},this.stream.speechEvent&&(this.stream.speechEvent.setInterval(i),this.stream.speechEvent.setThreshold(o))},t.prototype.initializeVideoProperties=function(n){!this.remote&&this.stream.displayMyRemote()||n.srcObject!==this.stream.getMediaStream()&&(n.srcObject=this.stream.getMediaStream()),n.autoplay=!0,n.controls=!1,(rr.isSafariBrowser()||rr.isIPhoneOrIPad()&&(rr.isChromeMobileBrowser()||rr.isEdgeMobileBrowser()||rr.isOperaMobileBrowser()||rr.isFirefoxMobileBrowser()))&&(n.playsInline=!0),n.id||(n.id=(this.remote?"remote-":"local-")+"video-"+this.stream.streamId,!this.id&&this.targetElement&&(this.id=n.id)),this.remote&&this.isMirroredVideo(n)?this.removeMirrorVideo(n):!this.remote&&!this.stream.displayMyRemote()&&(n.muted=!0,this.isMirroredVideo(n)&&!this.stream.outboundStreamOpts.publisherProperties.mirror?this.removeMirrorVideo(n):this.stream.outboundStreamOpts.publisherProperties.mirror&&!this.stream.isSendScreen()&&this.mirrorVideo(n))},t.prototype.removeAllVideos=function(){for(var n=this,r=this.stream.session.streamManagers.length-1;r>=0;--r)this.stream.session.streamManagers[r]===this&&this.stream.session.streamManagers.splice(r,1);this.videos.forEach(function(i){i.video&&i.video.removeEventListener&&i.video.removeEventListener("canplay",n.canPlayListener),i.canplayListenerAdded=!1,i.targetElement&&(i.video.parentNode.removeChild(i.video),n.ee.emitEvent("videoElementDestroyed",[new eh.VideoElementEvent(i.video,n,"videoElementDestroyed")])),n.removeSrcObject(i),n.videos=n.videos.filter(function(o){return!o.targetElement})})},t.prototype.disassociateVideo=function(n){for(var r=!1,i=0;i<this.videos.length;i++)if(this.videos[i].video===n){this.videos[i].video.removeEventListener("canplay",this.canPlayListener),this.videos.splice(i,1),r=!0,g0.info("Video element disassociated from ",this);break}return r},t.prototype.addPlayEventToFirstVideo=function(){this.videos[0]&&this.videos[0].video&&!this.videos[0].canplayListenerAdded&&(this.activateStreamPlayingEventExceptionTimeout(),this.videos[0].video.addEventListener("canplay",this.canPlayListener),this.videos[0].canplayListenerAdded=!0)},t.prototype.updateMediaStream=function(n){this.videos.forEach(function(r){if(r.video.srcObject=n,rr.isIonicIos()){var i=r.video.parentElement,o=r.video;i.replaceChild(o,r.video),r.video=o}})},t.prototype.emitEvent=function(n,r){this.ee.emitEvent(n,r)},t.prototype.createVideo=function(){return document.createElement("video")},t.prototype.removeSrcObject=function(n){n.video.srcObject=null,this.deactivateStreamPlayingEventExceptionTimeout()},t.prototype.pushNewStreamManagerVideo=function(n){this.videos.push(n),this.addPlayEventToFirstVideo(),this.stream.session.streamManagers.indexOf(this)===-1&&this.stream.session.streamManagers.push(this)},t.prototype.mirrorVideo=function(n){rr.isIonicIos()||(n.style.transform="rotateY(180deg)",n.style.webkitTransform="rotateY(180deg)")},t.prototype.removeMirrorVideo=function(n){n.style.transform="unset",n.style.webkitTransform="unset"},t.prototype.isMirroredVideo=function(n){return n.style.transform==="rotateY(180deg)"||n.style.webkitTransform==="rotateY(180deg)"},t.prototype.activateStreamPlayingEventExceptionTimeout=function(){var n=this;if(this.remote&&this.streamPlayingEventExceptionTimeout==null){var r=this.stream.session.openvidu.advancedConfiguration.noStreamPlayingEventExceptionTimeout||4e3;this.streamPlayingEventExceptionTimeout=setTimeout(function(){var i="StreamManager of Stream "+n.stream.streamId+" ("+(n.remote?"Subscriber":"Publisher")+') did not trigger "streamPlaying" event in '+r+" ms";g0.warn(i),n.stream.session.emitEvent("exception",[new $2.ExceptionEvent(n.stream.session,$2.ExceptionEventName.NO_STREAM_PLAYING_EVENT,n,i)]),delete n.streamPlayingEventExceptionTimeout},r)}},t.prototype.deactivateStreamPlayingEventExceptionTimeout=function(){clearTimeout(this.streamPlayingEventExceptionTimeout),delete this.streamPlayingEventExceptionTimeout},t}(z9.EventDispatcher);Mc.StreamManager=q9;var X9=me&&me.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Ac,"__esModule",{value:!0});Ac.Subscriber=void 0;var K9=Mc,Y9=ln,V2=Y9.OpenViduLogger.getInstance(),Q9=function(e){X9(t,e);function t(n,r,i){var o=e.call(this,n,r)||this;return o.element=o.targetElement,o.stream=n,o.properties=i,o}return t.prototype.subscribeToAudio=function(n){return this.stream.getMediaStream().getAudioTracks().forEach(function(r){r.enabled=n}),this.stream.audioActive=n,V2.info("'Subscriber' has "+(n?"subscribed to":"unsubscribed from")+" its audio stream"),this},t.prototype.subscribeToVideo=function(n){return this.stream.getMediaStream().getVideoTracks().forEach(function(r){r.enabled=n}),this.stream.videoActive=n,V2.info("'Subscriber' has "+(n?"subscribed to":"unsubscribed from")+" its video stream"),this},t.prototype.replaceTrackInMediaStream=function(n,r){var i=this.stream.getMediaStream(),o;n.kind==="video"?(o=i.getVideoTracks()[0],r&&(this.stream.lastVideoTrackConstraints=n.getConstraints())):o=i.getAudioTracks()[0],i.removeTrack(o),o.stop(),i.addTrack(n)},t}(K9.StreamManager);Ac.Subscriber=Q9;var Yi={},W2=["stun:","turn:"],J9=function(e){var t=(e||{}).url||e,n,r,i={};return typeof t!="string"&&!(t instanceof String)||(t=t.trim(),n=W2[W2.indexOf(t.slice(0,5))],!n)?e:(t=t.slice(5),r=t.split("@"),i.username=e.username,i.credential=e.credential,r.length>1&&(t=r[1],r=r[0].split(":"),i.username=r[0],i.credential=(e||{}).credential||r[1]||""),i.url=n+t,i.urls=[i.url],i)};const Z9=["stun.l.google.com:19302","stun1.l.google.com:19302","stun2.l.google.com:19302","stun3.l.google.com:19302","stun4.l.google.com:19302","stun.ekiga.net","stun.ideasip.com","stun.schlund.de","stun.stunprotocol.org:3478","stun.voiparound.com","stun.voipbuster.com","stun.voipstunt.com","stun.voxgratia.org"],eG=[];var tG=J9,nG=function(e){var t={stun:(e||{}).stun||Z9,turn:(e||{}).turn||eG},n=(e||{}).stunCount||2,r=(e||{}).turnCount||0,i;function o(a,s){for(var u=[],c=[].concat(t[a]),l;c.length&&u.length<s;)l=Math.random()*c.length|0,u=u.concat(c.splice(l,1));return u.map(function(d){return typeof d!="string"&&!(d instanceof String)?d:tG(a+":"+d)})}return i=[].concat(o("stun",n)),r&&(i=i.concat(o("turn",r))),i},rG=nG,Kw={},gm={},ym={};Object.defineProperty(ym,"__esModule",{value:!0});ym.default=oG;let th;const iG=new Uint8Array(16);function oG(){if(!th&&(th=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!th))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return th(iG)}var ja={},Vs={},bm={};Object.defineProperty(bm,"__esModule",{value:!0});bm.default=void 0;var aG=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;bm.default=aG;Object.defineProperty(Vs,"__esModule",{value:!0});Vs.default=void 0;var sG=uG(bm);function uG(e){return e&&e.__esModule?e:{default:e}}function cG(e){return typeof e=="string"&&sG.default.test(e)}var lG=cG;Vs.default=lG;Object.defineProperty(ja,"__esModule",{value:!0});ja.default=void 0;ja.unsafeStringify=YP;var dG=fG(Vs);function fG(e){return e&&e.__esModule?e:{default:e}}const _n=[];for(let e=0;e<256;++e)_n.push((e+256).toString(16).slice(1));function YP(e,t=0){return _n[e[t+0]]+_n[e[t+1]]+_n[e[t+2]]+_n[e[t+3]]+"-"+_n[e[t+4]]+_n[e[t+5]]+"-"+_n[e[t+6]]+_n[e[t+7]]+"-"+_n[e[t+8]]+_n[e[t+9]]+"-"+_n[e[t+10]]+_n[e[t+11]]+_n[e[t+12]]+_n[e[t+13]]+_n[e[t+14]]+_n[e[t+15]]}function hG(e,t=0){const n=YP(e,t);if(!(0,dG.default)(n))throw TypeError("Stringified UUID is invalid");return n}var pG=hG;ja.default=pG;Object.defineProperty(gm,"__esModule",{value:!0});gm.default=void 0;var vG=gG(ym),mG=ja;function gG(e){return e&&e.__esModule?e:{default:e}}let U2,y0,b0=0,w0=0;function yG(e,t,n){let r=t&&n||0;const i=t||new Array(16);e=e||{};let o=e.node||U2,a=e.clockseq!==void 0?e.clockseq:y0;if(o==null||a==null){const f=e.random||(e.rng||vG.default)();o==null&&(o=U2=[f[0]|1,f[1],f[2],f[3],f[4],f[5]]),a==null&&(a=y0=(f[6]<<8|f[7])&16383)}let s=e.msecs!==void 0?e.msecs:Date.now(),u=e.nsecs!==void 0?e.nsecs:w0+1;const c=s-b0+(u-w0)/1e4;if(c<0&&e.clockseq===void 0&&(a=a+1&16383),(c<0||s>b0)&&e.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");b0=s,w0=u,y0=a,s+=122192928e5;const l=((s&268435455)*1e4+u)%4294967296;i[r++]=l>>>24&255,i[r++]=l>>>16&255,i[r++]=l>>>8&255,i[r++]=l&255;const d=s/4294967296*1e4&268435455;i[r++]=d>>>8&255,i[r++]=d&255,i[r++]=d>>>24&15|16,i[r++]=d>>>16&255,i[r++]=a>>>8|128,i[r++]=a&255;for(let f=0;f<6;++f)i[r+f]=o[f];return t||(0,mG.unsafeStringify)(i)}var bG=yG;gm.default=bG;var wm={},Oa={},qd={};Object.defineProperty(qd,"__esModule",{value:!0});qd.default=void 0;var wG=xG(Vs);function xG(e){return e&&e.__esModule?e:{default:e}}function EG(e){if(!(0,wG.default)(e))throw TypeError("Invalid UUID");let t;const n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=t&255,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=t&255,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=t&255,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=t&255,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=t&255,n}var SG=EG;qd.default=SG;Object.defineProperty(Oa,"__esModule",{value:!0});Oa.URL=Oa.DNS=void 0;Oa.default=IG;var CG=ja,_G=kG(qd);function kG(e){return e&&e.__esModule?e:{default:e}}function RG(e){e=unescape(encodeURIComponent(e));const t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}const QP="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Oa.DNS=QP;const JP="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Oa.URL=JP;function IG(e,t,n){function r(i,o,a,s){var u;if(typeof i=="string"&&(i=RG(i)),typeof o=="string"&&(o=(0,_G.default)(o)),((u=o)===null||u===void 0?void 0:u.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+i.length);if(c.set(o),c.set(i,o.length),c=n(c),c[6]=c[6]&15|t,c[8]=c[8]&63|128,a){s=s||0;for(let l=0;l<16;++l)a[s+l]=c[l];return a}return(0,CG.unsafeStringify)(c)}try{r.name=e}catch{}return r.DNS=QP,r.URL=JP,r}var xm={};Object.defineProperty(xm,"__esModule",{value:!0});xm.default=void 0;function TG(e){if(typeof e=="string"){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return OG(PG(NG(e),e.length*8))}function OG(e){const t=[],n=e.length*32,r="0123456789abcdef";for(let i=0;i<n;i+=8){const o=e[i>>5]>>>i%32&255,a=parseInt(r.charAt(o>>>4&15)+r.charAt(o&15),16);t.push(a)}return t}function ZP(e){return(e+64>>>9<<4)+14+1}function PG(e,t){e[t>>5]|=128<<t%32,e[ZP(t)-1]=t;let n=1732584193,r=-271733879,i=-1732584194,o=271733878;for(let a=0;a<e.length;a+=16){const s=n,u=r,c=i,l=o;n=Bn(n,r,i,o,e[a],7,-680876936),o=Bn(o,n,r,i,e[a+1],12,-389564586),i=Bn(i,o,n,r,e[a+2],17,606105819),r=Bn(r,i,o,n,e[a+3],22,-1044525330),n=Bn(n,r,i,o,e[a+4],7,-176418897),o=Bn(o,n,r,i,e[a+5],12,1200080426),i=Bn(i,o,n,r,e[a+6],17,-1473231341),r=Bn(r,i,o,n,e[a+7],22,-45705983),n=Bn(n,r,i,o,e[a+8],7,1770035416),o=Bn(o,n,r,i,e[a+9],12,-1958414417),i=Bn(i,o,n,r,e[a+10],17,-42063),r=Bn(r,i,o,n,e[a+11],22,-1990404162),n=Bn(n,r,i,o,e[a+12],7,1804603682),o=Bn(o,n,r,i,e[a+13],12,-40341101),i=Bn(i,o,n,r,e[a+14],17,-1502002290),r=Bn(r,i,o,n,e[a+15],22,1236535329),n=jn(n,r,i,o,e[a+1],5,-165796510),o=jn(o,n,r,i,e[a+6],9,-1069501632),i=jn(i,o,n,r,e[a+11],14,643717713),r=jn(r,i,o,n,e[a],20,-373897302),n=jn(n,r,i,o,e[a+5],5,-701558691),o=jn(o,n,r,i,e[a+10],9,38016083),i=jn(i,o,n,r,e[a+15],14,-660478335),r=jn(r,i,o,n,e[a+4],20,-405537848),n=jn(n,r,i,o,e[a+9],5,568446438),o=jn(o,n,r,i,e[a+14],9,-1019803690),i=jn(i,o,n,r,e[a+3],14,-187363961),r=jn(r,i,o,n,e[a+8],20,1163531501),n=jn(n,r,i,o,e[a+13],5,-1444681467),o=jn(o,n,r,i,e[a+2],9,-51403784),i=jn(i,o,n,r,e[a+7],14,1735328473),r=jn(r,i,o,n,e[a+12],20,-1926607734),n=$n(n,r,i,o,e[a+5],4,-378558),o=$n(o,n,r,i,e[a+8],11,-2022574463),i=$n(i,o,n,r,e[a+11],16,1839030562),r=$n(r,i,o,n,e[a+14],23,-35309556),n=$n(n,r,i,o,e[a+1],4,-1530992060),o=$n(o,n,r,i,e[a+4],11,1272893353),i=$n(i,o,n,r,e[a+7],16,-155497632),r=$n(r,i,o,n,e[a+10],23,-1094730640),n=$n(n,r,i,o,e[a+13],4,681279174),o=$n(o,n,r,i,e[a],11,-358537222),i=$n(i,o,n,r,e[a+3],16,-722521979),r=$n(r,i,o,n,e[a+6],23,76029189),n=$n(n,r,i,o,e[a+9],4,-640364487),o=$n(o,n,r,i,e[a+12],11,-421815835),i=$n(i,o,n,r,e[a+15],16,530742520),r=$n(r,i,o,n,e[a+2],23,-995338651),n=Vn(n,r,i,o,e[a],6,-198630844),o=Vn(o,n,r,i,e[a+7],10,1126891415),i=Vn(i,o,n,r,e[a+14],15,-1416354905),r=Vn(r,i,o,n,e[a+5],21,-57434055),n=Vn(n,r,i,o,e[a+12],6,1700485571),o=Vn(o,n,r,i,e[a+3],10,-1894986606),i=Vn(i,o,n,r,e[a+10],15,-1051523),r=Vn(r,i,o,n,e[a+1],21,-2054922799),n=Vn(n,r,i,o,e[a+8],6,1873313359),o=Vn(o,n,r,i,e[a+15],10,-30611744),i=Vn(i,o,n,r,e[a+6],15,-1560198380),r=Vn(r,i,o,n,e[a+13],21,1309151649),n=Vn(n,r,i,o,e[a+4],6,-145523070),o=Vn(o,n,r,i,e[a+11],10,-1120210379),i=Vn(i,o,n,r,e[a+2],15,718787259),r=Vn(r,i,o,n,e[a+9],21,-343485551),n=ca(n,s),r=ca(r,u),i=ca(i,c),o=ca(o,l)}return[n,r,i,o]}function NG(e){if(e.length===0)return[];const t=e.length*8,n=new Uint32Array(ZP(t));for(let r=0;r<t;r+=8)n[r>>5]|=(e[r/8]&255)<<r%32;return n}function ca(e,t){const n=(e&65535)+(t&65535);return(e>>16)+(t>>16)+(n>>16)<<16|n&65535}function DG(e,t){return e<<t|e>>>32-t}function Em(e,t,n,r,i,o){return ca(DG(ca(ca(t,e),ca(r,o)),i),n)}function Bn(e,t,n,r,i,o,a){return Em(t&n|~t&r,e,t,i,o,a)}function jn(e,t,n,r,i,o,a){return Em(t&r|n&~r,e,t,i,o,a)}function $n(e,t,n,r,i,o,a){return Em(t^n^r,e,t,i,o,a)}function Vn(e,t,n,r,i,o,a){return Em(n^(t|~r),e,t,i,o,a)}var AG=TG;xm.default=AG;Object.defineProperty(wm,"__esModule",{value:!0});wm.default=void 0;var MG=eN(Oa),LG=eN(xm);function eN(e){return e&&e.__esModule?e:{default:e}}const FG=(0,MG.default)("v3",48,LG.default);var BG=FG;wm.default=BG;var Sm={},Cm={};Object.defineProperty(Cm,"__esModule",{value:!0});Cm.default=void 0;const jG=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var $G={randomUUID:jG};Cm.default=$G;Object.defineProperty(Sm,"__esModule",{value:!0});Sm.default=void 0;var z2=tN(Cm),VG=tN(ym),WG=ja;function tN(e){return e&&e.__esModule?e:{default:e}}function UG(e,t,n){if(z2.default.randomUUID&&!t&&!e)return z2.default.randomUUID();e=e||{};const r=e.random||(e.rng||VG.default)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n=n||0;for(let i=0;i<16;++i)t[n+i]=r[i];return t}return(0,WG.unsafeStringify)(r)}var zG=UG;Sm.default=zG;var _m={},km={};Object.defineProperty(km,"__esModule",{value:!0});km.default=void 0;function HG(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:return t^n^r;case 2:return t&n^t&r^n&r;case 3:return t^n^r}}function x0(e,t){return e<<t|e>>>32-t}function GG(e){const t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){const a=unescape(encodeURIComponent(e));e=[];for(let s=0;s<a.length;++s)e.push(a.charCodeAt(s))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const r=e.length/4+2,i=Math.ceil(r/16),o=new Array(i);for(let a=0;a<i;++a){const s=new Uint32Array(16);for(let u=0;u<16;++u)s[u]=e[a*64+u*4]<<24|e[a*64+u*4+1]<<16|e[a*64+u*4+2]<<8|e[a*64+u*4+3];o[a]=s}o[i-1][14]=(e.length-1)*8/Math.pow(2,32),o[i-1][14]=Math.floor(o[i-1][14]),o[i-1][15]=(e.length-1)*8&4294967295;for(let a=0;a<i;++a){const s=new Uint32Array(80);for(let h=0;h<16;++h)s[h]=o[a][h];for(let h=16;h<80;++h)s[h]=x0(s[h-3]^s[h-8]^s[h-14]^s[h-16],1);let u=n[0],c=n[1],l=n[2],d=n[3],f=n[4];for(let h=0;h<80;++h){const p=Math.floor(h/20),m=x0(u,5)+HG(p,c,l,d)+f+t[p]+s[h]>>>0;f=d,d=l,l=x0(c,30)>>>0,c=u,u=m}n[0]=n[0]+u>>>0,n[1]=n[1]+c>>>0,n[2]=n[2]+l>>>0,n[3]=n[3]+d>>>0,n[4]=n[4]+f>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,n[0]&255,n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,n[1]&255,n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,n[2]&255,n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,n[3]&255,n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,n[4]&255]}var qG=GG;km.default=qG;Object.defineProperty(_m,"__esModule",{value:!0});_m.default=void 0;var XG=nN(Oa),KG=nN(km);function nN(e){return e&&e.__esModule?e:{default:e}}const YG=(0,XG.default)("v5",80,KG.default);var QG=YG;_m.default=QG;var Rm={};Object.defineProperty(Rm,"__esModule",{value:!0});Rm.default=void 0;var JG="00000000-0000-0000-0000-000000000000";Rm.default=JG;var Im={};Object.defineProperty(Im,"__esModule",{value:!0});Im.default=void 0;var ZG=eq(Vs);function eq(e){return e&&e.__esModule?e:{default:e}}function tq(e){if(!(0,ZG.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}var nq=tq;Im.default=nq;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return a.default}});var t=l(gm),n=l(wm),r=l(Sm),i=l(_m),o=l(Rm),a=l(Im),s=l(Vs),u=l(ja),c=l(qd);function l(d){return d&&d.__esModule?d:{default:d}}})(Kw);var Yw=me&&me.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gp=me&&me.__assign||function(){return Gp=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Gp.apply(this,arguments)},E0=me&&me.__awaiter||function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function s(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?o(l.value):i(l.value).then(s,u)}c((r=r.apply(e,t||[])).next())})},S0=me&&me.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(l){return u([c,l])}}function u(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(n=0)),n;)try{if(r=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=t.call(e,n)}catch(l){c=[6,l],i=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(Yi,"__esModule",{value:!0});Yi.WebRtcPeerSendrecv=Yi.WebRtcPeerSendonly=Yi.WebRtcPeerRecvonly=Yi.WebRtcPeer=void 0;var rq=rG,iq=Kw,H2=$s,oq=ln,aq=Pi,Wt=oq.OpenViduLogger.getInstance(),Tm=function(){function e(t){var n=this;this.remoteCandidatesQueue=[],this.localCandidatesQueue=[],this.iceCandidateList=[],aq.PlatformUtils.getInstance(),this.configuration=Gp(Gp({},t),{iceServers:t.iceServers&&t.iceServers.length>0?t.iceServers:rq(),rtcConfiguration:t.rtcConfiguration!==void 0?t.rtcConfiguration:{},mediaStream:t.mediaStream!==void 0?t.mediaStream:null,mode:t.mode?t.mode:"sendrecv",id:t.id?t.id:this.generateUniqueId()}),Wt.debug(`[WebRtcPeer] configuration:
`.concat(JSON.stringify(this.configuration,null,2)));var r=this.configuration.rtcConfiguration?this.configuration.rtcConfiguration:{iceServers:this.configuration.iceServers};!r.iceServers&&this.configuration.iceServers&&(r.iceServers=this.configuration.iceServers),this.pc=new RTCPeerConnection(r),this.pc.addEventListener("icecandidate",function(i){if(i.candidate!==null){var o=i.candidate,a=new RTCIceCandidate(o);n.configuration.onIceCandidate(a),a.candidate!==""&&n.localCandidatesQueue.push(a)}}),this.pc.addEventListener("signalingstatechange",function(){return E0(n,void 0,void 0,function(){var i,o;return S0(this,function(a){switch(a.label){case 0:if(this.pc.signalingState!=="stable")return[3,6];a.label=1;case 1:if(!(this.iceCandidateList.length>0))return[3,6];i=this.iceCandidateList.shift(),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.pc.addIceCandidate(i)];case 3:return a.sent(),[3,5];case 4:return o=a.sent(),Wt.error("Error when calling RTCPeerConnection#addIceCandidate for RTCPeerConnection "+this.getId(),o),[3,5];case 5:return[3,1];case 6:return[2]}})})})}return e.prototype.getId=function(){return this.configuration.id},e.prototype.dispose=function(){if(Wt.debug("Disposing WebRtcPeer"),this.pc){if(this.pc.signalingState==="closed")return;this.pc.close(),this.remoteCandidatesQueue=[],this.localCandidatesQueue=[]}},e.prototype.createOfferLegacy=function(){this.configuration.mediaStream&&this.deprecatedPeerConnectionTrackApi();var t=this.configuration.mediaConstraints.audio,n=this.configuration.mediaConstraints.video,r={offerToReceiveAudio:this.configuration.mode!=="sendonly"&&t,offerToReceiveVideo:this.configuration.mode!=="sendonly"&&n};return Wt.debug("[createOfferLegacy] RTCPeerConnection.createOffer() options:",JSON.stringify(r)),this.pc.createOffer(r)},e.prototype.createOffer=function(){var t,n,r,i,o,a,s,u;return E0(this,void 0,void 0,function(){var c,l,d,f,h,p,m,g,v,y,b,w,E,x,R,S,_,F,T,B,L,k,D,F;return S0(this,function(M){switch(M.label){case 0:if("addTransceiver"in this.pc)Wt.debug("[createOffer] Method RTCPeerConnection.addTransceiver() is available; using it");else return Wt.warn("[createOffer] Method RTCPeerConnection.addTransceiver() is NOT available; using LEGACY offerToReceive{Audio,Video}"),[2,this.createOfferLegacy()];if(this.configuration.mode==="recvonly")return[3,7];if(!this.configuration.mediaStream)throw new Error("[WebRtcPeer.createOffer] Direction is '".concat(this.configuration.mode,"', but no stream was configured to be sent"));c=0,l=this.configuration.mediaStream.getTracks(),M.label=1;case 1:if(!(c<l.length))return[3,6];if(d=l[c],f={direction:this.configuration.mode,streams:[this.configuration.mediaStream]},d.kind==="video"&&this.configuration.simulcast)for(h=d.getSettings(),p=d.getConstraints(),m=(r=(n=(t=h.width)!==null&&t!==void 0?t:p.width.ideal)!==null&&n!==void 0?n:p.width)!==null&&r!==void 0?r:0,g=(a=(o=(i=h.height)!==null&&i!==void 0?i:p.height.ideal)!==null&&o!==void 0?o:p.height)!==null&&a!==void 0?a:0,Wt.info("[createOffer] Video track dimensions: ".concat(m,"x").concat(g)),v=m*g,y=0,v>=960*540?y=3:v>=480*270?y=2:y=1,f.sendEncodings=[],b=0;b<y;b++)w=Math.pow(2,y-b-1),E={rid:"rdiv"+w.toString(),scalabilityMode:"L1T1"},["detail","text"].includes(d.contentHint)?(E.scaleResolutionDownBy=1,E.maxFramerate=Math.floor(30/w)):E.scaleResolutionDownBy=w,f.sendEncodings.push(E);if(x=this.pc.addTransceiver(d,f),d.kind!=="video")return[3,5];if(R=x.sender.getParameters(),S=!1,!((s=R.degradationPreference)===null||s===void 0)&&s.length||(["detail","text"].includes(d.contentHint)?R.degradationPreference="maintain-resolution":R.degradationPreference="balanced",Wt.info("[createOffer] Video sender Degradation Preference set: ".concat(R.degradationPreference)),S=!0),this.configuration.simulcast&&((u=R.encodings)===null||u===void 0?void 0:u.length)!==f.sendEncodings.length&&(R.encodings=f.sendEncodings,S=!0),!S)return[3,5];Wt.debug("[createOffer] Setting new RTCRtpSendParameters to video sender"),M.label=2;case 2:return M.trys.push([2,4,,5]),[4,x.sender.setParameters(R)];case 3:return M.sent(),[3,5];case 4:throw _=M.sent(),F="[WebRtcPeer.createOffer] Cannot set RTCRtpSendParameters to video sender",_ instanceof Error&&(F+=": ".concat(_.message)),new Error(F);case 5:return c++,[3,1];case 6:return[3,8];case 7:for(T=0,B=["audio","video"];T<B.length;T++)L=B[T],this.configuration.mediaConstraints[L]&&(this.configuration.mediaStream=new MediaStream,this.pc.addTransceiver(L,{direction:this.configuration.mode,streams:[this.configuration.mediaStream]}));M.label=8;case 8:return M.trys.push([8,10,,11]),[4,this.pc.createOffer()];case 9:return k=M.sent(),[3,11];case 10:throw D=M.sent(),F="[WebRtcPeer.createOffer] Browser failed creating an SDP Offer",D instanceof Error&&(F+=": ".concat(D.message)),new Error(F);case 11:return[2,k]}})})},e.prototype.deprecatedPeerConnectionTrackApi=function(){for(var t=0,n=this.configuration.mediaStream.getTracks();t<n.length;t++){var r=n[t];this.pc.addTrack(r,this.configuration.mediaStream)}},e.prototype.createAnswer=function(){var t=this;return new Promise(function(n,r){if("getTransceivers"in t.pc){Wt.debug("[createAnswer] Method RTCPeerConnection.getTransceivers() is available; using it");for(var i=function(f){if(!t.configuration.mediaConstraints[f])return"continue";var h=t.pc.getTransceivers().find(function(p){return p.receiver.track.kind===f});if(h)h.direction=t.configuration.mode;else return{value:r(new Error("".concat(f," requested, but no transceiver was created from remote description")))}},o=0,a=["audio","video"];o<a.length;o++){var s=a[o],u=i(s);if(typeof u=="object")return u.value}t.pc.createAnswer().then(function(f){return n(f)}).catch(function(f){return r(f)})}else{var c=void 0,l=!0;if(t.configuration.mediaConstraints){c=typeof t.configuration.mediaConstraints.audio=="boolean"?t.configuration.mediaConstraints.audio:!0,l=typeof t.configuration.mediaConstraints.video=="boolean"?t.configuration.mediaConstraints.video:!0;var d={offerToReceiveAudio:c,offerToReceiveVideo:l};t.pc.createAnswer(d).then(function(f){return n(f)}).catch(function(f){return r(f)})}}})},e.prototype.processLocalOffer=function(t){var n=this;return new Promise(function(r,i){n.pc.setLocalDescription(t).then(function(){var o=n.pc.localDescription;return o?(Wt.debug("Local description set",o.sdp),r()):i("Local description is not defined")}).catch(function(o){return i(o)})})},e.prototype.processRemoteOffer=function(t){var n=this;return new Promise(function(r,i){var o={type:"offer",sdp:t};if(Wt.debug("SDP offer received, setting remote description",o),n.pc.signalingState==="closed")return i("RTCPeerConnection is closed when trying to set remote description");n.setRemoteDescription(o).then(function(){return r()}).catch(function(a){return i(a)})})},e.prototype.processLocalAnswer=function(t){var n=this;return new Promise(function(r,i){if(Wt.debug("SDP answer created, setting local description"),n.pc.signalingState==="closed")return i("RTCPeerConnection is closed when trying to set local description");n.pc.setLocalDescription(t).then(function(){return r()}).catch(function(o){return i(o)})})},e.prototype.processRemoteAnswer=function(t){var n=this;return new Promise(function(r,i){var o={type:"answer",sdp:t};if(Wt.debug("SDP answer received, setting remote description"),n.pc.signalingState==="closed")return i("RTCPeerConnection is closed when trying to set remote description");n.setRemoteDescription(o).then(function(){r()}).catch(function(a){return i(a)})})},e.prototype.setRemoteDescription=function(t){return E0(this,void 0,void 0,function(){return S0(this,function(n){return[2,this.pc.setRemoteDescription(t)]})})},e.prototype.addIceCandidate=function(t){var n=this;return new Promise(function(r,i){switch(Wt.debug("Remote ICE candidate received",t),n.remoteCandidatesQueue.push(t),n.pc.signalingState){case"closed":i(new Error("PeerConnection object is closed"));break;case"stable":n.pc.remoteDescription?n.pc.addIceCandidate(t).then(function(){return r()}).catch(function(o){return i(o)}):(n.iceCandidateList.push(t),r());break;default:n.iceCandidateList.push(t),r()}})},e.prototype.addIceConnectionStateChangeListener=function(t){var n=this;this.pc.addEventListener("iceconnectionstatechange",function(){var r=n.pc.iceConnectionState;switch(r){case"disconnected":var i="IceConnectionState of RTCPeerConnection "+n.configuration.id+" ("+t+') change to "disconnected". Possible network disconnection';Wt.warn(i),n.configuration.onIceConnectionStateException(H2.ExceptionEventName.ICE_CONNECTION_DISCONNECTED,i);break;case"failed":var o="IceConnectionState of RTCPeerConnection "+n.configuration.id+" ("+t+') to "failed"';Wt.error(o),n.configuration.onIceConnectionStateException(H2.ExceptionEventName.ICE_CONNECTION_FAILED,o);break;case"closed":Wt.log("IceConnectionState of RTCPeerConnection "+n.configuration.id+" ("+t+') change to "closed"');break;case"new":Wt.log("IceConnectionState of RTCPeerConnection "+n.configuration.id+" ("+t+') change to "new"');break;case"checking":Wt.log("IceConnectionState of RTCPeerConnection "+n.configuration.id+" ("+t+') change to "checking"');break;case"connected":Wt.log("IceConnectionState of RTCPeerConnection "+n.configuration.id+" ("+t+') change to "connected"');break;case"completed":Wt.log("IceConnectionState of RTCPeerConnection "+n.configuration.id+" ("+t+') change to "completed"');break}})},e.prototype.generateUniqueId=function(){return(0,iq.v4)()},e}();Yi.WebRtcPeer=Tm;var sq=function(e){Yw(t,e);function t(n){return n.mode="recvonly",e.call(this,n)||this}return t}(Tm);Yi.WebRtcPeerRecvonly=sq;var uq=function(e){Yw(t,e);function t(n){return n.mode="sendonly",e.call(this,n)||this}return t}(Tm);Yi.WebRtcPeerSendonly=uq;var cq=function(e){Yw(t,e);function t(n){return n.mode="sendrecv",e.call(this,n)||this}return t}(Tm);Yi.WebRtcPeerSendrecv=cq;var Om={},ru=me&&me.__awaiter||function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function s(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?o(l.value):i(l.value).then(s,u)}c((r=r.apply(e,t||[])).next())})},iu=me&&me.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(l){return u([c,l])}}function u(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(n=0)),n;)try{if(r=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=t.call(e,n)}catch(l){c=[6,l],i=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(Om,"__esModule",{value:!0});Om.WebRtcStats=void 0;var lq=ln,dq=Pi,Ga=lq.OpenViduLogger.getInstance(),ou,fq=function(){function e(t){this.stream=t,this.STATS_ITEM_NAME="webrtc-stats-config",this.webRtcStatsEnabled=!1,this.statsInterval=1,ou=dq.PlatformUtils.getInstance()}return e.prototype.isEnabled=function(){return this.webRtcStatsEnabled},e.prototype.initWebRtcStats=function(){var t=this,n;try{n=localStorage.getItem(this.STATS_ITEM_NAME)}catch{}if(n){this.webRtcStatsEnabled=!0;var r=JSON.parse(n);Ga.warn("WebRtc stats enabled for stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId),Ga.warn("localStorage item: "+JSON.stringify(r)),this.POST_URL=r.httpEndpoint,this.statsInterval=r.interval,this.webRtcStatsIntervalId=setInterval(function(){return ru(t,void 0,void 0,function(){return iu(this,function(i){switch(i.label){case 0:return[4,this.sendStatsToHttpEndpoint()];case 1:return i.sent(),[2]}})})},this.statsInterval*1e3)}else Ga.debug("WebRtc stats not enabled")},e.prototype.getSelectedIceCandidateInfo=function(){var t=this;return new Promise(function(n,r){return ru(t,void 0,void 0,function(){var i,o,a,s,u,c,l,d,f,h,p,m,g,v,E,x,y,b,_,w,E,x,R,S,_;return iu(this,function(T){switch(T.label){case 0:return[4,this.stream.getRTCPeerConnection().getStats()];case 1:if(i=T.sent(),a=new Map,s=new Map,u=new Map,i.forEach(function(B){switch(B.type==="transport"&&(ou.isChromium()||ou.isSafariBrowser()||ou.isReactNative())&&(o=B),B.type){case"candidate-pair":a.set(B.id,B);break;case"local-candidate":s.set(B.id,B);break;case"remote-candidate":u.set(B.id,B);break}}),o!=null)l=o.selectedCandidatePairId,c=a.get(l);else for(d=a.size,f=a.values(),h=0;h<d;h++)if(p=f.next().value,p.selected){c=p;break}if(m=c.localCandidateId,g=c.remoteCandidateId,v=s.get(m),v)for(E=this.stream.getLocalIceCandidateList(),x=E.filter(function(B){return!!B.candidate&&(B.candidate.indexOf(v.ip)>=0||B.candidate.indexOf(v.address)>=0)&&B.candidate.indexOf(v.port)>=0}),v.raw=[],y=0,b=x;y<b.length;y++)_=b[y],v.raw.push(_.candidate);else v="ERROR: No active local ICE candidate. Probably ICE-TCP is being used";if(w=u.get(g),w)for(E=this.stream.getRemoteIceCandidateList(),x=E.filter(function(B){return!!B.candidate&&(B.candidate.indexOf(w.ip)>=0||B.candidate.indexOf(w.address)>=0)&&B.candidate.indexOf(w.port)>=0}),w.raw=[],R=0,S=x;R<S.length;R++)_=S[R],w.raw.push(_.candidate);else w="ERROR: No active remote ICE candidate. Probably ICE-TCP is being used";return[2,n({localCandidate:v,remoteCandidate:w})]}})})})},e.prototype.stopWebRtcStats=function(){this.webRtcStatsEnabled&&(clearInterval(this.webRtcStatsIntervalId),Ga.warn("WebRtc stats stopped for disposed stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId))},e.prototype.sendStats=function(t,n){return ru(this,void 0,void 0,function(){var r,i;return iu(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r={headers:{"Content-type":"application/json"},body:JSON.stringify(n),method:"POST"},[4,fetch(t,r)];case 1:return o.sent(),[3,3];case 2:return i=o.sent(),Ga.error("sendStats error: ".concat(JSON.stringify(i))),[3,3];case 3:return[2]}})})},e.prototype.sendStatsToHttpEndpoint=function(){return ru(this,void 0,void 0,function(){var t,n,r;return iu(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,this.getCommonStats()];case 1:return t=i.sent(),n=this.generateJSONStatsResponse(t),[4,this.sendStats(this.POST_URL,n)];case 2:return i.sent(),[3,4];case 3:return r=i.sent(),Ga.log(r),[3,4];case 4:return[2]}})})},e.prototype.getCommonStats=function(){return ru(this,void 0,void 0,function(){var t=this;return iu(this,function(n){return[2,new Promise(function(r,i){return ru(t,void 0,void 0,function(){var o,a,s,u,c,l=this;return iu(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),[4,this.stream.getRTCPeerConnection().getStats()];case 1:return o=d.sent(),a=this.getWebRtcStatsResponseOutline(),s=["framesReceived","framesDropped","framesSent","frameHeight","frameWidth"],u=["availableOutgoingBitrate","currentRoundTripTime"],o.forEach(function(f){var h=f.mediaType!=null?f.mediaType:f.kind,p=function(m,g){f[g]!=null&&a[m]!=null&&(!h&&s.indexOf(g)>-1&&(h="video"),m!=null&&h!=null&&g!=null&&a[m][h]!=null?a[m][h][g]=Number(f[g]):m!=null&&g!=null&&u.includes(g)&&(a[m][g]=Number(f[g])))};switch(f.type){case"outbound-rtp":p("outbound","bytesSent"),p("outbound","packetsSent"),p("outbound","framesEncoded"),p("outbound","nackCount"),p("outbound","firCount"),p("outbound","pliCount"),p("outbound","qpSum");break;case"inbound-rtp":p("inbound","bytesReceived"),p("inbound","packetsReceived"),p("inbound","packetsLost"),p("inbound","jitter"),p("inbound","framesDecoded"),p("inbound","nackCount"),p("inbound","firCount"),p("inbound","pliCount");break;case"track":p("inbound","jitterBufferDelay"),p("inbound","framesReceived"),p("outbound","framesDropped"),p("outbound","framesSent"),p(l.stream.isLocal()?"outbound":"inbound","frameHeight"),p(l.stream.isLocal()?"outbound":"inbound","frameWidth");break;case"candidate-pair":p("candidatepair","currentRoundTripTime"),p("candidatepair","availableOutgoingBitrate");break}}),(!(a!=null&&a.candidatepair)||Object.keys(a.candidatepair).length===0)&&delete a.candidatepair,[2,r(a)];case 2:return c=d.sent(),Ga.error("Error getting common stats: ",c),[2,i(c)];case 3:return[2]}})})})]})})},e.prototype.generateJSONStatsResponse=function(t){return{"@timestamp":new Date().toISOString(),participant_id:this.stream.connection.data,session_id:this.stream.session.sessionId,platform:ou.getName(),platform_description:ou.getDescription(),stream:"webRTC",webrtc_stats:t}},e.prototype.getWebRtcStatsResponseOutline=function(){return this.stream.isLocal()?{outbound:{audio:{},video:{}},candidatepair:{}}:{inbound:{audio:{},video:{}}}},e}();Om.WebRtcStats=fq;var Xd={},hq=me&&me.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Xd,"__esModule",{value:!0});Xd.PublisherSpeakingEvent=void 0;var pq=En,vq=function(e){hq(t,e);function t(n,r,i,o){var a=e.call(this,!1,n,r)||this;return a.type=r,a.connection=i,a.streamId=o,a}return t.prototype.callDefaultBehavior=function(){},t}(pq.Event);Xd.PublisherSpeakingEvent=vq;var Pm={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TypeOfVideo=void 0,function(t){t.CAMERA="CAMERA",t.SCREEN="SCREEN",t.CUSTOM="CUSTOM",t.IPCAM="IPCAM"}(e.TypeOfVideo||(e.TypeOfVideo={}))})(Pm);var mq=qp;function qp(){}qp.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(n,r,i){this.callbacks=this.callbacks||{};var o=arguments.length===3,a=o?arguments[1]:void 0,s=o?arguments[2]:arguments[1];return s._groupName=a,(this.callbacks[n]=this.callbacks[n]||[]).push(s),this},t.once=function(n,r,i){var o=this,a=arguments.length===3,s=a?arguments[1]:void 0,u=a?arguments[2]:arguments[1];function c(){o.off(n,c),u.apply(this,arguments)}return this.on(n,s,c),this},t.releaseGroup=function(n){this.callbacks=this.callbacks||{};var r,i,o,a;for(r in this.callbacks)for(a=this.callbacks[r],i=0,o=a.length;i<o;i++)a[i]._groupName===n&&(a.splice(i,1),i--,o--);return this},t.off=function(n,r){this.callbacks=this.callbacks||{};var i=this.callbacks[n],o;return i?arguments.length===1?(delete this.callbacks[n],this):(o=i.indexOf(r),o!==-1&&(i.splice(o,1),i.length===0&&delete this.callbacks[n]),this):this},t.emit=function(n){this.callbacks=this.callbacks||{};var r=[].slice.call(arguments,1),i=this.callbacks[n],o=this.getWildcardCallbacks(n),a,s,u;if(i)for(u=i.slice(),a=0,s=u.length;a<s&&u[a];++a)u[a].apply(this,r);if(o)for(s=o.length,u=o.slice(),a=0,s=u.length;a<s&&u[a];++a)u[a].apply(this,[n].concat(r));return this},t.getWildcardCallbacks=function(n){this.callbacks=this.callbacks||{};var r,i,o=[];for(r in this.callbacks)i=r.split("*"),(r==="*"||i.length===2&&n.slice(0,i[0].length)===i[0])&&(o=o.concat(this.callbacks[r]));return o}};qp.mixin(qp);var gq=mq;function yq(e,t){var n=-1/0;e.getFloatFrequencyData(t);for(var r=4,i=t.length;r<i;r++)t[r]>n&&t[r]<0&&(n=t[r]);return n}var W1;typeof window<"u"&&(W1=window.AudioContext||window.webkitAudioContext);var pi=null,bq=function(e,r){var n=new gq;if(!W1)return n;var r=r||{},i=r.smoothing||.1,o=r.interval||50,a=r.threshold,s=r.play,u=r.history||10,c=!0;pi=r.audioContext||pi||new W1;var l,d,f;f=pi.createAnalyser(),f.fftSize=512,f.smoothingTimeConstant=i,d=new Float32Array(f.frequencyBinCount),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(l=pi.createMediaElementSource(e),typeof s>"u"&&(s=!0),a=a||-50):(l=pi.createMediaStreamSource(e),a=a||-50),l.connect(f),s&&f.connect(pi.destination),n.speaking=!1,n.suspend=function(){return pi.suspend()},n.resume=function(){return pi.resume()},Object.defineProperty(n,"state",{get:function(){return pi.state}}),pi.onstatechange=function(){n.emit("state_change",pi.state)},n.setThreshold=function(m){a=m},n.setInterval=function(m){o=m},n.stop=function(){c=!1,n.emit("volume_change",-100,a),n.speaking&&(n.speaking=!1,n.emit("stopped_speaking")),f.disconnect(),l.disconnect()},n.speakingHistory=[];for(var h=0;h<u;h++)n.speakingHistory.push(0);var p=function(){setTimeout(function(){if(c){var m=yq(f,d);n.emit("volume_change",m,a);var g=0;if(m>a&&!n.speaking){for(var v=n.speakingHistory.length-3;v<n.speakingHistory.length;v++)g+=n.speakingHistory[v];g>=2&&(n.speaking=!0,n.emit("speaking"))}else if(m<a&&n.speaking){for(var v=0;v<n.speakingHistory.length;v++)g+=n.speakingHistory[v];g==0&&(n.speaking=!1,n.emit("stopped_speaking"))}n.speakingHistory.shift(),n.speakingHistory.push(0+(m>a)),p()}},o)};return p(),n},ji=me&&me.__awaiter||function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function s(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?o(l.value):i(l.value).then(s,u)}c((r=r.apply(e,t||[])).next())})},$i=me&&me.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(l){return u([c,l])}}function u(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(n=0)),n;)try{if(r=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=t.call(e,n)}catch(l){c=[6,l],i=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(Nc,"__esModule",{value:!0});Nc.Stream=void 0;var C0=Dc,wq=Ac,_0=Yi,xq=Om,ul=$s,Go=Xd,G2=Fc,nh=Ao,qt=js,qo=Pm,Eq=ln,Sq=Pi,Cq=Kw,_q=bq,q2=Xw,at=Eq.OpenViduLogger.getInstance(),X2,kq=function(){function e(t,n){var r=this;this.isSubscribeToRemote=!1,this.isLocalStreamReadyToPublish=!1,this.isLocalStreamPublished=!1,this.publishedOnce=!1,this.harkSpeakingEnabled=!1,this.harkSpeakingEnabledOnce=!1,this.harkStoppedSpeakingEnabled=!1,this.harkStoppedSpeakingEnabledOnce=!1,this.harkVolumeChangeEnabled=!1,this.harkVolumeChangeEnabledOnce=!1,this.ee=new q2,X2=Sq.PlatformUtils.getInstance(),this.session=t,n.hasOwnProperty("id")?(this.inboundStreamOpts=n,this.streamId=this.inboundStreamOpts.id,this.creationTime=this.inboundStreamOpts.createdAt,this.hasAudio=this.inboundStreamOpts.hasAudio,this.hasVideo=this.inboundStreamOpts.hasVideo,this.hasAudio&&(this.audioActive=this.inboundStreamOpts.audioActive),this.hasVideo&&(this.videoActive=this.inboundStreamOpts.videoActive,this.typeOfVideo=this.inboundStreamOpts.typeOfVideo?this.inboundStreamOpts.typeOfVideo:void 0,this.frameRate=this.inboundStreamOpts.frameRate===-1?void 0:this.inboundStreamOpts.frameRate,this.videoDimensions=this.inboundStreamOpts.videoDimensions),this.inboundStreamOpts.filter&&Object.keys(this.inboundStreamOpts.filter).length>0&&(this.inboundStreamOpts.filter.lastExecMethod&&Object.keys(this.inboundStreamOpts.filter.lastExecMethod).length===0&&delete this.inboundStreamOpts.filter.lastExecMethod,this.filter=this.inboundStreamOpts.filter)):(this.outboundStreamOpts=n,this.hasAudio=this.isSendAudio(),this.hasVideo=this.isSendVideo(),this.hasAudio&&(this.audioActive=!!this.outboundStreamOpts.publisherProperties.publishAudio),this.hasVideo&&(this.videoActive=!!this.outboundStreamOpts.publisherProperties.publishVideo,this.frameRate=this.outboundStreamOpts.publisherProperties.frameRate,typeof MediaStreamTrack<"u"&&this.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?this.typeOfVideo=qo.TypeOfVideo.CUSTOM:this.typeOfVideo=this.isSendScreen()?qo.TypeOfVideo.SCREEN:qo.TypeOfVideo.CAMERA),this.outboundStreamOpts.publisherProperties.filter&&(this.filter=this.outboundStreamOpts.publisherProperties.filter)),this.ee.on("mediastream-updated",function(){var i;r.streamManager.updateMediaStream(r.mediaStream),at.debug("Video srcObject ["+((i=r.mediaStream)===null||i===void 0?void 0:i.id)+"] updated in stream ["+r.streamId+"]")})}return e.prototype.reconnect=function(){return this.reconnectStream("API")},e.prototype.applyFilter=function(t,n){var r=this;return new Promise(function(i,o){return ji(r,void 0,void 0,function(){var a,s,u,c,l,d,f=this;return $i(this,function(h){if(this.filter)return[2,o(new qt.OpenViduError(qt.OpenViduErrorName.GENERIC_ERROR,"There is already a filter applied to Stream "+this.streamId))];if(a=function(p,m){if(p)return at.error("Error applying filter for Stream "+f.streamId,p),p.code===401?o(new qt.OpenViduError(qt.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to apply a filter")):o(p);at.info("Filter successfully applied on Stream "+f.streamId);var g=f.filter;return f.filter=new C0.Filter(t,n),f.filter.stream=f,m&&(f.session.emitEvent("streamPropertyChanged",[new nh.StreamPropertyChangedEvent(f.session,f,"filter",f.filter,g,"applyFilter")]),f.streamManager.emitEvent("streamPropertyChanged",[new nh.StreamPropertyChangedEvent(f.streamManager,f,"filter",f.filter,g,"applyFilter")])),i(f.filter)},t.startsWith("VB:")){if(!this.hasVideo)return[2,o(new qt.OpenViduError(qt.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"The Virtual Background filter requires a video track to be applied"))];if(!this.mediaStream||this.streamManager.videos.length===0)return[2,o(new qt.OpenViduError(qt.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"The StreamManager requires some video element to be attached to it in order to apply a Virtual Background filter"))];if(this.session.token?s=this.session.token:s=n.token,!s)return[2,o(new qt.OpenViduError(qt.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,'Virtual Background requires the client to be connected to a Session or to have a "token" property available in "options" parameter with a valid OpenVidu token'))];if(u=this.session.getTokenParams(s),u.edition!=="pro"&&u.edition!=="enterprise")return[2,o(new qt.OpenViduError(qt.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"OpenVidu Virtual Background API is available from OpenVidu Pro edition onwards"))];s=encodeURIComponent(btoa(s)),at.info("Applying Virtual Background to stream "+this.streamId),c=function(){return ji(f,void 0,void 0,function(){var p,m,g,v,y,b,w;return $i(this,function(E){switch(E.label){case 0:return E.trys.push([0,8,,9]),p=this.streamId+"_"+(0,Cq.v4)(),m=this.mediaStream.clone(),g=this.streamManager.videos[0].video.cloneNode(!1),g.id=VirtualBackground.VirtualBackground.SOURCE_VIDEO_PREFIX+p,g.srcObject=m,g.muted=!0,this.virtualBackgroundSourceElements={videoClone:g,mediaStreamClone:m},VirtualBackground.VirtualBackground.hideHtmlElement(g,!1),VirtualBackground.VirtualBackground.appendHtmlElementToHiddenContainer(g,p),[4,g.play()];case 1:switch(E.sent(),v=new VirtualBackground.VirtualBackground({id:p,openviduServerUrl:new URL(u.httpUri),openviduToken:s,inputVideo:g,inputResolution:"160x96",outputFramerate:24}),y=void 0,b=t,b){case"VB:blur":return[3,2];case"VB:image":return[3,4]}return[3,6];case 2:return[4,v.backgroundBlur(n)];case 3:return y=E.sent(),[3,7];case 4:return[4,v.backgroundImage(n)];case 5:return y=E.sent(),[3,7];case 6:throw new Error("Unknown Virtual Background filter: "+t);case 7:return this.virtualBackgroundSinkElements={VB:v,video:y},g.style.display="none",this.streamManager.remote?this.streamManager.replaceTrackInMediaStream(this.virtualBackgroundSinkElements.video.srcObject.getVideoTracks()[0],!1):this.streamManager.replaceTrackAux(this.virtualBackgroundSinkElements.video.srcObject.getVideoTracks()[0],!1),a(void 0,!1),[3,9];case 8:return w=E.sent(),w.name===qt.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR?a(new qt.OpenViduError(qt.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,w.message),!1):a(w,!1),[3,9];case 9:return[2]}})})},typeof VirtualBackground>"u"?(l=document.createElement("script"),l.type="text/javascript",l.src=u.httpUri+"/openvidu/virtual-background/openvidu-virtual-background.js?token="+s,l.onload=function(){return ji(f,void 0,void 0,function(){var p;return $i(this,function(m){switch(m.label){case 0:return m.trys.push([0,2,,3]),[4,c()];case 1:return m.sent(),i(new C0.Filter(t,n)),[3,3];case 2:return p=m.sent(),o(p),[3,3];case 3:return[2]}})})},document.body.appendChild(l)):c().then(function(){return i(new C0.Filter(t,n))}).catch(function(p){return o(p)})}else{if(!this.session.sessionConnected())return[2,o(this.session.notConnectedError())];at.info("Applying server filter to stream "+this.streamId),n=n??{},d=n,typeof d!="string"&&(d=JSON.stringify(d)),this.session.openvidu.sendRequest("applyFilter",{streamId:this.streamId,type:t,options:d},function(p,m){a(p,!0)})}return[2]})})})},e.prototype.removeFilter=function(){return ji(this,void 0,void 0,function(){return $i(this,function(t){switch(t.label){case 0:return[4,this.removeFilterAux(!1)];case 1:return[2,t.sent()]}})})},e.prototype.getRTCPeerConnection=function(){return this.webRtcPeer.pc},e.prototype.getMediaStream=function(){return this.mediaStream},e.prototype.removeFilterAux=function(t){var n=this;return new Promise(function(r,i){return ji(n,void 0,void 0,function(){var o,a,s,u=this,c;return $i(this,function(l){switch(l.label){case 0:if(o=function(d,f){if(d)return delete u.filter,at.error("Error removing filter for Stream "+u.streamId,d),d.code===401?i(new qt.OpenViduError(qt.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to remove a filter")):i(d);at.info("Filter successfully removed from Stream "+u.streamId);var h=u.filter;return delete u.filter,f&&(u.session.emitEvent("streamPropertyChanged",[new nh.StreamPropertyChangedEvent(u.session,u,"filter",u.filter,h,"applyFilter")]),u.streamManager.emitEvent("streamPropertyChanged",[new nh.StreamPropertyChangedEvent(u.streamManager,u,"filter",u.filter,h,"applyFilter")])),r()},!this.filter)return[3,11];if(!(!((c=this.filter)===null||c===void 0)&&c.type.startsWith("VB:")))return[3,9];l.label=1;case 1:return l.trys.push([1,7,,8]),a=this.virtualBackgroundSourceElements.mediaStreamClone,t?[3,5]:this.streamManager.remote?(this.streamManager.replaceTrackInMediaStream(a.getVideoTracks()[0],!1),[3,4]):[3,2];case 2:return[4,this.streamManager.replaceTrackAux(a.getVideoTracks()[0],!1)];case 3:l.sent(),l.label=4;case 4:return[3,6];case 5:a.getTracks().forEach(function(d){return d.stop()}),l.label=6;case 6:return this.virtualBackgroundSinkElements.VB.cleanUp(),delete this.virtualBackgroundSinkElements,delete this.virtualBackgroundSourceElements,[2,o(void 0,!1)];case 7:return s=l.sent(),[2,o(s,!1)];case 8:return[3,10];case 9:if(!this.session.sessionConnected())return[2,i(this.session.notConnectedError())];at.info("Removing filter of stream "+this.streamId),this.session.openvidu.sendRequest("removeFilter",{streamId:this.streamId},function(d,f){return o(d,!0)}),l.label=10;case 10:return[3,12];case 11:return[2,i(new qt.OpenViduError(qt.OpenViduErrorName.GENERIC_ERROR,"Stream "+this.streamId+" has no filter applied"))];case 12:return[2]}})})})},e.prototype.setMediaStream=function(t){this.mediaStream=t},e.prototype.updateMediaStreamInVideos=function(){this.ee.emitEvent("mediastream-updated",[])},e.prototype.getWebRtcPeer=function(){return this.webRtcPeer},e.prototype.subscribeToMyRemote=function(t){this.isSubscribeToRemote=t},e.prototype.setOutboundStreamOptions=function(t){this.outboundStreamOpts=t},e.prototype.subscribe=function(){var t=this;return new Promise(function(n,r){t.initWebRtcPeerReceive(!1).then(function(){return n()}).catch(function(i){return r(i)})})},e.prototype.publish=function(){var t=this;return new Promise(function(n,r){t.isLocalStreamReadyToPublish?t.initWebRtcPeerSend(!1).then(function(){return n()}).catch(function(i){return r(i)}):t.ee.once("stream-ready-to-publish",function(){t.publish().then(function(){return n()}).catch(function(i){return r(i)})})})},e.prototype.disposeWebRtcPeer=function(){var t;this.webRtcPeer&&(this.webRtcPeer.dispose(),t=this.webRtcPeer.getId()),this.stopWebRtcStats(),at.info((this.outboundStreamOpts?"Outbound ":"Inbound ")+"RTCPeerConnection with id ["+t+"] from 'Stream' with id ["+this.streamId+"] is now closed")},e.prototype.disposeMediaStream=function(){return ji(this,void 0,void 0,function(){var t;return $i(this,function(n){switch(n.label){case 0:if(!(this.filter&&this.filter.type.startsWith("VB:")))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.removeFilterAux(!0)];case 2:return n.sent(),console.debug("Success removing Virtual Background filter for stream ".concat(this.streamId)),[3,4];case 3:return t=n.sent(),console.error("Error removing Virtual Background filter for stream ".concat(this.streamId),t),[3,4];case 4:return this.mediaStream&&(this.mediaStream.getAudioTracks().forEach(function(r){r.stop()}),this.mediaStream.getVideoTracks().forEach(function(r){r.stop()}),delete this.mediaStream),this.localMediaStreamWhenSubscribedToRemote&&(this.localMediaStreamWhenSubscribedToRemote.getAudioTracks().forEach(function(r){r.stop()}),this.localMediaStreamWhenSubscribedToRemote.getVideoTracks().forEach(function(r){r.stop()}),delete this.localMediaStreamWhenSubscribedToRemote),this.speechEvent&&(this.speechEvent.stop&&this.speechEvent.stop(),delete this.speechEvent),at.info((this.outboundStreamOpts?"Local ":"Remote ")+"MediaStream from 'Stream' with id ["+this.streamId+"] is now disposed"),[2]}})})},e.prototype.displayMyRemote=function(){return this.isSubscribeToRemote},e.prototype.isSendAudio=function(){return!!this.outboundStreamOpts&&this.outboundStreamOpts.publisherProperties.audioSource!==null&&this.outboundStreamOpts.publisherProperties.audioSource!==!1},e.prototype.isSendVideo=function(){return!!this.outboundStreamOpts&&this.outboundStreamOpts.publisherProperties.videoSource!==null&&this.outboundStreamOpts.publisherProperties.videoSource!==!1},e.prototype.isSendScreen=function(){var t=!1;if(typeof MediaStreamTrack<"u"&&this.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack){var n=this.outboundStreamOpts.publisherProperties.videoSource.getSettings();n.displaySurface&&(t=["monitor","window","browser"].includes(n.displaySurface))}return!t&&X2.isElectron()&&(t=typeof this.outboundStreamOpts.publisherProperties.videoSource=="string"&&this.outboundStreamOpts.publisherProperties.videoSource.startsWith("screen:")),t||(t=this.outboundStreamOpts.publisherProperties.videoSource==="screen"),!!this.outboundStreamOpts&&t},e.prototype.enableHarkSpeakingEvent=function(){var t=this;this.setHarkListenerIfNotExists(),!this.harkSpeakingEnabled&&this.speechEvent&&(this.harkSpeakingEnabled=!0,this.speechEvent.on("speaking",function(){t.session.emitEvent("publisherStartSpeaking",[new Go.PublisherSpeakingEvent(t.session,"publisherStartSpeaking",t.connection,t.streamId)]),t.streamManager.emitEvent("publisherStartSpeaking",[new Go.PublisherSpeakingEvent(t.streamManager,"publisherStartSpeaking",t.connection,t.streamId)]),t.harkSpeakingEnabledOnce=!1}))},e.prototype.enableOnceHarkSpeakingEvent=function(){var t=this;this.setHarkListenerIfNotExists(),!this.harkSpeakingEnabledOnce&&this.speechEvent&&(this.harkSpeakingEnabledOnce=!0,this.speechEvent.once("speaking",function(){t.harkSpeakingEnabledOnce&&(t.session.emitEvent("publisherStartSpeaking",[new Go.PublisherSpeakingEvent(t.session,"publisherStartSpeaking",t.connection,t.streamId)]),t.streamManager.emitEvent("publisherStartSpeaking",[new Go.PublisherSpeakingEvent(t.streamManager,"publisherStartSpeaking",t.connection,t.streamId)])),t.disableHarkSpeakingEvent(!0)}))},e.prototype.disableHarkSpeakingEvent=function(t){if(this.speechEvent){if(this.harkSpeakingEnabledOnce=!1,t){if(this.harkSpeakingEnabled)return}else this.harkSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.enableHarkStoppedSpeakingEvent=function(){var t=this;this.setHarkListenerIfNotExists(),!this.harkStoppedSpeakingEnabled&&this.speechEvent&&(this.harkStoppedSpeakingEnabled=!0,this.speechEvent.on("stopped_speaking",function(){t.session.emitEvent("publisherStopSpeaking",[new Go.PublisherSpeakingEvent(t.session,"publisherStopSpeaking",t.connection,t.streamId)]),t.streamManager.emitEvent("publisherStopSpeaking",[new Go.PublisherSpeakingEvent(t.streamManager,"publisherStopSpeaking",t.connection,t.streamId)]),t.harkStoppedSpeakingEnabledOnce=!1}))},e.prototype.enableOnceHarkStoppedSpeakingEvent=function(){var t=this;this.setHarkListenerIfNotExists(),!this.harkStoppedSpeakingEnabledOnce&&this.speechEvent&&(this.harkStoppedSpeakingEnabledOnce=!0,this.speechEvent.once("stopped_speaking",function(){t.harkStoppedSpeakingEnabledOnce&&(t.session.emitEvent("publisherStopSpeaking",[new Go.PublisherSpeakingEvent(t.session,"publisherStopSpeaking",t.connection,t.streamId)]),t.streamManager.emitEvent("publisherStopSpeaking",[new Go.PublisherSpeakingEvent(t.streamManager,"publisherStopSpeaking",t.connection,t.streamId)])),t.disableHarkStoppedSpeakingEvent(!0)}))},e.prototype.disableHarkStoppedSpeakingEvent=function(t){if(this.speechEvent){if(this.harkStoppedSpeakingEnabledOnce=!1,t){if(this.harkStoppedSpeakingEnabled)return}else this.harkStoppedSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce?this.speechEvent.off("stopped_speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.enableHarkVolumeChangeEvent=function(t){var n=this;this.setHarkListenerIfNotExists()?(!this.harkVolumeChangeEnabled||t)&&(this.harkVolumeChangeEnabled=!0,this.speechEvent.on("volume_change",function(r){var i=n.speechEvent.oldVolumeValue,o={newValue:r,oldValue:i};n.speechEvent.oldVolumeValue=r,n.streamManager.emitEvent("streamAudioVolumeChange",[new G2.StreamManagerEvent(n.streamManager,"streamAudioVolumeChange",o)])})):this.harkVolumeChangeEnabled=!0},e.prototype.enableOnceHarkVolumeChangeEvent=function(t){var n=this;this.setHarkListenerIfNotExists()?(!this.harkVolumeChangeEnabledOnce||t)&&(this.harkVolumeChangeEnabledOnce=!0,this.speechEvent.once("volume_change",function(r){var i=n.speechEvent.oldVolumeValue,o={newValue:r,oldValue:i};n.speechEvent.oldVolumeValue=r,n.disableHarkVolumeChangeEvent(!0),n.streamManager.emitEvent("streamAudioVolumeChange",[new G2.StreamManagerEvent(n.streamManager,"streamAudioVolumeChange",o)])})):this.harkVolumeChangeEnabledOnce=!0},e.prototype.disableHarkVolumeChangeEvent=function(t){if(this.speechEvent){if(this.harkVolumeChangeEnabledOnce=!1,t){if(this.harkVolumeChangeEnabled)return}else this.harkVolumeChangeEnabled=!1;this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("volume_change"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.isLocal=function(){return!this.inboundStreamOpts&&!!this.outboundStreamOpts},e.prototype.getSelectedIceCandidate=function(){var t=this;return new Promise(function(n,r){t.webRtcStats.getSelectedIceCandidateInfo().then(function(i){return n(i)}).catch(function(i){return r(i)})})},e.prototype.getRemoteIceCandidateList=function(){return this.webRtcPeer.remoteCandidatesQueue},e.prototype.getLocalIceCandidateList=function(){return this.webRtcPeer.localCandidatesQueue},e.prototype.streamIceConnectionStateBroken=function(){if(!this.getWebRtcPeer()||!this.getRTCPeerConnection())return!1;if(this.session.openvidu.advancedConfiguration.forceMediaReconnectionAfterNetworkDrop)return at.warn('OpenVidu Browser advanced configuration option "forceMediaReconnectionAfterNetworkDrop" is enabled. Stream '.concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") will force a reconnection")),!0;var t=this.getRTCPeerConnection().iceConnectionState;return t!=="connected"&&t!=="completed"},e.prototype.setHarkListenerIfNotExists=function(){if(this.mediaStream){if(!this.speechEvent){var t=this.harkOptions?this.harkOptions:this.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{};t.interval=typeof t.interval=="number"?t.interval:100,t.threshold=typeof t.threshold=="number"?t.threshold:-50,this.speechEvent=_q(this.mediaStream,t)}return!0}return!1},e.prototype.setupReconnectionEventEmitter=function(t,n){return this.reconnectionEventEmitter==null?(this.reconnectionEventEmitter=new q2,!1):(console.warn("Trying to reconnect stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") but an ongoing reconnection process is active. Waiting for response...")),this.reconnectionEventEmitter.once("success",function(){return t()}),this.reconnectionEventEmitter.once("error",function(r){return n(r)}),!0)},e.prototype.initWebRtcPeerSend=function(t){var n=this;return new Promise(function(r,i){var o;if(t){if(n.setupReconnectionEventEmitter(r,i))return}else n.initHarkEvents();var a=function(){var l;return t&&((l=n.reconnectionEventEmitter)===null||l===void 0||l.emitEvent("success"),delete n.reconnectionEventEmitter),r()},s=function(l){var d;return t&&((d=n.reconnectionEventEmitter)===null||d===void 0||d.emitEvent("error",[l]),delete n.reconnectionEventEmitter),i(l)},u=function(l){at.debug("Sending SDP offer to publish as "+n.streamId,l);var d=t?"reconnectStream":"publishVideo",f;if(t)f={stream:n.streamId,sdpString:l};else{var h=void 0;n.isSendVideo()&&(h=typeof MediaStreamTrack<"u"&&n.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?qo.TypeOfVideo.CUSTOM:n.isSendScreen()?qo.TypeOfVideo.SCREEN:qo.TypeOfVideo.CAMERA),f={doLoopback:n.displayMyRemote()||!1,hasAudio:n.isSendAudio(),hasVideo:n.isSendVideo(),audioActive:n.audioActive,videoActive:n.videoActive,typeOfVideo:h,frameRate:n.frameRate?n.frameRate:-1,videoDimensions:JSON.stringify(n.videoDimensions),filter:n.outboundStreamOpts.publisherProperties.filter,sdpOffer:l}}n.session.openvidu.sendRequest(d,f,function(p,m){p?p.code===401?s(new qt.OpenViduError(qt.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to publish")):s("Error on publishVideo: "+JSON.stringify(p)):n.webRtcPeer.processRemoteAnswer(m.sdpAnswer).then(function(){n.streamId=m.id,n.creationTime=m.createdAt,n.isLocalStreamPublished=!0,n.publishedOnce=!0,n.displayMyRemote()&&(n.localMediaStreamWhenSubscribedToRemote=n.mediaStream,n.remotePeerSuccessfullyEstablished(t)),t?n.ee.emitEvent("stream-reconnected-by-publisher",[]):n.ee.emitEvent("stream-created-by-publisher",[]),n.initWebRtcStats(),at.info("'Publisher' ("+n.streamId+") successfully "+(t?"reconnected":"published")+" to session"),a()}).catch(function(g){s(g)})})},c={mediaConstraints:{audio:n.hasAudio,video:n.hasVideo},simulcast:(o=n.outboundStreamOpts.publisherProperties.videoSimulcast)!==null&&o!==void 0?o:n.session.openvidu.videoSimulcast,onIceCandidate:n.connection.sendIceCandidate.bind(n.connection),onIceConnectionStateException:n.onIceConnectionStateExceptionHandler.bind(n),iceServers:n.getIceServersConf(),rtcConfiguration:n.session.openvidu.advancedConfiguration.rtcConfiguration,mediaStream:n.mediaStream,mediaServer:n.session.openvidu.mediaServer,typeOfVideo:n.typeOfVideo?qo.TypeOfVideo[n.typeOfVideo]:void 0};n.session.openvidu.mediaServer!=="mediasoup"&&(c.simulcast=!1),t&&n.disposeWebRtcPeer(),n.displayMyRemote()?n.webRtcPeer=new _0.WebRtcPeerSendrecv(c):n.webRtcPeer=new _0.WebRtcPeerSendonly(c),n.webRtcPeer.addIceConnectionStateChangeListener("publisher of "+n.connection.connectionId),n.webRtcPeer.createOffer().then(function(l){n.webRtcPeer.processLocalOffer(l).then(function(){u(l.sdp)}).catch(function(d){s(new Error("(publish) SDP process local offer error: "+JSON.stringify(d)))})}).catch(function(l){s(new Error("(publish) SDP create offer error: "+JSON.stringify(l)))})})},e.prototype.finalResolveForSubscription=function(t,n){var r;return at.info("'Subscriber' ("+this.streamId+") successfully "+(t?"reconnected":"subscribed")),this.remotePeerSuccessfullyEstablished(t),this.initWebRtcStats(),t&&((r=this.reconnectionEventEmitter)===null||r===void 0||r.emitEvent("success"),delete this.reconnectionEventEmitter),n()},e.prototype.finalRejectForSubscription=function(t,n,r){var i;return at.error("Error for 'Subscriber' ("+this.streamId+") while trying to "+(t?"reconnect":"subscribe")+": "+n.toString()),t&&((i=this.reconnectionEventEmitter)===null||i===void 0||i.emitEvent("error",[n]),delete this.reconnectionEventEmitter),r(n)},e.prototype.initWebRtcPeerReceive=function(t){var n=this;return new Promise(function(r,i){t&&n.setupReconnectionEventEmitter(r,i)||(n.session.openvidu.mediaServer==="mediasoup"?n.initWebRtcPeerReceiveFromServer(t).then(function(){return n.finalResolveForSubscription(t,r)}).catch(function(o){return n.finalRejectForSubscription(t,o,i)}):n.initWebRtcPeerReceiveFromClient(t).then(function(){return n.finalResolveForSubscription(t,r)}).catch(function(o){return n.finalRejectForSubscription(t,o,i)}))})},e.prototype.initWebRtcPeerReceiveFromClient=function(t){var n=this;return new Promise(function(r,i){n.completeWebRtcPeerReceive(t,!1).then(function(o){n.webRtcPeer.processRemoteAnswer(o.sdpAnswer).then(function(){return r()}).catch(function(a){return i(a)})}).catch(function(o){return i(o)})})},e.prototype.initWebRtcPeerReceiveFromServer=function(t){var n=this;return new Promise(function(r,i){n.session.openvidu.sendRequest("prepareReceiveVideoFrom",{sender:n.streamId,reconnect:t},function(o,a){if(o)return i(new Error("Error on prepareReceiveVideoFrom: "+JSON.stringify(o)));n.completeWebRtcPeerReceive(t,!1,a.sdpOffer).then(function(){return r()}).catch(function(s){return i(s)})})})},e.prototype.completeWebRtcPeerReceive=function(t,n,r){var i=this;return new Promise(function(o,a){at.debug("'Session.subscribe(Stream)' called");var s=function(c){at.debug("Sending local SDP ".concat(r?"answer":"offer"," to subscribe to ").concat(i.streamId),c);var l=t?"reconnectStream":"receiveVideoFrom",d={};d[t?"stream":"sender"]=i.streamId,r?d[t?"sdpString":"sdpAnswer"]=c:d.sdpOffer=c,t&&(d.forciblyReconnect=n),i.session.openvidu.sendRequest(l,d,function(f,h){return f?a(new Error("Error on "+l+" : "+JSON.stringify(f))):o(h)})},u={mediaConstraints:{audio:i.hasAudio,video:i.hasVideo},simulcast:!1,onIceCandidate:i.connection.sendIceCandidate.bind(i.connection),onIceConnectionStateException:i.onIceConnectionStateExceptionHandler.bind(i),iceServers:i.getIceServersConf(),rtcConfiguration:i.session.openvidu.advancedConfiguration.rtcConfiguration,mediaServer:i.session.openvidu.mediaServer,typeOfVideo:i.typeOfVideo?qo.TypeOfVideo[i.typeOfVideo]:void 0};t&&i.disposeWebRtcPeer(),i.webRtcPeer=new _0.WebRtcPeerRecvonly(u),i.webRtcPeer.addIceConnectionStateChangeListener(i.streamId),r?i.webRtcPeer.processRemoteOffer(r).then(function(){i.webRtcPeer.createAnswer().then(function(c){i.webRtcPeer.processLocalAnswer(c).then(function(){s(c.sdp)}).catch(function(l){return a(new Error("(subscribe) SDP process local answer error: "+JSON.stringify(l)))})}).catch(function(c){return a(new Error("(subscribe) SDP create answer error: "+JSON.stringify(c)))})}).catch(function(c){return a(new Error("(subscribe) SDP process remote offer error: "+JSON.stringify(c)))}):i.webRtcPeer.createOffer().then(function(c){i.webRtcPeer.processLocalOffer(c).then(function(){s(c.sdp)}).catch(function(l){return a(new Error("(subscribe) SDP process local offer error: "+JSON.stringify(l)))})}).catch(function(c){return a(new Error("(subscribe) SDP create offer error: "+JSON.stringify(c)))})})},e.prototype.remotePeerSuccessfullyEstablished=function(t){t&&this.mediaStream!=null&&this.disposeMediaStream(),this.mediaStream=new MediaStream;for(var n,r=0,i=this.webRtcPeer.pc.getReceivers();r<i.length;r++)n=i[r],n.track&&this.mediaStream.addTrack(n.track);if(at.debug("Peer remote stream",this.mediaStream),this.mediaStream){if(this.streamManager instanceof wq.Subscriber){if(this.mediaStream.getAudioTracks()[0]){var o=t?this.audioActive:!!this.streamManager.properties.subscribeToAudio;this.mediaStream.getAudioTracks()[0].enabled=o}if(this.mediaStream.getVideoTracks()[0]){var o=t?this.videoActive:!!this.videoActive&&!!this.streamManager.properties.subscribeToVideo;this.mediaStream.getVideoTracks()[0].enabled=o}}this.updateMediaStreamInVideos(),this.initHarkEvents()}},e.prototype.initHarkEvents=function(){this.mediaStream.getAudioTracks()[0]&&(this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!0,this.streamManager)&&this.enableOnceHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.streamManager)&&this.enableHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!0,this.streamManager)&&this.enableOnceHarkStoppedSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.streamManager)&&this.enableHarkStoppedSpeakingEvent(),this.harkVolumeChangeEnabledOnce&&this.enableOnceHarkVolumeChangeEvent(!0),this.harkVolumeChangeEnabled&&this.enableHarkVolumeChangeEvent(!0))},e.prototype.onIceConnectionStateExceptionHandler=function(t,n,r){switch(t){case ul.ExceptionEventName.ICE_CONNECTION_FAILED:this.onIceConnectionFailed();break;case ul.ExceptionEventName.ICE_CONNECTION_DISCONNECTED:this.onIceConnectionDisconnected();break}this.session.emitEvent("exception",[new ul.ExceptionEvent(this.session,t,this,n,r)])},e.prototype.onIceConnectionFailed=function(){at.log("[ICE_CONNECTION_FAILED] Handling ICE_CONNECTION_FAILED event. Reconnecting stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",")")),this.reconnectStreamAndLogResultingIceConnectionState(ul.ExceptionEventName.ICE_CONNECTION_FAILED)},e.prototype.onIceConnectionDisconnected=function(){var t=this;at.log("[ICE_CONNECTION_DISCONNECTED] Handling ICE_CONNECTION_DISCONNECTED event. Waiting for ICE to be restored and reconnect stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") if not possible"));var n=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3;this.awaitWebRtcPeerConnectionState(n).then(function(r){switch(r){case"failed":at.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(t.streamId," (").concat(t.isLocal()?"Publisher":"Subscriber",") is now failed after ICE_CONNECTION_DISCONNECTED"));break;case"connected":case"completed":at.log("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(t.streamId," (").concat(t.isLocal()?"Publisher":"Subscriber",") automatically restored after ICE_CONNECTION_DISCONNECTED. Current ICE connection state: ").concat(r));break;case"closed":case"checking":case"new":case"disconnected":at.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(t.streamId," (").concat(t.isLocal()?"Publisher":"Subscriber",") couldn't be restored after ICE_CONNECTION_DISCONNECTED event. Current ICE connection state after ").concat(n," ms: ").concat(r)),t.reconnectStreamAndLogResultingIceConnectionState(ul.ExceptionEventName.ICE_CONNECTION_DISCONNECTED);break}})},e.prototype.reconnectStreamAndLogResultingIceConnectionState=function(t){return ji(this,void 0,void 0,function(){var n,r;return $i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.reconnectStreamAndReturnIceConnectionState(t)];case 1:switch(n=i.sent(),n){case"connected":case"completed":at.log("[".concat(t,"] Stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") successfully reconnected after ").concat(t,". Current ICE connection state: ").concat(n));break;default:at.error("[".concat(t,"] Stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") failed to reconnect after ").concat(t,". Current ICE connection state: ").concat(n));break}return[3,3];case 2:return r=i.sent(),at.error("[".concat(t,"] Error reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") after ").concat(t,": ").concat(r)),[3,3];case 3:return[2]}})})},e.prototype.reconnectStreamAndReturnIceConnectionState=function(t){return ji(this,void 0,void 0,function(){var n,r;return $i(this,function(i){switch(i.label){case 0:at.log("[".concat(t,"] Reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") after event ").concat(t)),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.reconnectStream(t)];case 2:return i.sent(),n=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3,[2,this.awaitWebRtcPeerConnectionState(n)];case 3:return r=i.sent(),at.warn("[".concat(t,"] Error reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber","). Reason: ").concat(r)),[2,this.awaitWebRtcPeerConnectionState(1)];case 4:return[2]}})})},e.prototype.awaitWebRtcPeerConnectionState=function(t){return ji(this,void 0,void 0,function(){var n,r,i,o;return $i(this,function(a){switch(a.label){case 0:n=this.getRTCPeerConnection().iceConnectionState,r=150,i=Math.ceil(t/r),o=0,a.label=1;case 1:return o<i?(n=this.getRTCPeerConnection().iceConnectionState,n==="connected"||n==="completed"?[3,4]:[4,new Promise(function(s){return setTimeout(s,r)})]):[3,4];case 2:a.sent(),a.label=3;case 3:return o++,[3,1];case 4:return[2,n]}})})},e.prototype.reconnectStream=function(t){return ji(this,void 0,void 0,function(){var n,r;return $i(this,function(i){switch(i.label){case 0:return[4,this.isWebsocketConnected(t,3e3)];case 1:if(n=i.sent(),n)return at.log("[".concat(t,"] Trying to reconnect stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") and the websocket is opened")),this.isLocal()?[2,this.initWebRtcPeerSend(!0)]:[2,this.initWebRtcPeerReceive(!0)];throw r="[".concat(t,"] Trying to reconnect stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") but the websocket wasn't opened"),at.error(r),Error(r)}})})},e.prototype.isWebsocketConnected=function(t,n){var r=this;return new Promise(function(i,o){var a=r.session.openvidu.getWsReadyState();if(a===1){var s=setTimeout(function(){return console.warn("[".concat(t,"] Websocket timeout of ").concat(n,"ms")),i(!1)},n);r.session.openvidu.sendRequest("echo",{},function(u,c){return clearTimeout(s),u?(console.warn("[".concat(t,"] Websocket 'echo' returned error: ").concat(u)),i(!1)):i(!0)})}else return console.warn("[".concat(t,"] Websocket readyState is ").concat(a)),i(!1)})},e.prototype.initWebRtcStats=function(){this.webRtcStats=new xq.WebRtcStats(this),this.webRtcStats.initWebRtcStats()},e.prototype.stopWebRtcStats=function(){this.webRtcStats&&this.webRtcStats.isEnabled()&&this.webRtcStats.stopWebRtcStats()},e.prototype.getIceServersConf=function(){var t,n;return this.session.openvidu.advancedConfiguration.iceServers?n=this.session.openvidu.advancedConfiguration.iceServers==="freeice"?void 0:this.session.openvidu.advancedConfiguration.iceServers:!((t=this.session.openvidu.advancedConfiguration.rtcConfiguration)===null||t===void 0)&&t.iceServers?n=this.session.openvidu.advancedConfiguration.rtcConfiguration.iceServers:this.session.openvidu.iceServers?n=this.session.openvidu.iceServers:n=void 0,n},e.prototype.gatherStatsForPeer=function(){var t=this;return new Promise(function(n,r){t.isLocal()?t.getRTCPeerConnection().getSenders().forEach(function(i){return i.getStats().then(function(o){o.forEach(function(a){if(t.isReportWanted(a)){var s={};s.type=a.type,s.timestamp=a.timestamp,s.id=a.id,a.type==="outbound-rtp"&&(s.ssrc=a.ssrc,s.firCount=a.firCount,s.pliCount=a.pliCount,s.nackCount=a.nackCount,s.qpSum=a.qpSum,a.kind?s.mediaType=a.kind:a.mediaType?s.mediaType=a.mediaType:s.mediaType=a.id.indexOf("VideoStream")!==-1?"video":"audio",s.mediaType==="video"&&(s.framesEncoded=a.framesEncoded),s.packetsSent=a.packetsSent,s.bytesSent=a.bytesSent),a.type==="candidate-pair"&&a.totalRoundTripTime!==void 0&&(s.availableOutgoingBitrate=a.availableOutgoingBitrate,s.rtt=a.currentRoundTripTime,s.averageRtt=a.totalRoundTripTime/a.responsesReceived),a.type==="remote-inbound-rtp"||a.type,at.log(s)}})})}):t.getRTCPeerConnection().getReceivers().forEach(function(i){return i.getStats().then(function(o){o.forEach(function(a){if(t.isReportWanted(a)){var s={};s.type=a.type,s.timestamp=a.timestamp,s.id=a.id,a.type==="inbound-rtp"&&(s.ssrc=a.ssrc,s.firCount=a.firCount,s.pliCount=a.pliCount,s.nackCount=a.nackCount,s.qpSum=a.qpSum,a.kind?s.mediaType=a.kind:a.mediaType?s.mediaType=a.mediaType:s.mediaType=a.id.indexOf("VideoStream")!==-1?"video":"audio",s.mediaType==="video"&&(s.framesDecoded=a.framesDecoded),s.packetsReceived=a.packetsReceived,s.packetsLost=a.packetsLost,s.jitter=a.jitter,s.bytesReceived=a.bytesReceived),a.type==="candidate-pair"&&a.totalRoundTripTime!==void 0&&(s.availableIncomingBitrate=a.availableIncomingBitrate,s.rtt=a.currentRoundTripTime,s.averageRtt=a.totalRoundTripTime/a.responsesReceived),a.type==="remote-inbound-rtp"||a.type,at.log(s)}})})})})},e.prototype.isReportWanted=function(t){return t.type==="inbound-rtp"&&!this.isLocal()||t.type==="outbound-rtp"&&this.isLocal()||t.type==="candidate-pair"&&t.nominated&&t.bytesSent>0},e}();Nc.Stream=kq;Object.defineProperty(zd,"__esModule",{value:!0});zd.Connection=void 0;var Rq=Nc,Iq=ln,K2=$s,cl=Iq.OpenViduLogger.getInstance(),Tq=function(){function e(t,n){this.session=t,this.disposed=!1;var r="'Connection' created ";n.role?(this.localOptions=n,this.connectionId=this.localOptions.id,this.creationTime=this.localOptions.createdAt,this.data=this.localOptions.metadata,this.rpcSessionId=this.localOptions.sessionId,this.role=this.localOptions.role,this.record=this.localOptions.record,r+="(local)"):(this.remoteOptions=n,this.connectionId=this.remoteOptions.id,this.creationTime=this.remoteOptions.createdAt,this.remoteOptions.metadata&&(this.data=this.remoteOptions.metadata),this.remoteOptions.streams&&this.initRemoteStreams(this.remoteOptions.streams),r+="(remote) with 'connectionId' ["+this.remoteOptions.id+"]"),cl.info(r)}return e.prototype.sendIceCandidate=function(t){var n=this;this.disposed?cl.warn("Connection ".concat(this.connectionId," disposed when trying to send an ICE candidate. ICE candidate not sent")):(cl.debug((this.stream.outboundStreamOpts?"Local":"Remote")+"candidate for"+this.connectionId,t),this.session.openvidu.sendRequest("onIceCandidate",{endpointName:this.connectionId,candidate:t.candidate,sdpMid:t.sdpMid,sdpMLineIndex:t.sdpMLineIndex},function(r,i){r&&(cl.error("Error sending ICE candidate: "+JSON.stringify(r)),n.session.emitEvent("exception",[new K2.ExceptionEvent(n.session,K2.ExceptionEventName.ICE_CANDIDATE_ERROR,n.session,"There was an unexpected error on the server-side processing an ICE candidate generated and sent by the client-side",r)]))}))},e.prototype.initRemoteStreams=function(t){var n=this;t.forEach(function(r){var i={id:r.id,createdAt:r.createdAt,connection:n,hasAudio:r.hasAudio,hasVideo:r.hasVideo,audioActive:r.audioActive,videoActive:r.videoActive,typeOfVideo:r.typeOfVideo,frameRate:r.frameRate,videoDimensions:r.videoDimensions?JSON.parse(r.videoDimensions):void 0,filter:r.filter?r.filter:void 0},o=new Rq.Stream(n.session,i);n.addStream(o)}),cl.info("Remote 'Connection' with 'connectionId' ["+this.connectionId+"] is now configured for receiving Streams with options: ",this.stream.inboundStreamOpts)},e.prototype.addStream=function(t){t.connection=this,this.stream=t},e.prototype.removeStream=function(){delete this.stream},e.prototype.dispose=function(){this.disposed=!0,this.removeStream()},e}();zd.Connection=Tq;var Kd={},Oq=me&&me.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Kd,"__esModule",{value:!0});Kd.ConnectionEvent=void 0;var Pq=En,Nq=function(e){Oq(t,e);function t(n,r,i,o,a){var s=e.call(this,n,r,i)||this;return s.connection=o,s.reason=a,s}return t.prototype.callDefaultBehavior=function(){},t}(Pq.Event);Kd.ConnectionEvent=Nq;var Yd={},Dq=me&&me.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Yd,"__esModule",{value:!0});Yd.FilterEvent=void 0;var Aq=En,Mq=function(e){Dq(t,e);function t(n,r,i){var o=e.call(this,!1,n,r)||this;return o.data=i,o}return t.prototype.callDefaultBehavior=function(){},t}(Aq.Event);Yd.FilterEvent=Mq;var Qd={},Lq=me&&me.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Qd,"__esModule",{value:!0});Qd.RecordingEvent=void 0;var Fq=En,Bq=function(e){Lq(t,e);function t(n,r,i,o,a){var s=e.call(this,!1,n,r)||this;return s.id=i,o!==i&&(s.name=o),s.reason=a,s}return t.prototype.callDefaultBehavior=function(){},t}(Fq.Event);Qd.RecordingEvent=Bq;var Bc={},jq=me&&me.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Bc,"__esModule",{value:!0});Bc.SessionDisconnectedEvent=void 0;var $q=En,Vq=ln,Wq=Vq.OpenViduLogger.getInstance(),Uq=function(e){jq(t,e);function t(n,r){var i=e.call(this,!0,n,"sessionDisconnected")||this;return i.reason=r,i}return t.prototype.callDefaultBehavior=function(){Wq.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'");var n=this.target;n.remoteConnections.forEach(function(r){var i,o,a,s,u,c,l,d,f=r.connectionId;if(!((i=n.remoteConnections.get(f))===null||i===void 0)&&i.stream){(o=n.remoteConnections.get(f))===null||o===void 0||o.stream.disposeWebRtcPeer(),(a=n.remoteConnections.get(f))===null||a===void 0||a.stream.disposeMediaStream(),!((s=n.remoteConnections.get(f))===null||s===void 0)&&s.stream.streamManager&&((u=n.remoteConnections.get(f))===null||u===void 0||u.stream.streamManager.removeAllVideos());var h=(l=(c=n.remoteConnections.get(f))===null||c===void 0?void 0:c.stream)===null||l===void 0?void 0:l.streamId;h&&n.remoteStreamsCreated.delete(h),(d=n.remoteConnections.get(f))===null||d===void 0||d.dispose()}n.remoteConnections.delete(f)})},t}($q.Event);Bc.SessionDisconnectedEvent=Uq;var Jd={},zq=me&&me.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Jd,"__esModule",{value:!0});Jd.SignalEvent=void 0;var Hq=En,Gq=function(e){zq(t,e);function t(n,r,i,o){var a=e.call(this,!1,n,"signal")||this;return r&&(a.type="signal:"+r),a.data=i,a.from=o,a}return t.prototype.callDefaultBehavior=function(){},t}(Hq.Event);Jd.SignalEvent=Gq;var Zd={},qq=me&&me.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Zd,"__esModule",{value:!0});Zd.SpeechToTextEvent=void 0;var Xq=En,Kq=function(e){qq(t,e);function t(n,r,i,o,a,s){var u=e.call(this,!1,n,"speechToTextMessage")||this;return u.connection=r,u.text=i,u.reason=o,u.raw=a,u.lang=s,u}return t.prototype.callDefaultBehavior=function(){},t}(Xq.Event);Zd.SpeechToTextEvent=Kq;var ll={},Y2;function Qw(){if(Y2)return ll;Y2=1;var e=me&&me.__extends||function(){var s=function(u,c){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,d){l.__proto__=d}||function(l,d){for(var f in d)Object.prototype.hasOwnProperty.call(d,f)&&(l[f]=d[f])},s(u,c)};return function(u,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");s(u,c);function l(){this.constructor=u}u.prototype=c===null?Object.create(c):(l.prototype=c.prototype,new l)}}();Object.defineProperty(ll,"__esModule",{value:!0}),ll.StreamEvent=void 0;var t=En,n=Jw(),r=Nm(),i=ln,o=i.OpenViduLogger.getInstance(),a=function(s){e(u,s);function u(c,l,d,f,h){var p=s.call(this,c,l,d)||this;return p.stream=f,p.reason=h,p}return u.prototype.callDefaultBehavior=function(){if(this.type==="streamDestroyed"){if(this.target instanceof r.Session)o.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'"),this.stream.disposeWebRtcPeer();else if(this.target instanceof n.Publisher){o.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Publisher'"),clearInterval(this.target.screenShareResizeInterval),this.stream.isLocalStreamReadyToPublish=!1;for(var c=this.target.openvidu.publishers,l=0;l<c.length;l++)if(c[l]===this.target){c.splice(l,1);break}}this.stream.disposeMediaStream(),this.stream.streamManager&&this.stream.streamManager.removeAllVideos(),this.stream.session.remoteStreamsCreated.delete(this.stream.streamId);var d=this.stream.session.remoteConnections.get(this.stream.connection.connectionId);if(d&&d.remoteOptions)for(var f=d.remoteOptions.streams,l=f.length-1;l>=0;--l)f[l].id===this.stream.streamId&&f.splice(l,1)}},u}(t.Event);return ll.StreamEvent=a,ll}var ef={},Yq=me&&me.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(ef,"__esModule",{value:!0});ef.ConnectionPropertyChangedEvent=void 0;var Qq=En,Jq=function(e){Yq(t,e);function t(n,r,i,o,a){var s=e.call(this,!1,n,"connectionPropertyChanged")||this;return s.connection=r,s.changedProperty=i,s.newValue=o,s.oldValue=a,s}return t.prototype.callDefaultBehavior=function(){},t}(Qq.Event);ef.ConnectionPropertyChangedEvent=Jq;var tf={},Zq=me&&me.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(tf,"__esModule",{value:!0});tf.NetworkQualityLevelChangedEvent=void 0;var eX=En,tX=function(e){Zq(t,e);function t(n,r,i,o){var a=e.call(this,!1,n,"networkQualityLevelChanged")||this;return a.newValue=r,a.oldValue=i,a.connection=o,a}return t.prototype.callDefaultBehavior=function(){},t}(eX.Event);tf.NetworkQualityLevelChangedEvent=tX;var k0={};const nX=typeof process=="object"&&k0&&k0.NODE_DEBUG&&/\bsemver\b/i.test(k0.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var rN=nX;const rX="2.0.0",iN=256,iX=Number.MAX_SAFE_INTEGER||9007199254740991,oX=16,aX=iN-6,sX=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var oN={MAX_LENGTH:iN,MAX_SAFE_COMPONENT_LENGTH:oX,MAX_SAFE_BUILD_LENGTH:aX,MAX_SAFE_INTEGER:iX,RELEASE_TYPES:sX,SEMVER_SPEC_VERSION:rX,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},U1={exports:{}};(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=oN,o=rN;t=e.exports={};const a=t.re=[],s=t.safeRe=[],u=t.src=[],c=t.t={};let l=0;const d="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",i],[d,r]],h=m=>{for(const[g,v]of f)m=m.split(`${g}*`).join(`${g}{0,${v}}`).split(`${g}+`).join(`${g}{1,${v}}`);return m},p=(m,g,v)=>{const y=h(g),b=l++;o(m,b,g),c[m]=b,u[b]=g,a[b]=new RegExp(g,v?"g":void 0),s[b]=new RegExp(y,v?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`),p("MAINVERSION",`(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${u[c.NUMERICIDENTIFIER]}|${u[c.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${u[c.NUMERICIDENTIFIERLOOSE]}|${u[c.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${u[c.PRERELEASEIDENTIFIER]}(?:\\.${u[c.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${u[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[c.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${d}+`),p("BUILD",`(?:\\+(${u[c.BUILDIDENTIFIER]}(?:\\.${u[c.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${u[c.MAINVERSION]}${u[c.PRERELEASE]}?${u[c.BUILD]}?`),p("FULL",`^${u[c.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${u[c.MAINVERSIONLOOSE]}${u[c.PRERELEASELOOSE]}?${u[c.BUILD]}?`),p("LOOSE",`^${u[c.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${u[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${u[c.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:${u[c.PRERELEASE]})?${u[c.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:${u[c.PRERELEASELOOSE]})?${u[c.BUILD]}?)?)?`),p("XRANGE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),p("COERCE",`${u[c.COERCEPLAIN]}(?:$|[^\\d])`),p("COERCEFULL",u[c.COERCEPLAIN]+`(?:${u[c.PRERELEASE]})?(?:${u[c.BUILD]})?(?:$|[^\\d])`),p("COERCERTL",u[c.COERCE],!0),p("COERCERTLFULL",u[c.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${u[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${u[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${u[c.LONECARET]}${u[c.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${u[c.LONECARET]}${u[c.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${u[c.GTLT]}\\s*(${u[c.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]}|${u[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${u[c.XRANGEPLAIN]})\\s+-\\s+(${u[c.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${u[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[c.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(U1,U1.exports);var uX=U1.exports;const cX=Object.freeze({loose:!0}),lX=Object.freeze({}),dX=e=>e?typeof e!="object"?cX:e:lX;var fX=dX;const Q2=/^[0-9]+$/,aN=(e,t)=>{const n=Q2.test(e),r=Q2.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},hX=(e,t)=>aN(t,e);var pX={compareIdentifiers:aN,rcompareIdentifiers:hX};const rh=rN,{MAX_LENGTH:J2,MAX_SAFE_INTEGER:ih}=oN,{safeRe:Z2,t:e_}=uX,vX=fX,{compareIdentifiers:au}=pX;let mX=class Wi{constructor(t,n){if(n=vX(n),t instanceof Wi){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>J2)throw new TypeError(`version is longer than ${J2} characters`);rh("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?Z2[e_.LOOSE]:Z2[e_.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>ih||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ih||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ih||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const o=+i;if(o>=0&&o<ih)return o}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(rh("SemVer.compare",this.version,this.options,t),!(t instanceof Wi)){if(typeof t=="string"&&t===this.version)return 0;t=new Wi(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof Wi||(t=new Wi(t,this.options)),au(this.major,t.major)||au(this.minor,t.minor)||au(this.patch,t.patch)}comparePre(t){if(t instanceof Wi||(t=new Wi(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(rh("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return au(r,i)}while(++n)}compareBuild(t){t instanceof Wi||(t=new Wi(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(rh("build compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return au(r,i)}while(++n)}inc(t,n,r){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n,r),this.inc("pre",n,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n,r),this.inc("pre",n,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const i=Number(r)?1:0;if(!n&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let o=this.prerelease.length;for(;--o>=0;)typeof this.prerelease[o]=="number"&&(this.prerelease[o]++,o=-2);if(o===-1){if(n===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(n){let o=[n,i];r===!1&&(o=[n]),au(this.prerelease[0],n)===0?isNaN(this.prerelease[1])&&(this.prerelease=o):this.prerelease=o}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var sN=mX;const gX=sN,yX=(e,t)=>new gX(e,t).major;var bX=yX;const wX=sN,xX=(e,t)=>new wX(e,t).minor;var EX=xX,t_;function Nm(){if(t_)return sl;t_=1;var e=me&&me.__extends||function(){var B=function(L,k){return B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(D,F){D.__proto__=F}||function(D,F){for(var M in F)Object.prototype.hasOwnProperty.call(F,M)&&(D[M]=F[M])},B(L,k)};return function(L,k){if(typeof k!="function"&&k!==null)throw new TypeError("Class extends value "+String(k)+" is not a constructor or null");B(L,k);function D(){this.constructor=L}L.prototype=k===null?Object.create(k):(D.prototype=k.prototype,new D)}}(),t=me&&me.__awaiter||function(B,L,k,D){function F(M){return M instanceof k?M:new k(function(I){I(M)})}return new(k||(k=Promise))(function(M,I){function N(A){try{P(D.next(A))}catch(U){I(U)}}function j(A){try{P(D.throw(A))}catch(U){I(U)}}function P(A){A.done?M(A.value):F(A.value).then(N,j)}P((D=D.apply(B,L||[])).next())})},n=me&&me.__generator||function(B,L){var k={label:0,sent:function(){if(M[0]&1)throw M[1];return M[1]},trys:[],ops:[]},D,F,M,I;return I={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(I[Symbol.iterator]=function(){return this}),I;function N(P){return function(A){return j([P,A])}}function j(P){if(D)throw new TypeError("Generator is already executing.");for(;I&&(I=0,P[0]&&(k=0)),k;)try{if(D=1,F&&(M=P[0]&2?F.return:P[0]?F.throw||((M=F.return)&&M.call(F),0):F.next)&&!(M=M.call(F,P[1])).done)return M;switch(F=0,M&&(P=[P[0]&2,M.value]),P[0]){case 0:case 1:M=P;break;case 4:return k.label++,{value:P[1],done:!1};case 5:k.label++,F=P[1],P=[0];continue;case 7:P=k.ops.pop(),k.trys.pop();continue;default:if(M=k.trys,!(M=M.length>0&&M[M.length-1])&&(P[0]===6||P[0]===2)){k=0;continue}if(P[0]===3&&(!M||P[1]>M[0]&&P[1]<M[3])){k.label=P[1];break}if(P[0]===6&&k.label<M[1]){k.label=M[1],M=P;break}if(M&&k.label<M[2]){k.label=M[2],k.ops.push(P);break}M[2]&&k.ops.pop(),k.trys.pop();continue}P=L.call(B,k)}catch(A){P=[6,A],F=0}finally{D=M=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}};Object.defineProperty(sl,"__esModule",{value:!0}),sl.Session=void 0;var r=zd,i=Dc,o=Ac,a=Lc,s=Kd,u=Yd,c=Qd,l=Bc,d=Jd,f=Zd,h=Qw(),p=Ao,m=ef,g=tf,v=js,y=Gd,b=ln,w=Pi,E=bX,x=EX,R=$s,S=b.OpenViduLogger.getInstance(),_,T=function(B){e(L,B);function L(k){var D=B.call(this)||this;return D.streamManagers=[],D.remoteStreamsCreated=new Map,D.remoteConnections=new Map,_=w.PlatformUtils.getInstance(),D.openvidu=k,D}return L.prototype.connect=function(k,D){var F=this;return new Promise(function(M,I){if(F.processToken(k),F.openvidu.checkSystemRequirements())F.options={sessionId:F.sessionId,participantId:k,metadata:D?F.stringClientMetadata(D):""},F.connectAux(k).then(function(){return M()}).catch(function(N){return I(N)});else return I(new v.OpenViduError(v.OpenViduErrorName.BROWSER_NOT_SUPPORTED,"Browser "+_.getName()+" (version "+_.getVersion()+") for "+_.getFamily()+" is not supported in OpenVidu"))})},L.prototype.disconnect=function(){this.leave(!1,"disconnect")},L.prototype.subscribe=function(k,D,F,M){var I={};F&&typeof F!="function"?I={insertMode:typeof F.insertMode<"u"?typeof F.insertMode=="string"?y.VideoInsertMode[F.insertMode]:I.insertMode:y.VideoInsertMode.APPEND,subscribeToAudio:typeof F.subscribeToAudio<"u"?F.subscribeToAudio:!0,subscribeToVideo:typeof F.subscribeToVideo<"u"?F.subscribeToVideo:!0}:I={insertMode:y.VideoInsertMode.APPEND,subscribeToAudio:!0,subscribeToVideo:!0};var N=void 0;if(F&&typeof F=="function"?N=F:M&&(N=M),!this.sessionConnected())throw N!==void 0&&N(this.notConnectedError()),this.notConnectedError();S.info("Subscribing to "+k.connection.connectionId),k.subscribe().then(function(){S.info("Subscribed correctly to "+k.connection.connectionId),N!==void 0&&N(void 0)}).catch(function(P){N!==void 0&&N(P)});var j=new o.Subscriber(k,D,I);return j.targetElement&&k.streamManager.createVideoElement(j.targetElement,I.insertMode),j},L.prototype.subscribeAsync=function(k,D,F){var M=this;return new Promise(function(I,N){if(!M.sessionConnected())return N(M.notConnectedError());var j,P=function(A){return A?N(A):I(j)};F?j=M.subscribe(k,D,F,P):j=M.subscribe(k,D,P)})},L.prototype.unsubscribe=function(k){var D=this;return new Promise(function(F,M){if(D.sessionConnected()){var I=k.stream.connection.connectionId;S.info("Unsubscribing from "+I),D.openvidu.sendRequest("unsubscribeFromVideo",{sender:k.stream.connection.connectionId},function(N,j){return N?(S.error("Error unsubscribing from "+I),M(N)):(S.info("Unsubscribed correctly from "+I),k.stream.streamManager.removeAllVideos(),k.stream.disposeWebRtcPeer(),k.stream.disposeMediaStream(),F())})}else return M(D.notConnectedError())})},L.prototype.publish=function(k){var D=this;return new Promise(function(F,M){if(!D.sessionConnected())return M(D.notConnectedError());k.session=D,k.stream.session=D,k.stream.publishedOnce?k.initialize().then(function(){D.connection.addStream(k.stream),k.reestablishStreamPlayingEvent(),k.stream.publish().then(function(){return D.sendVideoData(k,8,!0,5),F()}).catch(function(I){return M(I)})}).catch(function(I){return M(I)}):(D.connection.addStream(k.stream),k.stream.publish().then(function(){return D.sendVideoData(k,8,!0,5),F()}).catch(function(I){return M(I)}))})},L.prototype.unpublish=function(k){var D=this;return new Promise(function(F,M){if(!D.sessionConnected())throw D.notConnectedError();var I=k.stream;if(I.connection){if(I.connection!==D.connection)return M(new Error("The associated Connection object of this Publisher is not your local Connection.  Only moderators can force unpublish on remote Streams via 'forceUnpublish' method"));S.info("Unpublishing local media ("+I.connection.connectionId+")"),D.openvidu.sendRequest("unpublishVideo",function(N,j){if(N)return M(N);S.info("Media unpublished correctly"),I.disposeWebRtcPeer(),I.connection.stream==I&&delete I.connection.stream;var P=new h.StreamEvent(!0,k,"streamDestroyed",k.stream,"unpublish");return k.emitEvent("streamDestroyed",[P]),P.callDefaultBehavior(),F()})}else return M(new Error("The associated Connection object of this Publisher is null"))})},L.prototype.forceDisconnect=function(k){var D=this;return new Promise(function(F,M){if(!D.sessionConnected())return M(D.notConnectedError());S.info("Forcing disconnect for connection "+k.connectionId),D.openvidu.sendRequest("forceDisconnect",{connectionId:k.connectionId},function(I,N){return I?(S.error("Error forcing disconnect for Connection "+k.connectionId,I),I.code===401?M(new v.OpenViduError(v.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force a disconnection")):M(I)):(S.info("Forcing disconnect correctly for Connection "+k.connectionId),F())})})},L.prototype.forceUnpublish=function(k){var D=this;return new Promise(function(F,M){if(!D.sessionConnected())return M(D.notConnectedError());S.info("Forcing unpublish for stream "+k.streamId),D.openvidu.sendRequest("forceUnpublish",{streamId:k.streamId},function(I,N){return I?(S.error("Error forcing unpublish for Stream "+k.streamId,I),I.code===401?M(new v.OpenViduError(v.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force an unpublishing")):M(I)):(S.info("Forcing unpublish correctly for Stream "+k.streamId),F())})})},L.prototype.signal=function(k){var D=this;return new Promise(function(F,M){if(!D.sessionConnected())return M(D.notConnectedError());var I={};if(k.to&&k.to.length>0){var N=[];k.to.forEach(function(P){P.connectionId&&N.push(P.connectionId)}),I.to=N}else I.to=[];I.data=k.data?k.data:"";var j=k.type?k.type:"signal";j&&j.substring(0,7)!=="signal:"&&(j="signal:"+j),I.type=j,D.openvidu.sendRequest("sendMessage",{message:JSON.stringify(I)},function(P,A){return P?M(P):F()})})},L.prototype.subscribeToSpeechToText=function(k,D){var F=this;return new Promise(function(M,I){F.openvidu.sendRequest("subscribeToSpeechToText",{connectionId:k.connection.connectionId,lang:D},function(N,j){return N?I(N):M()})})},L.prototype.unsubscribeFromSpeechToText=function(k){var D=this;return new Promise(function(F,M){D.openvidu.sendRequest("unsubscribeFromSpeechToText",{connectionId:k.connection.connectionId},function(I,N){return I?M(I):F()})})},L.prototype.on=function(k,D){var F,M,I,N;return B.prototype.onAux.call(this,k,"Event '"+k+"' triggered by 'Session'",D),k==="publisherStartSpeaking"&&(this.remoteConnections.forEach(function(j){var P;!((P=j.stream)===null||P===void 0)&&P.hasAudio&&j.stream.enableHarkSpeakingEvent()}),!((M=(F=this.connection)===null||F===void 0?void 0:F.stream)===null||M===void 0)&&M.hasAudio&&this.connection.stream.enableHarkSpeakingEvent()),k==="publisherStopSpeaking"&&(this.remoteConnections.forEach(function(j){var P;!((P=j.stream)===null||P===void 0)&&P.hasAudio&&j.stream.enableHarkStoppedSpeakingEvent()}),!((N=(I=this.connection)===null||I===void 0?void 0:I.stream)===null||N===void 0)&&N.hasAudio&&this.connection.stream.enableHarkStoppedSpeakingEvent()),this},L.prototype.once=function(k,D){var F,M,I,N;return B.prototype.onceAux.call(this,k,"Event '"+k+"' triggered once by 'Session'",D),k==="publisherStartSpeaking"&&(this.remoteConnections.forEach(function(j){var P;!((P=j.stream)===null||P===void 0)&&P.hasAudio&&j.stream.enableOnceHarkSpeakingEvent()}),!((M=(F=this.connection)===null||F===void 0?void 0:F.stream)===null||M===void 0)&&M.hasAudio&&this.connection.stream.enableOnceHarkSpeakingEvent()),k==="publisherStopSpeaking"&&(this.remoteConnections.forEach(function(j){var P;!((P=j.stream)===null||P===void 0)&&P.hasAudio&&j.stream.enableOnceHarkStoppedSpeakingEvent()}),!((N=(I=this.connection)===null||I===void 0?void 0:I.stream)===null||N===void 0)&&N.hasAudio&&this.connection.stream.enableOnceHarkStoppedSpeakingEvent()),this},L.prototype.off=function(k,D){var F=this,M,I,N,j;return B.prototype.offAux.call(this,k,D),k==="publisherStartSpeaking"&&(this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1)||(this.remoteConnections.forEach(function(P){var A;!((A=P.stream)===null||A===void 0)&&A.streamManager&&(F.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,P.stream.streamManager)||P.stream.disableHarkSpeakingEvent(!1))}),!((I=(M=this.connection)===null||M===void 0?void 0:M.stream)===null||I===void 0)&&I.streamManager&&(this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.connection.stream.streamManager)||this.connection.stream.disableHarkSpeakingEvent(!1)))),k==="publisherStopSpeaking"&&(this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1)||(this.remoteConnections.forEach(function(P){var A;!((A=P.stream)===null||A===void 0)&&A.streamManager&&(F.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,P.stream.streamManager)||P.stream.disableHarkStoppedSpeakingEvent(!1))}),!((j=(N=this.connection)===null||N===void 0?void 0:N.stream)===null||j===void 0)&&j.streamManager&&(this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.connection.stream.streamManager)||this.connection.stream.disableHarkStoppedSpeakingEvent(!1)))),this},L.prototype.onParticipantJoined=function(k){var D=this;this.getConnection(k.id,"").then(function(F){S.warn("Connection "+F.connectionId+" already exists in connections list")}).catch(function(F){var M=new r.Connection(D,k);D.remoteConnections.set(k.id,M),D.ee.emitEvent("connectionCreated",[new s.ConnectionEvent(!1,D,"connectionCreated",M,"")])})},L.prototype.onParticipantLeft=function(k){var D=this;this.getRemoteConnection(k.connectionId,"onParticipantLeft").then(function(F){if(F.stream){var M=F.stream,I=new h.StreamEvent(!0,D,"streamDestroyed",M,k.reason);D.ee.emitEvent("streamDestroyed",[I]),I.callDefaultBehavior(),D.remoteStreamsCreated.delete(M.streamId)}F.dispose(),D.remoteConnections.delete(F.connectionId),D.ee.emitEvent("connectionDestroyed",[new s.ConnectionEvent(!1,D,"connectionDestroyed",F,k.reason)])}).catch(function(F){S.error(F)})},L.prototype.onParticipantPublished=function(k){var D=this,F=function(I){D.remoteConnections.set(I.connectionId,I),D.remoteStreamsCreated.get(I.stream.streamId)||D.ee.emitEvent("streamCreated",[new h.StreamEvent(!1,D,"streamCreated",I.stream,"")]),D.remoteStreamsCreated.set(I.stream.streamId,!0)},M;this.getRemoteConnection(k.id,"onParticipantPublished").then(function(I){M=I,k.metadata=I.data,M.remoteOptions=k,M.initRemoteStreams(k.streams),F(M)}).catch(function(I){M=new r.Connection(D,k),F(M)})},L.prototype.onParticipantUnpublished=function(k){var D=this;k.connectionId===this.connection.connectionId?this.stopPublisherStream(k.reason):this.getRemoteConnection(k.connectionId,"onParticipantUnpublished").then(function(F){var M=new h.StreamEvent(!0,D,"streamDestroyed",F.stream,k.reason);if(D.ee.emitEvent("streamDestroyed",[M]),M.callDefaultBehavior(),F.stream!=null){var I=F.stream.streamId;D.remoteStreamsCreated.delete(I),F.removeStream()}}).catch(function(F){S.error(F)})},L.prototype.onParticipantEvicted=function(k){k.connectionId===this.connection.connectionId&&this.sessionId&&!this.connection.disposed&&this.leave(!0,k.reason)},L.prototype.onNewMessage=function(k){var D=this;S.info("New signal: "+JSON.stringify(k));var F=k.type?k.type.replace(/^(signal:)/,""):void 0;k.from?this.getConnection(k.from,"Connection '"+k.from+"' unknown when 'onNewMessage'. Existing remote connections: "+JSON.stringify(this.remoteConnections.keys())+". Existing local connection: "+this.connection.connectionId).then(function(M){D.ee.emitEvent("signal",[new d.SignalEvent(D,F,k.data,M)]),k.type&&k.type!=="signal"&&D.ee.emitEvent(k.type,[new d.SignalEvent(D,F,k.data,M)])}).catch(function(M){S.error(M)}):(this.ee.emitEvent("signal",[new d.SignalEvent(this,F,k.data,void 0)]),k.type&&k.type!=="signal"&&this.ee.emitEvent(k.type,[new d.SignalEvent(this,F,k.data,void 0)]))},L.prototype.onStreamPropertyChanged=function(k){var D=this,F=function(M){var I,N;if(M.stream&&M.stream.streamId===k.streamId){var j=M.stream,P=void 0;switch(k.property){case"audioActive":P=j.audioActive,k.newValue=k.newValue==="true",j.audioActive=k.newValue;break;case"videoActive":P=j.videoActive,k.newValue=k.newValue==="true",j.videoActive=k.newValue;var A=(N=(I=j==null?void 0:j.getMediaStream())===null||I===void 0?void 0:I.getVideoTracks())===null||N===void 0?void 0:N[0];A&&!A.enabled&&j.videoActive&&(A.enabled=!0);break;case"videoTrack":k.newValue=JSON.parse(k.newValue);break;case"audioTrack":k.newValue=JSON.parse(k.newValue);break;case"videoDimensions":P=j.videoDimensions,k.newValue=JSON.parse(JSON.parse(k.newValue)),j.videoDimensions=k.newValue;break;case"filter":P=j.filter,k.newValue=Object.keys(k.newValue).length>0?k.newValue:void 0,k.newValue!==void 0?(j.filter=new i.Filter(k.newValue.type,k.newValue.options),j.filter.stream=j,k.newValue.lastExecMethod&&(j.filter.lastExecMethod=k.newValue.lastExecMethod)):delete j.filter,k.newValue=j.filter;break}D.ee.emitEvent("streamPropertyChanged",[new p.StreamPropertyChangedEvent(D,j,k.property,k.newValue,P,k.reason)]),j.streamManager&&j.streamManager.emitEvent("streamPropertyChanged",[new p.StreamPropertyChangedEvent(j.streamManager,j,k.property,k.newValue,P,k.reason)])}else S.error("No stream with streamId '"+k.streamId+"' found for connection '"+k.connectionId+"' on 'streamPropertyChanged' event")};k.connectionId===this.connection.connectionId?F(this.connection):this.getRemoteConnection(k.connectionId,"onStreamPropertyChanged").then(function(M){F(M)}).catch(function(M){S.error(M)})},L.prototype.onConnectionPropertyChanged=function(k){var D;switch(k.property){case"role":D=this.connection.role.slice(),this.connection.role=k.newValue,this.connection.localOptions.role=k.newValue;break;case"record":D=this.connection.record,k.newValue=k.newValue==="true",this.connection.record=k.newValue,this.connection.localOptions.record=k.newValue;break}this.ee.emitEvent("connectionPropertyChanged",[new m.ConnectionPropertyChangedEvent(this,this.connection,k.property,k.newValue,D)])},L.prototype.onNetworkQualityLevelChangedChanged=function(k){var D=this;k.connectionId===this.connection.connectionId?this.ee.emitEvent("networkQualityLevelChanged",[new g.NetworkQualityLevelChangedEvent(this,k.newValue,k.oldValue,this.connection)]):this.getConnection(k.connectionId,"Connection not found for connectionId "+k.connectionId).then(function(F){D.ee.emitEvent("networkQualityLevelChanged",[new g.NetworkQualityLevelChangedEvent(D,k.newValue,k.oldValue,F)])}).catch(function(F){S.error(F)})},L.prototype.recvIceCandidate=function(k){var D={candidate:k.candidate,sdpMLineIndex:k.sdpMLineIndex,sdpMid:k.sdpMid},F=new RTCIceCandidate(D);this.getConnection(k.senderConnectionId,"Connection not found for connectionId "+k.senderConnectionId+" owning endpoint "+k.endpointName+". Ice candidate will be ignored: "+F).then(function(M){var I=M.stream;I.getWebRtcPeer().addIceCandidate(F).catch(function(N){S.error("Error adding candidate for "+I.streamId+" stream of endpoint "+k.endpointName+": "+N)})}).catch(function(M){S.error(M)})},L.prototype.onSessionClosed=function(k){S.info("Session closed: "+JSON.stringify(k));var D=k.sessionId;D!==void 0?this.ee.emitEvent("session-closed",[{session:D}]):S.warn("Session undefined on session closed",k)},L.prototype.onLostConnection=function(k){S.warn("Lost connection in Session "+this.sessionId),this.sessionId&&this.connection&&!this.connection.disposed&&this.leave(!0,k)},L.prototype.onRecoveredConnection=function(){S.info("Recovered connection in Session "+this.sessionId),this.reconnectBrokenStreams(),this.ee.emitEvent("reconnected",[])},L.prototype.onMediaError=function(k){S.error("Media error: "+JSON.stringify(k));var D=k.error;D?this.ee.emitEvent("error-media",[{error:D}]):S.warn("Received undefined media error:",k)},L.prototype.onRecordingStarted=function(k){this.ee.emitEvent("recordingStarted",[new c.RecordingEvent(this,"recordingStarted",k.id,k.name)])},L.prototype.onRecordingStopped=function(k){this.ee.emitEvent("recordingStopped",[new c.RecordingEvent(this,"recordingStopped",k.id,k.name,k.reason)])},L.prototype.onBroadcastStarted=function(){this.ee.emitEvent("broadcastStarted",[])},L.prototype.onBroadcastStopped=function(){this.ee.emitEvent("broadcastStopped",[])},L.prototype.onFilterEventDispatched=function(k){var D=this,F=k.connectionId;this.getConnection(F,"No connection found for connectionId "+F).then(function(M){S.info('Filter event of type "'.concat(k.eventType,'" dispatched'));var I=M.stream;if(!I||!I.filter)return S.error('Filter event of type "'.concat(k.eventType,'" dispatched for stream ').concat(I.streamId," but there is no ").concat(I?"filter":"stream"," defined"));var N=I.filter.handlers.get(k.eventType);if(!N||typeof N!="function"){var j=Array.from(I.filter.handlers.keys());return S.error('Filter event of type "'.concat(k.eventType,'" not handled or not a function! Active filter events: ').concat(j.join(",")))}else N.call(D,new u.FilterEvent(I.filter,k.eventType,k.data))})},L.prototype.onForciblyReconnectSubscriber=function(k){var D=this;return new Promise(function(F,M){D.getRemoteConnection(k.connectionId,"onForciblyReconnectSubscriber").then(function(I){if(I.stream&&I.stream.streamId===k.streamId){var N=I.stream;if(N.setupReconnectionEventEmitter(F,M)){if(N.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent!=null)return N.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent=k,M("Ongoing forced subscriber reconnection");N.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent=k;var j=function(){var A=N.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent;delete N.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent,D.onForciblyReconnectSubscriber(A)};N.reconnectionEventEmitter.once("success",function(){j()}),N.reconnectionEventEmitter.once("error",function(){j()});return}N.completeWebRtcPeerReceive(!0,!0,k.sdpOffer).then(function(){return N.finalResolveForSubscription(!0,F)}).catch(function(A){return N.finalRejectForSubscription(!0,"Error while forcibly reconnecting remote stream ".concat(k.streamId,": ").concat(A.toString()),M)})}else{var P="No stream with streamId '"+k.streamId+"' found for connection '"+k.connectionId+"' on 'streamPropertyChanged' event";return S.error(P),M(P)}}).catch(function(I){return S.error(I),M(I)})})},L.prototype.reconnectBrokenStreams=function(){S.info("Re-establishing media connections...");var k=!1;this.connection.stream&&this.connection.stream.streamIceConnectionStateBroken()&&(S.warn("Re-establishing Publisher "+this.connection.stream.streamId),this.connection.stream.initWebRtcPeerSend(!0),k=!0),this.remoteConnections.forEach(function(D){D.stream&&D.stream.streamIceConnectionStateBroken()&&(S.warn("Re-establishing Subscriber "+D.stream.streamId),D.stream.initWebRtcPeerReceive(!0),k=!0)}),k||S.info("There were no media streams in need of a reconnection")},L.prototype.onSpeechToTextMessage=function(k){return t(this,void 0,void 0,function(){var D,F;return n(this,function(M){switch(M.label){case 0:return[4,this.getConnection(k.connectionId,"No connection found for connectionId "+k.connectionId)];case 1:return D=M.sent(),F=new f.SpeechToTextEvent(this,D,k.text,k.reason.toLowerCase(),k.raw,k.lang),this.ee.emitEvent("speechToTextMessage",[F]),[2]}})})},L.prototype.onSpeechToTextDisconnected=function(k){return t(this,void 0,void 0,function(){return n(this,function(D){return this.emitEvent("exception",[new R.ExceptionEvent(this,R.ExceptionEventName.SPEECH_TO_TEXT_DISCONNECTED,this,k.message)]),[2]})})},L.prototype.emitEvent=function(k,D){this.ee.emitEvent(k,D)},L.prototype.leave=function(k,D){var F=this;if(k=!!k,S.info("Leaving Session (forced="+k+")"),this.stopVideoDataIntervals(),this.connection){if(!this.connection.disposed&&!k?this.openvidu.sendRequest("leaveRoom",function(I,N){I&&S.error("leaveRoom error: ".concat(JSON.stringify(I))),F.openvidu.closeWs()}):this.openvidu.closeWs(),this.stopPublisherStream(D),!this.connection.disposed){var M=new l.SessionDisconnectedEvent(this,D);this.ee.emitEvent("sessionDisconnected",[M]),M.callDefaultBehavior()}}else S.warn("You were not connected to the session "+this.sessionId);S.flush()},L.prototype.initializeParams=function(k){var D={token:k||"",session:this.sessionId,platform:_.getDescription()?_.getDescription():"unknown",sdkVersion:this.openvidu.libraryVersion,metadata:this.options.metadata?this.options.metadata:"",secret:this.openvidu.getSecret(),recorder:this.openvidu.getRecorder(),stt:this.openvidu.getStt()};return D},L.prototype.sendVideoData=function(k,D,F,M){var I=this,N,j;if(D===void 0&&(D=1),F===void 0&&(F=!1),M===void 0&&(M=1),_.isChromeBrowser()||_.isChromeMobileBrowser()||_.isOperaBrowser()||_.isOperaMobileBrowser()||_.isEdgeBrowser()||_.isEdgeMobileBrowser()||_.isElectron()||_.isSafariBrowser()&&!_.isIonicIos()||_.isAndroidBrowser()||_.isSamsungBrowser()||_.isIonicAndroid()||_.isIOSWithSafari()){var P=function(){return t(I,void 0,void 0,function(){var U,H,q;return n(this,function(Q){switch(Q.label){case 0:return U=k.stream.getRTCPeerConnection(),U.connectionState!=="connected"?[3,2]:[4,U.getStats()];case 1:H=Q.sent(),q=[],H.forEach(function(V){"frameWidth"in V&&"frameHeight"in V&&q.length===0&&q.push(V)}),q.length>0&&this.openvidu.sendRequest("videoData",{height:q[0].frameHeight,width:q[0].frameWidth,videoActive:k.stream.videoActive!=null?k.stream.videoActive:!1,audioActive:k.stream.audioActive!=null?k.stream.audioActive:!1},function(V,re){V&&S.error("Error sending 'videoData' event",V)}),Q.label=2;case 2:return[2]}})})};if(F){var A=1;this.videoDataInterval=setInterval(function(){A<M?(A++,P()):clearInterval(I.videoDataInterval)},D*1e3)}else this.videoDataTimeout=setTimeout(P,D*1e3)}else _.isFirefoxBrowser()||_.isFirefoxMobileBrowser()||_.isIonicIos()||_.isReactNative()?this.openvidu.sendRequest("videoData",{height:((N=k.stream.videoDimensions)===null||N===void 0?void 0:N.height)||0,width:((j=k.stream.videoDimensions)===null||j===void 0?void 0:j.width)||0,videoActive:k.stream.videoActive!=null?k.stream.videoActive:!1,audioActive:k.stream.audioActive!=null?k.stream.audioActive:!1},function(U,H){U&&S.error("Error sending 'videoData' event",U)}):S.error("Browser "+_.getName()+" (version "+_.getVersion()+") for "+_.getFamily()+" is not supported in OpenVidu for Network Quality")},L.prototype.sessionConnected=function(){return this.connection!=null},L.prototype.notConnectedError=function(){return new v.OpenViduError(v.OpenViduErrorName.OPENVIDU_NOT_CONNECTED,"There is no connection to the session. Method 'Session.connect' must be successfully completed first")},L.prototype.anySpeechEventListenerEnabled=function(k,D,F){var M=this.ee.getListeners(k);D&&(M=M.filter(function(P){return P.once}));var I=M.length;if(I>0)return!0;var N=0;if(F){var j=F.ee.getListeners(k);D&&(j=j.filter(function(P){return P.once})),N=j.length}return N>0},L.prototype.getTokenParams=function(k){var D=k.match(/^(wss?)\:\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);if(D){var F={protocol:D[1],host:D[2],hostname:D[3],port:D[4],pathname:D[5],search:D[6],hash:D[7]},M=k.split("?"),I=decodeURI(M[1]).split("&").map(function(N){return N.split("=")}).reduce(function(N,j){var P=j[0],A=j[1];return N[P]=A,N},{});return{sessionId:I.sessionId,secret:I.secret,recorder:I.recorder,stt:I.stt,webrtcStatsInterval:I.webrtcStatsInterval,sendBrowserLogs:I.sendBrowserLogs,edition:I.edition,wsUri:F.protocol+"://"+F.host+"/openvidu",httpUri:"https://"+F.host}}else throw new Error('Token not valid: "'.concat(k,'"'))},L.prototype.connectAux=function(k){var D=this;return new Promise(function(F,M){D.openvidu.startWs(function(I){if(I)return M(I);var N=D.initializeParams(k);D.openvidu.sendRequest("joinRoom",N,function(j,P){if(j)return M(j);D.processJoinRoomResponse(P,k),D.connection=new r.Connection(D,P);var A={connections:new Array,streams:new Array},U=P.value;return U.forEach(function(H){var q=new r.Connection(D,H);D.remoteConnections.set(q.connectionId,q),A.connections.push(q),q.stream&&(D.remoteStreamsCreated.set(q.stream.streamId,!0),A.streams.push(q.stream))}),D.ee.emitEvent("connectionCreated",[new s.ConnectionEvent(!1,D,"connectionCreated",D.connection,"")]),A.connections.forEach(function(H){D.ee.emitEvent("connectionCreated",[new s.ConnectionEvent(!1,D,"connectionCreated",H,"")])}),A.streams.forEach(function(H){D.ee.emitEvent("streamCreated",[new h.StreamEvent(!1,D,"streamCreated",H,"")])}),P.recordingId&&P.recordingName&&D.ee.emitEvent("recordingStarted",[new c.RecordingEvent(D,"recordingStarted",P.recordingId,P.recordingName)]),F()})})})},L.prototype.stopPublisherStream=function(k){this.connection.stream&&(this.connection.stream.disposeWebRtcPeer(),this.connection.stream.isLocalStreamPublished&&this.connection.stream.ee.emitEvent("local-stream-destroyed",[k]))},L.prototype.stopVideoDataIntervals=function(){clearInterval(this.videoDataInterval),clearTimeout(this.videoDataTimeout)},L.prototype.stringClientMetadata=function(k){return typeof k!="string"?JSON.stringify(k):k},L.prototype.getConnection=function(k,D){var F=this;return new Promise(function(M,I){var N=F.remoteConnections.get(k);return N?M(N):F.connection.connectionId===k?M(F.connection):I(new v.OpenViduError(v.OpenViduErrorName.GENERIC_ERROR,D))})},L.prototype.getRemoteConnection=function(k,D){var F=this;return new Promise(function(M,I){var N=F.remoteConnections.get(k);if(N)return M(N);var j="Remote connection "+k+" unknown when '"+D+"'. Existing remote connections: "+JSON.stringify(F.remoteConnections.keys());return I(new v.OpenViduError(v.OpenViduErrorName.GENERIC_ERROR,j))})},L.prototype.processToken=function(k){var D=this.getTokenParams(k);this.sessionId=D.sessionId,D.secret&&(this.openvidu.secret=D.secret),D.recorder&&(this.openvidu.recorder=!0),D.stt&&(this.openvidu.stt=!0),D.webrtcStatsInterval&&(this.openvidu.webrtcStatsInterval=D.webrtcStatsInterval),D.sendBrowserLogs&&(this.openvidu.sendBrowserLogs=D.sendBrowserLogs),this.openvidu.isAtLeastPro=D.edition==="pro"||D.edition==="enterprise",this.openvidu.isEnterprise=D.edition==="enterprise",this.openvidu.wsUri=D.wsUri,this.openvidu.httpUri=D.httpUri},L.prototype.processJoinRoomResponse=function(k,D){if(this.sessionId=k.session,k.customIceServers!=null&&k.customIceServers.length>0){this.openvidu.iceServers=[];for(var F=0,M=k.customIceServers;F<M.length;F++){var I=M[F],N={urls:[I.url]};S.log("STUN/TURN server IP: "+I.url),I.username!=null&&I.credential!=null&&(N.username=I.username,N.credential=I.credential,S.log("TURN credentials ["+I.username+":"+I.credential+"]")),this.openvidu.iceServers.push(N)}}this.openvidu.role=k.role,this.openvidu.finalUserId=k.finalUserId,this.openvidu.mediaServer=k.mediaServer,this.openvidu.videoSimulcast=k.videoSimulcast,this.capabilities={subscribe:!0,publish:this.openvidu.role!=="SUBSCRIBER",forceUnpublish:this.openvidu.role==="MODERATOR",forceDisconnect:this.openvidu.role==="MODERATOR"},S.info("openvidu-server version: "+k.version),k.life!=null&&(this.openvidu.life=k.life);var j=x(k.version)-x(this.openvidu.libraryVersion);E(k.version)!==E(this.openvidu.libraryVersion)||!(j==0||j==1)?S.error("openvidu-browser (".concat(this.openvidu.libraryVersion,") and openvidu-server (").concat(k.version,") versions are incompatible. ")+"Errors are likely to occur. openvidu-browser SDK is only compatible with the same version or the immediately following minor version of an OpenVidu deployment"):j==1&&S.warn("openvidu-browser version ".concat(this.openvidu.libraryVersion," does not match openvidu-server version ").concat(k.version,". ")+"These versions are still compatible with each other, but openvidu-browser version must be updated as soon as possible to ".concat(E(k.version),".").concat(x(k.version),".x. ")+"This client using openvidu-browser ".concat(this.openvidu.libraryVersion," will become incompatible with the next release of openvidu-server")),b.OpenViduLogger.configureJSNLog(this.openvidu,D),this.token=D},L}(a.EventDispatcher);return sl.Session=T,sl}var n_;function Jw(){if(n_)return al;n_=1;var e=me&&me.__extends||function(){var m=function(g,v){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,b){y.__proto__=b}||function(y,b){for(var w in b)Object.prototype.hasOwnProperty.call(b,w)&&(y[w]=b[w])},m(g,v)};return function(g,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");m(g,v);function y(){this.constructor=g}g.prototype=v===null?Object.create(v):(y.prototype=v.prototype,new y)}}(),t=me&&me.__awaiter||function(m,g,v,y){function b(w){return w instanceof v?w:new v(function(E){E(w)})}return new(v||(v=Promise))(function(w,E){function x(_){try{S(y.next(_))}catch(T){E(T)}}function R(_){try{S(y.throw(_))}catch(T){E(T)}}function S(_){_.done?w(_.value):b(_.value).then(x,R)}S((y=y.apply(m,g||[])).next())})},n=me&&me.__generator||function(m,g){var v={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},y,b,w,E;return E={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function x(S){return function(_){return R([S,_])}}function R(S){if(y)throw new TypeError("Generator is already executing.");for(;E&&(E=0,S[0]&&(v=0)),v;)try{if(y=1,b&&(w=S[0]&2?b.return:S[0]?b.throw||((w=b.return)&&w.call(b),0):b.next)&&!(w=w.call(b,S[1])).done)return w;switch(b=0,w&&(S=[S[0]&2,w.value]),S[0]){case 0:case 1:w=S;break;case 4:return v.label++,{value:S[1],done:!1};case 5:v.label++,b=S[1],S=[0];continue;case 7:S=v.ops.pop(),v.trys.pop();continue;default:if(w=v.trys,!(w=w.length>0&&w[w.length-1])&&(S[0]===6||S[0]===2)){v=0;continue}if(S[0]===3&&(!w||S[1]>w[0]&&S[1]<w[3])){v.label=S[1];break}if(S[0]===6&&v.label<w[1]){v.label=w[1],w=S;break}if(w&&v.label<w[2]){v.label=w[2],v.ops.push(S);break}w[2]&&v.ops.pop(),v.trys.pop();continue}S=g.call(m,v)}catch(_){S=[6,_],b=0}finally{y=w=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}};Object.defineProperty(al,"__esModule",{value:!0}),al.Publisher=void 0;var r=Nm(),i=Nc,o=Mc,a=Qw(),s=Ao,u=js,c=ln,l=Pi,d=Pm,f=c.OpenViduLogger.getInstance(),h,p=function(m){e(g,m);function g(v,y,b){var w=m.call(this,new i.Stream(b.session?b.session:new r.Session(b),{publisherProperties:y,mediaConstraints:{}}),v)||this;return w.accessAllowed=!1,w.isSubscribedToRemote=!1,w.accessDenied=!1,h=l.PlatformUtils.getInstance(),w.properties=y,w.openvidu=b,w.stream.ee.on("local-stream-destroyed",function(E){w.stream.isLocalStreamPublished=!1;var x=new a.StreamEvent(!0,w,"streamDestroyed",w.stream,E);w.emitEvent("streamDestroyed",[x]),x.callDefaultBehavior()}),w}return g.prototype.publishAudio=function(v){var y=this;if(this.stream.audioActive!==v){var b=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream();b.getAudioTracks().forEach(function(w){w.enabled=v}),this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"audioActive",newValue:v,reason:"publishAudio"},function(w,E){w?f.error("Error sending 'streamPropertyChanged' event",w):(y.session.emitEvent("streamPropertyChanged",[new s.StreamPropertyChangedEvent(y.session,y.stream,"audioActive",v,!v,"publishAudio")]),y.emitEvent("streamPropertyChanged",[new s.StreamPropertyChangedEvent(y,y.stream,"audioActive",v,!v,"publishAudio")]),y.session.sendVideoData(y.stream.streamManager))}),this.stream.audioActive=v,f.info("'Publisher' has "+(v?"published":"unpublished")+" its audio stream")}},g.prototype.publishVideo=function(v,y){var b=this;return new Promise(function(w,E){return t(b,void 0,void 0,function(){var x,R,S,_,T,B,L=this;return n(this,function(k){switch(k.label){case 0:return this.stream.videoActive===v?[3,9]:(x=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream(),R=!1,x.getVideoTracks().forEach(function(D){D.enabled=v,!v&&y===!0?D.stop():v&&D.readyState==="ended"&&(R=!0)}),!v&&y===!0&&this.stream.filter&&this.stream.filter.type.startsWith("VB:")?(this.stream.lastVBFilter=this.stream.filter,[4,this.stream.removeFilterAux(!0)]):[3,2]);case 1:k.sent(),k.label=2;case 2:return R?(S=x.getVideoTracks()[0],x.removeTrack(S),_=function(D){return t(L,void 0,void 0,function(){var F=this;return n(this,function(M){switch(M.label){case 0:return x.addTrack(D),this.stream.isLocalStreamPublished?[4,this.replaceTrackInRtcRtpSender(D)]:[3,2];case 1:M.sent(),M.label=2;case 2:return this.stream.lastVBFilter&&setTimeout(function(){return t(F,void 0,void 0,function(){var I,N;return n(this,function(j){switch(j.label){case 0:return I=this.stream.lastVBFilter.options,N=this.stream.lastVBFilter.lastExecMethod,N&&N.method==="update"&&(I=Object.assign({},I,N.params)),[4,this.stream.applyFilter(this.stream.lastVBFilter.type,I)];case 1:return j.sent(),delete this.stream.lastVBFilter,[2]}})})},1),[2]}})})},y&&y instanceof MediaStreamTrack?[4,_(y)]:[3,4]):[3,8];case 3:return k.sent(),[3,8];case 4:return k.trys.push([4,7,,8]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:this.stream.lastVideoTrackConstraints})];case 5:return T=k.sent(),[4,_(T.getVideoTracks()[0])];case 6:return k.sent(),[3,8];case 7:return B=k.sent(),[2,E(B)];case 8:return this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"videoActive",newValue:v,reason:"publishVideo"},function(D,F){D?f.error("Error sending 'streamPropertyChanged' event",D):(L.session.emitEvent("streamPropertyChanged",[new s.StreamPropertyChangedEvent(L.session,L.stream,"videoActive",v,!v,"publishVideo")]),L.emitEvent("streamPropertyChanged",[new s.StreamPropertyChangedEvent(L,L.stream,"videoActive",v,!v,"publishVideo")]),L.session.sendVideoData(L.stream.streamManager))}),this.stream.videoActive=v,f.info("'Publisher' has "+(v?"published":"unpublished")+" its video stream"),[2,w()];case 9:return[2]}})})})},g.prototype.subscribeToRemote=function(v){v=v!==void 0?v:!0,this.isSubscribedToRemote=v,this.stream.subscribeToMyRemote(v)},g.prototype.on=function(v,y){var b=this;return m.prototype.on.call(this,v,y),v==="streamCreated"&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new a.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.on("stream-created-by-publisher",function(){b.emitEvent("streamCreated",[new a.StreamEvent(!1,b,"streamCreated",b.stream,"")])})),v==="accessAllowed"&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),v==="accessDenied"&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},g.prototype.once=function(v,y){var b=this;return m.prototype.once.call(this,v,y),v==="streamCreated"&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new a.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.once("stream-created-by-publisher",function(){b.emitEvent("streamCreated",[new a.StreamEvent(!1,b,"streamCreated",b.stream,"")])})),v==="accessAllowed"&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),v==="accessDenied"&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},g.prototype.off=function(v,y){return m.prototype.off.call(this,v,y),this},g.prototype.replaceTrack=function(v){return t(this,void 0,void 0,function(){return n(this,function(y){return[2,this.replaceTrackAux(v,!0)]})})},g.prototype.initialize=function(){var v=this;return new Promise(function(y,b){return t(v,void 0,void 0,function(){var w,E,x,R,S,_,T,B,L,k,D,F,F,M,I,N=this,j,P;return n(this,function(A){switch(A.label){case 0:w={},E={},x=2e3,S=function(U){return N.accessDenied=!0,N.accessAllowed=!1,f.error("Publisher initialization failed. ".concat(U.name,": ").concat(U.message)),b(U)},_=function(U){var H,q;if(N.accessAllowed=!0,N.accessDenied=!1,typeof MediaStreamTrack<"u"&&N.properties.audioSource instanceof MediaStreamTrack&&(U.removeTrack(U.getAudioTracks()[0]),U.addTrack(N.properties.audioSource)),typeof MediaStreamTrack<"u"&&N.properties.videoSource instanceof MediaStreamTrack&&(U.removeTrack(U.getVideoTracks()[0]),U.addTrack(N.properties.videoSource)),U.getAudioTracks()[0]){var Q=N.stream.audioActive!==void 0&&N.stream.audioActive!==null?N.stream.audioActive:!!N.stream.outboundStreamOpts.publisherProperties.publishAudio;U.getAudioTracks()[0].enabled=Q}if(U.getVideoTracks()[0]){var Q=N.stream.videoActive!==void 0&&N.stream.videoActive!==null?N.stream.videoActive:!!N.stream.outboundStreamOpts.publisherProperties.publishVideo;U.getVideoTracks()[0].enabled=Q}for(var V=0,re=U.getAudioTracks();V<re.length;V++){var Z=re[V];!((H=Z.contentHint)===null||H===void 0)&&H.length||(Z.contentHint="",f.info("Audio track Content Hint set: '".concat(Z.contentHint,"'")))}for(var he=0,xe=U.getVideoTracks();he<xe.length;he++){var Z=xe[he];if(!(!((q=Z.contentHint)===null||q===void 0)&&q.length)){switch(N.stream.typeOfVideo){case d.TypeOfVideo.SCREEN:Z.contentHint="detail";break;case d.TypeOfVideo.CUSTOM:f.warn("CUSTOM type video track was provided without Content Hint!"),Z.contentHint="motion";break;case d.TypeOfVideo.CAMERA:case d.TypeOfVideo.IPCAM:default:Z.contentHint="motion";break}f.info("Video track Content Hint set: '".concat(Z.contentHint,"'"))}}return N.initializeVideoReference(U),N.stream.displayMyRemote()||N.stream.updateMediaStreamInVideos(),delete N.firstVideoElement,N.stream.isSendVideo()?N.getVideoDimensions().then(function(ie){N.stream.videoDimensions={width:ie.width,height:ie.height},N.stream.isSendScreen()&&(N.stream.isSendAudio()&&U.getAudioTracks().length===0&&(N.stream.audioActive=!1,N.stream.hasAudio=!1,N.stream.outboundStreamOpts.publisherProperties.publishAudio=!1,N.stream.outboundStreamOpts.publisherProperties.audioSource=!1),N.screenShareResizeInterval=setInterval(function(){var pe=U.getVideoTracks()[0].getSettings(),ce=pe.width,Y=pe.height,de=ce!=null&&ce!==N.stream.videoDimensions.width,be=Y!=null&&Y!==N.stream.videoDimensions.height;N.stream.isLocalStreamPublished&&(de||be)&&N.openvidu.sendVideoDimensionsChangedEvent(N,"screenResized",N.stream.videoDimensions.width,N.stream.videoDimensions.height,ce||0,Y||0)},650)),N.stream.isLocalStreamReadyToPublish=!0,N.stream.ee.emitEvent("stream-ready-to-publish",[])}):(N.stream.isLocalStreamReadyToPublish=!0,N.stream.ee.emitEvent("stream-ready-to-publish",[])),y()},T=function(U,H){return t(N,void 0,void 0,function(){var q,Q;return n(this,function(V){switch(V.label){case 0:if(this.clearPermissionDialogTimer(R,x),!(this.stream.isSendScreen()&&this.properties.audioSource!=="screen"&&this.stream.isSendAudio()))return[3,5];E.audio=H,E.video=!1,R=Date.now(),this.setPermissionDialogTimer(x),V.label=1;case 1:return V.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia(E)];case 2:return q=V.sent(),this.clearPermissionDialogTimer(R,x),U.addTrack(q.getAudioTracks()[0]),_(U),[3,4];case 3:return Q=V.sent(),this.clearPermissionDialogTimer(R,x),U.getAudioTracks().forEach(function(re){re.stop()}),U.getVideoTracks().forEach(function(re){re.stop()}),S(this.openvidu.generateAudioDeviceError(Q,w)),[2];case 4:return[3,6];case 5:_(U),V.label=6;case 6:return[2]}})})},B=function(U){return t(N,void 0,void 0,function(){var H,q,Q,re,V,re,Z;return n(this,function(he){switch(he.label){case 0:switch(f.error("getMediaError: ".concat(U.toString())),this.clearPermissionDialogTimer(R,x),U.name==="Error"&&(U.name=U.constructor.name),Q=U.name.toLowerCase(),Q){case"notfounderror":return[3,1];case"notallowederror":return[3,5];case"overconstrainederror":return[3,6];case"aborterror":return[3,10];case"notreadableerror":return[3,10]}return[3,11];case 1:return he.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:w.video})];case 2:return re=he.sent(),re.getVideoTracks().forEach(function(xe){xe.stop()}),H=u.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,q=U.toString(),S(new u.OpenViduError(H,q)),[3,4];case 3:return V=he.sent(),H=u.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,q=V.toString(),S(new u.OpenViduError(H,q)),[3,4];case 4:return[3,12];case 5:return H=this.stream.isSendScreen()?u.OpenViduErrorName.SCREEN_CAPTURE_DENIED:u.OpenViduErrorName.DEVICE_ACCESS_DENIED,q=U.toString(),S(new u.OpenViduError(H,q)),[3,12];case 6:return he.trys.push([6,8,,9]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:w.video})];case 7:return re=he.sent(),re.getVideoTracks().forEach(function(xe){xe.stop()}),U.constraint.toLowerCase()==="deviceid"?(H=u.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,q="Audio input device with deviceId '"+w.audio.deviceId.exact+"' not found"):(H=u.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,q="Audio input device doesn't support the value passed for constraint '"+U.constraint+"'"),S(new u.OpenViduError(H,q)),[3,9];case 8:return Z=he.sent(),Z.constraint.toLowerCase()==="deviceid"?(H=u.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,q="Video input device with deviceId '"+w.video.deviceId.exact+"' not found"):(H=u.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,q="Video input device doesn't support the value passed for constraint '"+Z.constraint+"'"),S(new u.OpenViduError(H,q)),[3,9];case 9:return[3,12];case 10:return H=u.OpenViduErrorName.DEVICE_ALREADY_IN_USE,q=U.toString(),S(new u.OpenViduError(H,q)),[3,12];case 11:return H=u.OpenViduErrorName.GENERIC_ERROR,q=U.toString(),S(new u.OpenViduError(H,q)),[3,12];case 12:return[2]}})})},A.label=1;case 1:return A.trys.push([1,14,,15]),[4,this.openvidu.generateMediaConstraints(this.properties)];case 2:return L=A.sent(),L.videoTrack&&L.audioTrack||L.audioTrack&&((j=L.constraints)===null||j===void 0?void 0:j.video)===!1||L.videoTrack&&((P=L.constraints)===null||P===void 0?void 0:P.audio)===!1?(_(this.openvidu.addAlreadyProvidedTracks(L,new MediaStream,this.stream)),[3,13]):[3,3];case 3:w=L.constraints,k={mediaConstraints:w,publisherProperties:this.properties},this.stream.setOutboundStreamOptions(k),D=w.audio===void 0?!0:w.audio,E.audio=this.stream.isSendScreen()?!1:D,E.video=w.video,R=Date.now(),this.setPermissionDialogTimer(x),A.label=4;case 4:return A.trys.push([4,11,,13]),this.stream.isSendScreen()&&navigator.mediaDevices.getDisplayMedia&&!h.isElectron()?[4,navigator.mediaDevices.getDisplayMedia({video:!0,audio:this.properties.audioSource==="screen"})]:[3,7];case 5:return F=A.sent(),this.openvidu.addAlreadyProvidedTracks(L,F),[4,T(F,D)];case 6:return A.sent(),[3,10];case 7:return this.stream.lastVideoTrackConstraints=E.video,[4,navigator.mediaDevices.getUserMedia(E)];case 8:return F=A.sent(),this.openvidu.addAlreadyProvidedTracks(L,F,this.stream),[4,T(F,D)];case 9:A.sent(),A.label=10;case 10:return[3,13];case 11:return M=A.sent(),[4,B(M)];case 12:return A.sent(),[3,13];case 13:return[3,15];case 14:return I=A.sent(),S(I),[3,15];case 15:return[2]}})})})},g.prototype.replaceTrackAux=function(v,y){return t(this,void 0,void 0,function(){var b,w;return n(this,function(E){switch(E.label){case 0:b=v.enabled,v.kind==="video"?v.enabled=this.stream.videoActive:v.kind==="audio"&&(v.enabled=this.stream.audioActive),E.label=1;case 1:return E.trys.push([1,5,,6]),this.stream.isLocalStreamPublished?(this.replaceTrackInMediaStream(v,y),[4,this.replaceTrackInRtcRtpSender(v)]):[3,3];case 2:return[2,E.sent()];case 3:return[2,this.replaceTrackInMediaStream(v,y)];case 4:return[3,6];case 5:throw w=E.sent(),v.enabled=b,w;case 6:return[2]}})})},g.prototype.getVideoDimensions=function(){var v=this;return new Promise(function(y,b){var w=(h.isIonicIos()||h.isIOSWithSafari())&&v.videoReference.readyState<1,E,x=function(){var R,S;if(typeof v.stream.getMediaStream().getVideoTracks()[0].getSettings=="function"){var _=v.stream.getMediaStream().getVideoTracks()[0].getSettings();R=_.width||v.videoReference.videoWidth,S=_.height||v.videoReference.videoHeight}else f.warn("MediaStreamTrack does not have getSettings method on "+h.getDescription()),R=v.videoReference.videoWidth,S=v.videoReference.videoHeight;return E!=null&&v.videoReference.removeEventListener("loadedmetadata",E),w&&document.body.removeChild(v.videoReference),y({width:R,height:S})};v.videoReference.readyState>=1?x():(E=function(){if(v.videoReference.videoWidth)x();else var R=setInterval(function(){v.videoReference.videoWidth&&(clearInterval(R),x())},40)},v.videoReference.addEventListener("loadedmetadata",E),w&&document.body.appendChild(v.videoReference))})},g.prototype.reestablishStreamPlayingEvent=function(){this.ee.getListeners("streamPlaying").length>0&&this.addPlayEventToFirstVideo()},g.prototype.initializeVideoReference=function(v){this.videoReference=document.createElement("video"),this.videoReference.style.display="none",this.videoReference.muted=!0,this.videoReference.autoplay=!0,this.videoReference.controls=!1,(h.isSafariBrowser()||h.isIPhoneOrIPad()&&(h.isChromeMobileBrowser()||h.isEdgeMobileBrowser()||h.isOperaMobileBrowser()||h.isFirefoxMobileBrowser()))&&(this.videoReference.playsInline=!0),this.stream.setMediaStream(v),this.firstVideoElement&&this.createVideoElement(this.firstVideoElement.targetElement,this.properties.insertMode),this.videoReference.srcObject=this.stream.getMediaStream()},g.prototype.replaceTrackInMediaStream=function(v,y){var b=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream(),w;v.kind==="video"?(w=b.getVideoTracks()[0],y&&(this.stream.lastVideoTrackConstraints=v.getConstraints())):w=b.getAudioTracks()[0],w.enabled=!1,w.stop(),b.removeTrack(w),b.addTrack(v);var E={oldLabel:(w==null?void 0:w.label)||"",newLabel:(v==null?void 0:v.label)||""};v.kind==="video"&&y?(this.openvidu.sendNewVideoDimensionsIfRequired(this,"trackReplaced",50,30),this.openvidu.sendTrackChangedEvent(this,E.oldLabel,E.newLabel,"videoTrack"),this.stream.isLocalStreamPublished&&this.session.sendVideoData(this.stream.streamManager,5,!0,5)):v.kind==="audio"&&y&&this.openvidu.sendTrackChangedEvent(this,E.oldLabel,E.newLabel,"audioTrack"),v.kind==="audio"&&(this.stream.disableHarkSpeakingEvent(!1),this.stream.disableHarkStoppedSpeakingEvent(!1),this.stream.disableHarkVolumeChangeEvent(!1),this.stream.initHarkEvents())},g.prototype.setPermissionDialogTimer=function(v){var y=this;this.permissionDialogTimeout=setTimeout(function(){y.emitEvent("accessDialogOpened",[])},v)},g.prototype.clearPermissionDialogTimer=function(v,y){clearTimeout(this.permissionDialogTimeout),Date.now()-v>y&&this.emitEvent("accessDialogClosed",[])},g.prototype.replaceTrackInRtcRtpSender=function(v){return t(this,void 0,void 0,function(){var y,b;return n(this,function(w){switch(w.label){case 0:if(y=this.stream.getRTCPeerConnection().getSenders(),v.kind==="video"){if(b=y.find(function(E){return!!E.track&&E.track.kind==="video"}),!b)throw new Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object")}else if(v.kind==="audio"){if(b=y.find(function(E){return!!E.track&&E.track.kind==="audio"}),!b)throw new Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object")}else throw new Error("Unknown track kind "+v.kind);return[4,b.replaceTrack(v)];case 1:return w.sent(),[2]}})})},g}(o.StreamManager);return al.Publisher=p,al}var uN={};globalThis.getScreenId=function(e,t,n){if(navigator.userAgent.indexOf("Edge")!==-1&&(navigator.msSaveOrOpenBlob||navigator.msSaveBlob)){t({video:!0});return}if(navigator.mozGetUserMedia){t(null,"firefox",{video:{mozMediaSource:e,mediaSource:e}});return}globalThis.addEventListener("message",r);function r(i){i.data&&(i.data.chromeMediaSourceId&&(i.data.chromeMediaSourceId==="PermissionDeniedError"?t("permission-denied"):t(null,i.data.chromeMediaSourceId,r_(null,i.data.chromeMediaSourceId,i.data.canRequestAudioTrack)),globalThis.removeEventListener("message",r)),i.data.chromeExtensionStatus&&(t(i.data.chromeExtensionStatus,null,r_(i.data.chromeExtensionStatus)),globalThis.removeEventListener("message",r)))}setTimeout(n?function(){Xp(n)}:Xp,100)};function r_(e,t,n){var r={audio:!1,video:{mandatory:{chromeMediaSource:e?"screen":"desktop",maxWidth:globalThis.screen.width>1920?globalThis.screen.width:1920,maxHeight:globalThis.screen.height>1080?globalThis.screen.height:1080},optional:[]}};return n&&(r.audio={mandatory:{chromeMediaSource:e?"screen":"desktop"},optional:[]}),t&&(r.video.mandatory.chromeMediaSourceId=t,r.audio&&r.audio.mandatory&&(r.audio.mandatory.chromeMediaSourceId=t)),r}function Xp(e){if(!ar){Zw(function(){Xp(e)});return}if(!ar.isLoaded){setTimeout(function(){Xp(e)},100);return}e?e.forEach?ar.contentWindow.postMessage({captureCustomSourceId:e},"*"):ar.contentWindow.postMessage({captureSourceIdWithAudio:!0},"*"):ar.contentWindow.postMessage({captureSourceId:!0},"*")}var ar;globalThis.getScreenConstraints=function(e){Zw(function(){getScreenId(function(t,n,r){r||(r={video:!0}),e(t,r.video)})})};function Zw(e){if(ar){e();return}ar=document.createElement("iframe"),ar.onload=function(){ar.isLoaded=!0,e()},ar.src="https://openvidu.github.io/openvidu-screen-sharing-chrome-extension/",ar.style.display="none",(document.body||document.documentElement).appendChild(ar)}globalThis.getChromeExtensionStatus=function(e){if(navigator.mozGetUserMedia){e("installed-enabled");return}globalThis.addEventListener("message",t);function t(n){n.data&&n.data.chromeExtensionStatus&&(e(n.data.chromeExtensionStatus),globalThis.removeEventListener("message",t))}setTimeout(z1,100)};function z1(){if(!ar){Zw(z1);return}if(!ar.isLoaded){setTimeout(z1,100);return}ar.contentWindow.postMessage({getChromeExtensionStatus:!0},"*")}uN.getScreenId=globalThis.getScreenId;var jc={},wa="screen",xa,Ou;if(typeof window<"u"&&typeof navigator<"u"&&typeof navigator.userAgent<"u"){var cN=typeof window.InstallTrigger<"u";window.opera||navigator.userAgent.indexOf(" OPR/")>=0,window.addEventListener("message",function(e){e.origin==window.location.origin&&SX(e.data)})}function SX(e){if(e=="PermissionDeniedError"){if(Ou)return Ou("PermissionDeniedError");throw new Error("PermissionDeniedError")}e=="rtcmulticonnection-extension-loaded"&&(wa="desktop"),e.sourceId&&Ou&&Ou(xa=e.sourceId,e.canRequestAudioTrack===!0)}function CX(e){if(e){if(wa=="desktop")return e(!0);window.postMessage("are-you-there","*"),setTimeout(function(){wa=="screen"?e(!1):e(!0)},2e3)}}function lN(e){if(!e)throw'"callback" parameter is mandatory.';if(xa)return e(xa);Ou=e,window.postMessage("get-sourceId","*")}function _X(e){if(!e)throw'"callback" parameter is mandatory.';if(xa)return e(xa);Ou=e,window.postMessage("audio-plus-tab","*")}function kX(e,t){if(cN)return t("not-chrome");arguments.length!=2&&(t=e,e="lfcgfepafnobdloecchnfaclibenjold");var n=document.createElement("img");n.src="chrome-extension://"+e+"/icon.png",n.onload=function(){wa="screen",window.postMessage("are-you-there","*"),setTimeout(function(){wa=="screen"?t("installed-disabled"):t("installed-enabled")},2e3)},n.onerror=function(){t("not-installed")}}function RX(e){dN(e,!0)}function dN(e,t){xa="";var n={mozMediaSource:"window",mediaSource:"window"};if(cN)return e(null,n);var r={mandatory:{chromeMediaSource:wa,maxWidth:screen.width>1920?screen.width:1920,maxHeight:screen.height>1080?screen.height:1080},optional:[]};if(wa=="desktop"&&!xa){t?_X(function(i,o){r.mandatory.chromeMediaSourceId=i,o&&(r.canRequestAudioTrack=!0),e(i=="PermissionDeniedError"?i:null,r)}):lN(function(i){r.mandatory.chromeMediaSourceId=i,e(i=="PermissionDeniedError"?i:null,r)});return}wa=="desktop"&&(r.mandatory.chromeMediaSourceId=xa),e(null,r)}jc.getScreenConstraints=dN;jc.getScreenConstraintsWithAudio=RX;jc.isChromeExtensionAvailable=CX;jc.getChromeExtensionStatus=kX;jc.getSourceId=lN;var ex={exports:{}},Vu=typeof Reflect=="object"?Reflect:null,i_=Vu&&typeof Vu.apply=="function"?Vu.apply:function(t,n,r){return Function.prototype.apply.call(t,n,r)},Wh;Vu&&typeof Vu.ownKeys=="function"?Wh=Vu.ownKeys:Object.getOwnPropertySymbols?Wh=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Wh=function(t){return Object.getOwnPropertyNames(t)};function IX(e){console&&console.warn&&console.warn(e)}var fN=Number.isNaN||function(t){return t!==t};function mt(){mt.init.call(this)}ex.exports=mt;ex.exports.once=NX;mt.EventEmitter=mt;mt.prototype._events=void 0;mt.prototype._eventsCount=0;mt.prototype._maxListeners=void 0;var o_=10;function Dm(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(mt,"defaultMaxListeners",{enumerable:!0,get:function(){return o_},set:function(e){if(typeof e!="number"||e<0||fN(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o_=e}});mt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};mt.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||fN(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function hN(e){return e._maxListeners===void 0?mt.defaultMaxListeners:e._maxListeners}mt.prototype.getMaxListeners=function(){return hN(this)};mt.prototype.emit=function(t){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=t==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var a;if(n.length>0&&(a=n[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var u=o[t];if(u===void 0)return!1;if(typeof u=="function")i_(u,this,n);else for(var c=u.length,l=yN(u,c),r=0;r<c;++r)i_(l[r],this,n);return!0};function pN(e,t,n,r){var i,o,a;if(Dm(n),o=e._events,o===void 0?(o=e._events=Object.create(null),e._eventsCount=0):(o.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),a===void 0)a=o[t]=n,++e._eventsCount;else if(typeof a=="function"?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),i=hN(e),i>0&&a.length>i&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=a.length,IX(s)}return e}mt.prototype.addListener=function(t,n){return pN(this,t,n,!1)};mt.prototype.on=mt.prototype.addListener;mt.prototype.prependListener=function(t,n){return pN(this,t,n,!0)};function TX(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function vN(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=TX.bind(r);return i.listener=n,r.wrapFn=i,i}mt.prototype.once=function(t,n){return Dm(n),this.on(t,vN(this,t,n)),this};mt.prototype.prependOnceListener=function(t,n){return Dm(n),this.prependListener(t,vN(this,t,n)),this};mt.prototype.removeListener=function(t,n){var r,i,o,a,s;if(Dm(n),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||n));else if(typeof r!="function"){for(o=-1,a=r.length-1;a>=0;a--)if(r[a]===n||r[a].listener===n){s=r[a].listener,o=a;break}if(o<0)return this;o===0?r.shift():OX(r,o),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,s||n)}return this};mt.prototype.off=mt.prototype.removeListener;mt.prototype.removeAllListeners=function(t){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var o=Object.keys(r),a;for(i=0;i<o.length;++i)a=o[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[t],typeof n=="function")this.removeListener(t,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(t,n[i]);return this};function mN(e,t,n){var r=e._events;if(r===void 0)return[];var i=r[t];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?PX(i):yN(i,i.length)}mt.prototype.listeners=function(t){return mN(this,t,!0)};mt.prototype.rawListeners=function(t){return mN(this,t,!1)};mt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):gN.call(e,t)};mt.prototype.listenerCount=gN;function gN(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}mt.prototype.eventNames=function(){return this._eventsCount>0?Wh(this._events):[]};function yN(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function OX(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function PX(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function NX(e,t){return new Promise(function(n,r){function i(a){e.removeListener(t,o),r(a)}function o(){typeof e.removeListener=="function"&&e.removeListener("error",i),n([].slice.call(arguments))}bN(e,t,o,{once:!0}),t!=="error"&&DX(e,i,{once:!0})})}function DX(e,t,n){typeof e.on=="function"&&bN(e,"error",t,n)}function bN(e,t,n,r){if(typeof e.on=="function")r.once?e.once(t,n):e.on(t,n);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(o){r.once&&e.removeEventListener(t,i),n(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var AX=ex.exports,H1={exports:{}};typeof Object.create=="function"?H1.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:H1.exports=function(t,n){if(n){t.super_=n;var r=function(){};r.prototype=n.prototype,t.prototype=new r,t.prototype.constructor=t}};var MX=H1.exports,tx={},nx={};function LX(e,t){var n={jsonrpc:"2.0"};if(e.method)n.method=e.method,e.params&&(n.params=e.params),t!=null&&(n.id=t);else if(t!=null){if(e.error){if(e.result!==void 0)throw new TypeError("Both result and error are defined");n.error=e.error}else if(e.result!==void 0)n.result=e.result;else throw new TypeError("No result or error is defined");n.id=t}return JSON.stringify(n)}function FX(e){var t=e;(typeof e=="string"||e instanceof String)&&(t=JSON.parse(e));var n=t.jsonrpc;if(n!=="2.0")throw new TypeError("Invalid JsonRPC version '"+n+"': "+e);if(t.method==null){if(t.id==null)throw new TypeError("Invalid message: "+e);var r=t.result!==void 0,i=t.error!==void 0;if(r&&i)throw new TypeError("Both result and error are defined: "+e);if(!r&&!i)throw new TypeError("No result or error is defined: "+e);t.ack=t.id,delete t.id}return t}nx.pack=LX;nx.unpack=FX;var rx={};function BX(e){throw new TypeError("Not yet implemented")}function jX(e){throw new TypeError("Not yet implemented")}rx.pack=BX;rx.unpack=jX;var $X=nx,VX=rx;tx.JsonRPC=$X;tx.XmlRPC=VX;function wN(){var e={};this.forEach=function(t){for(var n in e){var r=e[n];for(var i in r)t(r[i])}},this.get=function(t,n){var r=e[n];if(r!=null)return r[t]},this.remove=function(t,n){var r=e[n];if(r!=null){delete r[t];for(var i in r)return!1;delete e[n]}},this.set=function(t,n,r){if(t==null)return this.remove(n,r);var i=e[r];i==null&&(e[r]=i={}),i[n]=t}}wN.prototype.pop=function(e,t){var n=this.get(e,t);if(n!=null)return this.remove(e,t),n};var WX=wN,R0={},I0,a_;function xN(){if(a_)return I0;a_=1;var e=ln.OpenViduLogger,t=e.getInstance(),n=2e3,r=3e3,i=3;function o(a){var s=!1,u,c=a.uri,l=!1,d=new WebSocket(c);d.onopen=function(){t.debug("WebSocket connected to "+c),a.onconnected&&a.onconnected()},d.onerror=function(g){t.error("Could not connect to "+c+" (invoking onerror if defined)",g),a.onerror&&a.onerror(g)};var f=function(){d.readyState===i?s?t.debug("Connection closed by user"):a.ismasternodecrashed()?t.error("Master Node has crashed. Stopping reconnection process"):(t.debug("Connection closed unexpectedly. Reconnecting..."),h(n,1)):t.debug("Close callback from previous websocket. Ignoring it")};d.onclose=f;function h(g,v){if(t.debug("reconnect (attempt #"+v+", max="+g+")"),v===1){if(l){t.warn("Trying to reconnect when already reconnecting... Ignoring this reconnection.");return}else l=!0;a.onreconnecting&&a.onreconnecting()}m(g,v)}function p(g){var v=new URLSearchParams(new URL(g).search);return v.has("reconnect")||(g=Array.from(v).length>0?g+"&reconnect=true":g+"?reconnect=true"),g}function m(g,v){t.debug("Reconnection attempt #"+v),d.close(4104,"Connection closed for reconnection"),c=p(c),d=new WebSocket(c),d.onopen=function(){t.debug("Reconnected to "+c+" after "+v+" attempts..."),l=!1,u(),a.onreconnected&&a.onreconnected(),d.onclose=f},d.onerror=function(y){t.warn("Reconnection error: ",y),v===g?a.ondisconnect&&a.ondisconnect():setTimeout(function(){h(g,v+1)},r)}}this.close=function(g,v){s=!0,d.close(g,v)},this.reconnectWs=function(){t.debug("reconnectWs"),h(n,1)},this.send=function(g){d.send(g)},this.addEventListener=function(g,v){u=function(){d.addEventListener(g,v)},u()},this.getReadyState=function(){return d.readyState}}return I0=o,I0}var T0,s_;function UX(){if(s_)return T0;s_=1;var e=EN(),t=xN(),n=ln.OpenViduLogger;Date.now=Date.now||function(){return+new Date};var r=5e3,i="RECONNECTING",o="CONNECTED",a="DISCONNECTED",s=n.getInstance();function u(c){var l=this,d=c.ws,f=-1,h=0,p=!0,m=!1,g,v=a,y=d.onreconnecting,b=d.onreconnected,w=d.onconnected,E=d.onerror;c.rpc.pull=function(k,D){D.reply(null,"push")},d.onreconnecting=function(){if(s.debug("--------- ONRECONNECTING -----------"),v===i){s.error("Websocket already in RECONNECTING state when receiving a new ONRECONNECTING message. Ignoring it");return}L(),v=i,y&&y()},d.onreconnected=function(){if(s.debug("--------- ONRECONNECTED -----------"),v===o){s.error("Websocket already in CONNECTED state when receiving a new ONRECONNECTED message. Ignoring it");return}v=o,_(),b&&b()},d.onconnected=function(){if(s.debug("--------- ONCONNECTED -----------"),v===o){s.error("Websocket already in CONNECTED state when receiving a new ONCONNECTED message. Ignoring it");return}v=o,p=!0,B(),w&&w()},d.onerror=function(k){s.debug("--------- ONERROR -----------"),v=a,L(),E&&E(k)};var x=new t(d);s.debug("Connecting websocket to URI: "+d.uri);var R={request_timeout:c.rpc.requestTimeout,ping_request_timeout:c.rpc.heartbeatRequestTimeout},S=new e(e.packers.JsonRPC,R,x,function(k){s.debug("Received request: "+JSON.stringify(k));try{var D=c.rpc[k.method];D===void 0?s.error("Method "+k.method+" not registered in client"):D(k.params,k)}catch(F){s.error("Exception processing request: "+JSON.stringify(k)),s.error(F)}});this.send=function(k,D,F){var M=Date.now();S.encode(k,D,function(I,N){if(I){try{s.error("ERROR:"+I.message+" in Request: method:"+k+" params:"+JSON.stringify(D)+" request:"+I.request),I.data&&s.error("ERROR DATA:"+JSON.stringify(I.data))}catch{}I.requestTime=M}F&&(N!=null&&N.value!=="pong"&&s.debug("Response: "+JSON.stringify(N)),F(I,N))})};function _(){s.debug("notReconnectIfNumLessThan = "+h+" (old="+f+")"),f=h}function T(){if(p){var k=null;(h==0||h==f)&&(k={interval:c.heartbeat||r}),h++,l.send("ping",k,function(D){return function(F,M){F&&(s.debug("Error in ping request #"+D+" ("+F.message+")"),D>f&&(p=!1,_(),s.debug("Server did not respond to ping message #"+D+". Reconnecting... "),x.reconnectWs()))}}(h))}else s.debug("Trying to send ping, but ping is not enabled")}function B(){m||(s.debug("Starting ping (if configured)"),m=!0,c.heartbeat!=null&&(g=setInterval(T,c.heartbeat),T()))}function L(){clearInterval(g),m=!1,p=!1,h=-1,S.cancel()}this.close=function(k,D){s.debug("Closing  with code: "+k+" because: "+D),g!=null&&(s.debug("Clearing ping interval"),clearInterval(g)),m=!1,p=!1,x.close(k,D)},this.reconnect=function(){x.reconnectWs()},this.resetPing=function(){p=!0,h=0,B()},this.getReadyState=function(){return x.getReadyState()}}return T0=u,T0}var u_;function zX(){if(u_)return R0;u_=1;var e=UX();return R0.JsonRpcClient=e,R0}var O0={},c_;function HX(){if(c_)return O0;c_=1;var e=xN();return O0.WebSocketWithReconnection=e,O0}var P0,l_;function EN(){if(l_)return P0;l_=1;var e=!1;if(Object.defineProperty)try{Object.defineProperty({},"x",{})}catch{e=!0}Function.prototype.bind||(Function.prototype.bind=function(f){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var h=Array.prototype.slice.call(arguments,1),p=this,m=function(){},g=function(){return p.apply(this instanceof m&&f?this:f,h.concat(Array.prototype.slice.call(arguments)))};return m.prototype=this.prototype,g.prototype=new m,g});var t=AX.EventEmitter,n=MX,r=tx,i=WX,o=5e3;function a(f){if(!f)return{};for(var h in f){var p=f[h];typeof p=="string"&&(f[h]={response:p})}return f}function s(f){if(f){if(f instanceof Function)return{send:f};if(f.send instanceof Function)return f;if(f.postMessage instanceof Function)return f.send=f.postMessage,f;if(f.write instanceof Function)return f.send=f.write,f;if(f.onmessage===void 0&&!(f.pause instanceof Function))throw new SyntaxError("Transport is not a function nor a valid object")}}function u(f,h){e?(this.method=f,this.params=h):(Object.defineProperty(this,"method",{value:f,enumerable:!0}),Object.defineProperty(this,"params",{value:h,enumerable:!0}))}function c(f,h,p,m){var g=this;if(!f)throw new SyntaxError("Packer is not defined");if(!f.pack||!f.unpack)throw new SyntaxError("Packer is invalid");var v=a(f.responseMethods);if(h instanceof Function){if(p!=null)throw new SyntaxError("There can't be parameters after onRequest");m=h,p=void 0,h=void 0}if(h&&h.send instanceof Function){if(p&&!(p instanceof Function))throw new SyntaxError("Only a function can be after transport");m=p,p=h,h=void 0}if(p instanceof Function){if(m!=null)throw new SyntaxError("There can't be parameters after onRequest");m=p,p=void 0}if(p&&p.send instanceof Function&&m&&!(m instanceof Function))throw new SyntaxError("Only a function can be after transport");h=h||{},t.call(this),m&&this.on("request",m),e?this.peerID=h.peerID:Object.defineProperty(this,"peerID",{value:h.peerID});var y=h.max_retries||0;function b(I){g.decode(I.data||I)}this.getTransport=function(){return p},this.setTransport=function(I){p&&(p.removeEventListener?p.removeEventListener("message",b):p.removeListener&&p.removeListener("data",b)),I&&(I.addEventListener?I.addEventListener("message",b):I.addListener&&I.addListener("data",b)),p=s(I)},e||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)}),this.setTransport(p);var w=h.request_timeout||o,E=h.ping_request_timeout||w,x=h.response_timeout||o,R=h.duplicates_timeout||o,S=0,_=new i,T=new i,B=new i,L={};function k(I,N,j){var P={message:I,timeout:setTimeout(function(){T.remove(N,j)},x)};T.set(P,N,j)}function D(I,N){var j=setTimeout(function(){B.remove(I,N)},R);B.set(j,I,N)}function F(I,N,j,P,A){u.call(this,I,N),this.getTransport=function(){return A},this.setTransport=function(q){A=s(q)},e||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)});var U=T.get(j,P);A||g.getTransport()||(e?this.duplicated=!!U:Object.defineProperty(this,"duplicated",{value:!!U}));var H=v[I];this.pack=f.pack.bind(f,this,j),this.reply=function(q,Q,V){if(q instanceof Function||q&&q.send instanceof Function){if(Q!=null)throw new SyntaxError("There can't be parameters after callback");V=q,Q=null,q=void 0}else if(Q instanceof Function||Q&&Q.send instanceof Function){if(V!=null)throw new SyntaxError("There can't be parameters after callback");V=Q,Q=null}V=s(V),U&&clearTimeout(U.timeout),P!=null&&(q&&(q.dest=P),Q&&(Q.dest=P));var re;if(q||Q!=null){if(g.peerID!=null&&(q?q.from=g.peerID:Q.from=g.peerID),H)if(H.error==null&&q)re={error:q};else{var Z=q?H.error:H.response;re={method:Z,params:q||Q}}else re={error:q,result:Q};re=f.pack(re,j)}else U?re=U.message:re=f.pack({result:null},j);return k(re,j,P),V=V||this.getTransport()||g.getTransport(),V?V.send(re):re}}n(F,u);function M(I){var N=L[I];if(N){delete L[I];var j=_.pop(N.id,N.dest);j&&(clearTimeout(j.timeout),D(N.id,N.dest))}}this.cancel=function(I){if(I)return M(I);for(var I in L)M(I)},this.close=function(){var I=this.getTransport();I&&I.close&&I.close(4003,"Cancel request"),this.cancel(),B.forEach(clearTimeout),T.forEach(function(N){clearTimeout(N.timeout)})},this.encode=function(I,N,j,P,A){if(N instanceof Function){if(j!=null)throw new SyntaxError("There can't be parameters after callback");A=N,P=void 0,j=void 0,N=void 0}else if(j instanceof Function){if(P!=null)throw new SyntaxError("There can't be parameters after callback");A=j,P=void 0,j=void 0}else if(P instanceof Function){if(A!=null)throw new SyntaxError("There can't be parameters after callback");A=P,P=void 0}g.peerID!=null&&(N=N||{},N.from=g.peerID),j!=null&&(N=N||{},N.dest=j);var U={method:I,params:N};if(A){let ie=function(de,be){g.cancel(U),A(de,be)},pe=function(de){var be=I==="ping"?E:w;return Q.timeout=setTimeout(Y,be*Math.pow(2,q++)),L[U]={id:H,dest:j},_.set(Q,H,j),de=de||V||g.getTransport(),de?de.send(U):U},ce=function(de){de=s(de),console.warn(q+" retry for request message:",U);var be=B.pop(H,j);return clearTimeout(be),pe(de)},Y=function(){if(q<y)return ce(P);var de=new Error("Request has timed out");de.request=U,de.retry=ce,ie(de)};var re=ie,Z=pe,he=ce,xe=Y,H=S++,q=0;U=f.pack(U,H);var Q={message:U,callback:ie,responseMethods:v[I]||{}},V=s(P);return pe(P)}return U=f.pack(U),P=P||this.getTransport(),P?P.send(U):U},this.decode=function(I,N){if(!I)throw new TypeError("Message is not defined");try{I=f.unpack(I)}catch(Y){return console.debug(Y,I)}var j=I.id,P=I.ack,A=I.method,U=I.params||{},H=U.from,q=U.dest;if(g.peerID!=null&&H==g.peerID)return;if(j==null&&P==null){var Q=new u(A,U);return g.emit("request",Q)?void 0:Q}function V(){if(N=s(N)||g.getTransport(),N){var Y=T.get(j,H);if(Y)return N.send(Y.message)}var de=j??P,be=new F(A,U,de,H,N);if(!g.emit("request",be))return be}function re(Y,de,be){Y.callback(de,be)}function Z(Y){console.warn("Response already processed",I),clearTimeout(Y),D(P,H)}if(A){if(q==null||q==g.peerID){var ce=_.get(P,H);if(ce){var he=ce.responseMethods;return A==he.error?re(ce,U):A==he.response?re(ce,null,U):V()}var xe=B.get(P,H);if(xe)return Z(xe)}return V()}var ie=I.error,pe=I.result;if(!(ie&&ie.dest&&ie.dest!=g.peerID)&&!(pe&&pe.dest&&pe.dest!=g.peerID)){var ce=_.get(P,H);if(!ce){var xe=B.get(P,H);return xe?Z(xe):console.warn("No callback was defined for this message",I)}re(ce,ie,pe)}}}n(c,t),c.RpcNotification=u,P0=c;var l=zX(),d=HX();return c.clients=l,c.clients.transports=d,c.packers=r,P0}const GX="OpenVidu",qX={events:"3.3.0",freeice:"2.2.2",hark:"1.2.3",inherits:"2.0.4",jsnlog:"2.30.0",mime:"3.0.0",platform:"1.3.6",semver:"7.6.2",uuid:"9.0.1","wolfy87-eventemitter":"5.2.9"},XX="OpenVidu Browser",KX={"@types/node":"18.11.9","@types/platform":"1.3.4",browserify:"17.0.0",terser:"5.15.1",tsify:"5.0.4",tslint:"6.1.3",typedoc:"0.23.21",typescript:"4.9.3"},YX="Apache-2.0",QX="lib/index.js",JX="openvidu-browser",ZX={type:"git",url:"git://github.com/OpenVidu/openvidu"},eK={browserify:"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js Main.ts -p [ tsify ] --exclude kurento-browser-extensions --debug -o ../static/js/openvidu-browser-$VERSION.js -v","browserify-prod":"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js --debug Main.ts -p [ tsify ] --exclude kurento-browser-extensions | ../node_modules/terser/bin/terser --source-map content=inline --output ../static/js/openvidu-browser-$VERSION.min.js",build:"cd src/OpenVidu && ./../../node_modules/typescript/bin/tsc && cd ../.. && ./node_modules/typescript/bin/tsc --declaration src/index.ts --outDir ./lib --sourceMap --target es5 --lib dom,es5,es2015.promise,scripthost && rm -rf ./ts4.4 && mkdir -p ./ts4.4/lib && cp -r ./lib ./ts4.4 && find ./ts4.4/lib -type f ! -iname '*.d.ts' -delete && ./config/replace_for_ts44.sh",docs:"./generate-docs.sh"},tK="lib/index.d.ts",nK={"<4.4":{"*":["ts4.4/*"]}},rK="2.30.1",iK={author:GX,dependencies:qX,description:XX,devDependencies:KX,license:YX,main:QX,name:JX,repository:ZX,scripts:eK,types:tK,typesVersions:nK,version:rK};var d_=me&&me.__awaiter||function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function s(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?o(l.value):i(l.value).then(s,u)}c((r=r.apply(e,t||[])).next())})},f_=me&&me.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(l){return u([c,l])}}function u(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(n=0)),n;)try{if(r=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=t.call(e,n)}catch(l){c=[6,l],i=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(pm,"__esModule",{value:!0});pm.OpenVidu=void 0;var oK=Ud,aK=Jw(),h_=Nm(),sK=Bc,su=Ao,nt=js,N0=Gd,uK=ln,cK=Pi,lK=uN,p_=jc,dK=qw,fK=Xw,hK=EN(),pK=iK,xt=uK.OpenViduLogger.getInstance(),Qe,vK=function(){function e(){var t=this;this.masterNodeHasCrashed=!1,this.publishers=[],this.secret="",this.recorder=!1,this.stt=!1,this.life=-1,this.advancedConfiguration={},this.webrtcStatsInterval=-1,this.sendBrowserLogs=dK.OpenViduLoggerConfiguration.disabled,this.isAtLeastPro=!1,this.isEnterprise=!1,this.ee=new fK,Qe=cK.PlatformUtils.getInstance(),this.libraryVersion=pK.version,xt.info("OpenVidu initialized"),xt.info("Platform detected: "+Qe.getDescription()),xt.info("openvidu-browser version: "+this.libraryVersion),(Qe.isMobileDevice()||Qe.isReactNative())&&this.onOrientationChanged(function(){t.publishers.forEach(function(n){n.stream.isLocalStreamPublished&&n.stream&&n.stream.hasVideo&&t.sendNewVideoDimensionsIfRequired(n,"deviceRotated",75,10)})})}return e.prototype.initSession=function(){return this.session=new h_.Session(this),this.session},e.prototype.initPublisher=function(t,n,r){var i;n&&typeof n!="function"?(i=n,i={audioSource:typeof i.audioSource<"u"?i.audioSource:void 0,frameRate:typeof MediaStreamTrack<"u"&&i.videoSource instanceof MediaStreamTrack?void 0:typeof i.frameRate<"u"?i.frameRate:void 0,insertMode:typeof i.insertMode<"u"?typeof i.insertMode=="string"?N0.VideoInsertMode[i.insertMode]:i.insertMode:N0.VideoInsertMode.APPEND,mirror:typeof i.mirror<"u"?i.mirror:!0,publishAudio:typeof i.publishAudio<"u"?i.publishAudio:!0,publishVideo:typeof i.publishVideo<"u"?i.publishVideo:!0,resolution:typeof MediaStreamTrack<"u"&&i.videoSource instanceof MediaStreamTrack?void 0:typeof i.resolution<"u"?i.resolution:"640x480",videoSource:typeof i.videoSource<"u"?i.videoSource:void 0,videoSimulcast:i.videoSimulcast,filter:i.filter}):i={insertMode:N0.VideoInsertMode.APPEND,mirror:!0,publishAudio:!0,publishVideo:!0,resolution:"640x480"};var o=new aK.Publisher(t,i,this),a;return n&&typeof n=="function"?a=n:r&&(a=r),o.initialize().then(function(){a!==void 0&&a(void 0),o.emitEvent("accessAllowed",[])}).catch(function(s){a!==void 0&&a(s),o.emitEvent("accessDenied",[s])}),this.publishers.push(o),o},e.prototype.initPublisherAsync=function(t,n){var r=this;return new Promise(function(i,o){var a,s=function(u){return u?o(u):i(a)};n?a=r.initPublisher(t,n,s):a=r.initPublisher(t,s)})},e.prototype.initLocalRecorder=function(t){return new oK.LocalRecorder(t)},e.prototype.checkSystemRequirements=function(){return Qe.isIPhoneOrIPad()?Qe.isIOSWithSafari()||Qe.isChromeMobileBrowser()||Qe.isFirefoxMobileBrowser()||Qe.isOperaMobileBrowser()||Qe.isEdgeMobileBrowser()||Qe.isIonicIos():Qe.isChromeBrowser()||Qe.isChromeMobileBrowser()||Qe.isFirefoxBrowser()||Qe.isFirefoxMobileBrowser()||Qe.isOperaBrowser()||Qe.isOperaMobileBrowser()||Qe.isEdgeBrowser()||Qe.isEdgeMobileBrowser()||Qe.isSamsungBrowser()||Qe.isSafariBrowser()||Qe.isAndroidBrowser()||Qe.isElectron()||Qe.isNodeJs()||Qe.isMotorolaEdgeDevice()},e.prototype.checkScreenSharingCapabilities=function(){return Qe.canScreenShare()},e.prototype.getDevices=function(){return new Promise(function(t,n){navigator.mediaDevices.enumerateDevices().then(function(r){var i,o=[];if(Qe.isIonicAndroid()&&typeof cordova<"u"&&(!((i=cordova==null?void 0:cordova.plugins)===null||i===void 0)&&i.EnumerateDevicesPlugin))cordova.plugins.EnumerateDevicesPlugin.getEnumerateDevices().then(function(a){var s=[],u=[],c=[];return s=a.filter(function(l){return l.kind==="audioinput"}),u=r.filter(function(l){return l.kind==="videoinput"}),c=r.filter(function(l){return l.kind==="audioinput"}),u.forEach(function(l,d){if(l.label)o.push({kind:l.kind,deviceId:l.deviceId,label:l.label});else{var f="";d===0?f="Front Camera":d===1?f="Back Camera":f="Unknown Camera",o.push({kind:l.kind,deviceId:l.deviceId,label:f})}}),c.forEach(function(l,d){if(l.label)o.push({kind:l.kind,deviceId:l.deviceId,label:l.label});else{var f="";switch(d){case 0:f="Default";break;case 1:var h=s.filter(function(g){return g.label.includes("Built")})[0];f=h?h.label:"Built-in Microphone";break;case 2:var p=s.filter(function(g){return g.label.includes("Wired")})[0];p?f=p.label:f="Headset earpiece";break;case 3:var m=s.filter(function(g){return g.label.includes("Bluetooth")})[0];f=m?m.label:"Wireless";break;default:f="Unknown Microphone";break}o.push({kind:l.kind,deviceId:l.deviceId,label:f})}}),t(o)});else return r.forEach(function(a){(a.kind==="audioinput"||a.kind==="videoinput")&&o.push({kind:a.kind,deviceId:a.deviceId,label:a.label})}),t(o)}).catch(function(r){return xt.error("Error getting devices",r),n(r)})})},e.prototype.getUserMedia=function(t){var n,r;return d_(this,void 0,void 0,function(){var i,o,a,c,s,d,f,u,c,l,d,f,h,p=this;return f_(this,function(m){switch(m.label){case 0:i=function(g,v){return d_(p,void 0,void 0,function(){var y,b,w,E;return f_(this,function(x){switch(x.label){case 0:y=v.audio===void 0?!0:v.audio,b={audio:y,video:!1},x.label=1;case 1:return x.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia(b)];case 2:return w=x.sent(),g.addTrack(w.getAudioTracks()[0]),[2,g];case 3:throw E=x.sent(),g.getAudioTracks().forEach(function(R){R.stop()}),g.getVideoTracks().forEach(function(R){R.stop()}),this.generateAudioDeviceError(E,b);case 4:return[2]}})})},m.label=1;case 1:return m.trys.push([1,20,,21]),[4,this.generateMediaConstraints(t)];case 2:return o=m.sent(),o.videoTrack&&o.audioTrack||o.audioTrack&&((n=o.constraints)===null||n===void 0?void 0:n.video)===!1||o.videoTrack&&((r=o.constraints)===null||r===void 0?void 0:r.audio)===!1?[2,this.addAlreadyProvidedTracks(o,new MediaStream)]:[3,3];case 3:if(o.videoTrack&&delete o.constraints.video,o.audioTrack&&delete o.constraints.audio,a=!1,typeof t.videoSource!="string")return[3,12];if(!(t.videoSource==="screen"||t.videoSource==="window"||Qe.isElectron()&&t.videoSource.startsWith("screen:")))return[3,12];if(a=!o.audioTrack&&t.audioSource!==null&&t.audioSource!==!1,!(navigator.mediaDevices.getDisplayMedia&&!Qe.isElectron()))return[3,11];m.label=4;case 4:return m.trys.push([4,9,,10]),[4,navigator.mediaDevices.getDisplayMedia({video:!0,audio:t.audioSource==="screen"})];case 5:return c=m.sent(),this.addAlreadyProvidedTracks(o,c),a?[4,i(c,o.constraints)]:[3,7];case 6:return[2,m.sent()];case 7:return[2,c];case 8:return[3,10];case 9:throw s=m.sent(),d=nt.OpenViduErrorName.SCREEN_CAPTURE_DENIED,f=s.toString(),new nt.OpenViduError(d,f);case 10:return[3,11];case 11:return[3,12];case 12:u=a?{video:o.constraints.video}:o.constraints,m.label=13;case 13:return m.trys.push([13,18,,19]),[4,navigator.mediaDevices.getUserMedia(u)];case 14:return c=m.sent(),this.addAlreadyProvidedTracks(o,c),a?[4,i(c,o.constraints)]:[3,16];case 15:return[2,m.sent()];case 16:return[2,c];case 17:return[3,19];case 18:throw l=m.sent(),d=void 0,f=l.toString(),t.videoSource!=="screen"?d=nt.OpenViduErrorName.DEVICE_ACCESS_DENIED:d=nt.OpenViduErrorName.SCREEN_CAPTURE_DENIED,new nt.OpenViduError(d,f);case 19:return[3,21];case 20:throw h=m.sent(),h;case 21:return[2]}})})},e.prototype.enableProdMode=function(){xt.enableProdMode()},e.prototype.setAdvancedConfiguration=function(t){this.advancedConfiguration=t},e.prototype.onOrientationChanged=function(t){globalThis.addEventListener("orientationchange",t)},e.prototype.sendNewVideoDimensionsIfRequired=function(t,n,r,i){var o=this,a,s,u,c,l=0,d=((s=(a=t==null?void 0:t.stream)===null||a===void 0?void 0:a.videoDimensions)===null||s===void 0?void 0:s.width)||0,f=((c=(u=t==null?void 0:t.stream)===null||u===void 0?void 0:u.videoDimensions)===null||c===void 0?void 0:c.height)||0,h=setInterval(function(){l++,l>i&&clearTimeout(h),t.getVideoDimensions().then(function(p){(p.width!==d||p.height!==f)&&(clearTimeout(h),o.sendVideoDimensionsChangedEvent(t,n,d,f,p.width,p.height))})},r)},e.prototype.sendVideoDimensionsChangedEvent=function(t,n,r,i,o,a){var s=this;t.stream.videoDimensions={width:o||0,height:a||0},this.sendRequest("streamPropertyChanged",{streamId:t.stream.streamId,property:"videoDimensions",newValue:JSON.stringify(t.stream.videoDimensions),reason:n},function(u,c){u?xt.error("Error sending 'streamPropertyChanged' event",u):(s.session.emitEvent("streamPropertyChanged",[new su.StreamPropertyChangedEvent(s.session,t.stream,"videoDimensions",t.stream.videoDimensions,{width:r,height:i},n)]),t.emitEvent("streamPropertyChanged",[new su.StreamPropertyChangedEvent(t,t.stream,"videoDimensions",t.stream.videoDimensions,{width:r,height:i},n)]),s.session.sendVideoData(t))})},e.prototype.sendTrackChangedEvent=function(t,n,r,i){var o=this,a={label:n},s={label:r},u="trackReplaced";t.stream.isLocalStreamPublished?this.sendRequest("streamPropertyChanged",{streamId:t.stream.streamId,property:i,newValue:s,reason:u},function(c,l){c?xt.error("Error sending 'streamPropertyChanged' event",c):(o.session.emitEvent("streamPropertyChanged",[new su.StreamPropertyChangedEvent(o.session,t.stream,i,s,a,u)]),t.emitEvent("streamPropertyChanged",[new su.StreamPropertyChangedEvent(t,t.stream,i,s,a,u)]))}):(this.session.emitEvent("streamPropertyChanged",[new su.StreamPropertyChangedEvent(this.session,t.stream,i,s,a,u)]),t.emitEvent("streamPropertyChanged",[new su.StreamPropertyChangedEvent(t,t.stream,i,s,a,u)]))},e.prototype.generateMediaConstraints=function(t){var n=this;return new Promise(function(r,i){var o={audioTrack:void 0,videoTrack:void 0,constraints:{audio:void 0,video:void 0}},a=t.audioSource,s=t.videoSource;if((a===null||a===!1)&&(o.constraints.audio=!1),(s===null||s===!1)&&(o.constraints.video=!1),o.constraints.audio===!1&&o.constraints.video===!1)return i(new nt.OpenViduError(nt.OpenViduErrorName.NO_INPUT_SOURCE_SET,"Properties 'audioSource' and 'videoSource' cannot be set to false or null at the same time"));if(typeof MediaStreamTrack<"u"&&a instanceof MediaStreamTrack&&(o.audioTrack=a),typeof MediaStreamTrack<"u"&&s instanceof MediaStreamTrack&&(o.videoTrack=s),a===void 0&&(o.constraints.audio=!0),s===void 0&&(o.constraints.video={width:{ideal:640},height:{ideal:480}}),s!==null&&s!==!1){if(t.resolution){var u=t.resolution.toLowerCase().split("x"),c=Number(u[0]),l=Number(u[1]);o.constraints.video={width:{ideal:c},height:{ideal:l}}}t.frameRate&&(o.constraints.video.frameRate={ideal:t.frameRate})}return n.configureDeviceIdOrScreensharing(o,t,r,i),r(o)})},e.prototype.startWs=function(t){var n={heartbeat:5e3,ws:{uri:this.wsUri+"?sessionId="+this.session.sessionId,onconnected:t,ondisconnect:this.disconnectCallback.bind(this),onreconnecting:this.reconnectingCallback.bind(this),onreconnected:this.reconnectedCallback.bind(this),ismasternodecrashed:this.isMasterNodeCrashed.bind(this)},rpc:{requestTimeout:1e4,heartbeatRequestTimeout:5e3,participantJoined:this.session.onParticipantJoined.bind(this.session),participantPublished:this.session.onParticipantPublished.bind(this.session),participantUnpublished:this.session.onParticipantUnpublished.bind(this.session),participantLeft:this.session.onParticipantLeft.bind(this.session),participantEvicted:this.session.onParticipantEvicted.bind(this.session),recordingStarted:this.session.onRecordingStarted.bind(this.session),recordingStopped:this.session.onRecordingStopped.bind(this.session),broadcastStarted:this.session.onBroadcastStarted.bind(this.session),broadcastStopped:this.session.onBroadcastStopped.bind(this.session),sendMessage:this.session.onNewMessage.bind(this.session),streamPropertyChanged:this.session.onStreamPropertyChanged.bind(this.session),connectionPropertyChanged:this.session.onConnectionPropertyChanged.bind(this.session),networkQualityLevelChanged:this.session.onNetworkQualityLevelChangedChanged.bind(this.session),filterEventDispatched:this.session.onFilterEventDispatched.bind(this.session),iceCandidate:this.session.recvIceCandidate.bind(this.session),mediaError:this.session.onMediaError.bind(this.session),masterNodeCrashedNotification:this.onMasterNodeCrashedNotification.bind(this),forciblyReconnectSubscriber:this.session.onForciblyReconnectSubscriber.bind(this.session),speechToTextMessage:this.session.onSpeechToTextMessage.bind(this.session),speechToTextDisconnected:this.session.onSpeechToTextDisconnected.bind(this.session)}};this.jsonRpcClient=new hK.clients.JsonRpcClient(n)},e.prototype.onMasterNodeCrashedNotification=function(t){console.error("Master Node has crashed"),this.masterNodeHasCrashed=!0,this.session.onLostConnection("nodeCrashed"),this.jsonRpcClient.close(4103,"Master Node has crashed")},e.prototype.getWsReadyState=function(){return this.jsonRpcClient.getReadyState()},e.prototype.closeWs=function(){this.jsonRpcClient.close(4102,"Connection closed by client")},e.prototype.sendRequest=function(t,n,r){var i;n&&n instanceof Function&&(r=n,n={}),xt.debug('Sending request: {method:"'+t+'", params: '+JSON.stringify(n)+"}"),(i=this.jsonRpcClient)===null||i===void 0||i.send(t,n,r)},e.prototype.getWsUri=function(){return this.wsUri},e.prototype.getSecret=function(){return this.secret},e.prototype.getRecorder=function(){return this.recorder},e.prototype.getStt=function(){return this.stt},e.prototype.generateAudioDeviceError=function(t,n){t.name==="Error"&&(t.name=t.constructor.name);var r,i;switch(t.name.toLowerCase()){case"notfounderror":return r=nt.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,i=t.toString(),new nt.OpenViduError(r,i);case"notallowederror":return r=nt.OpenViduErrorName.DEVICE_ACCESS_DENIED,i=t.toString(),new nt.OpenViduError(r,i);case"overconstrainederror":return t.constraint.toLowerCase()==="deviceid"?(r=nt.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,i="Audio input device with deviceId '"+n.audio.deviceId.exact+"' not found"):(r=nt.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,i="Audio input device doesn't support the value passed for constraint '"+t.constraint+"'"),new nt.OpenViduError(r,i);case"notreadableerror":return r=nt.OpenViduErrorName.DEVICE_ALREADY_IN_USE,i=t.toString(),new nt.OpenViduError(r,i);default:return new nt.OpenViduError(nt.OpenViduErrorName.INPUT_AUDIO_DEVICE_GENERIC_ERROR,t.toString())}},e.prototype.addAlreadyProvidedTracks=function(t,n,r){return t.videoTrack&&(n.addTrack(t.videoTrack),r&&(t.constraints.video?r.lastVideoTrackConstraints=t.constraints.video:r.lastVideoTrackConstraints=t.videoTrack.getConstraints())),t.audioTrack&&n.addTrack(t.audioTrack),n},e.prototype.configureDeviceIdOrScreensharing=function(t,n,r,i){var o=this,a=n.audioSource,s=n.videoSource;if(typeof a=="string"&&a!=="screen"&&(t.constraints.audio={deviceId:{exact:a}}),typeof s=="string")if(!this.isScreenShare(s))this.setVideoSource(t,s),a==="screen"&&(xt.warn('Parameter "audioSource" is set to "screen", which means rquesting audio from screen sharing source. But "videoSource" is not set to "screen". No audio source will be requested'),t.constraints.audio=!1);else if(this.checkScreenSharingCapabilities())if(Qe.isElectron()){var c="screen:",l=s,d=l.substr(l.indexOf(c)+c.length);return t.constraints.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:d}},r(t)}else if(this.advancedConfiguration.screenShareChromeExtension&&!(Qe.isFirefoxBrowser()||Qe.isFirefoxMobileBrowser())&&!navigator.mediaDevices.getDisplayMedia){p_.getScreenConstraints(function(h,p){if(h||p.mandatory&&p.mandatory.chromeMediaSource==="screen")if(h==="permission-denied"||h==="PermissionDeniedError"){var m=new nt.OpenViduError(nt.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");return xt.error(m),i(m)}else{var g=o.advancedConfiguration.screenShareChromeExtension.split("/").pop().trim();p_.getChromeExtensionStatus(g,function(v){if(v==="installed-disabled"){var y=new nt.OpenViduError(nt.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");return xt.error(y),i(y)}if(v==="not-installed"){var b=new nt.OpenViduError(nt.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,o.advancedConfiguration.screenShareChromeExtension);return xt.error(b),i(b)}});return}else return t.constraints.video=p,r(t)});return}else{if(navigator.mediaDevices.getDisplayMedia)return r(t);var f=Qe.isFirefoxBrowser()||Qe.isFirefoxMobileBrowser()?n.videoSource:void 0;lK.getScreenId(f,function(h,p,m){if(h)if(h==="not-installed"){var g=o.advancedConfiguration.screenShareChromeExtension?o.advancedConfiguration.screenShareChromeExtension:"https://chrome.google.com/webstore/detail/openvidu-screensharing/lfcgfepafnobdloecchnfaclibenjold",v=new nt.OpenViduError(nt.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,g);return xt.error(v),i(v)}else if(h==="installed-disabled"){var v=new nt.OpenViduError(nt.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");return xt.error(v),i(v)}else if(h==="permission-denied"){var v=new nt.OpenViduError(nt.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");return xt.error(v),i(v)}else{var v=new nt.OpenViduError(nt.OpenViduErrorName.GENERIC_ERROR,"Unknown error when accessing screen share");return xt.error(v),xt.error(h),i(v)}else return t.constraints.video=m.video,r(t)});return}else{var u=new nt.OpenViduError(nt.OpenViduErrorName.SCREEN_SHARING_NOT_SUPPORTED,"You can only screen share in desktop Chrome, Firefox, Opera, Safari (>=13.0), Edge (>= 80) or Electron. Detected client: "+Qe.getName()+" "+Qe.getVersion());return xt.error(u),i(u)}},e.prototype.setVideoSource=function(t,n){t.constraints.video||(t.constraints.video={}),t.constraints.video.deviceId={exact:n}},e.prototype.disconnectCallback=function(){xt.warn("Websocket connection lost"),this.isRoomAvailable()?this.session.onLostConnection("networkDisconnect"):alert("Connection error. Please reload page.")},e.prototype.reconnectingCallback=function(){xt.warn("Websocket connection lost (reconnecting)"),this.isRoomAvailable()?this.session.emitEvent("reconnecting",[]):alert("Connection error. Please reload page.")},e.prototype.reconnectWebsocketThroughRpcConnectMethod=function(t){var n=this;this.sendRequest("connect",{sessionId:t,reconnect:!0},function(r,i){if(r)if(n.isMasterNodeCrashed())xt.warn("Master Node has crashed!");else{xt.error(r);var o=function(s,u){xt.warn(u),n.session.onLostConnection(s),n.jsonRpcClient.close(4101,"Reconnection fault: "+u)},a=function(){n.life===-1?o("networkDisconnect","WS successfully reconnected but the user was already evicted due to timeout"):n.sendRequest("sessionStatus",{sessionId:n.session.sessionId},function(s,u){s!=null?console.error("Error checking session status",s):n.life===u.life?o("networkDisconnect","WS successfully reconnected but the user was already evicted due to timeout"):o("nodeCrashed","WS successfully reconnected to OpenVidu Server but your Master Node crashed")})};r.code===40007&&r.message==="reconnection error"&&console.error("Invalid RPC sessionId. Client network disconnection or Master Node crash"),a()}else n.jsonRpcClient.resetPing(),n.session.onRecoveredConnection()})},e.prototype.reconnectedCallback=function(){if(xt.warn("Websocket reconnected"),this.isRoomAvailable())if(this.session.connection)this.reconnectWebsocketThroughRpcConnectMethod(this.session.connection.rpcSessionId);else{xt.warn("There was no previous connection when running reconnection callback");var t=new sK.SessionDisconnectedEvent(this.session,"networkDisconnect");this.session.ee.emitEvent("sessionDisconnected",[t]),t.callDefaultBehavior()}else alert("Connection error. Please reload page.")},e.prototype.isMasterNodeCrashed=function(){return this.masterNodeHasCrashed},e.prototype.isRoomAvailable=function(){return this.session!==void 0&&this.session instanceof h_.Session?!0:(xt.warn("Session instance not found"),!1)},e.prototype.isScreenShare=function(t){return t==="screen"||t==="window"||Qe.isElectron()&&t.startsWith("screen:")},e}();pm.OpenVidu=vK;var SN={};Object.defineProperty(SN,"__esModule",{value:!0});(function(e){var t=me&&me.__createBinding||(Object.create?function(I,N,j,P){P===void 0&&(P=j);var A=Object.getOwnPropertyDescriptor(N,j);(!A||("get"in A?!N.__esModule:A.writable||A.configurable))&&(A={enumerable:!0,get:function(){return N[j]}}),Object.defineProperty(I,P,A)}:function(I,N,j,P){P===void 0&&(P=j),I[P]=N[j]}),n=me&&me.__exportStar||function(I,N){for(var j in I)j!=="default"&&!Object.prototype.hasOwnProperty.call(N,j)&&t(N,I,j)};Object.defineProperty(e,"__esModule",{value:!0}),e.EventDispatcher=e.ExceptionEventName=e.ExceptionEvent=e.SpeechToTextEvent=e.NetworkQualityLevelChangedEvent=e.FilterEvent=e.ConnectionPropertyChangedEvent=e.StreamPropertyChangedEvent=e.VideoElementEvent=e.StreamManagerEvent=e.StreamEvent=e.SignalEvent=e.SessionDisconnectedEvent=e.RecordingEvent=e.PublisherSpeakingEvent=e.ConnectionEvent=e.Event=e.VideoInsertMode=e.TypeOfVideo=e.OpenViduErrorName=e.OpenViduError=e.LocalRecorderState=e.Filter=e.LocalRecorder=e.Connection=e.Stream=e.StreamManager=e.Subscriber=e.Publisher=e.Session=e.OpenVidu=void 0;var r=Hw,i=pm;Object.defineProperty(e,"OpenVidu",{enumerable:!0,get:function(){return i.OpenVidu}});var o=Nm();Object.defineProperty(e,"Session",{enumerable:!0,get:function(){return o.Session}});var a=Jw();Object.defineProperty(e,"Publisher",{enumerable:!0,get:function(){return a.Publisher}});var s=Ac;Object.defineProperty(e,"Subscriber",{enumerable:!0,get:function(){return s.Subscriber}});var u=Mc;Object.defineProperty(e,"StreamManager",{enumerable:!0,get:function(){return u.StreamManager}});var c=Nc;Object.defineProperty(e,"Stream",{enumerable:!0,get:function(){return c.Stream}});var l=zd;Object.defineProperty(e,"Connection",{enumerable:!0,get:function(){return l.Connection}});var d=Ud;Object.defineProperty(e,"LocalRecorder",{enumerable:!0,get:function(){return d.LocalRecorder}});var f=Dc;Object.defineProperty(e,"Filter",{enumerable:!0,get:function(){return f.Filter}});var h=Gw;Object.defineProperty(e,"LocalRecorderState",{enumerable:!0,get:function(){return h.LocalRecorderState}});var p=js;Object.defineProperty(e,"OpenViduError",{enumerable:!0,get:function(){return p.OpenViduError}}),Object.defineProperty(e,"OpenViduErrorName",{enumerable:!0,get:function(){return p.OpenViduErrorName}});var m=Pm;Object.defineProperty(e,"TypeOfVideo",{enumerable:!0,get:function(){return m.TypeOfVideo}});var g=Gd;Object.defineProperty(e,"VideoInsertMode",{enumerable:!0,get:function(){return g.VideoInsertMode}});var v=En;Object.defineProperty(e,"Event",{enumerable:!0,get:function(){return v.Event}});var y=Kd;Object.defineProperty(e,"ConnectionEvent",{enumerable:!0,get:function(){return y.ConnectionEvent}});var b=Xd;Object.defineProperty(e,"PublisherSpeakingEvent",{enumerable:!0,get:function(){return b.PublisherSpeakingEvent}});var w=Qd;Object.defineProperty(e,"RecordingEvent",{enumerable:!0,get:function(){return w.RecordingEvent}});var E=Bc;Object.defineProperty(e,"SessionDisconnectedEvent",{enumerable:!0,get:function(){return E.SessionDisconnectedEvent}});var x=Jd;Object.defineProperty(e,"SignalEvent",{enumerable:!0,get:function(){return x.SignalEvent}});var R=Qw();Object.defineProperty(e,"StreamEvent",{enumerable:!0,get:function(){return R.StreamEvent}});var S=Fc;Object.defineProperty(e,"StreamManagerEvent",{enumerable:!0,get:function(){return S.StreamManagerEvent}});var _=Hd;Object.defineProperty(e,"VideoElementEvent",{enumerable:!0,get:function(){return _.VideoElementEvent}});var T=Ao;Object.defineProperty(e,"StreamPropertyChangedEvent",{enumerable:!0,get:function(){return T.StreamPropertyChangedEvent}});var B=ef;Object.defineProperty(e,"ConnectionPropertyChangedEvent",{enumerable:!0,get:function(){return B.ConnectionPropertyChangedEvent}});var L=Yd;Object.defineProperty(e,"FilterEvent",{enumerable:!0,get:function(){return L.FilterEvent}});var k=tf;Object.defineProperty(e,"NetworkQualityLevelChangedEvent",{enumerable:!0,get:function(){return k.NetworkQualityLevelChangedEvent}});var D=Zd;Object.defineProperty(e,"SpeechToTextEvent",{enumerable:!0,get:function(){return D.SpeechToTextEvent}});var F=$s;Object.defineProperty(e,"ExceptionEvent",{enumerable:!0,get:function(){return F.ExceptionEvent}}),Object.defineProperty(e,"ExceptionEventName",{enumerable:!0,get:function(){return F.ExceptionEventName}});var M=Lc;Object.defineProperty(e,"EventDispatcher",{enumerable:!0,get:function(){return M.EventDispatcher}}),n(SN,e),r.JL.setOptions({enabled:!1})})(XP);const mK=async e=>{try{return(await We.post(`/openvidu/get-token?battleId=${e}`)).data}catch(t){throw console.error("Failed to get token:",t),t}},gK=()=>{const e=O.useRef(),t=O.useRef(),[n,r]=O.useState(),[i,o]=O.useState(!1),[a,s]=O.useState(!1),[u,c]=O.useState([]),[l,d]=O.useState(-1),f=O.useRef(),h=O.useRef(),p=O.useRef();let m;const g=O.useCallback(()=>{var S;t.current&&((S=t.current)==null||S.disconnect(),t.current=void 0),f.current=void 0,p.current=void 0,r(void 0),d(-1),c([]),o(!1),s(!1),e.current=void 0,h.current=void 0},[]);O.useEffect(()=>()=>g(),[g]);const v=async S=>{const _=await mK(S);if(!_.data)throw new Error("Invalid response data");return _.data},y=S=>{const _=JSON.parse(S.data.split("%/%").at(-1));return S.serverData=_,_},b=O.useCallback(S=>{const _=new Date(S.tokenEndDate).getTime()-Date.now();if(n){setTimeout(()=>{g(),m(h.current)},_+100);return}f.current==="SPEAKER"&&S.index===l&&(s(!1),setTimeout(()=>s(!0),_+100))},[]),w=O.useCallback((S,_)=>{console.log("STREAM CREATED");const T=y(S.stream.connection);if(_)c(B=>[...B,_]);else{const B=t.current.subscribe(S.stream,void 0,L=>{L?console.error("ERROR",L):setTimeout(()=>{c(k=>[...k,B])},100)})}T.role==="SUPPORTER"&&b(T)},[b]),E=S=>{console.log("STREAM DESTROYED"),c(_=>_.filter(T=>T.stream!==S.stream))};return m=O.useCallback(async S=>{var L;h.current=S,e.current=new XP.OpenVidu;const{token:_,index:T}=await v(S);if(d(T),!_)return;t.current=e.current.initSession(),t.current.on("streamCreated",w),t.current.on("streamDestroyed",E),await t.current.connect(_);const B=t.current.capabilities.publish;p.current=t.current.connection.connectionId,o(B),s(B),B&&(y(t.current.connection),f.current=(L=t.current.connection.serverData)==null?void 0:L.role)},[w]),{joinSession:m,publishMedia:async(S,_,T=!0,B=!0,L=30)=>{var k;if((k=t.current)!=null&&k.capabilities.publish){const D=e.current.initPublisher(void 0,{audioSource:_,videoSource:S,publishAudio:T,publishVideo:B,resolution:"480x240",frameRate:L});D.on("streamCreated",F=>w(F,D)),D.on("streamDestroyed",E),r(D),t.current.publish(D)}},unpublishMedia:()=>{var S;return n?(S=t.current)==null?void 0:S.unpublish(n):void 0},session:t,connectionId:p,publisher:n,subscribers:u,index:l,isPublisher:i,shouldPublish:a}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var CN=function(e,t){return(CN=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};function Ni(e,t){function n(){this.constructor=e}CN(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function _e(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(l){o(l)}}function s(c){try{u(r.throw(c))}catch(l){o(l)}}function u(c){c.done?i(c.value):new n(function(l){l(c.value)}).then(a,s)}u((r=r.apply(e,[])).next())})}function ke(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(c){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&l[0]?r.return:l[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,l[1])).done)return i;switch(r=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,r=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){a=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){a.label=l[1];break}if(l[0]===6&&a.label<i[1]){a.label=i[1],i=l;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(l);break}i[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(d){l=[6,d],r=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([u,c])}}}var yK=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){var i=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+i+"."),this.set(t,i)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,i=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(o){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return bK(r,a[0],a[1]),a.join("=")}),r);"tfjsflags"in i&&i.tfjsflags.split(",").forEach(function(o){var a=o.split(":"),s=a[0],u=a[1];t.urlFlags[s]=function(c,l){if((l=l.toLowerCase())==="true"||l==="false")return l==="true";if(""+ +l===l)return+l;throw new Error("Could not parse value flag value "+l+" for flag "+c+".")}(s,u)})}},e}();function bK(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function ae(){return _N}var _N=null,Kp=new Map,G1=new Map;function kN(e,t){var n=IN(e,t);return Kp.get(n)}function wK(e){return G1.get(e)}function v_(e){for(var t=Kp.entries(),n=[];;){var r=t.next(),i=r.done,o=r.value;if(i)break;var a=o[0],s=o[1];a.split("_")[0]===e&&n.push(s)}return n}function RN(e){var t=e.kernelName,n=e.backendName,r=IN(t,n);if(Kp.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");Kp.set(r,e)}function xK(e){var t=e.kernelName;G1.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),G1.set(t,e)}function IN(e,t){return t+"_"+e}function q1(e,t,n){return Math.max(e,Math.min(t,n))}function TN(e){return e%2==0?e:e+1}function EK(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function W(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function dt(e,t,n){n===void 0&&(n=""),W(bn(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function $c(e){W(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function mc(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||to(e)&&!n)for(var r=0;r<e.length;++r)mc(e[r],t,n);else t.push(e);return t}function Re(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function bn(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Kt(e){return e%1==0}function SK(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function X1(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function Wu(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function m_(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,i){var o=0,a=function(){if(e())r();else{o++;var s=t(o);n!=null&&o>=n?i():setTimeout(a,s)}};a()})}function CK(e,t){for(var n=1,r=-1,i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(e[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found "+e[i]+" at dim "+i);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var o=e.slice();return o[r]=t/n,o}function dn(e,t){var n=t.length;return W((e=e==null?t.map(function(r,i){return i}):[].concat(e)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),W(e.every(function(r){return Kt(r)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(r){return r<0?n+r:r})}function es(e,t){for(var n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,o=t==null||i?null:dn(t,e).sort(),a=0,s=0;s<e.length;++s){if(o!=null){if(o[a]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(o[a]==null||o[a]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),o[a]<=s&&a++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function md(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function Yp(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function _K(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function kK(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function RK(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function to(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function ON(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function IK(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function ix(e){return typeof e=="string"||e instanceof String}function TK(e){return typeof e=="boolean"}function OK(e){return typeof e=="number"}function nf(e){return Array.isArray(e)?nf(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":OK(e)?"float32":ix(e)?"string":TK(e)?"bool":"float32"}function K1(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Y1(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function no(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function PN(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=mc(e)),n&&_K(e,t),function(o,a){return o instanceof Float32Array&&a==="float32"||o instanceof Int32Array&&a==="int32"||o instanceof Uint8Array&&a==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),i=0;i<r.length;++i)Math.round(e[i])!==0&&(r[i]=1);return r}throw new Error("Unknown data type "+t)}function g_(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,i){return r*i});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function r(i,o,a){var s=new Array;if(o.length===1)for(var u=o[0],c=0;c<u;c++)s[c]=a[i+c];else{u=o[0];var l=o.slice(1),d=l.reduce(function(f,h){return f*h});for(c=0;c<u;c++)s[c]=r(i+c*d,l,a)}return s}(0,e,t)}function NN(e,t){for(var n=rf(e,t),r=0;r<n.length;r++)n[r]=1;return n}function rf(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function Gi(){return ae().platform.now()}function DN(e){e.forEach(function(t){W(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function PK(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",ae().platform.encode(e,t)}function Qp(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",ae().platform.decode(e,t)}function y_(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}function NK(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}var DK=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new AK)}return e.prototype.profileKernel=function(t,n,r){var i,o=this,a=this.backendTimer.time(function(){i=r()});return i.forEach(function(s){s.data().then(function(u){(function(c,l,d){if(l!=="float32")return!1;for(var f=0;f<c.length;f++){var h=c[f];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+d+"'"),!0}})(u,s.dtype,t),a.then(function(c){var l="";c.getExtraProfileInfo!=null&&(l=c.getExtraProfileInfo()),o.logger.logKernelProfile(t,s,u,c.kernelMs,n,l)})})}),i},e}(),AK=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,i,o,a){var s=typeof i=="number"?Wu(i+"ms",9):i.error,u=Wu(t,25),c=n.rank,l=n.size,d=Wu(n.shape.toString(),14),f="";for(var h in o){var p=o[h].shape||n.shape,m=p.length;f+=h+": "+m+"D "+(m>0?p:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+c+"D "+d+"	%c"+l+"	%c"+f+"	%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),b_=20,dl=3,D0=7;function MK(e,t,n,r){var i=no(t),o=function(c,l,d,f){var h=Re(l),p=f[f.length-1],m=new Array(p).fill(0),g=l.length,v=d==="complex64"?hl(c):c;if(g>1)for(var y=0;y<h/p;y++)for(var b=y*p,w=0;w<p;w++)m[w]=Math.max(m[w],fl(v[b+w],0,d).length);return m}(e,t,n,i),a=t.length,s=function c(l,d,f,h,p,m){m===void 0&&(m=!0);var g=f==="complex64"?2:1,v=d[0],y=d.length;if(y===0)return f==="complex64"?[fl(hl(l)[0],0,f)]:f==="bool"?[AN(l[0])]:[l[0].toString()];if(y===1){if(v>b_){var b=dl*g,w=Array.from(l.slice(0,b)),E=Array.from(l.slice((v-dl)*g,v*g));return f==="complex64"&&(w=hl(w),E=hl(E)),["["+w.map(function(F,M){return fl(F,p[M],f)}).join(", ")+", ..., "+E.map(function(F,M){return fl(F,p[v-dl+M],f)}).join(", ")+"]"]}return["["+(f==="complex64"?hl(l):Array.from(l)).map(function(F,M){return fl(F,p[M],f)}).join(", ")+"]"]}var x=d.slice(1),R=h.slice(1),S=h[0]*g,_=[];if(v>b_){for(var T=0;T<dl;T++){var B=(L=T*S)+S;_.push.apply(_,c(l.slice(L,B),x,f,R,p,!1))}for(_.push("..."),T=v-dl;T<v;T++)B=(L=T*S)+S,_.push.apply(_,c(l.slice(L,B),x,f,R,p,T===v-1))}else for(T=0;T<v;T++){var L;B=(L=T*S)+S,_.push.apply(_,c(l.slice(L,B),x,f,R,p,T===v-1))}var k=y===2?",":"";for(_[0]="["+_[0]+k,T=1;T<_.length-1;T++)_[T]=" "+_[T]+k;var D=`,
`;for(T=2;T<y;T++)D+=`
`;return _[_.length-1]=" "+_[_.length-1]+"]"+(m?"":D),_}(e,t,n,i,o),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(c){return"    "+c}).join(`
`)),u.join(`
`)}function fl(e,t,n){return Wu(Array.isArray(e)?parseFloat(e[0].toFixed(D0))+" + "+parseFloat(e[1].toFixed(D0))+"j":ix(e)?"'"+e+"'":n==="bool"?AN(e):parseFloat(e.toFixed(D0)).toString(),t)}function AN(e){return e===0?"false":"true"}function hl(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var gd=function(){function e(t,n,r){var i=this;if(this.dtype=n,this.shape=t.slice(),this.size=Re(t),r!=null){var o=r.length;W(o===this.size,function(){return"Length of values '"+o+"' does not match the size inferred by the shape '"+i.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Yp(n,this.size),this.strides=no(t)}return e.prototype.set=function(t){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),W(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var o=this.locToIndex(r);this.values[o]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,i=0,o=t;i<o.length;i++){var a=o[i];if(a<0||a>=this.shape[r]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=t[t.length-1],c=0;c<t.length-1;++c)u+=this.strides[c]*t[c];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return Xi().makeTensor(this.values,this.shape,this.dtype)},e}(),Xi=null,ne=null,MN=null,Lt=function(){function e(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=Re(t),this.strides=no(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),W(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,i){return this.throwIfDisposed(),this.reshape([t,n,r,i])},e.prototype.as5D=function(t,n,r,i,o){return this.throwIfDisposed(),this.reshape([t,n,r,i,o])},e.prototype.asType=function(t){return this.throwIfDisposed(),ne.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return _e(this,void 0,void 0,function(){var t;return ke(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,ne.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return ne.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return _e(this,void 0,void 0,function(){var t;return ke(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,g_(this.shape,t)]}})})},e.prototype.arraySync=function(){return g_(this.shape,this.dataSync())},e.prototype.data=function(){return _e(this,void 0,void 0,function(){var t,n;return ke(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=Xi().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(i){return Qp(i)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=Xi().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return Qp(n)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return _e(this,void 0,void 0,function(){var t;return ke(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,Xi().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(Xi().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),ne.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),ne.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),ne.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),ne.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),ne.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),ne.clone(this)},e.prototype.oneHot=function(t,n,r){return this.throwIfDisposed(),ne.oneHot(this,t,n,r)},e.prototype.toString=function(t){return t===void 0&&(t=!1),MK(this.dataSync(),this.shape,this.dtype,t)},e.prototype.tile=function(t){return this.throwIfDisposed(),ne.tile(this,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),ne.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),ne.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),ne.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),ne.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),ne.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),ne.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),ne.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),ne.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),ne.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),ne.unstack(this,t)},e.prototype.pad=function(t,n){return n===void 0&&(n=0),ne.pad(this,t,n)},e.prototype.batchNormalization=function(t,n,r,i,o){return r===void 0&&(r=.001),MN("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,o,i,r)},e.prototype.batchNorm=function(t,n,r,i,o){return o===void 0&&(o=.001),this.throwIfDisposed(),ne.batchNorm(this,t,n,r,i,o)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ne.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ne.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ne.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ne.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ne.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ne.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ne.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ne.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ne.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ne.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),ne.cast(this,t)},e.prototype.add=function(t){return this.throwIfDisposed(),ne.add(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),ne.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),ne.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),ne.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),ne.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),ne.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),ne.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),ne.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),ne.mulStrict(this,t)},e.prototype.div=function(t){return this.throwIfDisposed(),ne.div(this,t)},e.prototype.divNoNan=function(t){return this.throwIfDisposed(),ne.divNoNan(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),ne.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),ne.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),ne.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),ne.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),ne.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),ne.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),ne.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),ne.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),ne.squaredDifferenceStrict(this,t)},e.prototype.transpose=function(t){return this.throwIfDisposed(),ne.transpose(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),ne.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),ne.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),ne.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),ne.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),ne.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),ne.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),ne.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),ne.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),ne.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),ne.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),ne.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),ne.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),ne.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),ne.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),ne.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),ne.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),ne.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),ne.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),ne.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),ne.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),ne.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),ne.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),ne.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),ne.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),ne.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),ne.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),ne.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),ne.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),ne.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),ne.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),ne.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),ne.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),ne.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),ne.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),ne.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),ne.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),ne.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),ne.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),ne.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),ne.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),ne.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),ne.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),ne.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),ne.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),ne.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),ne.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),ne.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),ne.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),ne.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),ne.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),ne.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),ne.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),ne.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),ne.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),ne.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),ne.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),ne.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),ne.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),ne.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),ne.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ne.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ne.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),ne.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),ne.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,i,o,a){return i===void 0&&(i="NWC"),o===void 0&&(o=1),this.throwIfDisposed(),ne.conv1d(this,t,n,r,i,o,a)},e.prototype.conv2d=function(t,n,r,i,o,a){return i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),ne.conv2d(this,t,n,r,i,o,a)},e.prototype.conv2dTranspose=function(t,n,r,i,o){return this.throwIfDisposed(),ne.conv2dTranspose(this,t,n,r,i,o)},e.prototype.depthwiseConv2D=function(t,n,r,i,o,a){return i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),ne.depthwiseConv2d(this,t,n,r,i,o,a)},e.prototype.separableConv2d=function(t,n,r,i,o,a){return o===void 0&&(o=[1,1]),a===void 0&&(a="NHWC"),this.throwIfDisposed(),ne.separableConv2d(this,t,n,r,i,o,a)},e.prototype.avgPool=function(t,n,r,i){return this.throwIfDisposed(),ne.avgPool(this,t,n,r,i)},e.prototype.maxPool=function(t,n,r,i){return this.throwIfDisposed(),ne.maxPool(this,t,n,r,i)},e.prototype.localResponseNormalization=function(t,n,r,i){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5),ne.localResponseNormalization(this,t,n,r,i)},e.prototype.pool=function(t,n,r,i,o){return this.throwIfDisposed(),ne.pool(this,t,n,r,i,o)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),Xi().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),ne.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),ne.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),ne.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),ne.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,i,o,a,s,u){return i===void 0&&(i=0),o===void 0&&(o=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),ne.stridedSlice(this,t,n,r,i,o,a,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),ne.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),ne.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),ne.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),ne.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),ne.spectral.irfft(this)},e}();Object.defineProperty(Lt,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var w_,Q1,J1,Z1,eb,gc=function(e){function t(n,r,i,o){var a=e.call(this,n.shape,n.dtype,n.dataId,o)||this;return a.trainable=r,a.name=i,a}return Ni(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!bn(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");Xi().disposeTensor(this),this.dataId=n.dataId,Xi().incRef(this,null)},t.prototype.dispose=function(){Xi().disposeVariable(this),this.isDisposedInternal=!0},t}(Lt);Object.defineProperty(gc,Symbol.hasInstance,{value:function(e){return e instanceof Lt&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(w_||(w_={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(Q1||(Q1={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(J1||(J1={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Z1||(Z1={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(eb||(eb={}));var LK={float32:Z1,int32:Q1,bool:J1,complex64:eb};function Tn(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return LK[e][t]}function A0(e){return Tn(e,"int32")}function $t(e,t){if(e.dtype===t.dtype)return[e,t];var n=Tn(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function FK(e,t){W(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function LN(e){var t=[];return function n(r,i,o){if(r!=null){if(r instanceof Lt)return void i.push(r);if(a=r,!(!Array.isArray(a)&&typeof a!="object")){var a,s=r;for(var u in s){var c=s[u];o.has(c)||(o.add(c),n(c,i,o))}}}}(e,t,new Set),t}var M0,x_=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),BK=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new x_}return e.prototype.ready=function(){return _e(this,void 0,void 0,function(){var t,n,r;return ke(this,function(i){switch(i.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,i.label=1;case 1:return n<t.length?(r=t[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return i.sent()?[4,this.setBackend(r)]:[3,4];case 3:return i.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:r},!0)},e.prototype.setBackend=function(t){return _e(this,void 0,void 0,function(){var n,r,i;return ke(this,function(o){switch(o.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return i=o.sent(),[3,3];case 2:i=r,o.label=3;case 3:if(!i)return[2,!1];o.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new DK(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;v_(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;v_(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var i=r.factory();if(Promise.resolve(i)===i){var o=++this.pendingBackendInitId,a=i.then(function(s){return!(o<n.pendingBackendInitId)&&(n.registry[t]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(o<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[t]=i,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return t.registryFactory[r].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var r=t[n],i=this.initializeBackend(r),o=i.success,a=i.asyncInit;if(a||o)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var r=this.state.tensorInfo.get(n),i=r.backend,o=this.readSync(n);i.disposeData(n),r.backend=t,t.move(n,o,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var r,i=this,o=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=t}return this.scopedRun(function(){return i.startScope(o)},function(){return i.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},e.prototype.scopedRun=function(t,n,r){t();try{var i=r();return n(),i}catch(o){throw n(),o}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[n],function(i){return{x:function(){return i.toFloat()}}},[]),n},e.prototype.runKernel=function(t,n,r,i,o){return this.runKernelFunc(null,n,null,t,r,i,o)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,r){var i=this.backend.numDataIds(),o=0;r.forEach(function(u){o+=u.dtype==="complex64"?3:1});var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=i-n-o-a;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,r,i,o,a,s){var u,c=this;a===void 0&&(a=[]),s===void 0&&(s=[]);var l=[],d=this.isTapeOn();i==null&&(i=this.state.activeScope!=null?this.state.activeScope.name:"");var f,h=function(y){d&&(l=y.map(function(b){return c.keep(c.clone(b))}))},p=this.state.numBytes,m=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,v=kN(i,this.backendName);return f=v!=null?function(){var y=c.backend.numDataIds();g=v.kernelFunc({inputs:n,attrs:o,backend:c.backend});var b=Array.isArray(g)?g:[g];c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(i,y,b);var w=b.map(function(x){var R=x.dataId,S=x.shape,_=x.dtype;return c.makeTensorFromDataId(R,S,_)}),E=w.filter(function(x,R){return s[R]});return h((a||[]).slice().concat(E)),w}:function(){var y=c.backend.numDataIds();g=c.tidy(function(){return t(c.backend,h)});var b=Array.isArray(g)?g:[g];return c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(i,y,b),b},this.scopedRun(function(){return c.state.kernelDepth++},function(){return c.state.kernelDepth--},function(){u=c.ENV.getBool("DEBUG")?c.profiler.profileKernel(i,n,function(){return f()}):f()}),d&&this.addTapeNode(i,n,u,r,l),this.state.profiling&&this.state.activeProfile.kernels.push({name:i,bytesAdded:this.state.numBytes-p,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-m,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(y){return n[y].shape}),outputShapes:u.map(function(y){return y.shape})}),Array.isArray(g)?u:u[0]},e.prototype.makeTensor=function(t,n,r,i){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;var o=t;r==="string"&&ix(t[0])&&(o=t.map(function(l){return PK(l)}));var a=i.write(o,n,r),s=new Lt(n,r,a,this.nextTensorId());if(this.incRef(s,i),r==="string"){var u=this.state.tensorInfo.get(a),c=IK(o);this.state.numBytes+=c-u.bytes,u.bytes=c}return s},e.prototype.makeTensorFromDataId=function(t,n,r,i){var o=new Lt(n,r=r||"float32",t,this.nextTensorId());return this.incRef(o,i),o},e.prototype.makeVariable=function(t,n,r,i){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),i!=null&&i!==t.dtype&&(t=t.asType(i));var o=new gc(t,n,r,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error("Variable with name "+o.name+" was already registered");return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o},e.prototype.incRef=function(t,n){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var i=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(i=t.size*ON(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:i,refCount:0}),this.state.numBytes+=i}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof gc||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return _e(this,void 0,void 0,function(){var n,r;return ke(this,function(i){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(o){return o.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,r,i,o){var a=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:o},u=wK(t);u!=null&&(i=u.gradFunc),i!=null&&(s.gradient=function(c){return c=c.map(function(l,d){if(l==null){var f=r[d],h=rf(f.size,f.dtype);return a.makeTensor(h,f.shape,f.dtype)}return l}),i(c.length>1?c:c[0],o)}),this.state.activeTape.push(s)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,r=LN(t),i=new Set(r.map(function(u){return u.id})),o=0;o<this.state.activeScope.track.length;o++){var a=this.state.activeScope.track[o];a.kept||i.has(a.id)||a.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||n.track(u)})},e.prototype.gradients=function(t,n,r,i){var o=this;if(i===void 0&&(i=!1),W(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var a=this.scopedRun(function(){return o.startTape()},function(){return o.endTape()},function(){return o.tidy("forward",t)});W(a instanceof Lt,function(){return"The result y returned by f() must be a tensor."});var s=function(u,c,l){for(var d={},f={},h=0;h<c.length;h++)d[c[h].id]=!0;for(h=0;h<u.length;h++){var p=(x=u[h]).inputs;for(var m in p){for(var g=p[m],v=!1,y=0;y<c.length;y++)if(d[g.id]){x.outputs.forEach(function(T){return d[T.id]=!0}),v=!0,f[x.id]=!0;break}if(v)break}}var b={};b[l.id]=!0;var w={};for(h=u.length-1;h>=0;h--)for(p=(x=u[h]).inputs,y=0;y<x.outputs.length;y++)if(b[x.outputs[y].id]){for(var m in p)b[p[m].id]=!0,w[x.id]=!0;break}var E=[];for(h=0;h<u.length;h++){var x;if(f[(x=u[h]).id]&&w[x.id]){var R={};for(var m in x.inputs){var S=x.inputs[m];d[S.id]&&(R[m]=S)}var _=Object.assign({},x);_.inputs=R,_.outputs=x.outputs,E.push(_)}}return E}(this.state.activeTape,n,a);if(!i&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,c,l={};l[a.id]=r??(u=a.shape,c=NN(Re(u),"float32"),X.makeTensor(c,u,"float32")),function(f,h,p){for(var m=function(v){var y=h[v],b=[];if(y.outputs.forEach(function(R){var S=f[R.id];S!=null?b.push(S):b.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.kernelName+".");var w=y.gradient(b),E=function(R){if(!(R in w))throw new Error("Cannot backprop through input "+R+". Available gradients found: "+Object.keys(w)+".");var S=p(function(){return w[R]()});if(S.dtype!=="float32")throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input "+R+" must have 'float32' dtype, but has '"+S.dtype+"'");var _=y.inputs[R];if(!bn(S.shape,_.shape))throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input '"+R+"' has shape '"+S.shape+"', which does not match the shape of the input '"+_.shape+"'");if(f[_.id]==null)f[_.id]=S;else{var T=f[_.id];f[_.id]=T.add(S),T.dispose()}};for(var x in y.inputs)E(x)},g=h.length-1;g>=0;g--)m(g)}(l,s,function(f){return o.tidy(f)});var d=n.map(function(f){return l[f.id]});return o.state.gradientDepth===0&&(o.state.activeTape.forEach(function(f){for(var h=0,p=f.saved;h<p.length;h++)p[h].dispose()}),o.state.activeTape=null),{value:a,grads:d}})},e.prototype.customGrad=function(t){var n=this;return W(K1(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];W(i.every(function(s){return s instanceof Lt}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a={};return i.forEach(function(s,u){a[u]=s}),n.runKernelFunc(function(s,u){return W((r=t.apply(void 0,i.concat([u]))).value instanceof Lt,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),W(K1(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},a,function(s,u){var c=r.gradFunc(s,u),l=Array.isArray(c)?c:[c];W(l.length===i.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),W(l.every(function(f){return f instanceof Lt}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var d={};return l.forEach(function(f,h){d[h]=function(){return f}}),d})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return _e(this,void 0,void 0,function(){var n,r;return ke(this,function(i){switch(i.label){case 0:return n=Gi(),[4,this.backend.time(t)];case 1:return(r=i.sent()).wallMs=Gi()-n,[2,r]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new x_,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),X=function(){var e=function(){if(M0==null){var n=void 0;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(typeof self>"u")throw new Error("Could not find a global object");n=self}M0=n}return M0}();if(e._tfengine==null){var t=new yK(e);e._tfengine=new BK(t)}return function(n){_N=n}(e._tfengine.ENV),Xi=function(){return e._tfengine},e._tfengine}();function FN(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var ho=ae();ho.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),ho.registerFlag("IS_BROWSER",function(){return FN()}),ho.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),ho.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),ho.registerFlag("PROD",function(){return!1}),ho.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return ho.getBool("DEBUG")}),ho.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),ho.registerFlag("IS_TEST",function(){return!1});var yd,jr,Lr,Qa={},L0={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function jK(e,t){Qa[e]=t}function uo(e){e in Qa||(Qa[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(i){if(typeof OffscreenCanvas<"u"&&i===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(i){i.preventDefault(),delete Qa[n]},!1),n===1?r.getContext("webgl",L0)||r.getContext("experimental-webgl",L0):r.getContext("webgl2",L0)}(e));var t=Qa[e];return t.isContextLost()?(delete Qa[e],uo(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Qa[e])}function Am(e,t){return[t,e]}function Bl(e){var t=Re(e);return X1(Math.ceil(t/4))}function of(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function ox(e,t){var n,r,i,o,a,s,u,c,l,d=e;return ae().getNumber("WEBGL_VERSION")===2?(n=d.R32F,r=d.R16F,i=d.RGBA16F,o=d.RGBA32F,a=d.RED,s=4,u=1,c=d.HALF_FLOAT,l=d.FLOAT):(n=e.RGBA,r=e.RGBA,i=e.RGBA,o=d.RGBA,a=e.RGBA,s=4,u=4,c=t!=null?t.HALF_FLOAT_OES:null,l=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:l}}function Ie(e,t,n){var r=n();return t&&function(i){var o=i.getError();if(o!==i.NO_ERROR)throw new Error("WebGL Error: "+UK(i,o))}(e),r}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(yd||(yd={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(jr||(jr={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Lr||(Lr={}));var $K=596e-10,VK=65504;function WK(e){return!!(ae().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||$K<Math.abs(e)&&Math.abs(e)<VK)}function UK(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function oh(e,t,n){return Mo(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function zK(e,t,n){var r=Mo(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(Ie(e,t,function(){return e.shaderSource(r,n)}),Ie(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function HK(e,t,n){var r=Mo(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(Ie(e,t,function(){return e.shaderSource(r,n)}),Ie(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw function(i,o){var a=GK.exec(o);if(a==null)return console.log("Couldn't parse line number in error: "+o),void console.log(i);for(var s=+a[1],u=i.split(`
`),c=u.length.toString().length+2,l=u.map(function(g,v){return Wu((v+1).toString(),c)+g}),d=0,f=0;f<l.length;f++)d=Math.max(l[f].length,d);var h=l.slice(0,s-1),p=l.slice(s-1,s),m=l.slice(s);console.log(h.join(`
`)),console.log(o.split(`
`)[0]),console.log("%c "+Wu(p[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(m.join(`
`))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var F0,B0,GK=/ERROR: [0-9]+:([0-9]+):/g;function qK(e,t){return Mo(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function XK(e,t,n){if(Ie(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function j0(e,t,n){if(Ie(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function KK(e,t,n){var r=Mo(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return Ie(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),Ie(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function YK(e,t,n){var r=Mo(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return Ie(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),Ie(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function QK(e,t){return Mo(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function JK(e,t){var n=ae().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function ZK(e,t){return Mo(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function E_(e,t,n,r,i,o,a,s){var u=e.getAttribLocation(n,r);return u!==-1&&(Ie(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,i)}),Ie(e,t,function(){return e.vertexAttribPointer(u,o,e.FLOAT,!1,a,s)}),Ie(e,t,function(){return e.enableVertexAttribArray(u)}),!0)}function eY(e,t,n,r){oY(e,r),Ie(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),Ie(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function tY(e,t,n,r){return Mo(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function nY(e,t,n){return e.getUniformLocation(t,n)}function rY(e,t,n,r,i,o){Ie(e,t,function(){return eY(e,t,r,o)}),Ie(e,t,function(){return e.uniform1i(i,o)})}function $0(e,t,n,r){Ie(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),Ie(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function S_(e,t,n){Ie(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),Ie(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function ah(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+iY(e,t))}function iY(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function Mo(e,t,n,r){var i=Ie(e,t,function(){return n()});if(i==null)throw new Error(r);return i}function oY(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function Jp(e,t){return t===void 0&&(t=2),Re(e.slice(0,e.length-t))}function Zp(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function V0(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[Jp(e)].concat(Zp(e))),t}function aY(e,t){var n;t===void 0&&(t=!1);var r=ae().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(e=e.map(function(c,l){return l>=e.length-2?TN(e[l]):e[l]})).length===1&&(e=[2,e[0]])),e.length!==2){var i=es(e);e=i.newShape}var o=Re(e);if(e.length<=1&&o<=r)return[1,o];if(e.length===2&&e[0]<=r&&e[1]<=r)return e;if(e.length===3&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var a=Jp(e),s=2,u=2;return e.length&&(s=(n=Zp(e))[0],u=n[1]),X1(o=a*(s/2)*(u/2)).map(function(c){return 2*c})}return X1(o)}function sh(e){return e%2==0}function uh(e,t){if(bn(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r||sh(n)&&sh(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&sh(e[0])&&sh(t[0])}function sY(e){if(F0==null){var t=uo(e);F0=t.getParameter(t.MAX_TEXTURE_SIZE)}return F0}function uY(e){if(B0==null){var t=uo(e);B0=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,B0)}function cY(e){if(e===0)return 0;var t=uo(e);return ni(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:ni(t,"EXT_disjoint_timer_query")?1:0}function ni(e,t){return e.getExtension(t)!=null}function C_(e){try{if(uo(e)!=null)return!0}catch{return!1}return!1}function lY(e){if(e===0)return!1;var t=uo(e);if(e===1){if(!ni(t,"OES_texture_float"))return!1}else if(!ni(t,"EXT_color_buffer_float"))return!1;return tb(t)}function dY(e){if(e===0)return!1;var t=uo(e);if(e!==1){if(ni(t,"EXT_color_buffer_float"))return tb(t);if(ni(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(r,i){var o=ox(r,i),a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,o.internalFormatHalfFloat,1,1,0,o.textureFormatFloat,o.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(a),r.deleteFramebuffer(s),u}(t,n)}return!1}return!!ni(t,"OES_texture_float")&&!!ni(t,"WEBGL_color_buffer_float")&&tb(t)}function tb(e){var t=ox(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),i}function fY(e){return e===2&&uo(e).fenceSync!=null}var Fe=ae();function BN(e){ae().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Se(e,t){return X.tidy(e,t)}function Rr(e){LN(e).forEach(function(t){return t.dispose()})}function hY(e){return X.keep(e)}function ev(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];ae().getBool("IS_TEST")||console.warn.apply(console,e)}function $a(e,t){var n=e;if(to(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||to(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&ae().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function i(o,a,s){if(s=s||[],!Array.isArray(o)&&!to(o))return void W(a.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+a[0]+" elements"});W(a.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+o.length+" elements"}),W(o.length===a[0],function(){return"Element arr["+s.join("][")+"] should have "+a[0]+" elements, but has "+o.length+" elements"});for(var u=a.slice(1),c=0;c<o.length;++c)i(o[c],u,s.concat(c))}(e,r,[]),r}function __(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function $(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof Lt)return __(r,e.dtype,t,n),e;var i=nf(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),__(r,i,t,n),e==null||!to(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var o=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+o+"'")}var a=$a(e,i);to(e)||Array.isArray(e)||(e=[e]);var s=i!=="string"?PN(e,i,ae().getBool("DEBUG")):mc(e,[],!0);return X.makeTensor(s,a,i)}function tv(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(i,o){return $(i,t+"["+o+"]",n)},r)}function jN(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function pY(e,t,n){for(var r=e.length+t.length,i=[],o=0,a=0,s=0;s<r;s++)n.indexOf(s)===-1?i.push(e[o++]):i.push(t[a++]);return i}function Un(e,t){for(var n=[],r=e.length,i=0;i<r;i++)t.indexOf(i)===-1&&n.push(e[i]);return[n,t.map(function(o){return e[o]})]}function Ir(e,t){return pY(e,t.map(function(n){return 1}),t)}function Ar(e,t,n){W(jN(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function co(e,t){if(jN(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(i){return n.push(i)}),n}function ax(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function lo(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function vY(e,t){var n=e[0].length;e.forEach(function(i,o){W(i.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+o+"] must be the same as the rank of the rest ("+n+")"})}),W(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(i,o){for(var a=0;a<n;a++)W(a===t||i[a]===r[a],function(){return"Error in concat"+n+"D: Shape of tensors["+o+"] ("+i+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+o+"."})})}function yc(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function z(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];X.startScope(n);try{var s=r.apply(void 0,o);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),X.endScope(s),s}catch(u){throw X.endScope(null),u}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}Fe.registerFlag("HAS_WEBGL",function(){return Fe.getNumber("WEBGL_VERSION")>0}),Fe.registerFlag("WEBGL_VERSION",function(){return C_(2)?2:C_(1)?1:0}),Fe.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return Fe.get("WEBGL_VERSION")===2}),Fe.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Fe.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Fe.registerFlag("WEBGL_PACK",function(){return Fe.getBool("HAS_WEBGL")}),Fe.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Fe.getBool("WEBGL_PACK")}),Fe.registerFlag("WEBGL_PACK_CLIP",function(){return Fe.getBool("WEBGL_PACK")}),Fe.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Fe.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Fe.getBool("WEBGL_PACK")}),Fe.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Fe.getBool("WEBGL_PACK")}),Fe.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Fe.getBool("WEBGL_PACK")}),Fe.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Fe.getBool("WEBGL_PACK")}),Fe.registerFlag("WEBGL_PACK_REDUCE",function(){return Fe.getBool("WEBGL_PACK")}),Fe.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Fe.getBool("WEBGL_PACK")}),Fe.registerFlag("WEBGL_CONV_IM2COL",function(){return Fe.getBool("WEBGL_PACK")}),Fe.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return sY(Fe.getNumber("WEBGL_VERSION"))}),Fe.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return uY(Fe.getNumber("WEBGL_VERSION"))}),Fe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=Fe.getNumber("WEBGL_VERSION");return e===0?0:cY(e)}),Fe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Fe.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),Fe.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return lY(Fe.getNumber("WEBGL_VERSION"))}),Fe.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Fe.getBool("WEBGL_FORCE_F16_TEXTURES")&&Fe.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Fe.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return dY(Fe.getNumber("WEBGL_VERSION"))}),Fe.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return fY(Fe.getNumber("WEBGL_VERSION"))}),Fe.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Fe.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),MN=BN;var In=z({complex_:function(e,t){var n=$(e,"real","complex"),r=$(t,"imag","complex");return dt(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),X.runKernelFunc(function(i){return i.complex(n,r)},{$real:n,$imag:r})}}),ei=z({real_:function(e){var t=$(e,"input","real");return X.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),Ki=z({imag_:function(e){var t=$(e,"input","imag");return X.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function On(e,t,n){return Va(e,t,$a(e,n),n)}function Va(e,t,n,r){if(r==null&&(r=nf(e)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!to(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){DN(t);var i=Re(t),o=Re(n);W(i===o,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+i+" values but has "+o});for(var a=0;a<n.length;++a){var s=n[a],u=a!==n.length-1||s!==Re(t.slice(a));W(n[a]===t[a]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return to(e)||Array.isArray(e)||(e=[e]),t=t||n,e=r!=="string"?PN(e,r,ae().getBool("DEBUG")):mc(e,[],!0),X.makeTensor(e,t,r)}function ye(e,t){if((to(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&to(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Va(e,[],[],t)}function tn(e,t){$c(e);var n=$a(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Va(e,null,n,t)}function Ea(e,t,n){if($c(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=$a(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Va(e,t,r,n)}function sx(e,t,n){if($c(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=$a(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Va(e,t,r,n)}function gr(e,t,n){if($c(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=$a(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Va(e,t,r,n)}function mY(e,t,n){if($c(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=$a(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Va(e,t,r,n)}function gY(e,t,n){if($c(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=$a(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Va(e,t=t||r,r,n)}function yY(e,t,n,r){return t===void 0&&(t=!0),X.makeVariable(e,t,n,r)}function Vc(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Vc(e,"float32"),r=Rt(e,"float32");return In(n,r)}var i=NN(Re(e),t);return X.makeTensor(i,e,t)}function Rt(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Rt(e,"float32"),r=Rt(e,"float32");return In(n,r)}var i=rf(Re(e),t);return X.makeTensor(i,e,t)}function ro(e,t,n){return X.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function bY(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return X.runKernelFunc(function(r){return r.linspace(e,t,n)},{})}function nv(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return Rt([0],r);var i=rf(Math.abs(Math.ceil((t-e)/n)),r);t<e&&n===1&&(n=-1),i[0]=e;for(var o=1;o<i.length;o++)i[o]=i[o-1]+n;return tn(i,r)}var $N=z({onesLike_:function(e){var t=$(e,"x","onesLike");if(t.dtype==="complex64"){var n=$N(ei(t)),r=rt(Ki(t));return In(n,r)}return X.runKernelFunc(function(i){return i.onesLike(t)},{$x:t},function(i,o){return{$x:function(){return rt(i)}}})}}),rt=z({zerosLike_:function(e){var t=$(e,"x","zerosLike");return X.runKernelFunc(function(n){return n.zerosLike(t)},{$x:t},function(n,r){return{$x:function(){return rt(n)}}})}}),an=z({concat_:function(e,t){t===void 0&&(t=0),W(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=tv(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),t=dn(t,n[0].shape)[0];var r=yc(n.map(function(s){return s.shape}),t);if(Re(r)===0)return On([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var i=n.map(function(s){return s.shape});vY(i,t);var o=n,a={axis:t};return X.runKernelFunc(function(s){return s.concat(n,t)},o,function(s){var u=i.map(function(c){return c[t]});return ux(s,u,t).map(function(c){return function(){return c}})},"Concat",a)}}),wY=z({concat1d_:function(e){return an(e,0)}}),xY=z({concat2d_:function(e,t){return an(e,t)}}),EY=z({concat3d_:function(e,t){return an(e,t)}}),SY=z({concat4d_:function(e,t){return an(e,t)}}),ux=z({split_:function(e,t,n){n===void 0&&(n=0);var r,i=$(e,"x","split");return n=dn(n,i.shape)[0],typeof t=="number"?(W(i.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(i.shape[n]/t)):(W(i.shape[n]===t.reduce(function(o,a){return o+a}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),X.runKernelFunc(function(o){return o.split(i,r,n)},{$x:i},function(o){return{$x:function(){return an(o,n)}}})}});function Ws(e,t){return e(t={exports:{}},t.exports),t.exports}var CY=Ws(function(e){(function(t,n,r){function i(s){var u,c=this,l=(u=4022871197,function(d){d=d.toString();for(var f=0;f<d.length;f++){var h=.02519603282416938*(u+=d.charCodeAt(f));h-=u=h>>>0,u=(h*=u)>>>0,u+=4294967296*(h-=u)}return 23283064365386963e-26*(u>>>0)});c.next=function(){var d=2091639*c.s0+23283064365386963e-26*c.c;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=0|d)},c.c=1,c.s0=l(" "),c.s1=l(" "),c.s2=l(" "),c.s0-=l(s),c.s0<0&&(c.s0+=1),c.s1-=l(s),c.s1<0&&(c.s1+=1),c.s2-=l(s),c.s2<0&&(c.s2+=1),l=null}function o(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function a(s,u){var c=new i(s),l=u&&u.state,d=c.next;return d.int32=function(){return 4294967296*c.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,l&&(typeof l=="object"&&o(l,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=a:this.alea=a})(0,e)}),_Y=Ws(function(e){(function(t,n,r){function i(s){var u=this,c="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},s===(0|s)?u.x=s:c+=s;for(var l=0;l<c.length+64;l++)u.x^=0|c.charCodeAt(l),u.next()}function o(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function a(s,u){var c=new i(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=c.next,d.quick=d,l&&(typeof l=="object"&&o(l,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=a:this.xor128=a})(0,e)}),kY=Ws(function(e){(function(t,n,r){function i(s){var u=this,c="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^d^d<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:c+=s;for(var l=0;l<c.length+64;l++)u.x^=0|c.charCodeAt(l),l==c.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function o(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function a(s,u){var c=new i(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=c.next,d.quick=d,l&&(typeof l=="object"&&o(l,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=a:this.xorwow=a})(0,e)}),RY=Ws(function(e){(function(t,n,r){function i(s){var u=this;u.next=function(){var c,l,d=u.x,f=u.i;return c=d[f],l=(c^=c>>>7)^c<<24,l^=(c=d[f+1&7])^c>>>10,l^=(c=d[f+3&7])^c>>>3,l^=(c=d[f+4&7])^c<<7,c=d[f+7&7],l^=(c^=c<<13)^c<<9,d[f]=l,u.i=f+1&7,l},function(c,l){var d,f=[];if(l===(0|l))f[0]=l;else for(l=""+l,d=0;d<l.length;++d)f[7&d]=f[7&d]<<15^l.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],c.x=f,c.i=0,d=256;d>0;--d)c.next()}(u,s)}function o(s,u){return u.x=s.x.slice(),u.i=s.i,u}function a(s,u){s==null&&(s=+new Date);var c=new i(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=c.next,d.quick=d,l&&(l.x&&o(l,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=a:this.xorshift7=a})(0,e)}),IY=Ws(function(e){(function(t,n,r){function i(s){var u=this;u.next=function(){var c,l,d=u.w,f=u.X,h=u.i;return u.w=d=d+1640531527|0,l=f[h+34&127],c=f[h=h+1&127],l^=l<<13,c^=c<<17,l^=l>>>15,c^=c>>>12,l=f[h]=l^c,u.i=h,l+(d^d>>>16)|0},function(c,l){var d,f,h,p,m,g=[],v=128;for(l===(0|l)?(f=l,l=null):(l+="\0",f=0,v=Math.max(v,l.length)),h=0,p=-32;p<v;++p)l&&(f^=l.charCodeAt((p+32)%l.length)),p===0&&(m=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,p>=0&&(m=m+1640531527|0,h=(d=g[127&p]^=f+m)==0?h+1:0);for(h>=128&&(g[127&(l&&l.length||0)]=-1),h=127,p=512;p>0;--p)f=g[h+34&127],d=g[h=h+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,g[h]=f^d;c.w=m,c.X=g,c.i=h}(u,s)}function o(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function a(s,u){s==null&&(s=+new Date);var c=new i(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=c.next,d.quick=d,l&&(l.X&&o(l,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=a:this.xor4096=a})(0,e)}),TY=Ws(function(e){(function(t,n,r){function i(s){var u=this,c="";u.next=function(){var d=u.b,f=u.c,h=u.d,p=u.a;return d=d<<25^d>>>7^f,f=f-h|0,h=h<<24^h>>>8^p,p=p-d|0,u.b=d=d<<20^d>>>12^f,u.c=f=f-h|0,u.d=h<<16^f>>>16^p,u.a=p-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):c+=s;for(var l=0;l<c.length+20;l++)u.b^=0|c.charCodeAt(l),u.next()}function o(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function a(s,u){var c=new i(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=c.next,d.quick=d,l&&(typeof l=="object"&&o(l,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=a:this.tychei=a})(0,e)}),Ja=Ws(function(e){(function(t,n){var r,i=this,o=256,a=6,s="random",u=n.pow(o,a),c=n.pow(2,52),l=2*c,d=o-1;function f(v,y,b){var w=[],E=m(function S(_,T){var B,L=[],k=typeof _;if(T&&k=="object")for(B in _)try{L.push(S(_[B],T-1))}catch{}return L.length?L:k=="string"?_:_+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[v,g(t)]:v??function(){try{var S;return r&&(S=r.randomBytes)?S=S(o):(S=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(S)),g(S)}catch{var _=i.navigator,T=_&&_.plugins;return[+new Date,i,T,i.screen,g(t)]}}(),3),w),x=new h(w),R=function(){for(var S=x.g(a),_=u,T=0;S<c;)S=(S+T)*o,_*=o,T=x.g(1);for(;S>=l;)S/=2,_/=2,T>>>=1;return(S+T)/_};return R.int32=function(){return 0|x.g(4)},R.quick=function(){return x.g(4)/4294967296},R.double=R,m(g(x.S),t),(y.pass||b||function(S,_,T,B){return B&&(B.S&&p(B,x),S.state=function(){return p(x,{})}),T?(n[s]=S,_):S})(R,E,"global"in y?y.global:this==n,y.state)}function h(v){var y,b=v.length,w=this,E=0,x=w.i=w.j=0,R=w.S=[];for(b||(v=[b++]);E<o;)R[E]=E++;for(E=0;E<o;E++)R[E]=R[x=d&x+v[E%b]+(y=R[E])],R[x]=y;(w.g=function(S){for(var _,T=0,B=w.i,L=w.j,k=w.S;S--;)_=k[B=d&B+1],T=T*o+k[d&(k[B]=k[L=d&L+_])+(k[L]=_)];return w.i=B,w.j=L,T})(o)}function p(v,y){return y.i=v.i,y.j=v.j,y.S=v.S.slice(),y}function m(v,y){for(var b,w=v+"",E=0;E<w.length;)y[d&E]=d&(b^=19*y[d&E])+w.charCodeAt(E++);return g(y)}function g(v){return String.fromCharCode.apply(0,v)}if(n["seed"+s]=f,m(n.random(),t),e.exports){e.exports=f;try{r=require("crypto")}catch{}}})([],Math)});Ja.alea=CY,Ja.xor128=_Y,Ja.xorwow=kY,Ja.xorshift7=RY,Ja.xor4096=IY,Ja.tychei=TY;var Mm=Ja.alea,cx=function(){function e(t,n,r,i,o){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=o||Math.random();this.random=Mm(a.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,r,i=!1;!i;){var o=void 0,a=void 0,s=void 0;do s=(o=2*this.random()-1)*o+(a=2*this.random()-1)*a;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*o*u,r=this.mean+this.stdDev*a*u,this.truncated&&!this.isValidTruncated(n)||(i=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),OY=function(){function e(t,n,r,i){this.alpha=t,this.beta=1/n,this.dtype=r;var o=i||Math.random();this.randu=Mm(o.toString()),this.randn=new cx(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,r,i,o,a;;){do i=this.randn.nextValue(),a=1+this.c*i;while(a<=0);if(a*=a*a,n=1-.331*(t=i*i)*t,r=.5*t+this.d*(1-a+Math.log(a)),(o=this.randu())<n||Math.log(o)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),PY=function(){function e(t,n,r,i){var o=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return o.dtype==null||o.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=Mm(i)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function je(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",DN(e),new gd(e,t,n)}function NY(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var VN=z({batchToSpaceND_:function(e,t,n){var r=$(e,"x","batchToSpaceND"),i=t.reduce(function(o,a){return o*a});return W(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),W(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),W(r.shape[0]%i==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+i}),X.runKernelFunc(function(o){return o.batchToSpaceND(r,t,n)},{$x:r},function(o){return{$x:function(){return o.spaceToBatchND(t,n)}}})}}),DY=z({broadcastTo_:function(e,t){var n=$(e,"broadcastTo","x"),r=n.shape;if(t.some(function(u){return!(u>0)||u%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var i=n.shape.slice();i.length<t.length;)i.unshift(1);n=n.reshape(i)}for(var o=Array.from(t),a=t.length-1;a>=0;a--)if(n.shape[a]===t[a])o[a]=1;else if(n.shape[a]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var s=o.map(function(u,c){return u>1?c:-1}).filter(function(u){return u>=0});return s.length===0?n.clone():X.runKernelFunc(function(u){return u.tile(n,o)},{input:n},function(u){return{input:function(){return u.sum(s,!0)}}})}}),AY=z({cast_:function(e,t){var n=$(e,"x","cast");if(!kK(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return X.runKernelFunc(function(i){return i.cast(n,t)},{x:n},function(i){return{x:function(){return i.clone()}}},"Cast",r)}}),MY=z({clone_:function(e){var t=$(e,"x","clone",null);return X.runKernelFunc(function(){return X.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(n){return{$x:function(){return n.toFloat()}}})}}),LY=z({cumsum_:function(e,t,n,r){t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var i=$(e,"x","cumsum"),o=co([t|=0],i.rank),a=i;o!=null&&(a=i.transpose(o));var s=lo(1,i.rank)[0],u=X.runKernelFunc(function(c){return c.cumsum(a,s,n,r)},{permutedX:a},function(c){return{permutedX:function(){return c.cumsum(t,n,!r)}}});return o!=null&&(u=u.transpose(o)),u}}),FY=z({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var r=$(e,"x","depthToSpace"),i=n==="NHWC"?r.shape[1]:r.shape[2],o=n==="NHWC"?r.shape[2]:r.shape[3],a=n==="NHWC"?r.shape[3]:r.shape[1];return W(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),W(o*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+t+` for depthToSpace with input shape
          `+r.shape}),W(a%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+a+" for depthToSpace with input shape "+r.shape}),X.runKernelFunc(function(s){return s.depthToSpace(r,t,n)},{$x:r})}}),Zr=z({expandDims_:function(e,t){t===void 0&&(t=0);var n=$(e,"x","expandDims",null);W(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(W(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),xi(n,r)}}),WN=z({eye_:function(e,t,n,r){r===void 0&&(r="float32"),t==null&&(t=e);for(var i=je([e,t],r),o=e<=t?e:t,a=0;a<o;++a)i.set(1,a,a);var s=i.toTensor().as2D(e,t);if(n==null)return s;if(n.length===1)return Uu(Zr(s,0),[n[0],1,1]);if(n.length===2)return Uu(Zr(Zr(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return Uu(Zr(Zr(Zr(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),BY=z({multinomial_:function(e,t,n,r){r===void 0&&(r=!1);var i=$(e,"logits","multinomial"),o=i.size,a=i.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=a===1?i.as2D(1,-1):i,u=X.runKernelFunc(function(c){return c.multinomial(s,r,t,n)},{logits2D:s});return a===1?u.as1D():u}}),nb=z({oneHot_:function(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var i=$(e,"indices","oneHot","int32"),o=i.shape.concat([t]);return i=i.flatten(),X.runKernelFunc(function(a){return a.oneHot(i,t,n,r)},{$indices:i},function(a){return{$indices:function(){return Rt(i.shape,"float32")}}}).reshape(o)}}),Us=z({pad_:function(e,t,n){n===void 0&&(n=0);var r=$(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i={paddings:t,constantValue:n};return X.runKernelFunc(function(o){return o.pad(r,t,n)},{x:r},function(o){var a=t.map(function(s){return s[0]});return{x:function(){return o.slice(a,r.shape)}}},"PadV2",i)}}),jY=z({pad1d_:function(e,t,n){return n===void 0&&(n=0),W(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Us(e,[t],n)}}),$Y=z({pad2d_:function(e,t,n){return n===void 0&&(n=0),W(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Us(e,t,n)}}),VY=z({pad3d_:function(e,t,n){return n===void 0&&(n=0),W(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Us(e,t,n)}}),WY=z({pad4d_:function(e,t,n){return n===void 0&&(n=0),W(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Us(e,t,n)}}),UY=z({rand_:function(e,t,n){var r=Re(e),i=null;if(n==null||n==="float32")i=new Float32Array(r);else if(n==="int32")i=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var o=0;o<r;o++)i[o]=t();return X.makeTensor(i,e,n)}}),zY=z({randomNormal_:function(e,t,n,r,i){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var o=new cx(t,n,r,!1,i),a=je(e,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),HY=z({randomGamma_:function(e,t,n,r,i){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var o=new OY(t,n,r,i),a=je(e,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),UN=z({randomUniform_:function(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var o=je(e,r),a=new PY(t,n,null,i),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),xi=z({reshape_:function(e,t){var n=$(e,"x","reshape",null);t=CK(t,n.size),W(n.size===Re(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return X.runKernelFunc(function(i){return i.reshape(n,t)},{x:n},function(i){return{x:function(){return i.reshape(n.shape)}}},"Reshape",r)}}),zN=z({spaceToBatchND_:function(e,t,n){var r=$(e,"x","spaceToBatchND");return W(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),W(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),W(r.shape.reduce(function(i,o,a){return a>0&&a<=t.length?i&&(o+n[a-1][0]+n[a-1][1])%t[a-1]==0:i},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),X.runKernelFunc(function(i){return i.spaceToBatchND(r,t,n)},{$x:r},function(i){return{$x:function(){return i.batchToSpaceND(t,n)}}})}}),HN=z({squeeze_:function(e,t){var n=$(e,"x","squeeze");return xi(n,es(n.shape,t).newShape)}}),zr=z({stack_:function(e,t){t===void 0&&(t=0);var n=tv(e,"tensors","stack");if(W(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var r=n[0].rank,i=n[0].shape,o=n[0].dtype;W(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){dt(i,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){W(o===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var a=n.map(function(s){return s.expandDims(t)});return an(a,t)}}),Uu=z({tile_:function(e,t){var n=$(e,"x","tile",null);W(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],i={reps:t};return X.runKernelFunc(function(o,a){var s=o.tile(n,t);return a([n]),s},{x:n},function(o,a){var s=a[0];return{x:function(){var u=rt(s);if(s.rank===1)for(var c=0;c<t[0];++c)u=u.add(o.slice([c*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(c=0;c<t[0];++c)for(var l=0;l<t[1];++l)u=u.add(o.slice([c*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(c=0;c<t[0];++c)for(l=0;l<t[1];++l)for(var d=0;d<t[2];++d)u=u.add(o.slice([c*s.shape[0],l*s.shape[1],d*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else{if(s.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+s.rank+" tensors yet.");for(c=0;c<t[0];++c)for(l=0;l<t[1];++l)for(d=0;d<t[2];++d)for(var f=0;f<t[3];++f)u=u.add(o.slice([c*s.shape[0],l*s.shape[1],d*s.shape[2],f*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]))}return u}}},"Tile",i,r)}}),GY=z({truncatedNormal_:function(e,t,n,r,i){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var o=new cx(t,n,r,!0,i),a=je(e,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),sn=z({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=$(e,"x","unstack");W(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return X.runKernelFunc(function(i){return i.unstack(n,t)},{x:n},function(i){return{x:function(){return zr(i,t)}}},"Unpack",r)}}),qY=function(e,t){return _e(this,void 0,void 0,function(){var n,r,i,o,a,s,u,c,l,d;return ke(this,function(f){switch(f.label){case 0:return n=$(e,"x","setdiff1d"),r=$(t,"y","setdiff1d"),W(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),W(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),W(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return i=f.sent(),[4,r.data()];case 2:for(o=f.sent(),a=new Set(o),s=0,l=0;l<i.length;l++)a.has(i[l])||s++;for(u=new gd([s],n.dtype),c=new gd([s],"int32"),l=0,d=0;l<i.length;l++)a.has(i[l])||(u.values[d]=i[l],c.values[d]=l,d++);return[2,[u.toTensor(),c.toTensor()]]}})})};function rv(e,t,n,r){r===void 0&&(r=!0);var i=[];if(r)(i=i.concat(t.slice(0))).push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);for(var o=t.length,a=0;a<o;++a)i=i.concat([e[a+1]/t[a],t[a]]);i=i.concat(e.slice(o+1))}return i}function iv(e,t,n){n===void 0&&(n=!0);var r=[];if(n){r.push(t);for(var i=t+1;i<e;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{var o=[],a=[];for(i=1;i<e;++i)i>=2*t+1||i%2==1?a.push(i):o.push(i);r.push.apply(r,o),r.push(0),r.push.apply(r,a)}return r}function ov(e,t,n,r){r===void 0&&(r=!0);var i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(var o=1;o<e.length;++o)o<=t.length?r?i.push(t[o-1]*e[o]):i.push(e[o]/t[o-1]):i.push(e[o]);return i}function GN(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function qN(e,t,n){for(var r=e.slice(0,1),i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}function XN(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],i=1,o=0;o<n.length-1;++o)i*=n[o];var a=e.shape,s=n.slice();s.pop();var u=1;for(o=r;o<e.rank;++o)u*=a[o],s.push(a[o]);var c=no(e.shape).map(function(l){return l/u}).concat([1]).slice(0,r);return[s,i,u,c]}var KN=30;function W0(e){return e<=KN?e:Y1(e,Math.floor(Math.sqrt(e)))}function XY(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(o+" update.rank < "+i+". ");if(e.length<r+(n.rank-i))throw new Error(o+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+e.length-r)throw new Error(o+" update.rank != "+(i+e.length-r));for(var a=0;a<i;++a)if(n.shape[a]!==t.shape[a])throw new Error(o+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+t.shape[a]+").");for(a=0;a<n.rank-i;++a)if(n.shape[a+i]!==e[a+r])throw new Error(o+" updates.shape["+(a+i)+"] ("+n.shape[a+i]+") != shape["+(a+i)+"] ("+e[a+i]+")")}function KY(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}XY(n,t,e)}function av(e,t,n){for(var r=t.shape.length,i=r>1?t.shape[r-1]:1,o=n.length,a=1,s=i;s<o;++s)a*=n[s];var u=i<1?1:i;return{sliceRank:i,numUpdates:Re(t.shape)/u,sliceSize:a,strides:no(n.slice(0,i)).concat([1]),outputSize:Re(n)}}function YY(e,t,n){W(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),W(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(o){W(t[o]+n[o]<=e.shape[o],function(){return"Error in slice"+e.rank+"D: begin["+o+"] + size["+o+"] ("+(t[o]+n[o])+") would overflow input.shape["+o+"] ("+e.shape[o]+")"})},i=0;i<e.rank;++i)r(i)}function k_(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function lx(e,t,n){for(var r=[],i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function QY(e,t,n,r,i){var o=t[i],a=n[i]||1;(e&1<<i||o==null)&&(o=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[i];return o<0&&(o+=s),o=q1(0,o,s-1)}function JY(e,t,n,r,i){var o=t[i],a=n[i]||1;(e&1<<i||o==null)&&(o=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return o<0&&(o+=s),o=a>0?q1(0,o,s):q1(-1,o,s-1)}function YN(e,t,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function QN(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function ZY(e,t){W(K1(e),function(){return"The f passed in variableGrads(f) must be a function"}),W(t==null||Array.isArray(t)&&t.every(function(l){return l instanceof gc}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var r in t=[],X.registeredVariables)t.push(X.registeredVariables[r]);var i=n?t.filter(function(l){return!l.trainable}):null,o=t.length;W((t=t.filter(function(l){return l.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."});var a=X.gradients(e,t,null,!0),s=a.value,u=a.grads;W(u.some(function(l){return l!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),W(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var c={};return t.forEach(function(l,d){u[d]!=null&&(c[l.name]=u[d])}),i!=null&&i.forEach(function(l){return c[l.name]=null}),{value:s,grads:c}}function Lm(e){return X.customGrad(e)}var Lo=z({softmax_:function(e,t){t===void 0&&(t=-1);var n=$(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return X.runKernelFunc(function(r,i){var o=r.softmax(n,t);return i([o]),o},{logits:n},function(r,i){var o=i[0],a=r.mul(o);return{logits:function(){return a.sub(a.sum([t],!0).mul(o))}}},"Softmax",{dim:t},[],[!0])}}),eQ=z({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=$(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return Lm(function(r,i){var o=r.max(t,!0),a=r.sub(o),s=a.toFloat().sub(a.exp().sum(t,!0).log());return i([s]),{value:s,gradFunc:function(u,c){var l=c[0].exp();return u.sub(u.sum(t,!0).mul(l))}}})(n)}}),JN=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),ZN=function(){function e(){}return e.prototype.time=function(t){return ee("time")},e.prototype.read=function(t){return ee("read")},e.prototype.readSync=function(t){return ee("readSync")},e.prototype.numDataIds=function(){return ee("numDataIds")},e.prototype.disposeData=function(t){return ee("disposeData")},e.prototype.write=function(t,n,r){return ee("write")},e.prototype.move=function(t,n,r,i){return ee("move")},e.prototype.memory=function(){return ee("memory")},e.prototype.floatPrecision=function(){return ee("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,r,i){return ee("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,ee("fusedBatchMatMul")},e.prototype.slice=function(t,n,r){return ee("slice")},e.prototype.stridedSlice=function(t,n,r,i){return ee("stridedSlice")},e.prototype.unstack=function(t,n){return ee("unstack")},e.prototype.reverse=function(t,n){return ee("reverse")},e.prototype.concat=function(t,n){return ee("concat")},e.prototype.neg=function(t){return ee("neg")},e.prototype.add=function(t,n){return ee("add")},e.prototype.addN=function(t){return ee("addN")},e.prototype.subtract=function(t,n){return ee("subtract")},e.prototype.multiply=function(t,n){return ee("multiply")},e.prototype.realDivide=function(t,n){return ee("realDivide")},e.prototype.floorDiv=function(t,n){return ee("floorDiv")},e.prototype.sum=function(t,n){return ee("sum")},e.prototype.prod=function(t,n){return ee("prod")},e.prototype.unsortedSegmentSum=function(t,n,r){return ee("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return ee("argMin")},e.prototype.argMax=function(t,n){return ee("argMax")},e.prototype.equal=function(t,n){return ee("equal")},e.prototype.notEqual=function(t,n){return ee("notEqual")},e.prototype.less=function(t,n){return ee("less")},e.prototype.lessEqual=function(t,n){return ee("lessEqual")},e.prototype.greater=function(t,n){return ee("greater")},e.prototype.greaterEqual=function(t,n){return ee("greaterEqual")},e.prototype.logicalNot=function(t){return ee("logicalNot")},e.prototype.logicalAnd=function(t,n){return ee("logicalAnd")},e.prototype.logicalOr=function(t,n){return ee("logicalOr")},e.prototype.where=function(t){return ee("where")},e.prototype.select=function(t,n,r){return ee("select")},e.prototype.topk=function(t,n,r){return ee("topk")},e.prototype.min=function(t,n){return ee("min")},e.prototype.minimum=function(t,n){return ee("minimum")},e.prototype.mod=function(t,n){return ee("mod")},e.prototype.max=function(t,n){return ee("max")},e.prototype.maximum=function(t,n){return ee("maximum")},e.prototype.all=function(t,n){return ee("all")},e.prototype.any=function(t,n){return ee("any")},e.prototype.squaredDifference=function(t,n){return ee("squaredDifference")},e.prototype.ceil=function(t){return ee("ceil")},e.prototype.floor=function(t){return ee("floor")},e.prototype.round=function(t){return ee("round")},e.prototype.sign=function(t){return ee("sign")},e.prototype.isNaN=function(t){return ee("isNaN")},e.prototype.isInf=function(t){return ee("isInf")},e.prototype.isFinite=function(t){return ee("isFinite")},e.prototype.pow=function(t,n){return ee("pow")},e.prototype.exp=function(t){return ee("exp")},e.prototype.expm1=function(t){return ee("expm1")},e.prototype.softmax=function(t,n){return ee("softmax")},e.prototype.log=function(t){return ee("log")},e.prototype.log1p=function(t){return ee("log1p")},e.prototype.sqrt=function(t){return ee("sqrt")},e.prototype.rsqrt=function(t){return ee("rsqrt")},e.prototype.square=function(t){return ee("square")},e.prototype.reciprocal=function(t){return ee("reciprocal")},e.prototype.relu=function(t){return ee("relu")},e.prototype.relu6=function(t){return ee("relu6")},e.prototype.prelu=function(t,n){return ee("prelu")},e.prototype.elu=function(t){return ee("elu")},e.prototype.eluDer=function(t,n){return ee("eluDer")},e.prototype.selu=function(t){return ee("selu")},e.prototype.int=function(t){return ee("int")},e.prototype.clip=function(t,n,r){return ee("clip")},e.prototype.abs=function(t){return ee("abs")},e.prototype.complexAbs=function(t){return ee("complexAbs")},e.prototype.sigmoid=function(t){return ee("sigmoid")},e.prototype.softplus=function(t){return ee("softplus")},e.prototype.sin=function(t){return ee("sin")},e.prototype.cos=function(t){return ee("cos")},e.prototype.tan=function(t){return ee("tan")},e.prototype.asin=function(t){return ee("asin")},e.prototype.acos=function(t){return ee("acos")},e.prototype.atan=function(t){return ee("atan")},e.prototype.atan2=function(t,n){return ee("atan2")},e.prototype.sinh=function(t){return ee("sinh")},e.prototype.cosh=function(t){return ee("cosh")},e.prototype.tanh=function(t){return ee("tanh")},e.prototype.asinh=function(t){return ee("asinh")},e.prototype.acosh=function(t){return ee("acosh")},e.prototype.atanh=function(t){return ee("atanh")},e.prototype.erf=function(t){return ee("erf")},e.prototype.step=function(t,n){return ee("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,ee("fusedConv2d")},e.prototype.conv2d=function(t,n,r){return ee("conv2d")},e.prototype.conv2dDerInput=function(t,n,r){return ee("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,r){return ee("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,ee("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,r){return ee("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,r){return ee("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,r){return ee("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,r){return ee("conv3d")},e.prototype.conv3dDerInput=function(t,n,r){return ee("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,r){return ee("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return ee("maxPool")},e.prototype.maxPoolBackprop=function(t,n,r,i){return ee("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return ee("avgPool")},e.prototype.avgPoolBackprop=function(t,n,r){return ee("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return ee("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,r){return ee("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return ee("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,r,i){return ee("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return ee("reshape")},e.prototype.cast=function(t,n){return ee("cast")},e.prototype.tile=function(t,n){return ee("tile")},e.prototype.pad=function(t,n,r){return ee("pad")},e.prototype.transpose=function(t,n){return ee("transpose")},e.prototype.gather=function(t,n,r){return ee("gather")},e.prototype.gatherND=function(t,n){return ee("gatherND")},e.prototype.scatterND=function(t,n,r){return ee("scatterND")},e.prototype.batchToSpaceND=function(t,n,r){return ee("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,r){return ee("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,r,i){return ee("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,r){return ee("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,r,i){return ee("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,r){return ee("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,r,i,o,a){return ee("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,r,i,o){return ee("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,r,i,o,a,s){return ee("LRNGrad")},e.prototype.multinomial=function(t,n,r,i){return ee("multinomial")},e.prototype.oneHot=function(t,n,r,i){return ee("oneHot")},e.prototype.cumsum=function(t,n,r,i){return ee("cumsum")},e.prototype.nonMaxSuppression=function(t,n,r,i,o){return ee("nonMaxSuppression")},e.prototype.fft=function(t){return ee("fft")},e.prototype.ifft=function(t){return ee("ifft")},e.prototype.complex=function(t,n){return ee("complex")},e.prototype.real=function(t){return ee("real")},e.prototype.imag=function(t){return ee("imag")},e.prototype.cropAndResize=function(t,n,r,i,o,a){return ee("cropAndResize")},e.prototype.depthToSpace=function(t,n,r){return ee("depthToSpace")},e.prototype.split=function(t,n,r){return ee("split")},e.prototype.sparseToDense=function(t,n,r,i){return ee("sparseToDense")},e.prototype.diag=function(t){return ee("diag")},e.prototype.fill=function(t,n,r){return ee("fill")},e.prototype.onesLike=function(t){return ee("onesLike")},e.prototype.zerosLike=function(t){return ee("zerosLike")},e.prototype.linspace=function(t,n,r){return ee("linspace")},e.prototype.dispose=function(){return ee("dispose")},e}();function ee(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function la(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var o=n-1-i,a=e[o]||1;(t[t.length-1-i]||1)>1&&a===1&&r.unshift(o)}return r}function un(e,t){for(var n=[],r=0;r<t.length;r++){var i=e[e.length-r-1],o=t.length-r-1,a=t[o];(i==null||i===1&&a>1)&&n.unshift(o)}return n}function et(e,t){for(var n=[],r=Math.max(e.length,t.length),i=0;i<r;i++){var o=e[e.length-i-1];o==null&&(o=1);var a=t[t.length-i-1];if(a==null&&(a=1),o===1)n.unshift(a);else if(a===1)n.unshift(o);else{if(o!==a)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(o)}}return n}function bd(e,t,n,r,i,o,a){a===void 0&&(a="channelsLast");var s,u=cv(t),c=u[0],l=u[1];if(a==="channelsLast")s=[c,l,e[3],e[3]];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);s=[c,l,e[1],e[1]]}return zs(e,s,n,r,i,o,!1,a)}function sv(e,t,n,r,i,o,a){a===void 0&&(a="NDHWC");var s,u,c=rb(t),l=c[0],d=c[1],f=c[2];if(a==="NDHWC")u="channelsLast",s=[l,d,f,e[4],e[4]];else{if(a!=="NCDHW")throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[l,d,f,e[1],e[1]]}return uv(e,s,n,r,i,!1,u,o)}function zs(e,t,n,r,i,o,a,s){a===void 0&&(a=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],d=u[2],f=u[3];if(s==="channelsLast")c=e[0],l=e[1],d=e[2],f=e[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);c=e[0],f=e[1],l=e[2],d=e[3]}var h,p=t[0],m=t[1],g=t[3],v=cv(n),y=v[0],b=v[1],w=cv(r),E=w[0],x=w[1],R=zu(p,E),S=zu(m,x),_=function(D,F,M,I,N,j,P,A){var U,H,q;if(typeof D=="number"){U={top:D,bottom:D,left:D,right:D,type:D===0?"VALID":"NUMBER"};var Q=function(ie,pe,ce,Y,de){Y==null&&(Y=eD(ie,pe,ce));var be=ie[0],le=ie[1],Tt=jl((be-pe+2*Y)/ce+1,de);W(Kt(Tt),function(){return"The output # of rows ("+Tt+") must be an integer. Change the stride and/or zero pad parameters"});var yt=jl((le-pe+2*Y)/ce+1,de);return W(Kt(yt),function(){return"The output # of columns ("+yt+") must be an integer. Change the stride and/or zero pad parameters"}),[Tt,yt]}([F,M],j,I,D,A);H=Q[0],q=Q[1]}else if(D==="same"){H=Math.ceil(F/I),q=Math.ceil(M/N);var V=Math.max(0,(H-1)*I+j-F),re=Math.max(0,(q-1)*N+P-M),Z=Math.floor(V/2),he=V-Z,xe=Math.floor(re/2);U={top:Z,bottom:he,left:xe,right:re-xe,type:"SAME"}}else{if(D!=="valid")throw Error("Unknown padding parameter: "+D);U={top:0,bottom:0,left:0,right:0,type:"VALID"},H=Math.ceil((F-j+1)/I),q=Math.ceil((M-P+1)/N)}return{padInfo:U,outHeight:H,outWidth:q}}(i,l,d,y,b,R,S,o),T=_.padInfo,B=_.outHeight,L=_.outWidth,k=a?g*f:g;return s==="channelsFirst"?h=[c,k,B,L]:s==="channelsLast"&&(h=[c,B,L,k]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:d,inChannels:f,outHeight:B,outWidth:L,outChannels:k,padInfo:T,strideHeight:y,strideWidth:b,filterHeight:p,filterWidth:m,effectiveFilterHeight:R,effectiveFilterWidth:S,dilationHeight:E,dilationWidth:x,inShape:e,outShape:h,filterShape:t}}function uv(e,t,n,r,i,o,a,s){o===void 0&&(o=!1),a===void 0&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],l=u[1],d=u[2],f=u[3],h=u[4];if(a==="channelsLast")c=e[0],l=e[1],d=e[2],f=e[3],h=e[4];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);c=e[0],h=e[1],l=e[2],d=e[3],f=e[4]}var p,m=t[0],g=t[1],v=t[2],y=t[4],b=rb(n),w=b[0],E=b[1],x=b[2],R=rb(r),S=R[0],_=R[1],T=R[2],B=zu(m,S),L=zu(g,_),k=zu(v,T),D=function(P,A,U,H,q,Q,V,re,Z,he,xe){var ie,pe,ce,Y;if(typeof P=="number"){ie={top:P,bottom:P,left:P,right:P,front:P,back:P,type:P===0?"VALID":"NUMBER"};var de=function(Sn,it,bt,Ye,Ne,pt){Ne==null&&(Ne=eD(Sn,it,Ye));var Ua=Sn[0],Mi=Sn[1],Uc=Sn[2],hr=jl((Ua-it+2*Ne)/Ye+1,pt);W(Kt(hr),function(){return"The output # of depths ("+hr+") must be an integer. Change the stride and/or zero pad parameters"});var qs=jl((Mi-it+2*Ne)/Ye+1,pt);W(Kt(qs),function(){return"The output # of rows ("+qs+") must be an integer. Change the stride and/or zero pad parameters"});var Xs=jl((Uc-it+2*Ne)/Ye+1,pt);return W(Kt(Xs),function(){return"The output # of columns ("+Xs+") must be an integer. Change the stride and/or zero pad parameters"}),[hr,qs,Xs,bt]}([A,U,H,1],re,1,q,P,xe);pe=de[0],ce=de[1],Y=de[2]}else if(P==="same"){pe=Math.ceil(A/q),ce=Math.ceil(U/Q),Y=Math.ceil(H/V);var be=(pe-1)*q+re-A,le=(ce-1)*Q+Z-U,Tt=(Y-1)*V+he-H,yt=Math.floor(be/2),Gt=be-yt,er=Math.floor(le/2),tr=le-er,An=Math.floor(Tt/2);ie={top:er,bottom:tr,left:An,right:Tt-An,front:yt,back:Gt,type:"SAME"}}else{if(P!=="valid")throw Error("Unknown padding parameter: "+P);ie={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},pe=Math.ceil((A-re+1)/q),ce=Math.ceil((U-Z+1)/Q),Y=Math.ceil((H-he+1)/V)}return{padInfo:ie,outDepth:pe,outHeight:ce,outWidth:Y}}(i,l,d,f,w,E,x,B,L,k,s),F=D.padInfo,M=D.outDepth,I=D.outHeight,N=D.outWidth,j=o?y*h:y;return a==="channelsFirst"?p=[c,j,M,I,N]:a==="channelsLast"&&(p=[c,M,I,N,j]),{batchSize:c,dataFormat:a,inDepth:l,inHeight:d,inWidth:f,inChannels:h,outDepth:M,outHeight:I,outWidth:N,outChannels:j,padInfo:F,strideDepth:w,strideHeight:E,strideWidth:x,filterDepth:m,filterHeight:g,filterWidth:v,effectiveFilterDepth:B,effectiveFilterHeight:L,effectiveFilterWidth:k,dilationDepth:S,dilationHeight:_,dilationWidth:T,inShape:e,outShape:p,filterShape:t}}function eD(e,t,n,r){r===void 0&&(r=1);var i=zu(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function cv(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function rb(e){return typeof e=="number"?[e,e,e]:e}function zu(e,t){return t<=1?e:e+(e-1)*(t-1)}function jl(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function bc(e){var t=cv(e),n=t[0],r=t[1],i=t[2];return n===1&&r===1&&i===1}function Tr(e,t){return bc(e)||bc(t)}function dx(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function tD(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var r=Rt(e.shape),i=e.toFloat(),o=n.complex(i,r);return r.dispose(),i.dispose(),o}if(!RK(e.dtype,t))return X.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var a=n.real(e);return o=a.cast(t),a.dispose(),o}if(t==="int32")return n.int(e);if(t==="bool"){var s=ye(0,e.dtype);return o=n.notEqual(e,s),s.dispose(),o}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function ib(e,t){return X.makeTensorFromDataId(e.dataId,t,e.dtype)}function nD(e,t,n){var r=(t-e)/(n-1),i=rf(n,"float32");i[0]=e;for(var o=1;o<i.length;o++)i[o]=i[o-1]+r;return tn(i,"float32")}function ob(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function R_(e,t){return{real:e[2*t],imag:e[2*t+1]}}function tQ(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function nQ(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function rQ(e,t,n){var r=function(o,a,s){return function(u,c,l){for(var d=0,f=u.length,h=0,p=!1;d<f;){var m=l(c,u[h=d+(f-d>>>1)]);m>0?d=h+1:(f=h,p=!m)}return p?d:-d-1}(o,a,s||iQ)}(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function iQ(e,t){return e>t?1:e<t?-1:0}function fx(e,t,n,r,i){return rD(e,t,n,r,i,0).selectedIndices}function hx(e,t,n,r,i,o){var a=rD(e,t,n,r,i,o);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function rD(e,t,n,r,i,o,a,s){s===void 0&&(s=!1);for(var u=Array.from(t).map(function(w,E){return{score:w,boxIndex:E,suppressBeginIndex:0}}).filter(function(w){return w.score>i}).sort(I_),c=o>0?-.5/o:0,l=[],d=[];l.length<n&&u.length>0;){var f=u.pop(),h=f.score,p=f.boxIndex,m=f.suppressBeginIndex;if(h<i)break;for(var g=!1,v=l.length-1;v>=m;--v){var y=oQ(e,p,l[v]);if(y>=r){g=!0;break}if(f.score=f.score*aQ(r,c,y),f.score<=i)break}f.suppressBeginIndex=l.length,g||(f.score===h?(l.push(p),d.push(f.score)):f.score>i&&rQ(u,f,I_))}var b=l.length;return s&&(l.fill(0,b),d.fill(0,b)),{selectedIndices:tn(l,"int32"),selectedScores:tn(d,"float32"),numValidOutputs:ye(b,"int32")}}function oQ(e,t,n){var r=e.subarray(4*t,4*t+4),i=e.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(i[0],i[2]),l=Math.min(i[1],i[3]),d=Math.max(i[0],i[2]),f=Math.max(i[1],i[3]),h=(s-o)*(u-a),p=(d-c)*(f-l);if(h<=0||p<=0)return 0;var m=Math.max(o,c),g=Math.max(a,l),v=Math.min(s,d),y=Math.min(u,f),b=Math.max(v-m,0)*Math.max(y-g,0);return b/(h+p-b)}function aQ(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function I_(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function iD(e,t,n){var r=new Array(e.rank).fill(0),i=e.shape.slice();return t.map(function(o){i[n]=o;var a=e.slice(r,i);return r[n]+=o,a})}function oD(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var i=je(n,e.dtype);for(r=0;r<i.values.length;++r){for(var o=i.indexToLoc(r),a=new Array(e.rank),s=0;s<a.length;s++)a[s]=o[s]%e.shape[s];var u=e.locToIndex(a);i.values[r]=e.values[u]}return i.toTensor()}function aD(e,t,n,r,i){for(var o=t[t.length-1],a=[e.length/o,o],s=a[0],u=a[1],c=md(n,s*r),l=md("int32",s*r),d=0;d<s;d++){for(var f=d*u,h=e.subarray(f,f+u),p=[],m=0;m<h.length;m++)p.push({value:h[m],index:m});p.sort(function(w,E){return E.value-w.value});var g=d*r,v=c.subarray(g,g+r),y=l.subarray(g,g+r);for(m=0;m<r;m++)v[m]=p[m].value,y[m]=p[m].index}var b=t.slice();return b[b.length-1]=r,[On(c,b,n),On(l,b,"int32")]}function px(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var i=je(e,"int32"),o=je([n.length,e.length],"int32");for(r=0;r<n.length;r++){var a=i.indexToLoc(n[r]),s=r*e.length;o.values.set(a,s)}return o.toTensor()}var sQ=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(i,o){return"T"+o});var n=[];this.variableNames.forEach(function(i){n.push("float v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},uQ=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(i,o){return"T"+o});var n=[];this.variableNames.forEach(function(i){n.push("vec4 v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},cQ=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,i=e.batchSize,o=e.inSize,a=Math.ceil(o/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a];var s=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function sD(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function yr(e,t){return t===1?[e]:sD(e,t)}function qn(){var e,t,n,r,i,o,a,s,u,c;return ae().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",i="texture",o="outputColor",a="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",i="texture2D",o="gl_FragColor",a="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:o,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function ds(e,t,n){n===void 0&&(n="index");var r=no(t);return r.map(function(i,o){return"int "+e[o]+" = "+n+" / "+i+"; "+(o===r.length-1?"int "+e[o+1]+" = "+n+" - "+e[o]+" * "+i:"index -= "+e[o]+" * "+i)+";"}).join("")}function vx(e){var t=no(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var uD=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function lQ(e,t,n,r){var i=[];e.forEach(function(h){var p=Re(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?i.push("uniform float "+h.name+(p>1?"["+p+"]":"")+";"):(i.push("uniform sampler2D "+h.name+";"),i.push("uniform int offset"+h.name+";"))});var o,a,s=i.join(`
`),u=e.map(function(h){return function(p,m,g){g===void 0&&(g=!1);var v="";v+=g?cD(p):hu(p);var y=p.shapeInfo.logicalShape,b=m.logicalShape;return y.length<=b.length&&(v+=g?function(w,E){var x,R=w.name,S=R.charAt(0).toUpperCase()+R.slice(1),_="get"+S+"AtOutCoords",T=w.shapeInfo.logicalShape.length,B=E.logicalShape.length,L=la(w.shapeInfo.logicalShape,E.logicalShape),k=Ct(B),D=B-T,F=["x","y","z","w","u","v"];x=T===0?"":B<2&&L.length>=1?"coords = 0;":L.map(function(U){return"coords."+F[U+D]+" = 0;"}).join(`
`);var M="";M=B<2&&T>0?"coords":w.shapeInfo.logicalShape.map(function(U,H){return"coords."+F[H+D]}).join(", ");var I="return outputValue;",N=Re(w.shapeInfo.logicalShape)===1,j=Re(E.logicalShape)===1;if(T!==1||N||j){if(N&&!j)I=B===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(L.length){var P=T-2,A=T-1;L.indexOf(P)>-1&&L.indexOf(A)>-1?I="return vec4(outputValue.x);":L.indexOf(P)>-1?I="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":L.indexOf(A)>-1&&(I="return vec4(outputValue.xx, outputValue.zz);")}}else I=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+_+`() {
      `+k+` coords = getOutputCoords();
      `+x+`
      vec4 outputValue = get`+S+"("+M+`);
      `+I+`
    }
  `}(p,m):function(w,E){var x=w.name,R=x.charAt(0).toUpperCase()+x.slice(1),S="get"+R+"AtOutCoords",_=E.texShape,T=w.shapeInfo.texShape,B=w.shapeInfo.logicalShape.length,L=E.logicalShape.length;if(!w.shapeInfo.isUniform&&B===L&&w.shapeInfo.flatOffset==null&&bn(T,_))return`
      float `+S+`() {
        return sampleTexture(`+x+`, resultUV);
      }
    `;var k,D=Ct(L),F=la(w.shapeInfo.logicalShape,E.logicalShape),M=L-B,I=["x","y","z","w","u","v"];k=B===0?"":L<2&&F.length>=1?"coords = 0;":F.map(function(j){return"coords."+I[j+M]+" = 0;"}).join(`
`);var N="";return N=L<2&&B>0?"coords":w.shapeInfo.logicalShape.map(function(j,P){return"coords."+I[P+M]}).join(", "),`
    float `+S+`() {
      `+D+` coords = getOutputCoords();
      `+k+`
      return get`+R+"("+N+`);
    }
  `}(p,m)),v}(h,t,r)}).join(`
`),c=t.texShape,l=qn(),d=function(h){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+h.texture2D+`(textureSampler, uv).r;
    }
  `}(l),f=function(h){return h.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+h.varyingFs+` vec2 resultUV;
    `+h.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+h.defineSpecialNaN+`
    `+h.defineSpecialInf+`
    `+h.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+dQ+`
    `+fQ+`
    `+hQ+`
  `}(l);return t.isPacked?(o=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(w,E){var x=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)];return x[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+x[1]+`.0);
      }
    `:x[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+x[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+x[0]+", "+x[1]+`));
      return 2 * (resTexRC.x * `+x[1]+` + resTexRC.y);
    }
  `}(0,p);case 2:return function(w,E){var x=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)];if(bn(w,E))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+x[0]+", "+x[1]+`));
      }
    `;var R=Math.ceil(w[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+x[0]+", "+x[1]+`));

      int index = resTexRC.x * `+x[1]+` + resTexRC.y;
      int r = 2 * (index / `+R+`);
      int c = imod(index, `+R+`) * 2;

      return ivec2(r, c);
    }
  `}(h,p);case 3:return m=h,g=p,v=[Math.ceil(g[0]/2),Math.ceil(g[1]/2)],y=Math.ceil(m[2]/2),b=y*Math.ceil(m[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;

      int b = index / `+b+`;
      index -= b * `+b+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(w,E){for(var x=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)],R=Math.ceil(w[w.length-1]/2),S=R*Math.ceil(w[w.length-2]/2),_=S,T="",B="b, r, c",L=2;L<w.length-1;L++)_*=w[w.length-L-1],T=`
      int b`+L+" = index / "+_+`;
      index -= b`+L+" * "+_+`;
    `+T,B="b"+L+", "+B;return`
    ivec`+w.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;

      `+T+`

      int b = index / `+S+`;
      index -= b * `+S+`;

      int r = 2 * (index / `+R+`);
      int c = imod(index, `+R+`) * 2;

      return ivec`+w.length+"("+B+`);
    }
  `}(h,p)}var m,g,v,y,b}(t.logicalShape,c),a=function(h){return`
    void setOutput(vec4 val) {
      `+h.output+` = val;
    }
  `}(l)):(o=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(v,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,p);case 2:return function(v,y){return bn(v,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:v[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:v[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+v[1]+`;
      int c = index - r * `+v[1]+`;
      return ivec2(r, c);
    }
  `}(h,p);case 3:return m=p,g=ds(["r","c","d"],h),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+m[0]+", "+m[1]+`));
      int index = resTexRC.x * `+m[1]+` + resTexRC.y;
      `+g+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(v,y){var b=ds(["r","c","d","d2"],v);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+b+`
      return ivec4(r, c, d, d2);
    }
  `}(h,p);case 5:return function(v,y){var b=ds(["r","c","d","d2","d3"],v);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(h,p);case 6:return function(v,y){var b=ds(["r","c","d","d2","d3","d4"],v);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(h,p);default:throw new Error(h.length+"-D output sampling is not yet supported")}var m,g}(t.logicalShape,c),a=function(h){return`
    void setOutput(float val) {
      `+h.output+` = vec4(val, 0, 0, 0);
    }
  `}(l)),r&&(f+=pQ),[f,d,a,s,o,u,n].join(`
`)}function hu(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+i+"() {return "+r+";}";var o=n.shapeInfo.texShape,a=o[0],s=o[1];if(a===1&&s===1)return`
      float `+i+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,c=u[0],l=u[1],d=qa(r);return`
    float `+i+`() {
      vec2 uv = uvFromFlat(`+c+", "+l+", "+d+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 1:return function(n){var r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+i+`(int index) {
        `+uu(n)+`
      }
    `;var o=n.shapeInfo.texShape,a=o[0],s=o[1];if(s===1&&a===1)return`
      float `+i+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=qa(r);return s===1?`
      float `+i+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+a+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:a===1?`
      float `+i+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+i+`(int index) {
      vec2 uv = uvFromFlat(`+a+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 2:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=n.shapeInfo.texShape;if(a!=null&&bn(r,a)){var s=a[0],u=a[1];return`
    float `+o+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `}var c=es(r),l=c.newShape,d=c.keptDims,f=l;if(f.length<r.length){var h=pu(n,f);return`
      `+hu(h)+`
      float `+o+`(int row, int col) {
        return `+o+"("+vu(["row","col"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+o+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+uu(n)+`
      }
    `;var p=a[0],m=a[1],g=qa(i);return m===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+p+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `:p===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+m+`.0, 0.5);
      return sampleTexture(`+i+`, uv);
    }
  `:`
  float `+o+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+g+`;
    vec2 uv = uvFromFlat(`+p+", "+m+`, index);
    return sampleTexture(`+i+`, uv);
  }
`}(e);case 3:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=r[1]*r[2],s=r[2],u=es(r),c=u.newShape,l=u.keptDims,d=c;if(d.length<r.length){var f=pu(n,d);return`
        `+hu(f)+`
        float `+o+`(int row, int col, int depth) {
          return `+o+"("+vu(["row","col","depth"],l)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+a+", "+s+`, 1)));
        `+uu(n)+`
      }
    `;var h=n.shapeInfo.texShape,p=h[0],m=h[1],g=n.shapeInfo.flatOffset;if(m===a&&g==null)return`
        float `+o+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+m+".0, "+p+`.0);
          return sampleTexture(`+i+`, uv);
        }
      `;if(m===s&&g==null)return`
    float `+o+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+m+".0, "+p+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `;var v=qa(i);return`
      float `+o+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+a+" + col * "+s+" + depth + "+v+`;
        vec2 uv = uvFromFlat(`+p+", "+m+`, index);
        return sampleTexture(`+i+`, uv);
      }
  `}(e);case 4:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=r[3],s=r[2]*a,u=r[1]*s,c=es(r),l=c.newShape,d=c.keptDims;if(l.length<r.length){var f=pu(n,l);return`
      `+hu(f)+`
      float `+o+`(int row, int col, int depth, int depth2) {
        return `+o+"("+vu(["row","col","depth","depth2"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+a+`, 1)));
        `+uu(n)+`
      }
    `;var h=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,m=p[0],g=p[1];if(g===u&&h==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+g+".0, "+m+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(g===a&&h==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+g+".0, "+m+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var v=qa(i);return`
    float `+o+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+a+` + depth2;
      vec2 uv = uvFromFlat(`+m+", "+g+", index + "+v+`);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);case 5:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=r[4],s=r[3]*a,u=r[2]*s,c=r[1]*u,l=es(r),d=l.newShape,f=l.keptDims;if(d.length<r.length){var h=pu(n,d);return`
      `+hu(h)+`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        return `+o+"("+vu(["row","col","depth","depth2","depth3"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+c+", "+u+", "+s+", "+a+`)) +
          depth3;
        `+uu(n)+`
      }
    `;var p=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,g=m[0],v=m[1];if(v===c&&p==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+v+".0, "+g+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(v===a&&p==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+v+".0, "+g+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var y=qa(i);return`
    float `+o+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+c+" + col * "+u+" + depth * "+s+` +
          depth2 * `+a+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+g+", "+v+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);case 6:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=es(r),s=a.newShape,u=a.keptDims;if(s.length<r.length){var c=pu(n,s);return`
      `+hu(c)+`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+o+"("+vu(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var l=r[5],d=r[4]*l,f=r[3]*d,h=r[2]*f,p=r[1]*h;if(n.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+p+", "+h+", "+f+", "+d+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+l+`, 1)));
        `+uu(n)+`
      }
    `;var m=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,v=g[0],y=g[1];if(y===p&&m==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+h+", "+f+", "+d+", "+l+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(y===l&&m==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var b=qa(i);return`
    float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+p+" + col * "+h+" + depth * "+f+` +
          depth2 * `+d+" + depth3 * "+l+" + depth4 + "+b+`;
      vec2 uv = uvFromFlat(`+v+", "+y+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function cD(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=qn(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(i){var o=i.name,a="get"+o.charAt(0).toUpperCase()+o.slice(1),s=i.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=qn();return`
    vec4 `+a+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+c.texture2D+"("+o+`, uv);
    }
  `}(e);case 2:return function(i){var o=i.shapeInfo.logicalShape,a=i.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=i.shapeInfo.texShape,c=u[0],l=u[1],d=qn();if(u!=null&&bn(o,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+l+".0, "+c+`.0);

        return `+d.texture2D+"("+a+`, uv);
      }
    `;var f=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],h=Math.ceil(o[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+h+", "+f[0]+", "+f[1]+`, row, col);
      return `+d.texture2D+"("+a+`, uv);
    }
  `}(e);case 3:return function(i){var o=i.shapeInfo.logicalShape,a=i.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=i.shapeInfo.texShape,c=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(o[0]===1){var l=o.slice(1),d=pu(i,l);return`
        `+cD(d)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+vu(["b","row","col"],[1,2])+`);
        }
      `}var f=c[0],h=c[1],p=Math.ceil(o[2]/2),m=p*Math.ceil(o[1]/2),g=qn();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+f+", "+h+", "+m+", "+p+`, b, row, col);
      return `+g.texture2D+"("+a+`, uv);
    }
  `}(e);default:return function(i){for(var o=i.shapeInfo.logicalShape,a=o.length,s=i.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),c=i.shapeInfo.texShape,l=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],d=l[0],f=l[1],h=Math.ceil(o[a-1]/2),p=h*Math.ceil(o[a-2]/2),m="int b, int row, int col",g="b * "+p+" + (row / 2) * "+h+" + (col / 2)",v=2;v<a-1;v++)m="int b"+v+", "+m,p*=o[a-v-1],g="b"+v+" * "+p+" + "+g;var y=qn();return`
    vec4 `+u+"("+m+`) {
      int index = `+g+`;
      int texR = index / `+f+`;
      int texC = index - texR * `+f+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+f+", "+d+`);
      return `+y.texture2D+"("+s+`, uv);
    }
  `}(e)}}var dQ=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,fQ=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,hQ=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,pQ=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function qa(e){return"offset"+e}function uu(e){var t=e.name,n=Re(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function Ct(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function pu(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function vu(e,t){return t.map(function(n){return e[n]}).join(", ")}var vQ=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,W(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var i=e[e.length-1],o=Math.ceil(i/t);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,c=u.length,l=Ct(c),d=yr("coords",c);if(o===1){var f=Ct(s=c+1);a=`
        `+f+" sourceLocR = "+f+"("+d.join()+`, 0);
        ++`+d[c-1]+`;
        `+f+" sourceLocG = "+f+"("+d.join()+`, 0);
        ++`+d[c-2]+`;
        `+f+" sourceLocA = "+f+"("+d.join()+`, 0);
        --`+d[c-1]+`;
        `+f+" sourceLocB = "+f+"("+d.join()+`, 0);
        --`+d[c-2]+";"}else s=c,a=`
        `+l+` sourceLocR = coords;
        ++`+d[c-1]+`;
        `+l+` sourceLocG = coords;
        ++`+d[c-2]+`;
        `+l+` sourceLocA = coords;
        --`+d[c-1]+`;
        `+l+` sourceLocB = coords;
        --`+d[c-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),p="."+h[s-1],m=h.map(function(S){return"int "+S}),g=yr("sourceLocR",s-1).concat("inIdx.r"),v=yr("sourceLocG",s-1).concat("inIdx.g"),y=yr("sourceLocB",s-1).concat("inIdx.b"),b=yr("sourceLocA",s-1).concat("inIdx.a"),w=n==="max"?"greaterThan":"lessThan",E=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+g.join()+`),
                             getBestIndicesAChannel(`+v.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+b.join()+")));",x=`vec4(
            getAChannel(`+g.join()+`),
            hasNextCol ? getAChannel(`+v.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+b.join()+") : 0.)",R=r?"":`
      float getBestIndicesAChannel(`+m.join()+`) {
        return getChannel(getBestIndicesA(`+h.join()+`),
                                          vec2(`+h.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+m.join()+`) {
        return getChannel(getA(`+h.join()+`),
                               vec2(`+h.slice(-2).join()+`));
      }
      `+R+`
      void main() {
        `+l+` coords = getOutputCoords();
        bool hasNextCol = `+d[c-1]+" < "+(u[c-1]-1)+`;
        bool hasNextRow = `+d[c-2]+" < "+(u[c-2]-1)+`;
        `+a+`
        ivec4 srcIdx = ivec4(sourceLocR`+p+", sourceLocG"+p+`,
          sourceLocB`+p+", sourceLocA"+p+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+x+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+E+`
          vec4 candidate = `+x+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+w+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},mQ=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=s-1-e.padInfo.top,l=u-1-e.padInfo.left,d=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+c+", "+l+`);
      const float avgMultiplier = float(`+d+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+o+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+a+`) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},gQ=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=l-1-e.padInfo.front,p=d-1-e.padInfo.top,m=f-1-e.padInfo.left,g=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+p+", "+m+`);
      const float avgMultiplier = float(`+g+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+l+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+i+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+d+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+c+`) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},yQ=function(e,t,n,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],et(e,t),et(e,n);var a="0.0";r!=null&&(et(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";i!=null&&(et(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+a+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+o+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},bQ=function(e,t,n,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],et(e,t),et(e,n);var a="vec4(0.0)";r!=null&&(et(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";i!=null&&(et(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+a+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+o+`));

        setOutput((x - mean) * inv + offset);
      }
    `},wQ="return areal * breal - aimag * bimag;",xQ="return areal * bimag + aimag * breal;",T_=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=et(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},U0="return a + b;",z0="return a - b;",O_="return a * b;",lD="return (a < 0.) ? b * a : a;",Ut=function(e,t,n){this.variableNames=["A","B"],this.outputShape=et(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},dD=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,vo=function(e,t,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=et(t,n);var i=this.outputShape.length,o="";if(r)if(i===0||Re(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          `+Ct(i)+` coords = getOutputCoords();
        `,i===1)o+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var a=yr("coords",i);o+=`
            bool nextRowOutOfBounds =
              (`+a[i-2]+" + 1) >= "+this.outputShape[i-2]+`;
            bool nextColOutOfBounds =
              (`+a[i-1]+" + 1) >= "+this.outputShape[i-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+o+`

        setOutput(result);
      }
    `},EQ=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(i,o){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(o,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(o,"maxVal")),i.gl.uniform1f(r.minLoc,t),i.gl.uniform1f(r.maxLoc,n)}},e}(),SQ=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(i,o){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(o,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(o,"maxVal")),i.gl.uniform1f(r.minLoc,t),i.gl.uniform1f(r.maxLoc,n)}},e}(),CQ=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},_Q=function(e){this.outputShape=[],this.outputShape=yc(e,1),this.variableNames=e.map(function(s,u){return"T"+u});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var i=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+i+"));")}var o=t.length,a=t[t.length-1];r.push("else setOutput(getT"+o+"(yR, yC-"+a+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},kQ=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=yc(e,t);var n=this.outputShape,r=n.length,i=Ct(r),o=yr("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(g,v){return"T"+v});var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var c=a[t],l=a.slice(-2),d=a.join(),f="if ("+c+" < "+s[0]+`) {
        return getChannel(
            getT0(`+d+"), vec2("+l.join()+`));
        }`;for(u=1;u<s.length;u++){var h=s[u-1];f+=`
        if (`+c+" < "+s[u]+"  && "+c+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+ch(a,c,h)+`),
            vec2(`+ch(l,c,h)+`));
        }`}var p=s.length,m=s[s.length-1];f+=`
        return getChannel(
          getT`+p+"("+ch(a,c,m)+`),
          vec2(`+ch(l,c,m)+"));",this.userCode=`
      float getValue(`+a.map(function(g){return"int "+g})+`) {
        `+f+`
      }

      void main() {
        `+i+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+o+`), 0., 0., 0.);

        `+o[r-1]+" = "+o[r-1]+` + 1;
        if (`+o[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+o+`);
        }

        `+o[r-2]+" = "+o[r-2]+` + 1;
        if (`+o[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+o+`);
        }

        `+o[r-1]+" = "+o[r-1]+` - 1;
        if (`+o[r-2]+" < "+n[r-2]+` &&
            `+o[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+o+`);
        }
        setOutput(result);
      }
    `};function ch(e,t,n){var r=e.indexOf(t);return e.map(function(i,o){return o===r?i+" - "+n:i}).join()}var RQ=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+i+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+o+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},IQ=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=o?1:2,c=o?2:3,l=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+l+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+c+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+o+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},TQ=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+i+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+o+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+a+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},OQ=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,c=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+c+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+i+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},PQ=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+o+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+i+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},NQ=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=t-1-e.padInfo.top,a=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},P_=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.padInfo.top,o=e.padInfo.left,a=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,l=e.filterHeight,d=e.filterWidth,f=4*Math.floor(e.inChannels/4),h=e.inChannels%4,p=e.dataFormat==="channelsLast",m=p?1:2,g=p?2:3,v=p?3:1,y="",b="";n&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,b="result = activation(result);");var w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+a+", "+s+`);
      const ivec2 pads = ivec2(`+i+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+v+`];

        ivec2 xRCCorner =
            ivec2(coords[`+m+"], coords["+g+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+l+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+c+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+f+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+p+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(h===1)+`) {

              if (`+p+`) {
                dotProd +=
                    getX(batch, xR, xC, `+f+`) *
                    getW(wR, wC, `+f+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+f+`, xR, xC) *
                    getW(wR, wC, `+f+`, d2);
              }

            } else if (`+(h===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2)
              );

              if (`+p+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(h===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2),
                getW(wR, wC, `+f+` + 2, d2)
              );

              if (`+p+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1),
                  getX(batch, xR, xC, `+f+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC),
                  getX(batch, `+f+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+w+`
        `+b+`
        setOutput(result);
      }
    `},DQ=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.filterDepth,d=e.filterHeight,f=e.filterWidth,h=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+i+", "+o+", "+a+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+l+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`; wC++) {
              int xC = xCCorner + wC * `+c+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+h+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(p===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+h+`) *
                  getW(wF, wR, wC, `+h+`, d2);
              } else if (`+(p===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(p===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1),
                  getX(batch, xF, xR, xC, `+h+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2),
                  getW(wF, wR, wC, `+h+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},N_=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.inHeight,o=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,p=e.outChannels/e.inChannels,m="",g="";n&&(m=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,g="result = activation(result);");var v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+m+`

      const ivec2 strides = ivec2(`+u+", "+c+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+p+`;
        int q = d2 - d1 * `+p+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+f+`; wR++) {
          int xR = xRCorner + wR * `+l+`;

          if (xR < 0 || xR >= `+i+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+d+`;

            if (xC < 0 || xC >= `+o+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+v+`
        `+g+`
        setOutput(result);
      }
    `},D_=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var i=e.inHeight,o=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,p=h,m="int xR; int xC; int xCOffset;",g=0;g<f;g++)for(var v=0;v<h;v++)m+=`
          vec4 xTexelR`+g+"C"+2*v+` = vec4(0.);
          vec4 wR`+g+"C"+v+` = vec4(0.);
          vec4 xR`+g+"C"+v+" = vec4(0.);";for(g=0;g<f;g++)for(var y=0;y<p;y++){if(m+=`
          xR = xRCorner + `+g*l+`;
          xC = xCCorner + `+(v=2*y)*d+`;
        `,c===1){if(v<h&&(m+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+o+`) {
                    xTexelR`+g+"C"+v+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+o+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+g+"C"+v+" = vec4(previous.zw, xTexelR"+g+"C"+v+`.xy);
                } else {
                  xR`+g+"C"+v+" = vec4(0, 0, xTexelR"+g+"C"+v+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+i+" && xC >= 0 && xC < "+o+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xR`+g+"C"+v+" = xTexelR"+g+"C"+v+`;
              `,v+1<h)){var b=s%2==0?TN(d):d;d%2==0&&s%2==1||d%2!=0&&s%2!=1?(m+=`
                  xCOffset = xC + `+s%2+" + "+b+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,d>1&&(m+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+i+` &&
                      xCOffset >= 0 && xCOffset < `+o+`) {
                      xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+g+"C"+v+` = vec4(0.);
                    }
                  `),m+=`
                  xR`+g+"C"+(v+1)+` = vec4(
                    xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.xy);
                `):m+=`
                  xCOffset = xC + `+b+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+g+"C"+(v+1)+" = xTexelR"+g+"C"+(v+2)+`;
                `}}else v<h&&(m+=`
              if(xR >= 0 && xR < `+i+`) {
            `,s%2==1?(m+=`
                xCOffset = xC + 1 - `+c+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+o+`) {
                  xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+g+"C"+(v+2)+` = vec4(0.);
                }

                xR`+g+"C"+v+` = vec4(
                  xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.zw);
              `,v+1<h&&(m+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+c+`;
                  if(xCOffset >= 0 && xCOffset < `+o+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+g+"C"+(v+1)+" = vec4(xTexelR"+g+"C"+(v+2)+`.xy, final.xy);
                `)):(m+=`
                if(xC >= 0 && xC < `+o+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + `+c+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+(v+2)+` = vec4(0.);
                }

                xR`+g+"C"+v+` = vec4(
                  xTexelR`+g+"C"+v+".xy, xTexelR"+g+"C"+(v+2)+`.xy);
              `,v+1<h&&(m+=`
                  xR`+g+"C"+(v+1)+` = vec4(
                    xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.zw);
                `)),m+="}");v<h&&(m+=`
            vec4 wTexelR`+g+"C"+v+" = getW("+g+", "+v+`, d1, q);
            wR`+g+"C"+v+" = vec4(wTexelR"+g+"C"+v+".xz, wTexelR"+g+"C"+v+`.xz);
          `,v+1<h&&(m+=`
              vec4 wTexelR`+g+"C"+(v+1)+" = getW("+g+", "+(v+1)+`, d1, q);
              wR`+g+"C"+(v+1)+` =
                vec4(wTexelR`+g+"C"+(v+1)+".xz, wTexelR"+g+"C"+(v+1)+".xz);"))}for(g=0;g<f;g++)for(v=0;v<h;v++)m+="dotProd += xR"+g+"C"+v+" * wR"+g+"C"+v+";";var w="",E="";n&&(w=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,E="result = activation(result);");var x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+u+", "+c+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+m+`

        vec4 result = dotProd;
        `+x+`
        `+E+`
        setOutput(result);
      }
    `},AQ=function(e,t,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=e[0],a=e[1],s=e[2],u=e[3],c=t[0],l=n[0],d=n[1];this.outputShape=[c,l,d,u];var f=r==="bilinear"?1:0,h=[a-1+".0",s-1+".0"],p=h[0],m=h[1],g=l>1?[""+(a-1)/(l-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],v=g[0],y=g[1],b=g[2],w=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio","x1*"+m+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+m],E=w[0],x=w[1],R=w[2];this.userCode=`
      const float height_ratio = float(`+v+`);
      const float width_ratio = float(`+E+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+o+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+x+`;

        float in_y = `+b+`;
        if( in_y < 0.0 || in_y > `+p+` ) {
          setOutput(float(`+i+`));
          return;
        }
        float in_x = `+R+`;
        if( in_x < 0.0 || in_x > `+m+` ) {
          setOutput(float(`+i+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+f+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},MQ=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,i=e[e.length-1],o=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+i+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Ct(r)+` coords = getOutputCoords();
        int end = `+A_(r,"coords")+`;
        float val = 0.0;
        for (int i = `+i+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+o+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+A_(r,"coords")+` = idx;
          val += getX(`+function(a,s){if(a===1)return""+s;if(a===2)return s+".x, "+s+".y";if(a===3)return s+".x, "+s+".y, "+s+".z";if(a===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+a+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function A_(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var LQ=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=yd.DENSE;var t=Bl(e),n=qn();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+ds(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},FQ=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=yd.DENSE;var t=Bl(e),n=qn();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+ds(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},BQ=function(){function e(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),jQ=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},$Q=function(e){this.variableNames=["A"],this.outTexUsage=jr.DOWNLOAD;var t=qn();this.outputShape=e,this.userCode=`
      `+uD+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},VQ=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=jr.DOWNLOAD;var t=qn();this.outputShape=e,this.userCode=`
      `+uD+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},WQ=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=qn(),i=t[0],o=t[1];this.outputShape=e;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      `+vx(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+o+`;
        int c = imod(flatIndex, `+o+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+i+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+a+`, 0., 0., 0.);
      }
    `},UQ=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=qn(),i=t[0],o=t[1];this.outputShape=e;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;a+=`
          localCoords = coords;
          if(localCoords[2] + `+c+" < "+e[2]+`) {
            localCoords[2] += `+c+`;
            if(localCoords[1] + `+u+" < "+e[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+o+`;
              c = imod(flatIndex, `+o+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+i+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+l+`] = values[0];
              } else if(offset == 1) {
                result[`+l+`] = values[1];
              } else if(offset == 2) {
                result[`+l+`] = values[2];
              } else {
                result[`+l+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+vx(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+a+`

        `+r.output+" = "+s+`;
      }
    `},zQ="return real * expR - imag * expI;",HQ="return real * expI + imag * expR;",M_=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,o=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+i+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+o+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},GQ=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,i){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(i,"value")),r.gl.uniform1f(n.valueLoc,t)}},e}(),qQ=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var i=Ct(this.rank),o=function(a,s){var u=a.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],d=0;d<a.length;d++)d===s?l.push("int(getIndices("+c[d]+"))"):l.push(""+c[d]);return l.join()}(e,n);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `},XQ=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Ct(t.length),i=Ct(n.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+i+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+o+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function KQ(e,t){var n=qn();return zK(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function YQ(e,t){return KK(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function QQ(e,t){return YK(e,t,new Uint16Array([0,1,2,2,1,3]))}function af(e,t,n,r,i,o,a){JK(n,r);var s=QK(e,t),u=e.TEXTURE_2D;return Ie(e,t,function(){return e.bindTexture(u,s)}),Ie(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),Ie(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),Ie(e,t,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),Ie(e,t,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),Ie(e,t,function(){return e.texImage2D(u,0,i,n,r,0,o,a,null)}),Ie(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function JQ(e,t,n,r,i){var o=Am(n,r);return af(e,t,o[0],o[1],i.internalFormatFloat,i.textureFormatFloat,e.FLOAT)}function ZQ(e,t,n,r,i){var o=Am(n,r);return af(e,t,o[0],o[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function eJ(e,t,n,r,i){var o=Am(n,r);return af(e,t,o[0],o[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function tJ(e,t,n,r,i){var o=of(n,r);return af(e,t,o[0],o[1],i.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function nJ(e,t,n,r,i){var o=of(n,r);return af(e,t,o[0],o[1],i.internalFormatPackedHalfFloat,e.RGBA,i.textureTypeHalfFloat)}function rJ(e,t,n,r){return Ie(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),E_(e,t,n,"clipSpacePos",r,3,20,0)&&E_(e,t,n,"uv",r,2,20,12)}function iJ(e,t,n,r,i,o,a){var s,u,c;Ie(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),o instanceof Uint8Array?(s=new Uint8Array(r*i*4),u=e.UNSIGNED_BYTE,c=e.RGBA):(s=new Float32Array(r*i*4),u=e.FLOAT,c=a.internalFormatPackedFloat),s.set(o),Ie(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,c,r,i,0,e.RGBA,u,s)}),Ie(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function oJ(e,t,n,r){Ie(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?Ie(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):Ie(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),Ie(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function aJ(e,t,n,r,i){var o=e.createBuffer();Ie(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,o)});var a=16*n*r;return Ie(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)}),Ie(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),Ie(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),o}function sJ(e,t,n){var r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function uJ(e,t,n,r,i){var o=Am(n,r),a=o[0],s=o[1],u=new Uint8Array(n*r*4);return Ie(e,t,function(){return e.readPixels(0,0,a,s,i.downloadTextureFormat,e.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function cJ(e,t,n,r,i,o,a,s){var u=e,c=new Float32Array(function(l,d){var f=of(l,d);return f[0]*f[1]*4}(o,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function lJ(e,t,n,r){var i=new Float32Array(n*r*4);return Ie(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,i)}),i}var dJ=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=ae().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,jK(n,t)):this.gl=uo(n);var r="WEBGL_color_buffer_float";if(ae().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=oh(this.gl,this.debug,"OES_texture_float"),ni(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=oh(this.gl,this.debug,"OES_texture_half_float");else if(ae().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),ni(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=oh(this.gl,this.debug,"EXT_color_buffer_half_float");else if(ae().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",ni(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!ni(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=YQ(this.gl,this.debug),this.indexBuffer=QQ(this.gl,this.debug),this.framebuffer=ZK(this.gl,this.debug),this.textureConfig=ox(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return ae().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;Ie(n,this.debug,function(){return n.finish()}),Ie(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),Ie(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),Ie(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),Ie(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),Ie(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),JQ(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),ZQ(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),eJ(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),oJ(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,r,i){this.throwIfDisposed(),iJ(this.gl,this.debug,t,n,r,i,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),nJ(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),tJ(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(S_(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Ie(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,r){var i=this;return this.downloadMatrixDriver(t,function(){return uJ(i.gl,i.debug,n,r,i.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,r,i,o,a){return cJ(this.gl,t,0,0,0,o,a,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return sJ(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,r){this.bindTextureToFrameBuffer(t);var i=aJ(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,r,i=this;if(ae().getBool("WEBGL_FENCE_API_ENABLED")){var o=t,a=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var s=o.clientWaitSync(a,0,0);return s===o.ALREADY_SIGNALED||s===o.CONDITION_SATISFIED},n=a}else ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return i.isQueryAvailable(n,ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,r){var i=this;return this.downloadMatrixDriver(t,function(){return lJ(i.gl,i.debug,n,r)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,r=HK(n,this.debug,t),i=KQ(n,this.debug),o=qK(n,this.debug);return Ie(n,this.debug,function(){return n.attachShader(o,i)}),Ie(n,this.debug,function(){return n.attachShader(o,r)}),XK(n,this.debug,o),this.debug&&j0(n,this.debug,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=rJ(n,this.debug,this.program,this.vertexBuffer)),o},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&Ie(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&j0(this.gl,this.debug,this.program),Ie(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?tY(this.gl,this.debug,t,n):nY(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var r=this;return this.throwIfDisposed(),Ie(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),rY(this.gl,this.debug,this.program,t,n,r)},e.prototype.setOutputMatrixTexture=function(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,r){this.throwIfDisposed();var i=of(n,r),o=i[0],a=i[1];this.setOutputMatrixTextureDriver(t,o,a)},e.prototype.setOutputMatrixWriteRegion=function(t,n,r,i){this.setOutputMatrixWriteRegionDriver(r,t,i,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&j0(this.gl,this.debug,this.program),ah(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),Ie(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),Ie(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=oh(this.gl,this.debug,ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,r),r}var i=this.getQueryTimerExtensionWebGL1(),o=i.createQueryEXT();return i.beginQueryEXT(i.TIME_ELAPSED_EXT,o),o},e.prototype.endQuery=function(){if(ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return _e(this,void 0,void 0,function(){var n=this;return ke(this,function(r){switch(r.label){case 0:return[4,m_(function(){return n.disposed||n.isQueryAvailable(t,ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var i=this.getQueryTimerExtensionWebGL1();return i.getQueryObjectEXT(t,i.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var r=this.gl,i=this.getQueryTimerExtensionWebGL2(),o=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}return o=(i=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,i.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},e.prototype.pollItems=function(){for(var t=function(r){for(var i=0;i<r.length&&r[i]();++i);return i-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||m_(function(){return r.pollItems(),r.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),$0(this.gl,this.debug,t,this.framebuffer),this.debug&&ah(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?($0(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&ah(this.gl)):S_(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var r=n();return this.unbindTextureToFrameBuffer(),r},e.prototype.setOutputMatrixTextureDriver=function(t,n,r){this.throwIfDisposed();var i=this.gl;$0(i,this.debug,t,this.framebuffer),this.debug&&ah(i),this.outputTexture=t,Ie(i,this.debug,function(){return i.viewport(0,0,n,r)}),Ie(i,this.debug,function(){return i.scissor(0,0,n,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,r,i){var o=this;this.throwIfDisposed(),Ie(this.gl,this.debug,function(){return o.gl.scissor(t,n,r,i)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function L_(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,r){var i=n.logicalShape,o=t[r],a=o.shape;if(!bn(i,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+i+" and "+a+" must match");if(!n.isUniform||!o.isUniform){var s=n.texShape,u=o.isUniform?null:o.texData.texShape;if(!bn(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var fJ=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,i=n.inChannels,o=n.strideWidth,a=n.strideHeight,s=n.padInfo,u=n.outWidth,c=n.dilationWidth,l=n.dilationHeight,d=n.dataFormat,f=s.left,h=s.top,p=i*r,m=qn(),g=d==="channelsLast",v=g?0:1,y=g?1:2,b="",w=0;w<=1;w++)for(var E=0;E<=1;E++)b+=`
          blockIndex = rc.y + `+E+`;
          pos = rc.x + `+w+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+a+" - "+h+`;
            d0 = offsetY + `+l+" * (pos / "+p+`);

            if(d0 < `+t[v]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+o+". - "+f+`.);
              d1 = offsetX + `+c+" * (int(mod(float(pos), "+p+".) / "+i+`.));

              if(d1 < `+t[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+i+`.));

                if (`+g+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*w+E)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*w+E)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+b+`

        `+m.output+` = result;
      }
    `},hJ=function(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[];var o,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";o=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+a+"; j <= "+a+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+o+`;
        setOutput(val);
      }
    `},pJ=function(e,t,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+i+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+i+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},vJ=function(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";o=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+a+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+a+"; j <= "+a+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+o+`;
        setOutput(result);
      }
    `},mJ=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,s=o-1-e.padInfo.left,u=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+i+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+o+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+o+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},gJ=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=s-1-e.padInfo.front,d=u-1-e.padInfo.top,f=c-1-e.padInfo.left,h=s*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(`+l+", "+d+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+i+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+o+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+c+`;
                wC += `+a+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+h+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+c+` +
                  wR * `+c+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},H0=function(e,t,n,r,i,o,a){n===void 0&&(n=!1),r===void 0&&(r=!1),i===void 0&&(i=!1),o===void 0&&(o=null),a===void 0&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),c=n?"i * 2, rc.y":"rc.y, i * 2",l=r?"rc.z, i * 2":"i * 2, rc.z",d=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",p="";o&&(h=a?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+o+`
        }`:`vec4 activation(vec4 x) {
          `+o+`
        }`,p="result = activation(result);");var m=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+h+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+c+`);
          vec4 b = getMatrixB(rc.x, `+l+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+d[0]+" * "+f[0]+`);
          result += (`+d[1]+" * "+f[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+m+`

        `+p+`

        setOutput(result);
      }
    `},yJ=function(){function e(t,n,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,i){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(i,"seed")),r.gl.uniform1f(n.seedLoc,t)}},e}(),bJ=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},wJ=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=yr("rc",t),r=Ct(t),i=function(s,u,c){if(s===1)return"rc > "+u[0];for(var l="",d=s-2;d<s;d++)l+=c[d]+" >= "+u[d],d<s-1&&(l+="||");return l}(t,e,n),o=function(s,u,c,l){if(s===1)return"";var d=l.slice(-2);return`
    int r = `+d[0]+`;
    int c = `+d[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+c+`;
  `}(t,e[e.length-1],e[e.length-2],n),a=function(s,u){var c=s.length,l=function(d,f){for(var h=[],p=0;p<=1;p++)for(var m=0;m<=1;m++){for(var g=(p===0?"r":"rp1")+", "+(m===0?"c":"cp1"),v=2;v<d;v++)g=f[f.length-1-v]+","+g;h.push(g)}return h}(c,u);return c===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+l[0]+`),
          cEdge ? 0. : getA(`+l[1]+`),
          rEdge ? 0. : getA(`+l[2]+`),
          rEdge || cEdge ? 0. : getA(`+l[3]+")"}(e,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+i+`) {
            setOutput(vec4(0));
          } else {
            `+o+`

            setOutput(vec4(`+a+`));
          }
        }
      `}},xJ=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(u,c){return u[0]+e[c]+u[1]});var r=e.length,i=Ct(r),o=t.map(function(u){return u[0]}).join(","),a=t.map(function(u,c){return u[0]+e[c]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+i+" start = "+i+"("+o+`);
      `+i+" end = "+i+"("+a+`);

      void main() {
        `+i+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+i+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+o+`;
        int end = `+a+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},EJ=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(g,v){return g[0]+e[v]+g[1]});for(var r=e.length,i=Ct(r),o=t.map(function(g){return g[0]}).join(","),a=t.map(function(g,v){return g[0]+e[v]}).join(","),s=yr("rc",r),u=yr("source",r),c=s[r-1]+" < "+this.outputShape[r-1],l=r===1?"source":"vec2("+u.slice(-2).join()+")",d=[i+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+c+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+c+") {"],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",p=0,m=r===1?2:4;p<m;p++)h+=`
        `+d[p]+`
        if (`+f+`) {
          result[`+p+"] = float("+n+`);
        } else {
          `+i+` source = rc - start;
          result[`+p+"] = getChannel(getX("+u.join()+"), "+l+`);
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const `+i+" start = "+i+"("+o+`);
      const `+i+" end = "+i+"("+a+`);

      void main() {
        `+i+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+h+`
        setOutput(result);
      }
    `},G0=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,i=e.strideHeight,o=e.strideWidth,a=e.dilationHeight,s=e.dilationWidth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=e.padInfo.top,d=e.padInfo.left;this.outputShape=e.outShape;var f=t==="avg",h="0.0";if(f||(h="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+i+", "+o+`);
        const ivec2 pads = ivec2(`+l+", "+d+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+c+`;
                wC += `+s+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+c+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var p=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(p="avgValue / count");var m=4*Math.floor(r/4),g=r%4,v=`
      if (`+f+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+i+", "+o+`);
      const ivec2 pads = ivec2(`+l+", "+d+`);
      const float initializationValue = `+h+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+h+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+a+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+m+`; wC += 4) {
            int xC = xCCorner + wC * `+s+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              getValue(batch, xR, xC + 3 * `+s+`, d)
            );

            `+v+`
          }

          int xC = xCCorner + `+m+`;
          if (`+(g===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+v+`
          } else if (`+(g===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              initializationValue,
              initializationValue
            );

            `+v+`
          } else if (`+(g===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              initializationValue
            );

            `+v+`
          }
        }
        setOutput(`+p+`);
      }
    `}},q0=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=e.padInfo.front,p=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;var g=t==="avg",v="0.0";if(g||(v="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+i+", "+o+", "+a+`);
        const ivec3 pads = ivec3(`+h+", "+p+", "+m+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+l+`;
              wD += `+s+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+d+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+f+`;
                  wC += `+c+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+d+" * "+f+` +
                      wR * `+f+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(y="avgValue / count");var b=4*Math.floor(r/4),w=r%4,E=`
      if (`+g+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+i+", "+o+", "+a+`);
      const ivec3 pads = ivec3(`+h+", "+p+", "+m+`);
      const float initializationValue = `+v+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+v+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+l+`;
            wD += `+s+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+b+`; wC += 4) {
              int xC = xCCorner + wC * `+c+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+c+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+c+`, ch)
              );

              `+E+`
            }

            int xC = xCCorner + `+b+`;
            if (`+(w===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+E+`
            } else if (`+(w===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                initializationValue,
                initializationValue
              );

              `+E+`
            } else if (`+(w===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+c+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+c+`, ch),
                initializationValue
              );

              `+E+`
            }
          }
          setOutput(`+y+`);
        }
      }
    `}},SJ=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,i=e.inSize,o=Math.ceil(i/n);this.outputShape=[r,o];var a="0.0",s="";t==="prod"?a="1.0":t==="min"?(a="1.0 / 1e-20",s="min"):t==="max"&&(a="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,d=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,f="vec4";t==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):t==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");var h="";i%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+a+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+a+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+c+`; i += 4) {
          int inIdx = inOffset + i;
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+d+`
        }

        int inIdx = inOffset + `+c+`;
        if (`+(l===1)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(l===2)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(l===3)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+d+`
        }
        setOutput(`+u+`);
      }
    `},CJ=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+=`
        `+i+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+ds(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+vx(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},_J=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,i=r[1],o=r[2],a=e.shape,s=a[1],u=a[2],c=[n&&s>1?i-1:i,n&&u>1?o-1:o],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=c[0]/l[0],f=c[1]/l[1],h=1/d,p=1/f,m=2*Math.ceil(h)+2,g=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+m+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(i-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(o-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},kJ=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var i=e[0],o=e[1],a=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?o-1:o,r&&n>1?a-1:a],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/c[0]+`,
          `+u[1]/c[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},RJ=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=e[0],o=e[1],a=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?o-1:o,r&&n>1?a-1:a],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/c[0]+`,
          `+u[1]/c[1]+`,
          `+u[1]/c[1]+`);
      const vec3 inputShapeRC = vec3(`+o+".0, "+a+`.0,
                                     `+a+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},IJ=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,i=r[1],o=r[2],a=e.shape,s=a[1],u=a[2],c=[n&&s>1?i-1:i,n&&u>1?o-1:o],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=c[0]/l[0],f=c[1]/l[1],h=1/d,p=1/f,m=2*Math.ceil(h)+2,g=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+m+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+c[0]+`) *
                (float(dyR) / float(`+l[0]+`));

            float sourceFracCol =
                float(`+c[1]+`) *
                  (float(dyC) / float(`+l[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+o+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},TJ=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var i=e[0],o=e[1],a=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?o-1:o,r&&n>1?a-1:a],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],l=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/c[0]+`,
          `+u[1]/c[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+l+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},OJ=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var r=e.map(function(o,a){return function(s){return t.indexOf(s)!==-1&&e[s]!==1?e[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(a)}).join(","),i=Ct(n);this.userCode=`
      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},PJ=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=yr("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],o=r[n-2]+" + 1 < "+this.outputShape[n-2],a=Ct(n);function s(u){var c=e.map(function(l,d){return function(f,h){return t.indexOf(f)!==-1&&e[f]!==1?e[f]+" - "+h[f]+" - 1":""+h[f]}(d,u)});return"getChannel(getX("+c.join(",")+"), vec2("+c.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+i+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+a+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+i+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+o+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+i+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},F_=function(e,t,n,r,i,o,a){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=Ct(i.length),u=Ct(o.length),c="";n===1?c="i":n===2&&(c="i, j");var l="getIndices("+c+")",d="";r===1?d="i":r===2&&(d="i, coords[1]");var f="getUpdates("+d+")",h=t>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+i+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+l+`);
              flattenedIndex += index * `+h+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+f+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},NJ=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,c=`
        sumValue += dot(values, segFilter);
    `,l="";i%n>0&&(l=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `);var d="";i%n>0&&(d=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+l+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+d+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+o+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+o+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+c+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+c+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+c+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+c+`
        }
        setOutput(sumValue);
      }
    `},DJ=function(e,t,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)i="resRC",r="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<t.length;u++)s.push(""+o[u]),u<e&&a.push(""+o[u]);r=a.join(),i=s.join()}var c=Ct(n);this.userCode=`
      void main() {
        `+c+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+i+`));
        } else {
          setOutput(getB(`+i+`));
        }
      }
    `},AJ=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=Ct(this.rank),i="uniform int start["+this.rank+"];",o=function(a){if(a===1)return"sourceLoc";if(a<=6)return X0.slice(0,a).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+a+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(a,s){return"sourceLoc."+X0[s]+" = start["+s+"] + coords."+X0[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+i+`
      void main() {
        `+n+`
        setOutput(getSource(`+o+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,i){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(i,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),X0=["x","y","z","w","u","v"],MJ=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=Ct(this.rank),r=yr("coords",this.rank),i=yr("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":"vec2("+i.slice(-2).join()+")",a="getChannel(getSource("+i.join()+"), "+o+")",s=`
      result.x = `+a+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+i[this.rank-1]+`;
        result.y = `+a+`;
        --`+i[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+i[this.rank-2]+`;
        result.z = `+a+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+i[this.rank-1]+`;
          result.w = `+a+`;
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(l,d){return"start["+d+"]"}).join()+");":t.map(function(l,d){return i[d]+" = "+r[d]+" + start["+d+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+c+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,i){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(i,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),LJ=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=Ct(n.length),o=Ct(n.length),a="";if(r===1)a="coords * strides + begin";else{var s=0;a=n.map(function(u,c){return s++,n.length===1?"coords * strides["+c+"] + begin["+c+"]":"coords["+(s-1)+"] * strides["+c+"] + begin["+c+"]"}).join(",")}this.userCode=`
      `+i+" begin = "+i+"("+e+`);
      `+i+" strides = "+i+"("+t+`);

      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+a+`));
      }
    `},FJ=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,r){var i,o=B_(n,r),a=j_(t,o,r);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return this.numUsedTextures++,this.log(),o===Lr.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):o===Lr.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):o===Lr.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):o===Lr.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):o===Lr.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(i),i},e.prototype.releaseTexture=function(t,n,r,i){if(this.freeTextures!=null){var o=j_(n,B_(r,i),i);o in this.freeTextures||(this.freeTextures[o]=[]),this.freeTextures[o].push(t),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[o],s=a.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(s,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(i){t.gpgpu.deleteMatrixTexture(i)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function B_(e,t){if(e===jr.UPLOAD)return Lr.PACKED_2X2_FLOAT32;if(e===jr.RENDER||e==null)return function(n){return ae().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Lr.PACKED_2X2_FLOAT32:Lr.UNPACKED_FLOAT32:n?Lr.PACKED_2X2_FLOAT16:Lr.UNPACKED_FLOAT16}(t);if(e===jr.DOWNLOAD||e===jr.PIXELS)return Lr.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function j_(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var BJ=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var i=Ct(this.rank),o=function(a){var s=a.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+a[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],c=[],l=0;l<a.length;l++)c.push("imod("+u[l]+", "+a[l]+")");return c.join()}(e);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `},jJ=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var i=Ct(this.rank),o=function(a){var s=a.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],c=new Array(s),l=0;l<a.length;l++)c[a[l]]=u[l];return c.join()}(t);this.userCode=`
    void main() {
      `+i+` resRC = getOutputCoords();
      setOutput(getA(`+o+`));
    }
    `},$J=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=Ct(this.rank),o=sD("rc",this.rank),a=new Array(this.rank);for(r=0;r<t.length;r++)a[t[r]]=o[r];var s="vec2("+a.slice(-2).join()+")",u="++"+o[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+a.join()+"), "+s+")";this.userCode=`
    void main() {
      `+i+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+c+`;
      if(`+u+`) {
        result[1] = `+c+`;
      }
      --`+o[this.rank-1]+`;
      if(++`+o[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+c+`;
        if(`+u+`) {
          result[3] = `+c+`;
        }
      }
      setOutput(result);
    }
    `},mx=1.7580993408473768,gx=1.0507009873554805,He=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Di="if (isnan(x)) return x;",VJ="return x;",$_="return abs(x);",fD=Di+`
  return (x < 0.0) ? 0.0 : x;
`,hD=Di+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,pD="return (x >= 0.0) ? x : (exp(x) - 1.0);",WJ=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+mx+`;
  float scale = `+gx+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,V_="return -x;",W_="return ceil(x);",U_="return floor(x);",z_="return exp(x);",H_="return exp(x) - 1.0;",UJ=Di+`
  return sin(x);
`,zJ=Di+`
  return cos(x);
`,HJ=Di+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,GJ=Di+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,qJ=Di+`
  return atan(x);
`,XJ=Di+"return log(x + sqrt(x * x + 1.0));",KJ=Di+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,YJ=Di+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,lh="return x;",QJ="return x;",vD=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,mD=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,gD=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,pl=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},JJ=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=yr("rc",t),r=Ct(t),i=function(s,u){if(s===1)return"rc";for(var c="",l=0;l<s;l++)c+=u[l],l<s-1&&(c+=",");return c}(t,n),o=n.slice(-2),a=t<=1?"rc":"vec2("+o.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+i+`);

        setOutput(getChannel(packedInput, `+a+`));
      }
    `},dh={};function fh(e,t){if(t===void 0&&(t=!1),e==="linear")return t?QJ:VJ;if(e==="relu")return t?vD:fD;if(e==="elu")return t?gD:pD;if(e==="relu6")return t?mD:hD;if(e==="prelu")return t?dD:lD;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var ZJ=600,eZ=function(e){function t(n){var r,i=e.call(this)||this;if(i.pendingRead=new WeakMap,i.pendingDisposal=new WeakSet,i.dataRefCount=new WeakMap,i.numBytesInGPU=0,i.uploadWaitMs=0,i.downloadWaitMs=0,i.warnedAboutMemory=!1,i.pendingDeletes=0,i.disposed=!1,!ae().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var o=uo(ae().getNumber("WEBGL_VERSION"));i.binaryCache=((r=ae().getNumber("WEBGL_VERSION"))in dh||(dh[r]={}),dh[r]),i.gpgpu=new dJ(o),i.canvas=o.canvas,i.gpgpuCreatedLocally=!0}else i.gpgpu=n,i.binaryCache={},i.gpgpuCreatedLocally=!1,i.canvas=n.gl.canvas;return i.textureManager=new FJ(i.gpgpu),i.numMBBeforeWarning=ae().global.screen==null?1024:ae().global.screen.height*ae().global.screen.width*window.devicePixelRatio*ZJ/1024/1024,i.texData=new JN(i,X),i}return Ni(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,r,i){if(ae().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var o={};return this.texData.set(o,{shape:r,dtype:i,values:n,usage:jr.UPLOAD}),o},t.prototype.move=function(n,r,i,o){if(ae().getBool("DEBUG")&&this.checkNumericalProblems(r),o==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:i,dtype:o,values:r,usage:jr.UPLOAD})},t.prototype.readSync=function(n){var r=this.texData.get(n),i=r.values,o=r.dtype,a=r.complexTensors,s=r.slice,u=r.shape,c=r.isPacked;if(s!=null){var l=void 0;l=c?new pl(u,lh):new He(u,lh);var d=this.runWebGLProgram(l,[{dataId:n,shape:u,dtype:o}],o),f=this.readSync(d.dataId);return this.disposeData(d.dataId),f}if(i!=null)return this.convertAndCacheOnCPU(n);if(o==="string")return i;var h,p,m=this.activeTimers!=null;return m&&(h=Gi()),o==="complex64"?p=ob(a.real.dataSync(),a.imag.dataSync()):p=this.getValuesFromTexture(n),m&&(this.downloadWaitMs+=Gi()-h),this.convertAndCacheOnCPU(n,p)},t.prototype.read=function(n){return _e(this,void 0,void 0,function(){var r,i,o,a,s,u,c,l,d,f,h,p,m,g,v,y,b,w,E,x,R,S;return ke(this,function(_){switch(_.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(T){return r.push(T)})];if(i=this.texData.get(n),o=i.values,a=i.shape,s=i.slice,u=i.dtype,c=i.complexTensors,l=i.isPacked,s!=null)return d=void 0,d=l?new pl(a,lh):new He(a,lh),f=this.runWebGLProgram(d,[{dataId:n,shape:a,dtype:u}],u),h=this.read(f.dataId),this.disposeData(f.dataId),[2,h];if(o!=null)return[2,this.convertAndCacheOnCPU(n)];if(!ae().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ae().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return p=null,u!=="complex64"&&ae().get("WEBGL_BUFFER_SUPPORTED")&&(m=this.decode(n),g=this.texData.get(m.dataId),p=(S=this.gpgpu).createBufferFromTexture.apply(S,[g.texture].concat(Bl(a)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:_.sent(),_.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([c.real.data(),c.imag.data()])];case 3:return y=_.sent(),b=y[0],w=y[1],v=ob(b,w),[3,5];case 4:p==null?v=this.getValuesFromTexture(n):(E=Re(a),v=this.gpgpu.downloadFloat32MatrixFromBuffer(p,E)),_.label=5;case 5:return m!=null&&this.disposeData(m.dataId),x=this.convertAndCacheOnCPU(n,v),R=this.pendingRead.get(n),this.pendingRead.delete(n),R.forEach(function(T){return T(x)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,x]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var i=n[r];if(!WK(i))throw ae().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+i+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+i+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var r,i=this.texData.get(n),o=i.shape,a=i.dtype,s=i.isPacked,u=Re(o);if(ae().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var c=this.decode(n),l=this.texData.get(c.dataId),d=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[l.texture].concat(Bl(o))).subarray(0,u);return this.disposeData(c.dataId),d}var f=ae().getBool("WEBGL_PACK")&&s===!0,h=f?V0(o):o,p=f?new VQ(h):new $Q(h),m=this.runWebGLProgram(p,[{shape:h,dtype:a,dataId:n}],"float32"),g=this.texData.get(m.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(g.texture,g.texShape[0],g.texShape[1]).subarray(0,u);return this.disposeData(m.dataId),v},t.prototype.time=function(n){return _e(this,void 0,void 0,function(){var r,i,o,a,s,u,c;return ke(this,function(l){switch(l.label){case 0:return r=this.activeTimers,i=[],o=!1,this.programTimersStack==null?(this.programTimersStack=i,o=!0):this.activeTimers.push(i),this.activeTimers=i,n(),a=mc(this.activeTimers.map(function(d){return d.query})).filter(function(d){return d!=null}),s=mc(this.activeTimers.map(function(d){return d.name})).filter(function(d){return d!=null}),this.activeTimers=r,o&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return c=l.sent(),u.kernelMs=EK(c),u.getExtraProfileInfo=function(){return c.map(function(d,f){return{name:s[f],ms:d}}).map(function(d){return d.name+": "+d.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},l.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Gi(),endMs:null}},t.prototype.endTimer=function(n){return ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=Gi(),n)},t.prototype.getQueryTime=function(n){return _e(this,void 0,void 0,function(){var r;return ke(this,function(i){return ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var r=this.texData.get(n),i=r.texture,o=r.dtype,a=r.texShape,s=r.usage,u=r.isPacked,c=r.slice,l=c&&c.origDataId||n,d=this.dataRefCount.get(l);d>1?this.dataRefCount.set(l,d-1):(this.dataRefCount.delete(l),i!=null&&(this.numBytesInGPU-=this.computeBytes(a,o),this.textureManager.releaseTexture(i,a,s,u)));var f=this.texData.get(n);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return ae().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=X.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,r){var i=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(o){return i.texData.get(o.dataId).texture==null&&o.size<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,r){var i=this.makeOutput(n.shape,"complex64");return this.texData.get(i.dataId).complexTensors={real:X.keep(n.clone()),imag:X.keep(r.clone())},i},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,i);if(Re(i)===0)return On([],i,n.dtype);var o=this.texData.get(n.dataId).isPacked,a=YN(n.shape,r,i);if(o||!a){var s=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new MJ(i):new AJ(i),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,i)},t.prototype.shallowSlice=function(n,r,i){var o=this.texData.get(n.dataId),a=this.makeOutput(i,n.dtype),s=this.texData.get(a.dataId);Object.assign(s,o),s.shape=i,s.dtype=n.dtype;var u=QN(r,n.strides);o.slice&&(u+=o.slice.flatOffset),s.slice={flatOffset:u,origDataId:o.slice&&o.slice.origDataId||n.dataId};var c=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,c+1),a},t.prototype.stridedSlice=function(n,r,i,o){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,i,o);var a=lx(r,i,o);if(a.some(function(u){return u===0}))return On([],a);var s=new LJ(r,o,a);return this.compileAndRun(s,[n])},t.prototype.reverse=function(n,r){var i=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new PJ(n.shape,r):new OJ(n.shape,r);return this.compileAndRun(i,[n])},t.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var i=n.map(function(h){return ei(h)}),o=n.map(function(h){return Ki(h)});return In(this.concat(i,r),this.concat(o,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>ae().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(n.length/2),s=this.concat(n.slice(0,a),r),u=this.concat(n.slice(a),r);return this.concat([s,u],r)}if(ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var c=new kQ(n.map(function(h){return h.shape}),r);return this.compileAndRun(c,n)}var l=yc(n.map(function(h){return h.shape}),r),d=n.map(function(h){return h.as2D(-1,Re(h.shape.slice(r)))}),f=new _Q(d.map(function(h){return h.shape}));return this.compileAndRun(f,d).reshape(l)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(ae().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,V_,n.dtype);var r=new He(n.shape,V_);return this.compileAndRun(r,[n])},t.prototype.batchMatMul=function(n,r,i,o){var a=i?n.shape[2]:n.shape[1],s=o?r.shape[1]:r.shape[2],u=i?n.shape[1]:n.shape[2],c=n.shape[0];if((a===1||s===1)&&u>1e3){i&&(n=n.transpose([0,2,1])),o&&(r=r.transpose([0,2,1]));var l=s===1?n:n.as3D(c,u,1),d=s===1?2:1,f=s===1?r.as3D(c,1,u):r;return this.multiply(l,f).sum(d,!0)}var h=Tn(n.dtype,r.dtype),p=new H0(n.shape,[c,a,s],i,o);return this.compileAndRun(p,[n,r],h)},t.prototype.fusedBatchMatMul=function(n){var r=n.a,i=n.b,o=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,c=n.preluActivationWeights,l=o?r.shape[2]:r.shape[1],d=a?i.shape[1]:i.shape[2],f=r.shape[0],h=Tn(r.dtype,i.dtype),p=s!=null,m=c!=null,g=u?fh(u,!0):null,v=new H0(r.shape,[f,l,d],o,a,p,g,m),y=[r,i];return s&&y.push(s),c&&y.push(c),this.compileAndRun(v,y,h)},t.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var i=this.texData.get(n.dataId),o=this.texData.get(r.dataId),a=new T_(wQ,n.shape,r.shape),s=new T_(xQ,n.shape,r.shape),u=[this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag),this.makeComplexComponentTensorInfo(r,o.complexTensors.real),this.makeComplexComponentTensorInfo(r,o.complexTensors.imag)],c=this.compileAndRun(a,u),l=this.compileAndRun(s,u),d=this.complex(c,l);return c.dispose(),l.dispose(),d}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(ae().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,O_,n.dtype);var f=new Ut(O_,n.shape,r.shape);return this.compileAndRun(f,[n,r],n.dtype)},t.prototype.batchNormalization=function(n,r,i,o,a,s){var u=[n,r,i],c=null;s!=null&&(c=s.shape,u.push(s));var l=null;if(a!=null&&(l=a.shape,u.push(a)),ae().getBool("WEBGL_PACK_NORMALIZATION")){var d=new bQ(n.shape,r.shape,i.shape,c,l,o);return this.compileAndRun(d,u)}var f=new yQ(n.shape,r.shape,i.shape,c,l,o);return this.compileAndRun(f,u)},t.prototype.localResponseNormalization4D=function(n,r,i,o,a){var s=ae().getBool("WEBGL_PACK_NORMALIZATION")?new vJ(n.shape,r,i,o,a):new hJ(n.shape,r,i,o,a);return this.compileAndRun(s,[n])},t.prototype.LRNGrad=function(n,r,i,o,a,s,u){var c=new pJ(r.shape,o,a,s,u);return this.compileAndRun(c,[r,i,n])},t.prototype.tile=function(n,r){if(n.dtype==="string"){var i=this.readSync(n.dataId).map(function(a){return Qp(a)});return oD(je(n.shape,n.dtype,i),r)}var o=new BJ(n.shape,r);return this.compileAndRun(o,[n])},t.prototype.pad=function(n,r,i){var o=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new EJ(n.shape,r,i):new xJ(n.shape,r,i);return this.compileAndRun(o,[n])},t.prototype.transpose=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.transpose(n,r);var i=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new $J(n.shape,r):new jJ(n.shape,r);return this.compileAndRun(i,[n])},t.prototype.gather=function(n,r,i){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,i);var o=new qQ(n.shape,r.size,i);return this.compileAndRun(o,[n,r])},t.prototype.batchToSpaceND=function(n,r,i){W(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var o=r.reduce(function(d,f){return d*f}),a=rv(n.shape,r,o),s=iv(a.length,r.length),u=ov(n.shape,r,o),c=GN(i,r.length),l=qN(u,i,r.length);return n.reshape(a).transpose(s).reshape(u).slice(c,l)},t.prototype.spaceToBatchND=function(n,r,i){W(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var o=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,i);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),c=rv(u.shape,r,o,!1),l=iv(c.length,r.length,!1),d=ov(u.shape,r,o,!1);return u.reshape(c).transpose(l).reshape(d)},t.prototype.reduce=function(n,r,i){var o=n.shape[0],a=n.shape[1],s=W0(a),u=new SJ({windowSize:s,inSize:a,batchSize:o},r),c=this.compileAndRun(u,[n],i);return c.shape[1]===1?c:this.reduce(c,r,i)},t.prototype.argReduce=function(n,r,i){i===void 0&&(i=null);var o=n.shape[0],a=n.shape[1];i!=null&&(o=i.shape[0],a=i.shape[1]);var s=W0(a),u=new cQ({windowSize:s,inSize:a,batchSize:o},r,i==null),c=[n];i!=null&&c.push(i);var l=this.compileAndRun(u,c,"int32");return l.shape[1]===1?l:this.argReduce(n,r,l)},t.prototype.argReducePacked=function(n,r,i){i===void 0&&(i=null);var o=i!=null?i.shape:n.shape,a=W0(o[o.length-1]),s=new vQ(o,a,r,i==null),u=i==null?[n]:[n,i],c=this.compileAndRun(s,u,"int32");return c.rank===n.rank?this.argReducePacked(n,r,c):c},t.prototype.sum=function(n,r){Ar("sum",r,n.rank);var i=Un(n.shape,r),o=i[0],a=Re(i[1]),s=n.as2D(-1,a),u=A0(n.dtype);return this.reduce(s,"sum",u).reshape(o)},t.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var i=Un(n.shape,r),o=i[0],a=Re(i[1]),s=n.as2D(-1,a),u=A0(n.dtype);return this.reduce(s,"prod",u).reshape(o)},t.prototype.unsortedSegmentSum=function(n,r,i){var o=0,a=co([o],n.rank),s=n;a!=null&&(s=n.transpose(a),o=lo(1,n.rank)[0]);var u=function(h,p,m){for(var g=[],v=h.length,y=0;y<v;y++)y!==p?g.push(h[y]):g.push(m);return g}(s.shape,o,i),c=Re([s.shape[o]]),l=s.as2D(-1,c),d=A0(n.dtype),f=this.segOpCompute(l,"unsortedSegmentSum",r,d,i).reshape(u);return a!=null&&(f=f.transpose(ax(a))),f},t.prototype.segOpCompute=function(n,r,i,o,a){var s=n.shape[0],u=n.shape[1],c=function(f,h){var p,m=!1;for(f<=KN?(p=f,m=!0):p=Y1(f,Math.floor(Math.sqrt(f)));!m;)p>h||p===f?m=!0:p=Y1(f,p+1);return p}(u,a),l=new NJ({windowSize:c,inSize:u,batchSize:s,numSegments:a}),d=this.compileAndRun(l,[n,i],o);return d.shape[1]===a?d:(i=nv(0,a).tile([u/c]),this.segOpCompute(d,r,i,o,a))},t.prototype.argMinMaxReduce=function(n,r,i){var o=[r];if(Ar("arg"+i.charAt(0).toUpperCase()+i.slice(1),o,n.rank),!ae().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var a=Un(n.shape,o),s=a[0],u=Re(a[1]),c=n.as2D(-1,u);return this.argReduce(c,i).reshape(s)}return this.argReducePacked(n,i)},t.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},t.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},t.prototype.cumsum=function(n,r,i,o){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var a=new MQ(n.shape,i,o);return this.compileAndRun(a,[n])},t.prototype.equal=function(n,r){if(ae().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var i=new Ut("return float(a == b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.notEqual=function(n,r){if(ae().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var i=new Ut("return float(a != b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(ae().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var i=new Ut("return float(a < b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.lessEqual=function(n,r){if(ae().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var i=new Ut("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(ae().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var i=new Ut("return float(a > b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.greaterEqual=function(n,r){if(ae().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var i=new Ut("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.logicalNot=function(n){var r=new He(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},t.prototype.logicalAnd=function(n,r){if(ae().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var i=new Ut("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.logicalOr=function(n,r){if(ae().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var i=new Ut("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.select=function(n,r,i){var o=new DJ(n.rank,r.shape,r.rank);return this.compileAndRun(o,[n,r,i],Tn(r.dtype,i.dtype))},t.prototype.where=function(n){ev("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return px(n.shape,r)},t.prototype.topk=function(n,r,i){return aD(n.dataSync(),n.shape,n.dtype,r)},t.prototype.min=function(n,r){Ar("min",r,n.rank);var i=Un(n.shape,r),o=i[0],a=Re(i[1]),s=n.as2D(-1,a);return this.reduce(s,"min",s.dtype).reshape(o)},t.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var i=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new vo(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ut(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.mod=function(n,r){var i=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new vo(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ut(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);Ar("max",r,n.rank);var i=Un(n.shape,r),o=i[0],a=Re(i[1]),s=n.as2D(-1,a);return this.reduce(s,"max",s.dtype).reshape(o)},t.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var i=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new vo(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ut(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.all=function(n,r){Ar("all",r,n.rank);var i=Un(n.shape,r),o=i[0],a=Re(i[1]),s=n.as2D(-1,a);return this.reduce(s,"all",s.dtype).reshape(o)},t.prototype.any=function(n,r){Ar("any",r,n.rank);var i=Un(n.shape,r),o=i[0],a=Re(i[1]),s=n.as2D(-1,a);return this.reduce(s,"any",s.dtype).reshape(o)},t.prototype.realDivide=function(n,r){if(ae().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var i=new Ut(`
if (a == b) {
  return 1.0;
};
return a / b;`,n.shape,r.shape);return this.compileAndRun(i,[n,r],"float32")},t.prototype.floorDiv=function(n,r){if(ae().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var i=new Ut(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(i,[n,r],"int32")},t.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,U0);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var i=Tn(n.dtype,r.dtype);if(ae().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,U0,i);var o=new Ut(U0,n.shape,r.shape);return this.compileAndRun(o,[n,r],i)},t.prototype.packedUnaryOp=function(n,r,i){var o=new pl(n.shape,r);return this.compileAndRun(o,[n],i)},t.prototype.packedBinaryOp=function(n,r,i,o,a){a===void 0&&(a=!1);var s=new vo(i,n.shape,r.shape,a);return this.compileAndRun(s,[n,r],o)},t.prototype.complexSeparableBinaryOp=function(n,r,i){var o=this,a=this.texData.get(n.dataId),s=this.texData.get(r.dataId),u=[[a.complexTensors.real,s.complexTensors.real],[a.complexTensors.imag,s.complexTensors.imag]].map(function(f){var h=f[0],p=f[1],m=o.makeComplexComponentTensorInfo(n,h),g=o.makeComplexComponentTensorInfo(r,p),v=new Ut(i,n.shape,r.shape);return o.compileAndRun(v,[m,g],Tn(h.dtype,p.dtype))}),c=u[0],l=u[1],d=this.complex(c,l);return c.dispose(),l.dispose(),d},t.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>ae().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),i=this.addN(n.slice(0,r)),o=this.addN(n.slice(r));return this.addN([i,o])}var a=n.map(function(c){return c.dtype}).reduce(function(c,l){return Tn(c,l)}),s=n.map(function(c){return c.shape}),u=ae().getBool("WEBGL_PACK")?new uQ(n[0].shape,s):new sQ(n[0].shape,s);return this.compileAndRun(u,n,a)},t.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,z0);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var i=Tn(n.dtype,r.dtype);if(ae().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,z0,n.dtype);var o=new Ut(z0,n.shape,r.shape);return this.compileAndRun(o,[n,r],i)},t.prototype.pow=function(n,r){var i=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new vo(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ut(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),o=Tn(n.dtype,r.dtype);return this.compileAndRun(i,[n,r],o)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(ae().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,W_,n.dtype);var r=new He(n.shape,W_);return this.compileAndRun(r,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(ae().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,U_,n.dtype);var r=new He(n.shape,U_);return this.compileAndRun(r,[n])},t.prototype.sign=function(n){var r=new He(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},t.prototype.isNaN=function(n){var r=new He(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isInf=function(n){var r=new He(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isFinite=function(n){var r=new He(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.round=function(n){var r=new He(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(ae().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,z_,n.dtype);var r=new He(n.shape,z_);return this.compileAndRun(r,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(ae().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,H_,n.dtype);var r=new He(n.shape,H_);return this.compileAndRun(r,[n])},t.prototype.softmax=function(n,r){var i=dn([r],n.shape),o=this.max(n,i),a=Ir(o.shape,i),s=this.subtract(n,o.reshape(a)),u=this.exp(s),c=this.sum(u,i).reshape(a);return this.realDivide(u,c)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(ae().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new He(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},t.prototype.log1p=function(n){var r=new He(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},t.prototype.sqrt=function(n){var r=new He(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new He(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},t.prototype.reciprocal=function(n){var r=new He(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},t.prototype.relu=function(n){var r;return r=ae().getBool("WEBGL_PACK")?new pl(n.shape,vD):new He(n.shape,fD),this.compileAndRun(r,[n])},t.prototype.relu6=function(n){var r;return r=ae().getBool("WEBGL_PACK")?new pl(n.shape,mD):new He(n.shape,hD),this.compileAndRun(r,[n])},t.prototype.prelu=function(n,r){var i=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new vo(dD,n.shape,r.shape):new Ut(lD,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.elu=function(n){if(ae().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,gD,n.dtype);var r=new He(n.shape,pD);return this.compileAndRun(r,[n])},t.prototype.eluDer=function(n,r){var i=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new vo(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new Ut("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.selu=function(n){var r=new He(n.shape,WJ);return this.compileAndRun(r,[n])},t.prototype.int=function(n){var r=new He(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},t.prototype.clip=function(n,r,i){var o,a=(o=ae().getBool("WEBGL_PACK_CLIP")?new SQ(n.shape):new EQ(n.shape)).getCustomSetupFunc(r,i);return this.compileAndRun(o,[n],null,a)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(ae().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,$_,n.dtype);var r=new He(n.shape,$_);return this.compileAndRun(r,[n])},t.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),i=new CQ(n.shape),o=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(i,o)},t.prototype.sigmoid=function(n){var r=new He(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},t.prototype.softplus=function(n){var r=new He(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},t.prototype.sin=function(n){var r=new He(n.shape,UJ);return this.compileAndRun(r,[n])},t.prototype.cos=function(n){var r=new He(n.shape,zJ);return this.compileAndRun(r,[n])},t.prototype.tan=function(n){var r=new He(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},t.prototype.asin=function(n){var r=new He(n.shape,HJ);return this.compileAndRun(r,[n])},t.prototype.acos=function(n){var r=new He(n.shape,GJ);return this.compileAndRun(r,[n])},t.prototype.atan=function(n){var r=new He(n.shape,qJ);return this.compileAndRun(r,[n])},t.prototype.atan2=function(n,r){var i=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new vo(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ut(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.sinh=function(n){var r=new He(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.cosh=function(n){var r=new He(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.tanh=function(n){var r=new He(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},t.prototype.asinh=function(n){var r=new He(n.shape,XJ);return this.compileAndRun(r,[n])},t.prototype.acosh=function(n){var r=new He(n.shape,KJ);return this.compileAndRun(r,[n])},t.prototype.atanh=function(n){var r=new He(n.shape,YJ);return this.compileAndRun(r,[n])},t.prototype.erf=function(n){var r=new He(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},t.prototype.step=function(n,r){var i=new He(n.shape,function(o){return o===void 0&&(o=0),Di+`
    return x > 0.0 ? 1.0 : float(`+o+`);
  `}(r));return this.compileAndRun(i,[n])},t.prototype.conv2dByMatMul=function(n,r,i,o,a,s){var u=n.shape,c=this.texData.get(n.dataId),l=i.inChannels,d=u[0]*u[1]*u[2],f=i.outChannels,h=i.dataFormat==="channelsLast",p=(d===1||f===1)&&l>1e3,m=u[2]%2!=0&&!!c.isPacked;if(p||!ae().getBool("WEBGL_LAZILY_UNPACK")||!ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!m){var g=h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],v=this.reshape(n,[1,g,i.inChannels]),y=this.reshape(r,[1,i.inChannels,i.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:y,transposeA:!1,transposeB:!1,bias:o,activation:a,preluActivationWeights:s}),i.outShape)}var b=h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),w={dataId:n.dataId,shape:[1,b,i.inChannels],dtype:n.dtype},E=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,W(uh(c.shape,w.shape),function(){return"packed reshape "+c.shape+" to "+w.shape+" isn't free"});var x=this.reshape(r,[1,i.inChannels,i.outChannels]),R=this.fusedBatchMatMul({a:w,b:x,transposeA:!1,transposeB:!1,bias:o,activation:a,preluActivationWeights:s}),S=this.texData.get(R.dataId);return W(S.isPacked,function(){return"batchMatMul result is expected to be packed"}),c.shape=E,S.shape=i.outShape,X.makeTensorFromDataId(R.dataId,i.outShape,R.dtype)},t.prototype.conv2dWithIm2Row=function(n,r,i,o,a,s){var u=i.filterWidth,c=i.filterHeight,l=i.inChannels,d=i.outWidth,f=i.outHeight,h=i.dataFormat==="channelsLast",p=u*c*l,m=f*d,g=[p,m],v=n.squeeze([0]),y=r.reshape([1,p,-1]),b=new fJ(g,v.shape,i),w=this.compileAndRun(b,[v]).reshape([1,g[0],g[1]]),E=o!=null,x=s!=null,R=a?fh(a,!0):null,S=new H0(w.shape,[1,m,i.outChannels],!0,!1,E,R,x),_=[w,y];o&&_.push(o),x&&_.push(s);var T=this.compileAndRun(S,_);return h?T.reshape([1,f,d,i.outChannels]):T.reshape([1,i.outChannels,f,d])},t.prototype.fusedConv2d=function(n){var r=n.input,i=n.filter,o=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights;if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(r,i,o,a,s,u);if(ae().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,i,o,a,s,u);var c=a!=null,l=u!=null,d=s?fh(s,!1):null,f=new P_(o,c,d,l),h=[r,i];return a&&h.push(a),u&&h.push(u),this.compileAndRun(f,h)},t.prototype.conv2d=function(n,r,i){if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,i);if(ae().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,i);var o=new P_(i);return this.compileAndRun(o,[n,r])},t.prototype.conv2dDerInput=function(n,r,i){var o=new IQ(i);return this.compileAndRun(o,[n,r])},t.prototype.conv2dDerFilter=function(n,r,i){var o=new RQ(i);return this.compileAndRun(o,[n,r])},t.prototype.fusedDepthwiseConv2D=function(n){var r,i=n.input,o=n.filter,a=n.convInfo,s=n.bias,u=n.activation,c=n.preluActivationWeights,l=ae().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,d=u?fh(u,l):null,f=[i,o],h=s!=null,p=c!=null;return h&&f.push(s),p&&f.push(c),l?(r=new D_(a,h,d,p),this.compileAndRun(r,f)):(r=new N_(a,h,d,p),this.compileAndRun(r,f))},t.prototype.depthwiseConv2D=function(n,r,i){var o;return ae().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1?(o=new D_(i),this.compileAndRun(o,[n,r])):(o=new N_(i),this.compileAndRun(o,[n,r]))},t.prototype.depthwiseConv2DDerInput=function(n,r,i){var o=new NQ(i);return this.compileAndRun(o,[n,r])},t.prototype.depthwiseConv2DDerFilter=function(n,r,i){var o=new PQ(i);return this.compileAndRun(o,[n,r])},t.prototype.conv3d=function(n,r,i){var o=new DQ(i);return this.compileAndRun(o,[n,r])},t.prototype.conv3dDerInput=function(n,r,i){var o=new OQ(i);return this.compileAndRun(o,[n,r])},t.prototype.conv3dDerFilter=function(n,r,i){var o=new TQ(i);return this.compileAndRun(o,[n,r])},t.prototype.maxPool=function(n,r){var i=new G0(r,"max",!1);return this.compileAndRun(i,[n])},t.prototype.avgPool=function(n,r){var i=new G0(r,"avg",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.maxPoolBackprop=function(n,r,i,o){var a=new G0(o,"max",!0),s=this.compileAndRun(a,[r]),u=new mJ(o),c=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),c},t.prototype.avgPoolBackprop=function(n,r,i){var o=new mQ(i);return this.compileAndRun(o,[n],r.dtype)},t.prototype.cast=function(n,r){return tD(n,r,this)},t.prototype.unstack=function(n,r){for(var i=n.shape[r],o=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(o[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),c=n.shape.slice();c[r]=1;var l=new Array(i);for(s=0;s<l.length;s++)u[r]=s,l[s]=this.slice(n,u,c).reshape(o);return l},t.prototype.avgPool3d=function(n,r){var i=new q0(r,"avg",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,r,i){var o=new gQ(i);return this.compileAndRun(o,[n],r.dtype)},t.prototype.maxPool3d=function(n,r){var i=new q0(r,"max",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,r,i,o){var a=new q0(o,"max",!0),s=this.compileAndRun(a,[r]),u=new gJ(o),c=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),c},t.prototype.reshape=function(n,r){var i=this.texData.get(n.dataId);if(i.isPacked&&!uh(n.shape,r)&&(i.texture===null||!uh(i.shape,r))){var o=this.packedReshape(n,r);return X.makeTensorFromDataId(o.dataId,o.shape,o.dtype)}return ib(n,r)},t.prototype.resizeBilinear=function(n,r,i,o){var a=ae().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new RJ(n.shape,r,i,o):new kJ(n.shape,r,i,o);return this.compileAndRun(a,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,r,i){var o=new _J(n,r,i);return this.compileAndRun(o,[n])},t.prototype.resizeNearestNeighbor=function(n,r,i,o){var a=new TJ(n.shape,r,i,o);return this.compileAndRun(a,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,r,i){var o=new IJ(n,r,i);return this.compileAndRun(o,[n])},t.prototype.multinomial=function(n,r,i,o){var a=r?n:Lo(n),s=a.shape[0],u=a.shape[1],c=new yJ(s,u,i),l=c.getCustomSetupFunc(o);return this.compileAndRun(c,[a],"int32",l)},t.prototype.oneHot=function(n,r,i,o){var a=new bJ(n.size,r,i,o);return this.compileAndRun(a,[n])},t.prototype.diag=function(n){var r=new jQ(n.size);return this.compileAndRun(r,[n])},t.prototype.nonMaxSuppression=function(n,r,i,o,a){return ev("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),fx(n.dataSync(),r.dataSync(),i,o,a)},t.prototype.cropAndResize=function(n,r,i,o,a,s){var u=new AQ(n.shape,r.shape,o,a,s);return this.compileAndRun(u,[n,r,i],"float32")},t.prototype.depthToSpace=function(n,r,i){W(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var o=n.shape[0],a=i==="NHWC"?n.shape[1]:n.shape[2],s=i==="NHWC"?n.shape[2]:n.shape[3],u=i==="NHWC"?n.shape[3]:n.shape[1],c=a*r,l=s*r,d=u/(r*r),f=new BQ(i==="NHWC"?[o,c,l,d]:[o,d,c,l],r,i);return this.compileAndRun(f,[n])},t.prototype.split=function(n,r,i){return iD(n,r,i)},t.prototype.scatterND=function(n,r,i){var o=av(0,n,i),a=o.sliceRank,s=o.numUpdates,u=o.sliceSize,c=o.strides,l=o.outputSize,d=[l/u,u],f=n.reshape([s,a]),h=r.reshape([s,u]);if(l===0)return ib(On([]),i);var p=ye(0),m=new F_(s,a,f.rank,h.rank,c,d);return this.compileAndRun(m,[h,f,p]).reshape(i)},t.prototype.sparseToDense=function(n,r,i,o){var a=av(0,n,i),s=a.sliceRank,u=a.numUpdates,c=a.strides,l=a.outputSize,d=new F_(u,s,n.rank,r.rank,c,[l,1]);return this.compileAndRun(d,[r,n,o]).reshape(i)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,r){var i=this.texData.get(n.dataId),o=new M_(zQ,n.shape,r),a=new M_(HQ,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag)],u=this.compileAndRun(o,s),c=this.compileAndRun(a,s),l=this.complex(u,c).as2D(n.shape[0],n.shape[1]);return u.dispose(),c.dispose(),l},t.prototype.gatherND=function(n,r){var i=r.shape,o=i[i.length-1],a=XN(n,r),s=a[0],u=a[1],c=a[2],l=a[3],d=r.reshape([u,o]),f=n.reshape([n.size/c,c]),h=new XQ(o,l,[u,c]);return this.compileAndRun(h,[f,d]).reshape(s)},t.prototype.fill=function(n,r,i){if((i=i||nf(r))==="string"){var o=Yp(i,Re(n));return o.fill(r),X.makeTensor(o,n,i,this)}var a=new GQ(n,r),s=a.getCustomSetupFunc(r);return this.compileAndRun(a,[],i,s)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,r,i){return nD(n,r,i)},t.prototype.makeTensorInfo=function(n,r){var i=this.write(null,n,r);return this.texData.get(i).usage=null,{dataId:i,shape:n,dtype:r}},t.prototype.makeOutput=function(n,r){var i=this.makeTensorInfo(n,r).dataId;return X.makeTensorFromDataId(i,n,r,this)},t.prototype.unpackTensor=function(n){var r=new JJ(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},t.prototype.packTensor=function(n){var r=new wJ(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,r){var i=[Jp(n.shape)].concat(Zp(n.shape)),o={dtype:n.dtype,shape:i,dataId:n.dataId},a=[Jp(r)].concat(Zp(r)),s=new CJ(a,i),u=this.runWebGLProgram(s,[o],n.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},t.prototype.decode=function(n){var r,i=this.texData.get(n),o=i.isPacked,a=i.shape,s=i.dtype,u=V0(a);return r=o?new FQ(u):new LQ(u),{dtype:s,shape:a,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:n}],s,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,r,i,o,a){var s=this;a===void 0&&(a=!1);var u=this.makeTensorInfo(n.outputShape,i),c=this.texData.get(u.dataId);if(n.packedOutput&&(c.isPacked=!0),n.outPackingScheme===yd.DENSE){var l=Bl(n.outputShape);c.texShape=l.map(function(b){return 2*b})}if(n.outTexUsage!=null&&(c.usage=n.outTexUsage),Re(u.shape)===0)return c.values=md(u.dtype,0),u;var d=[],f=r.map(function(b){if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var w=s.texData.get(b.dataId);if(w.texture==null){if(!n.packedInputs&&Re(b.shape)<=ae().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:w.values};n.packedInputs&&(w.isPacked=!0,w.shape=b.shape)}else if(!!w.isPacked!=!!n.packedInputs)b=w.isPacked?s.unpackTensor(b):s.packTensor(b),d.push(b),w=s.texData.get(b.dataId);else if(w.isPacked&&!uh(w.shape,b.shape)){var E=b,x=b.shape;b.shape=w.shape,b=s.packedReshape(b,x),d.push(b),w=s.texData.get(b.dataId),E.shape=x}return s.uploadToGPU(b.dataId),{shape:b.shape,texData:w,isUniform:!1}});this.uploadToGPU(u.dataId);var h,p={shape:u.shape,texData:c,isUniform:!1},m=function(b,w,E){var x="";w.concat(E).forEach(function(_){var T=_.texData!=null&&_.texData.slice!=null&&_.texData.slice.flatOffset>0,B=_.isUniform?"uniform":_.texData.texShape;x+=_.shape+"_"+B+"_"+T});var R=b.userCode,S=b.constructor.name;return S+="_"+x+"_"+R}(n,f,p),g=this.getAndSaveBinary(m,function(){return function(b,w,E,x){var R=w.userCode,S=E.map(function(N,j){var P={logicalShape:N.shape,texShape:N.isUniform?null:N.texData.texShape,isUniform:N.isUniform,isPacked:!N.isUniform&&N.texData.isPacked,flatOffset:null};return N.texData!=null&&N.texData.slice!=null&&N.texData.slice.flatOffset>0&&(P.flatOffset=N.texData.slice.flatOffset),{name:w.variableNames[j],shapeInfo:P}}),_=S.map(function(N){return N.shapeInfo}),T={logicalShape:x.shape,texShape:x.texData.texShape,isUniform:!1,isPacked:x.texData.isPacked,flatOffset:null},B=lQ(S,T,R,w.packedInputs),L=b.createProgram(B),k=null,D=b.getUniformLocation(L,"NAN",!1);ae().getNumber("WEBGL_VERSION")===1&&(k=b.getUniformLocation(L,"INFINITY",!1));for(var F={},M=0;M<w.variableNames.length;M++){var I=w.variableNames[M];F[I]=b.getUniformLocation(L,I,!1),F["offset"+I]=b.getUniformLocation(L,"offset"+I,!1)}return{program:w,source:B,webGLProgram:L,uniformLocations:F,inShapeInfos:_,outShapeInfo:T,infLoc:k,nanLoc:D}}(s.gpgpu,n,f,p)}),v=this.activeTimers!=null;if(v&&(h=this.startTimer()),function(b,w,E,x,R){L_(w.inShapeInfos,E),L_([w.outShapeInfo],[x]);var S=x.texData.texture,_=x.texData.texShape;x.texData.isPacked?b.setOutputPackedMatrixTexture(S,_[0],_[1]):b.setOutputMatrixTexture(S,_[0],_[1]),b.setProgram(w.webGLProgram),ae().getNumber("WEBGL_VERSION")===1&&w.infLoc!==null&&b.gl.uniform1f(w.infLoc,1/0),w.nanLoc!==null&&b.gl.uniform1f(w.nanLoc,NaN),E.forEach(function(T,B){var L=w.program.variableNames[B],k=w.uniformLocations[L],D=w.uniformLocations["offset"+L];if(k!=null)if(T.isUniform)if(Re(T.shape)<2)b.gl.uniform1f(k,T.uniformValues[0]);else{var F=T.uniformValues;F instanceof Float32Array||(F=new Float32Array(F)),b.gl.uniform1fv(k,F)}else T.texData.slice!=null&&D!=null&&b.gl.uniform1i(D,T.texData.slice.flatOffset),b.setInputMatrixTexture(T.texData.texture,k,B)}),R!=null&&R(b,w.webGLProgram),b.executeProgram()}(this.gpgpu,g,f,p,o),d.forEach(function(b){return s.disposeData(b.dataId)}),v&&(h=this.endTimer(h),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(h)})),!ae().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&a===!1){var y=this.unpackTensor(u);return this.disposeData(u.dataId),y}return u},t.prototype.compileAndRun=function(n,r,i,o,a){a===void 0&&(a=!1),i=i||r[0].dtype;var s=this.runWebGLProgram(n,r,i,o,a);return X.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},t.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(ae().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Se(function(){if(!ae().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=ae().getBool("DEBUG");ae().set("DEBUG",!1);var i=n.abs(ye(1e-8)).dataSync()[0];if(ae().set("DEBUG",r),i>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var r,i=this.texData.get(n),o=i.shape,a=i.dtype,s=i.values,u=i.texture,c=i.usage,l=i.isPacked;if(u==null){var d,f=this.activeTimers!=null;f&&(d=Gi());var h=i.texShape;if(h==null&&(h=aY(o,l),i.texShape=h),s!=null){var p=V0(o),m=void 0,g=h[1],v=h[0],y=s instanceof Uint8Array;l?(g=(r=of(h[0],h[1]))[0],v=r[1],m=new UQ(p,[v,g],y)):m=new WQ(p,[v,g],y);var b=this.makeTensorInfo([v,g],a);this.texData.get(b.dataId).usage=y?jr.PIXELS:jr.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),g,v,s);var w=this.runWebGLProgram(m,[b],a,null,!0),E=this.texData.get(w.dataId);i.texture=E.texture,i.texShape=E.texShape,i.isPacked=E.isPacked,i.usage=E.usage,this.disposeData(b.dataId),this.texData.delete(w.dataId),i.values=null,f&&(this.uploadWaitMs+=Gi()-d)}else{var x=this.acquireTexture(h,c,a,l);i.texture=x}}},t.prototype.convertAndCacheOnCPU=function(n,r){var i=this.texData.get(n),o=i.dtype;return this.releaseGPUData(n),r!=null&&(i.values=function(a,s){if(s==="float32"||s==="complex64")return a;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(a.length):new Uint8Array(a.length),c=0;c<u.length;++c)u[c]=Math.round(a[c]);return u}throw new Error("Unknown dtype "+s)}(r,o)),i.values},t.prototype.acquireTexture=function(n,r,i,o){if(this.numBytesInGPU+=this.computeBytes(n,i),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,o)},t.prototype.computeBytes=function(n,r){return n[0]*n[1]*ON(r)},t}(ZN);FN()&&X.registerBackend("webgl",function(){return new eZ},2);var tZ=z({square_:function(e){var t=$(e,"x","square"),n=[t];return X.runKernelFunc(function(r,i){return i([t]),r.square(t)},{x:t},null,"Square",{},n,[])}}),wd="SquaredDifference",yD=z({squaredDifference_:function(e,t){var n,r=$(e,"a","squaredDifference"),i=$(t,"b","squaredDifference");n=$t(r,i),r=n[0],i=n[1],et(r.shape,i.shape);var o={a:r,b:i},a=[r,i];return X.runKernelFunc(function(s,u){var c=s.squaredDifference(r,i);return u([r,i]),c},o,function(s,u){var c=u[0],l=u[1],d=ye(2);return{a:function(){return s.mul(c.sub(l).mul(d))},b:function(){return s.mul(l.sub(c).mul(d))}}},wd,{},a,[])}}),nZ=z({abs_:function(e){var t=$(e,"x","abs");return t.dtype==="complex64"?X.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):X.runKernelFunc(function(n,r){var i=n.abs(t);return r([t]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mul(i.toFloat().step(-1))}}},"Abs")}}),rZ=z({acos_:function(e){var t=$(e,"x","acos");return X.runKernelFunc(function(n,r){var i=n.acos(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(ye(1).sub(i.toFloat().square()).sqrt()).neg()}}})}}),iZ=z({acosh_:function(e){var t=$(e,"x","acosh");return X.runKernelFunc(function(n,r){var i=n.acosh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(i.toFloat().square().sub(1).sqrt())}}})}}),oZ=z({asin_:function(e){var t=$(e,"x","asin");return X.runKernelFunc(function(n,r){var i=n.asin(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(ye(1).sub(i.toFloat().square()).sqrt())}}})}}),aZ=z({asinh_:function(e){var t=$(e,"x","asinh");return X.runKernelFunc(function(n,r){var i=n.asinh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(ye(1).add(i.toFloat().square()).sqrt())}}})}}),sZ=z({atan_:function(e){var t=$(e,"x","atan");return X.runKernelFunc(function(n,r){var i=n.atan(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.toFloat().square().add(1))}}})}}),uZ=z({atanh_:function(e){var t=$(e,"x","atanh");return X.runKernelFunc(function(n,r){var i=n.atanh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(ye(1).sub(i.toFloat().square()))}}})}}),cZ=z({ceil_:function(e){var t=$(e,"x","ceil");return X.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return rt(n)}}})}}),yx=z({clipByValue_:function(e,t,n){var r=$(e,"x","clipByValue");W(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var i=[r],o={min:t,max:n};return X.runKernelFunc(function(a,s){var u=a.clip(r,t,n);return s([r]),u},{x:r},function(a,s){var u=s[0];return{x:function(){return a.where(u.greaterEqual(t).logicalAnd(u.lessEqual(n)),rt(a))}}},"ClipByValue",o,i)}}),lZ=z({cos_:function(e){var t=$(e,"x","cos"),n=[t];return X.runKernelFunc(function(r,i){var o=r.cos(t);return i([t]),o},{x:t},function(r,i){var o=i[0];return{x:function(){return o.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),dZ=z({cosh_:function(e){var t=$(e,"x","cosh");return X.runKernelFunc(function(n,r){var i=n.cosh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return i.toFloat().sinh().mulStrict(n)}}})}}),fZ=z({erf_:function(e){var t=$(e,"x","erf");return W(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),X.runKernelFunc(function(n,r){var i=n.erf(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),ab=z({exp_:function(e){var t=$(e,"x","exp");return X.runKernelFunc(function(n,r){var i=n.exp(t);return r([i]),i},{x:t},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),hZ=z({expm1_:function(e){var t=$(e,"x","expm1");return X.runKernelFunc(function(n,r){var i=n.expm1(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.exp())}}})}}),pZ=z({floor_:function(e){var t=$(e,"x","floor");return X.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return rt(n)}}})}}),vZ=z({log_:function(e){var t=$(e,"x","log"),n=[t];return X.runKernelFunc(function(r,i){var o=r.log(t);return i([t]),o},{x:t},function(r,i){var o=i[0];return{x:function(){return r.div(o.toFloat())}}},"Log",{},n)}}),mZ=z({log1p_:function(e){var t=$(e,"x","log1p");return X.runKernelFunc(function(n,r){var i=n.log1p(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.add(1))}}})}}),gZ=z({logSigmoid_:function(e){var t=$(e,"x","logSigmoid");return X.runKernelFunc(function(n,r){var i=n.softplus(t.neg()).neg();return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.neg().sigmoid())}}})}}),lv=z({neg_:function(e){var t=$(e,"x","neg"),n=[t];return X.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),yZ=z({reciprocal_:function(e){var t=$(e,"x","reciprocal");return X.runKernelFunc(function(n,r){var i=n.reciprocal(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.square().neg())}}})}}),bZ=z({round_:function(e){var t=$(e,"x","round");return X.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return rt(n)}}})}}),bD=z({rsqrt_:function(e){var t=$(e,"x","rsqrt"),n=[t];return X.runKernelFunc(function(r,i){var o=r.rsqrt(t);return i([t]),o},{x:t},function(r,i){var o=i[0];return{x:function(){return r.div(o.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),wD=z({sigmoid_:function(e){var t=$(e,"x","sigmoid");return X.runKernelFunc(function(n,r){var i=n.sigmoid(t);return r([i]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mul(i.mul(ye(1).sub(i)))}}},"Sigmoid")}}),wZ=z({sign_:function(e){var t=$(e,"x","sign");return X.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return rt(n)}}})}}),xZ=z({isNaN_:function(e){var t=$(e,"x","isNaN");return X.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return rt(n)}}})}}),EZ=z({isInf_:function(e){var t=$(e,"x","isInf");return X.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return rt(n)}}})}}),SZ=z({isFinite_:function(e){var t=$(e,"x","isFinite");return X.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return rt(n)}}})}}),CZ=z({sin_:function(e){var t=$(e,"x","sin"),n=[t];return X.runKernelFunc(function(r,i){var o=r.sin(t);return i([t]),o},{x:t},function(r,i){var o=i[0];return{x:function(){return o.toFloat().cos().mul(r)}}},"Sin",{},n)}}),_Z=z({sinh_:function(e){var t=$(e,"x","sinh");return X.runKernelFunc(function(n,r){var i=n.sinh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return i.toFloat().cosh().mulStrict(n)}}})}}),kZ=z({softplus_:function(e){var t=$(e,"x","softplus");return X.runKernelFunc(function(n,r){var i=n.softplus(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.sigmoid())}}})}}),RZ=z({sqrt_:function(e){var t=$(e,"x","sqrt");return X.runKernelFunc(function(n,r){var i=n.sqrt(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.toFloat().sqrt().mul(2))}}})}}),IZ=z({step_:function(e,t){t===void 0&&(t=0);var n=$(e,"x","step");return X.runKernelFunc(function(r){return r.step(n,t)},{$x:n},function(r){return{$x:function(){return rt(r)}}})}}),TZ=z({tan_:function(e){var t=$(e,"x","tan");return X.runKernelFunc(function(n,r){var i=n.tan(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.cos().square())}}})}}),OZ=z({tanh_:function(e){var t=$(e,"x","tanh");return X.runKernelFunc(function(n,r){var i=n.tanh(t);return r([i]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return ye(1).sub(i.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function xD(e,t,n,r,i,o){var a,s,u=$(e,"x","batchNorm"),c=$(t,"mean","batchNorm"),l=$(n,"variance","batchNorm");return i!=null&&(a=$(i,"scale","batchNorm")),r!=null&&(s=$(r,"offset","batchNorm")),W(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),W(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."}),W(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."}),a!=null&&W(a.rank===2||a.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."}),s!=null&&W(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),sf(u,c,l,s,a,o)}function ED(e,t,n,r,i,o){var a,s,u=$(e,"x","batchNorm"),c=$(t,"mean","batchNorm"),l=$(n,"variance","batchNorm");return i!=null&&(a=$(i,"scale","batchNorm")),r!=null&&(s=$(r,"offset","batchNorm")),W(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),W(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."}),W(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."}),a!=null&&W(a.rank===3||a.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."}),s!=null&&W(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),sf(u,c,l,s,a,o)}function SD(e,t,n,r,i,o){var a,s,u=$(e,"x","batchNorm"),c=$(t,"mean","batchNorm"),l=$(n,"variance","batchNorm");return i!=null&&(a=$(i,"scale","batchNorm")),r!=null&&(s=$(r,"offset","batchNorm")),W(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),W(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."}),W(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."}),a!=null&&W(a.rank===4||a.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."}),s!=null&&W(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),sf(u,c,l,s,a,o)}function sf(e,t,n,r,i,o){o==null&&(o=.001);var a,s,u,c=$(e,"x","batchNorm"),l=$(t,"mean","batchNorm"),d=$(n,"variance","batchNorm");i!=null&&(a=$(i,"scale","batchNorm")),r!=null&&(s=$(r,"offset","batchNorm")),W(l.rank===d.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),W(s==null||l.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),W(a==null||l.rank===a.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=c.rank===0||c.rank===1?c.as4D(1,1,1,c.size):c.rank===2?c.as4D(1,1,c.shape[0],c.shape[1]):c.rank===3?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c;var f=[c,l,d,a];return X.runKernelFunc(function(h,p){var m=h.batchNormalization(u,hh(l),hh(d),o,hh(a),hh(s));return p([c,l,d,a]),m},{x:c,mean:l,variance:d,scale:a,offset:s},function(h,p){var m=p,g=m[0],v=m[1],y=m[2],b=m[3],w=b??ye(1),E=un(v.shape,u.shape),x=[];if(v.rank===1){for(var R=0;R<u.shape.length-1;++R)x.push(u.shape[R]);x.push(1)}var S=g.sub(v),_=h.mul(w),T=bD(y.add(ye(o))),B=T.mul(T).mul(T).mul(ye(-.5));return{x:function(){return v.rank===1?h.mul(Uu(T.as4D(1,1,1,v.shape[0]),x)).mul(w).reshape(g.shape):h.mul(T).mul(w).reshape(g.shape)},mean:function(){var L=T.mul(ye(-1)).mul(_);return v.rank===1&&(L=L.sum(E)),L.reshape(v.shape)},variance:function(){var L=B.mul(S).mul(_);return v.rank===1&&(L=L.sum(E)),L.reshape(v.shape)},scale:function(){var L=S.mul(T),k=h.mul(L);return v.rank===1&&(k=k.sum(E)),k.reshape(v.shape)},offset:function(){var L=h;return v.rank===1&&(L=L.sum(E)),L.reshape(v.shape)}}},"BatchNormalization",{varianceEpsilon:o},f).reshape(c.shape)}function hh(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function Fm(){BN("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var PZ=z({batchNormalization2d_:function(e,t,n,r,i,o){return r===void 0&&(r=.001),Fm(),xD(e,t,n,o,i,r)}}),NZ=z({batchNormalization3d_:function(e,t,n,r,i,o){return r===void 0&&(r=.001),Fm(),ED(e,t,n,o,i,r)}}),DZ=z({batchNormalization4d_:function(e,t,n,r,i,o){return r===void 0&&(r=.001),Fm(),SD(e,t,n,o,i,r)}}),AZ=z({batchNormalization_:function(e,t,n,r,i,o){return r===void 0&&(r=.001),Fm(),sf(e,t,n,o,i,r)}}),CD=z({batchNorm_:sf}),MZ=z({batchNorm2d_:xD}),LZ=z({batchNorm3d_:ED}),FZ=z({batchNorm4d_:SD}),Bm=z({logicalAnd_:function(e,t){var n=$(e,"a","logicalAnd","bool"),r=$(t,"b","logicalAnd","bool");return et(n.shape,r.shape),X.runKernelFunc(function(i){return i.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),BZ=z({logicalNot_:function(e){var t=$(e,"x","logicalNot","bool");return X.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),_D=z({logicalOr_:function(e,t){var n=$(e,"a","logicalOr","bool"),r=$(t,"b","logicalOr","bool");return et(n.shape,r.shape),X.runKernelFunc(function(i){return i.logicalOr(n,r)},{$a:n,$b:r})}}),jZ=z({logicalXor_:function(e,t){var n=$(e,"a","logicalXor","bool"),r=$(t,"b","logicalXor","bool");return et(n.shape,r.shape),_D(e,t).logicalAnd(Bm(e,t).logicalNot())}}),Ds=z({where_:function(e,t,n){var r=$(t,"a","where"),i=$(n,"b","where"),o=$(e,"condition","where","bool");return dt(r.shape,i.shape,"Error in where: "),o.rank===1?W(o.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):dt(o.shape,i.shape,"Error in where: "),X.runKernelFunc(function(a,s){var u=a.select(o,r,i);return s([o]),u},{$condition:o,$a:r,$b:i},function(a,s){var u=s[0];return{$condition:function(){return rt(u).toFloat()},$a:function(){return a.mul(u.cast(a.dtype))},$b:function(){return a.mul(u.logicalNot().cast(a.dtype))}}})}}),kD=function(e){return _e(this,void 0,void 0,function(){var t,n,r;return ke(this,function(i){switch(i.label){case 0:return[4,(t=$(e,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=px(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},Ke=z({add_:function(e,t){var n,r=$(e,"a","add"),i=$(t,"b","add");n=$t(r,i),r=n[0],i=n[1];var o=et(r.shape,i.shape);return X.runKernelFunc(function(a){return a.add(r,i)},{a:r,b:i},function(a){return{a:function(){var s=a,u=un(r.shape,o);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=un(i.shape,o);return u.length>0&&(s=s.sum(u)),s.reshape(i.shape)}}},"Add")}}),$Z=z({addN_:function(e){W(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),W(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(i,o){return $(i,"tensors"+o,"addN")}),n=t[0];t.forEach(function(i){if(i.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(i){if(!bn(i.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return X.runKernelFunc(function(i){return i.addN(t)},r,function(i){var o={};return t.forEach(function(a,s){o[s]=function(){return i.clone()}}),o},"AddN")}}),VZ=z({addStrict_:function(e,t){var n=$(e,"a","addStrict"),r=$(t,"b","addStrict");return dt(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),WZ=z({atan2_:function(e,t){var n,r=$(e,"a","atan2"),i=$(t,"b","atan2");n=$t(r,i),r=n[0],i=n[1];var o=et(r.shape,i.shape);return X.runKernelFunc(function(a,s){var u=a.atan2(r,i);return s([r,i]),u},{$a:r,$b:i},function(a,s){var u=s[0],c=s[1];return{$a:function(){var l=Ke(u.square(),c.square()),d=a.mul(c.div(l)),f=un(u.shape,o);return f.length>0&&(d=d.sum(f)),d.reshape(u.shape)},$b:function(){var l=Ke(u.square(),c.square()),d=lv(a.mul(u.div(l))),f=un(c.shape,o);return f.length>0&&(d=d.sum(f)),d.reshape(c.shape)}}})}}),wi=z({div_:function(e,t){var n,r=$(e,"a","div"),i=$(t,"b","div");if(n=$t(r,i),r=n[0],i=n[1],r.dtype==="int32"&&i.dtype==="int32")return RD(r,i);var o=et(r.shape,i.shape);return X.runKernelFunc(function(a,s){var u=a.realDivide(r,i);return s([r,i]),u},{a:r,b:i},function(a,s){var u=s[0],c=s[1];return{a:function(){var l=a.div(c.toFloat()),d=un(u.shape,o);return d.length>0?l.sum(d).reshape(u.shape):l},b:function(){var l=a.mul(u.toFloat()),d=un(c.shape,o);d.length>0&&(l=l.sum(d).reshape(c.shape));var f=c.square();return l.div(f.toFloat()).neg()}}},"Div")}}),UZ=z({divNoNan_:function(e,t){var n,r=$(e,"a","div"),i=$(t,"b","div");r=(n=$t(r,i))[0],i=n[1];var o=wi(r,i),a=rt(o),s=i.equal(a);return Ds(s,a,o)}}),zZ=z({divStrict_:function(e,t){var n=$(e,"a","div"),r=$(t,"b","div");return dt(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),RD=z({floorDiv_:function(e,t){var n,r=$(e,"a","floorDiv"),i=$(t,"b","floorDiv");n=$t(r,i),r=n[0],i=n[1];var o=et(r.shape,i.shape);return X.runKernelFunc(function(a,s){var u=a.floorDiv(r,i);return s([r,i]),u},{a:r,b:i},function(a,s){var u=s[0],c=s[1];return{a:function(){var l=a.div(c.toFloat()),d=un(u.shape,o);return d.length>0?l.sum(d).reshape(u.shape):l},b:function(){var l=a.mul(u.toFloat()),d=un(c.shape,o);d.length>0&&(l=l.sum(d).reshape(c.shape));var f=c.square();return l.div(f.toFloat()).neg()}}},"FloorDiv")}}),bx=z({maximum_:function(e,t){var n,r=$(e,"a","maximum"),i=$(t,"b","maximum");return n=$t(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),et(r.shape,i.shape),X.runKernelFunc(function(o,a){var s=o.maximum(r,i);return a([r,i]),s},{a:r,b:i},function(o,a){var s=a[0],u=a[1];return{a:function(){return o.mul(s.greaterEqual(u).toFloat())},b:function(){return o.mul(s.less(u).toFloat())}}},"Maximum")}}),HZ=z({maximumStrict_:function(e,t){var n=$(e,"a","maximumStrict"),r=$(t,"b","maximumStrict");return dt(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),ID=z({minimum_:function(e,t){var n,r=$(e,"a","minimum"),i=$(t,"b","minimum");return n=$t(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),et(r.shape,i.shape),X.runKernelFunc(function(o,a){var s=o.minimum(r,i);return a([r,i]),s},{a:r,b:i},function(o,a){var s=a[0],u=a[1];return{a:function(){return o.mul(s.lessEqual(u).toFloat())},b:function(){return o.mul(s.greater(u).toFloat())}}},"Minimum")}}),GZ=z({minimumStrict_:function(e,t){var n=$(e,"a","minimumStrict"),r=$(t,"b","minimumStrict");return dt(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),qZ=z({mod_:function(e,t){var n,r=$(e,"a","mod"),i=$(t,"b","mod");n=$t(r,i),r=n[0],i=n[1];var o=et(r.shape,i.shape);return X.runKernelFunc(function(a,s){var u=a.mod(r,i);return s([r,i]),u},{$a:r,$b:i},function(a,s){var u=s[0],c=s[1];return{$a:function(){var l=un(u.shape,o);return l.length>0?a.sum(l).reshape(u.shape):a},$b:function(){var l=a.mul(u.div(c).floor().neg()),d=un(c.shape,o);return d.length>0?l.sum(d).reshape(c.shape):l}}})}}),XZ=z({modStrict_:function(e,t){var n=$(e,"a","modStrict"),r=$(t,"b","modStrict");return dt(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),Yn=z({mul_:function(e,t){var n,r=$(e,"a","mul"),i=$(t,"b","mul");n=$t(r,i),r=n[0],i=n[1];var o=et(r.shape,i.shape);return X.runKernelFunc(function(a,s){var u=a.multiply(r,i);return s([r,i]),u},{a:r,b:i},function(a,s){var u=s[0],c=s[1];return{a:function(){var l=a.mul(c.toFloat()),d=un(u.shape,o);return d.length>0?l.sum(d).reshape(u.shape):l},b:function(){var l=a.mul(u.toFloat()),d=un(c.shape,o);return d.length>0?l.sum(d).reshape(c.shape):l}}},"Mul")}}),KZ=z({mulStrict_:function(e,t){var n=$(e,"a","mul"),r=$(t,"b","mul");return dt(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),dv=z({pow_:function(e,t){var n,r=$(e,"base","pow"),i=$(t,"exp","pow");n=$t(r,i),r=n[0],i=n[1];var o=et(r.shape,i.shape),a=[r,i];return X.runKernelFunc(function(s,u){var c=s.pow(r,i);return u([r,i,c]),c},{a:r,b:i},function(s,u){var c=u[0],l=u[1],d=u[2];return{a:function(){var f=l.toFloat(),h=s.mul(f.mul(c.pow(f.sub(ye(1))))),p=un(c.shape,o);return p.length>0&&(h=h.sum(p)),h.reshape(c.shape)},b:function(){var f=c.greater(0),h=c.log().where(f,rt(c)),p=s.mul(d.mul(h)),m=un(l.shape,o);return m.length>0&&(p=p.sum(m)),p.reshape(l.shape)}}},"Pow",{},a,[!0])}}),YZ=z({powStrict_:function(e,t){return dt(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),QZ=z({squaredDifferenceStrict_:function(e,t){var n=$(e,"a","squaredDifferenceStrict"),r=$(t,"b","squaredDifferenceStrict");return dt(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),cn=z({sub_:function(e,t){var n,r=$(e,"a","sub"),i=$(t,"b","sub");n=$t(r,i),r=n[0],i=n[1];var o=et(r.shape,i.shape);return X.runKernelFunc(function(a){return a.subtract(r,i)},{a:r,b:i},function(a){return{a:function(){var s=a,u=un(r.shape,o);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=un(i.shape,o);return u.length>0&&(s=s.sum(u)),s.neg().reshape(i.shape)}}},"Sub")}}),JZ=z({subStrict_:function(e,t){var n=$(e,"a","subStrict"),r=$(t,"b","subStrict");return dt(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),TD=z({equal_:function(e,t){var n,r=$(e,"a","equal"),i=$(t,"b","equal");return n=$t(r,i),r=n[0],i=n[1],et(r.shape,i.shape),X.runKernelFunc(function(o){return o.equal(r,i)},{$a:r,$b:i})}}),ZZ=z({equalStrict_:function(e,t){var n=$(e,"a","equalStrict"),r=$(t,"b","equalStrict");return dt(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),eee=z({greater_:function(e,t){var n,r=$(e,"a","greater"),i=$(t,"b","greater");return n=$t(r,i),r=n[0],i=n[1],et(r.shape,i.shape),X.runKernelFunc(function(o){return o.greater(r,i)},{a:r,b:i},null,"Greater")}}),OD=z({greaterEqual_:function(e,t){var n,r=$(e,"a","greaterEqual"),i=$(t,"b","greaterEqual");return n=$t(r,i),r=n[0],i=n[1],et(r.shape,i.shape),X.runKernelFunc(function(o,a){var s=o.greaterEqual(r,i);return a([r,i]),s},{a:r,b:i},function(o,a){var s=a[0],u=a[1];return{a:function(){return rt(s)},b:function(){return rt(u)}}},"GreaterEqual")}}),tee=z({greaterEqualStrict_:function(e,t){var n=$(e,"a","greaterEqualStrict"),r=$(t,"b","greaterEqualStrict");return dt(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),nee=z({greaterStrict_:function(e,t){var n=$(e,"a","greaterStrict"),r=$(t,"b","greaterStrict");return dt(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),ree=z({less_:function(e,t){var n,r=$(e,"a","less"),i=$(t,"b","less");return n=$t(r,i),r=n[0],i=n[1],et(r.shape,i.shape),X.runKernelFunc(function(o){return o.less(r,i)},{a:r,b:i},null,"Less")}}),iee=z({lessEqual_:function(e,t){var n,r=$(e,"a","lessEqual"),i=$(t,"b","lessEqual");return n=$t(r,i),r=n[0],i=n[1],et(r.shape,i.shape),X.runKernelFunc(function(o,a){var s=o.lessEqual(r,i);return a([r,i]),s},{a:r,b:i},null,"LessEqual")}}),oee=z({lessEqualStrict_:function(e,t){var n=$(e,"a","lessEqualStrict"),r=$(t,"b","lessEqualStrict");return dt(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),aee=z({lessStrict_:function(e,t){var n=$(e,"a","lessStrict"),r=$(t,"b","lessStrict");return dt(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),see=z({notEqual_:function(e,t){var n,r=$(e,"a","notEqual"),i=$(t,"b","notEqual");return n=$t(r,i),r=n[0],i=n[1],et(r.shape,i.shape),X.runKernelFunc(function(o){return o.notEqual(r,i)},{a:r,b:i},null,"NotEqual")}}),uee=z({notEqualStrict_:function(e,t){var n=$(e,"a","notEqualStrict"),r=$(t,"b","notEqualStrict");return dt(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function G_(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function q_(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var wx=z({gather_:function(e,t,n){n===void 0&&(n=0);var r=$(e,"x","gather"),i=$(t,"indices","gather","int32");n=dn(n,r.shape)[0];var o=function(a,s,u){for(var c=a.shape[u],l=[],d=1,f=1,h=0;h<u;h++)l.push(a.shape[h]),d*=a.shape[h];for(h=0;h<s.rank;h++)l.push(s.shape[h]);for(h=u+1;h<a.rank;h++)l.push(a.shape[h]),f*=a.shape[h];return{batchSize:d,sliceSize:f,dimSize:c,outputShape:l}}(r,i,n);return X.runKernelFunc(function(a,s){var u=a.gather(r,i.flatten(),n);return s([i]),u},{x:r,indices:i},function(a,s){var u=s[0];return{x:function(){var c=r.shape,l=u.size,d=c.slice(0,n),f=d.length,h=c.slice(n,c.length).slice(1),p=h.length,m=G_(0,f),g=G_(f+1,f+1+p),v=q_([d,[l],h]),y=a.reshape(v),b=u.reshape([l]),w=q_([[f],m,g]),E=y.transpose(w),x=PD(E,b,r.shape[n]),R=ax(w);return x=x.transpose(R)},indices:function(){return u}}},"Gather",{axis:n}).reshape(o.outputShape)}}),PD=z({unsortedSegmentSum_:function(e,t,n){var r=$(e,"x","unsortedSegmentSum"),i=$(t,"segmentIds","unsortedSegmentSum","int32");return W(Kt(n),function(){return"numSegments must be of dtype int"}),X.runKernelFunc(function(o,a){var s=o.unsortedSegmentSum(r,i,n);return a([i]),s},{$x:r},function(o,a){var s=a[0];return{$x:function(){return function(u,c){for(var l=bx(c,rt(c)),d=wx(u,l),f=OD(c,ye(0,"int32")),h=d.rank-f.rank,p=0;p<h;++p)f=Zr(f,p+1);f=Bm(f,Vc(d.shape,"bool"));var m=rt(d);return Ds(f,d,m)}(o,s)}}})}}),cee=function(e,t,n){return _e(this,void 0,void 0,function(){var r,i,o,a,s,u,c,l,d,f,h,p,m;return ke(this,function(g){switch(g.label){case 0:for(r=$(e,"tensor","boolMask"),i=$(t,"mask","boolMask","bool"),o=n??0,a=i.rank,s=r.shape,W(a>0,function(){return"mask cannot be scalar"}),dt(s.slice(o,o+a),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,c=o;c<o+a;c++)u*=s[c];return l=s.slice(0,o).concat([u],s.slice(o+a)),d=r.reshape(l),f=i.reshape([-1]),[4,kD(f)];case 1:return h=g.sent(),p=h.squeeze([1]),m=wx(d,p,o),e!==r&&r.dispose(),t!==i&&i.dispose(),p.dispose(),d.dispose(),f.dispose(),h.dispose(),[2,m]}})})};function ND(e,t,n,r,i,o,a){o===void 0&&(o="NHWC"),W(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,u=t,c=!1;t.rank===3&&(c=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),W(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),W(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),W(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var l=o==="NHWC"?s[3]:s[1],d=o==="NHWC"?u.shape[3]:u.shape[1];W(l===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[2]+"."}),W(d===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+n.shape[3]+"."}),a!=null&&W(Kt(i),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var f=dx(o),h=zs(s,n.shape,r,1,i,a,!1,f),p=X.runKernelFunc(function(m,g){var v=m.conv2dDerInput(u,n,h);return g([n,u]),v},{dy4D:u,filter:n},function(m,g){var v=g[0],y=g[1];return{dy4D:function(){return di(m,v,r,i,o,1,a)},filter:function(){return xx(m,y,v.shape,r,i,o,a)}}});return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function K0(e){var t=function(o){return typeof o=="number"?[o,o,o]:o.length===2?[o[0],o[1],1]:o}(e),n=t[0],r=t[1],i=t[2];return n===1&&r===1&&i===1}function DD(e,t,n,r,i){W(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var o=e,a=t,s=!1;t.rank===4&&(s=!0,a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),o=[1,e[0],e[1],e[2],e[3]]);var u=o[4],c=a.shape[4];W(o.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."}),W(a.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank}),W(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),W(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),W(c===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."});var l=uv(o,n.shape,r,1,i),d=X.runKernelFunc(function(f){return f.conv3dDerInput(a,n,l)},{dy5D:a});return s?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var lee=z({conv1d_:function(e,t,n,r,i,o,a){i===void 0&&(i="NWC"),o===void 0&&(o=1);var s=$(e,"x","conv1d"),u=$(t,"filter","conv1d"),c=s,l=!1;s.rank===2&&(l=!0,c=s.as3D(1,s.shape[0],s.shape[1])),W(c.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."}),W(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),a!=null&&W(Kt(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}),W(c.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),W(Tr(n,o),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+o+"'"}),W(i==="NWC",function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."});var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),h=di(f,d,[1,n],r,"NHWC",[1,o],a);return l?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),di=z({conv2d_:function(e,t,n,r,i,o,a){i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]);var s=$(e,"x","conv2d"),u=$(t,"filter","conv2d"),c=s,l=!1;s.rank===3&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),W(c.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."}),W(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),a!=null&&W(Kt(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=i==="NHWC"?c.shape[3]:c.shape[1];W(d===u.shape[2],function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."}),W(Tr(n,o),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"});var f=dx(i),h=zs(c.shape,u.shape,n,o,r,a,!1,f),p=[u,c],m=X.runKernelFunc(function(g,v){var y=g.conv2d(c,u,h);return v([u,c]),y},{x:c,filter:u},function(g,v){var y=v,b=y[0],w=y[1];return W(bc(o),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}),{x:function(){return AD(w.shape,g,b,n,r,i)},filter:function(){return xx(w,g,b.shape,n,r,i)}}},"Conv2D",h,p);return l?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),dee=z({conv3d_:function(e,t,n,r,i,o){i===void 0&&(i="NDHWC"),o===void 0&&(o=[1,1,1]);var a=$(e,"x","conv3d"),s=$(t,"filter","conv3d"),u=a,c=!1;a.rank===4&&(c=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),W(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),W(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),W(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),W(function(f,h){return K0(f)||K0(h)}(n,o),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),W(i==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."});var l=uv(u.shape,s.shape,n,o,r),d=X.runKernelFunc(function(f,h){var p=f.conv3d(u,s,l);return h([u,s]),p},{x:u,$filter:s},function(f,h){W(K0(o),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"});var p=h[0],m=h[1];return{x:function(){return DD(p.shape,f,m,n,r)},$filter:function(){return function(g,v,y,b,w){var E=g;g.rank===4&&(E=g.as5D(1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]));var x=v;x.rank===4&&(x=v.as5D(1,v.shape[0],v.shape[1],v.shape[2],v.shape[3])),W(E.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+E.shape+"."}),W(x.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+x.shape+"."}),W(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),W(E.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+E.shape[4]+") must match input depth in filter ("+y[3]+"."}),W(x.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+x.shape[4]+") must match output depth for filter ("+y[4]+")."});var R=uv(E.shape,y,b,1,w);return X.runKernelFunc(function(S){return S.conv3dDerFilter(E,x,R)},{x5D:E,dy5D:x})}(p,f,m.shape,n,r)}}});return c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),xx=z({conv2dDerFilter_:function(e,t,n,r,i,o,a){o===void 0&&(o="NHWC");var s=e;e.rank===3&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;u.rank===3&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),W(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),W(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),W(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var c=o==="NHWC"?s.shape[3]:s.shape[1],l=o==="NHWC"?u.shape[3]:u.shape[1];W(c===n[2],function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."}),W(l===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+l+") must match output depth for filter ("+n[3]+")."}),a!=null&&W(Kt(i),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var d=dx(o),f=zs(s.shape,n,r,1,i,a,!1,d);return X.runKernelFunc(function(h){return h.conv2dDerFilter(s,u,f)},{x4D:s,dy4D:u})}}),AD=z({conv2dDerInput_:ND}),jm=z({depthwiseConv2d_:function(e,t,n,r,i,o,a){o===void 0&&(o=[1,1]);var s=$(e,"x","depthwiseConv2d"),u=$(t,"filter","depthwiseConv2d"),c=s,l=!1;s.rank===3&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),W(c.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."}),W(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),W(c.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),o==null&&(o=[1,1]),W(Tr(n,o),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),a!=null&&W(Kt(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=zs(c.shape,u.shape,n,o,r,a,!0),f=[c,u],h=X.runKernelFunc(function(p,m){var g=p.depthwiseConv2D(c,u,d);return m([c,u]),g},{x:c,filter:u},function(p,m){W(bc(o),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"});var g=m[0],v=m[1];return{x:function(){return MD(g.shape,p,v,d)},filter:function(){return LD(g,p,v.shape,d)}}},"DepthwiseConv2dNative",d,f);return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),MD=z({depthwiseConv2dDerInput_:function(e,t,n,r){var i=t,o=!1;t.rank===3&&(o=!0,i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=X.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(i,n,r)},{dy4D:i});return o?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),LD=z({depthwiseConv2dDerFilter_:function(e,t,n,r){var i=e;e.rank===3&&(i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var o=t;return o.rank===3&&(o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),X.runKernelFunc(function(a){return a.depthwiseConv2DDerFilter(i,o,r)},{x4D:i,dy4D:o})}}),Ex=z({separableConv2d_:function(e,t,n,r,i,o,a){o===void 0&&(o=[1,1]),a===void 0&&(a="NHWC");var s=$(e,"x","separableConv2d"),u=$(t,"depthwiseFilter","separableConv2d"),c=$(n,"pointwiseFilter","separableConv2d"),l=s,d=!1;if(s.rank===3&&(d=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");W(l.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."}),W(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),W(c.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),W(c.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."}),W(c.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."});var f=u.shape[2],h=u.shape[3];W(c.shape[2]===f*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*h+", but got "+c.shape[2]+"."});var p=jm(l,u,r,i,a,o),m=di(p,c,1,"valid",a);return d?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),fee=z({conv2dTranspose_:function(e,t,n,r,i,o){return ND(n,$(e,"x","conv2dTranspose"),$(t,"filter","conv2dTranspose"),r,i,"NHWC",o)}}),hee=z({conv3dTranspose_:function(e,t,n,r,i){return DD(n,$(e,"x","conv3dTranspose"),$(t,"filter","conv3dTranspose"),r,i)}}),$m=z({matMul_:function(e,t,n,r){var i;n===void 0&&(n=!1),r===void 0&&(r=!1);var o=$(e,"a","matMul"),a=$(t,"b","matMul");i=$t(o,a),o=i[0],a=i[1];var s=n?o.shape[o.rank-2]:o.shape[o.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],c=n?o.shape[o.rank-1]:o.shape[o.rank-2],l=r?a.shape[a.rank-2]:a.shape[a.rank-1],d=o.shape.slice(0,-2),f=a.shape.slice(0,-2),h=Re(d),p=Re(f);W(o.rank>=2&&a.rank>=2&&o.rank===a.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+a.rank+"."}),W(bn(d,f),function(){return"Error in matMul: outer dimensions ("+d+") and ("+f+") of Tensors with shapes "+o.shape+" and "+a.shape+" must match."}),W(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+o.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var m=o.shape.slice(0,-2).concat([c,l]),g=n?o.as3D(h,s,c):o.as3D(h,c,s),v=r?a.as3D(p,l,u):a.as3D(p,u,l),y={transposeA:n,transposeB:r};return X.runKernelFunc(function(b,w){var E=b.batchMatMul(g,v,n,r);return w([g,v]),E},{a:g,b:v},function(b,w){var E=w,x=E[0],R=E[1];return n||r?!n&&r?{a:function(){return b.matMul(R,!1,!1)},b:function(){return b.matMul(x,!0,!1)}}:n&&!r?{a:function(){return R.matMul(b,!1,!0)},b:function(){return x.matMul(b,!1,!1)}}:{a:function(){return R.matMul(b,!0,!0)},b:function(){return b.matMul(x,!0,!0)}}:{a:function(){return b.matMul(R,!1,!0)},b:function(){return x.matMul(b,!0,!1)}}},"BatchMatMul",y).reshape(m)}}),pee=z({dot_:function(e,t){var n=$(e,"t1","dot"),r=$(t,"t2","dot");W(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var i=n.rank===1?n.size:n.shape[1],o=r.rank===1?r.size:r.shape[0];return W(i===o,function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+o+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),vee=z({outerProduct_:function(e,t){var n=$(e,"v1","outerProduct"),r=$(t,"v2","outerProduct");return W(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),uf=z({reverse_:function(e,t){var n=$(e,"x","reverse");if(n.rank===0)return n.clone();var r=dn(t,n.shape);return X.runKernelFunc(function(i){return i.reverse(n,r)},{$x:n},function(i){return{$x:function(){return i.reverse(r)}}}).reshapeAs(n)}}),mee=z({reverse1d_:function(e){var t=$(e,"x","reverse");return W(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),uf(t,0)}}),gee=z({reverse2d_:function(e,t){var n=$(e,"x","reverse");return W(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),uf(n,t)}}),yee=z({reverse3d_:function(e,t){var n=$(e,"x","reverse");return W(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),uf(n,t)}}),bee=z({reverse4d_:function(e,t){var n=$(e,"x","reverse");return W(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),uf(n,t)}});function FD(e,t,n,r,i,o){var a=$(e,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),W(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),W(Tr(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),o!=null&&W(Kt(i),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var c=bd(s.shape,t,n,r,i,o);if(c.filterWidth===1&&c.filterHeight===1&&bn(c.inShape,c.outShape))return a.clone();var l=[s],d=X.runKernelFunc(function(f,h){var p=f.maxPool(s,c);return h([s,p]),p},{x:s},function(f,h){var p=h[0],m=h[1];return{x:function(){return function(g,v,y,b,w,E,x,R){var S=$(g,"dy","maxPoolBackprop"),_=$(v,"input","maxPoolBackprop"),T=$(y,"output","maxPoolBackprop");W(_.rank===S.rank,function(){return"Rank of input ("+_.rank+") does not match rank of dy ("+S.rank+")"}),W(Tr(w,E),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+E+"'"}),W(S.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+S.rank+"."}),W(_.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+_.rank+"."});var B=bd(_.shape,b,w,E,x,R);return X.runKernelFunc(function(L){return L.maxPoolBackprop(S,_,T,B)},{$dy:S,$input:_})}(f,p,m,t,n,r,i)}}},"MaxPool",c,l);return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function BD(e,t,n,r,i,o){var a=$(e,"x","avgPool","float32");W(Tr(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),W(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),o!=null&&W(Kt(i),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var c=bd(s.shape,t,n,r,i,o);if(c.filterWidth===1&&c.filterHeight===1&&bn(c.inShape,c.outShape))return a.clone();var l=X.runKernelFunc(function(d){return d.avgPool(s,c)},{x:s},function(d){return{x:function(){return function(f,h,p,m,g,v){var y=$(f,"dy","avgPoolBackprop"),b=$(h,"input","avgPoolBackprop");W(b.rank===y.rank,function(){return"Rank of input ("+b.rank+") does not match rank of dy ("+y.rank+")"}),W(Tr(m,g),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+m+" and dilations '"+g+"'"});var w=b,E=y,x=!1;b.rank===3&&(x=!0,w=b.as4D(1,b.shape[0],b.shape[1],b.shape[2]),E=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),W(E.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+E.rank+"."}),W(w.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+w.rank+"."});var R=bd(w.shape,p,m,g,v),S=X.runKernelFunc(function(_){return _.avgPoolBackprop(E,w,R)},{dy4D:E,input4D:w});return x?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}(d,s,t,n,r,i)}}},"AvgPool",c);return l=l.cast(a.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var hn=z({maxPool_:function(e,t,n,r,i){return FD(e,t,n,1,r,i)}}),cf=z({avgPool_:function(e,t,n,r,i){return BD(e,t,n,1,r,i)}}),wee=z({pool_:function(e,t,n,r,i,o){i==null&&(i=[1,1]),o==null&&(o=1),r===0&&(r="valid");var a=$(e,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),W(Tr(o,i),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"});var c,l=bd(s.shape,t,o,i,r),d=[l.dilationHeight,l.dilationWidth];c=r==="same"?function(w,E){var x=w.map(function(_,T){return _+(_-1)*(E[T]-1)}).map(function(_){return _-1}),R=x.map(function(_){return Math.floor(_/2)}),S=x.map(function(_,T){return _-R[T]});return x.map(function(_,T){return[R[T],S[T]]})}([l.filterHeight,l.filterWidth],d):[[0,0],[0,0]];var f=d[0]===1&&d[1]===1,h=function(w,E,x){var R=x.map(function(D){return D[0]}),S=x.map(function(D){return D[1]}),_=w.concat(R,S),T=E.map(function(D,F){return(D-_[F]%D)%D}),B=S.map(function(D,F){return D+T[F]}),L=E.map(function(D,F){return[R[F],B[F]]}),k=E.map(function(D,F){return[0,T[F]]});return[L,k]}([l.inHeight,l.inWidth],d,c),p=h[0],m=h[1],g=f?r:"valid",v=f?s:zN(s,d,p),y=(n==="avg"?function(){return BD(v,t,o,1,g)}:function(){return FD(v,t,o,1,g)})(),b=f?y:VN(y,d,m);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),xee=z({maxPool3d_:function(e,t,n,r,i,o,a){o===void 0&&(o="NDHWC");var s=$(e,"x","maxPool3d"),u=s,c=!1;s.rank===4&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),W(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),W(o==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+o}),W(Tr(n,a),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),i!=null&&W(Kt(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var l=sv(u.shape,t,n,a,r,i,o),d=X.runKernelFunc(function(f,h){var p=f.maxPool3d(u,l);return h([u,p]),p},{x:u},function(f,h){var p=h[0],m=h[1];return{x:function(){return function(g,v,y,b,w,E,x,R){var S=$(g,"dy","maxPool3dBackprop"),_=$(v,"input","maxPool3dBackprop"),T=$(y,"output","maxPool3dBackprop"),B=S,L=_,k=T,D=!1;_.rank===4&&(D=!0,B=S.as5D(1,S.shape[0],S.shape[1],S.shape[2],S.shape[3]),L=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3]),k=T.as5D(1,T.shape[0],T.shape[1],T.shape[2],T.shape[3])),W(B.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+B.rank+"."}),W(L.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+L.rank+"."}),W(k.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+k.rank+"."}),E==null&&(E=[1,1,1]),W(Tr(w,E),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+E+"'"}),R!=null&&W(Kt(x),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+R+" but got pad "+x+"."});var F=sv(L.shape,b,w,E,x,R),M=X.runKernelFunc(function(I){return I.maxPool3dBackprop(B,L,k,F)},{dy5D:B,input5D:L});return D?M.as4D(M.shape[1],M.shape[2],M.shape[3],M.shape[4]):M}(f,p,m,t,n,a,r,i)}}});return c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Eee=z({avgPool3d_:function(e,t,n,r,i,o,a){o===void 0&&(o="NDHWC");var s=$(e,"x","avgPool3d","float32"),u=s,c=!1;s.rank===4&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),W(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),W(o==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+o}),W(Tr(n,a),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),i!=null&&W(Kt(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var l=sv(u.shape,t,n,a,r,i,o),d=X.runKernelFunc(function(f){return f.avgPool3d(u,l)},{x:u},function(f){return{x:function(){return function(h,p,m,g,v,y,b){var w=$(h,"dy","avgPool3dBackprop"),E=$(p,"input","avgPool3dBackprop"),x=w,R=E,S=!1;E.rank===4&&(S=!0,x=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]),R=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3])),W(x.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+x.rank+"."}),W(R.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+R.rank+"."}),v==null&&(v=[1,1,1]),W(Tr(g,v),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+v+"'"}),b!=null&&W(Kt(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+b+" but got pad "+y+"."});var _=sv(R.shape,m,g,v,y,b),T=X.runKernelFunc(function(B){return B.avgPool3dBackprop(x,R,_)},{dy5D:x,input5D:R});return S?T.as4D(T.shape[1],T.shape[2],T.shape[3],T.shape[4]):T}(f,u,t,n,a,r,i)}}});return d=d.cast(u.dtype),c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),oo=z({slice_:function(e,t,n){var r,i,o=$(e,"x","slice");if(o.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(o.rank-1).fill(0)):t.length<o.rank?t.concat(new Array(o.rank-t.length).fill(0)):t.slice()).forEach(function(u){W(u!==-1,function(){return"slice() does not support negative begin indexing."})}),i=(i=n==null?new Array(o.rank).fill(-1):typeof n=="number"?[n].concat(new Array(o.rank-1).fill(-1)):n.length<o.rank?n.concat(new Array(o.rank-n.length).fill(-1)):n).map(function(u,c){return u>=0?u:(W(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+c+"."}),o.shape[c]-r[c])}),YY(o,r,i);var a=o.shape,s={begin:r,size:i};return X.runKernelFunc(function(u){return u.slice(o,r,i)},{x:o},function(u){for(var c=[],l=0;l<u.rank;l++)c.push([r[l],a[l]-r[l]-i[l]]);return{x:function(){return u.pad(c)}}},"Slice",s)}}),See=z({slice1d_:function(e,t,n){var r=$(e,"x","slice1d");return W(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),oo(r,[t],[n])}}),Cee=z({slice2d_:function(e,t,n){var r=$(e,"x","slice2d");return W(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),oo(r,t,n)}}),jD=z({slice3d_:function(e,t,n){var r=$(e,"x","slice3d");return W(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),oo(r,t,n)}}),_ee=z({slice4d_:function(e,t,n){var r=$(e,"x","slice4d");return W(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),oo(r,t,n)}});function $D(e,t,n,r,i){return t.rank<n.rank&&(t=t.reshape(Ir(t.shape,r))),e.rank<n.rank&&(e=e.reshape(Ir(e.shape,r))),{x:function(){var o=e.mul(n.equal(t).cast(e.dtype));return i==null?o:o.transpose(i)}}}var kee=z({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=$(e,"x","all","bool"),i=dn(t,r.shape),o=i,a=co(o,r.rank);a!=null&&(r=r.transpose(a),o=lo(o.length,r.rank));var s=X.runKernelFunc(function(c){return c.all(r,o)},{$x:r});if(n){var u=Ir(s.shape,i);return s.reshape(u)}return s}}),Ree=z({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=$(e,"x","any","bool"),i=dn(t,r.shape),o=i,a=co(o,r.rank);a!=null&&(r=r.transpose(a),o=lo(o.length,r.rank));var s=X.runKernelFunc(function(c){return c.any(r,o)},{$x:r});if(n){var u=Ir(s.shape,i);return s.reshape(u)}return s}}),Iee=z({argMax_:function(e,t){t===void 0&&(t=0);var n=$(e,"x","argMax");t==null&&(t=0);var r=dn(t,n.shape),i=co(r,n.rank);i!=null&&(n=n.transpose(i),r=lo(r.length,n.rank));var o={axis:r[0]},a=[n];return X.runKernelFunc(function(s,u){var c=s.argMax(n,r[0]);return u([n]),c},{x:n},function(s,u){var c=u[0];return{x:function(){return rt(c)}}},"ArgMax",o,a)}}),Tee=z({argMin_:function(e,t){t===void 0&&(t=0);var n=$(e,"x","argMin");t==null&&(t=0);var r=dn(t,n.shape),i=co(r,n.rank);return i!=null&&(n=n.transpose(i),r=lo(r.length,n.rank)),X.runKernelFunc(function(o,a){var s=o.argMin(n,r[0]);return a([n]),s},{$x:n},function(o,a){var s=a[0];return{$x:function(){return rt(s)}}})}}),Oee=z({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=$(e,"x","logSumExp"),i=dn(t,r.shape),o=r.max(i,!0),a=r.sub(o).exp().sum(i).log(),s=o.reshape(a.shape).add(a);if(n){var u=Ir(s.shape,i);return s.reshape(u)}return s}}),Vm=z({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=$(e,"x","max"),i=r,o=dn(t,r.shape),a=o,s=co(a,r.rank);s!=null&&(r=r.transpose(s),a=lo(a.length,r.rank));var u=[r],c=X.runKernelFunc(function(d,f){var h=d.max(r,a);return f([i,h]),h},{x:r},function(d,f){return $D(d,f[1],f[0],o,s)},"Max",{axes:a},u,[!0]);if(n){var l=Ir(c.shape,o);c=c.reshape(l)}return c}}),Pee=z({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=$(e,"x","mean"),i=dn(t,r.shape),o=Re(Un(r.shape,i)[1]);return Lm(function(a){var s=ye(o);return{value:(s.dtype===a.dtype?a:a.cast(s.dtype)).div(s).sum(t,n),gradFunc:function(u){var c=a.shape.slice();return i.forEach(function(l){c[l]=1}),u.reshape(c).mul(Vc(a.shape,"float32")).div(o)}}})(r)}}),Nee=z({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=$(e,"x","min"),i=r,o=dn(t,r.shape),a=o,s=co(a,r.rank);s!=null&&(r=r.transpose(s),a=lo(a.length,r.rank));var u=[r],c=X.runKernelFunc(function(d,f){var h=d.min(r,a);return f([i,h]),h},{x:r},function(d,f){return $D(d,f[1],f[0],o,s)},"Min",{axes:a},u,[!0]);if(n){var l=Ir(c.shape,o);c=c.reshape(l)}return c}}),Dee=z({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=dn(t,(e=$(e,"x","moments")).shape),i=e.mean(r,n),o=i.shape;n||(o=Ir(i.shape,r));var a=e.toFloat().sub(i.reshape(o)).square();return{mean:i,variance:a.mean(r,n)}}}),VD=z({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=$(e,"x","sum");r.dtype==="bool"&&(r=r.toInt());var i=dn(t,r.shape);return Lm(function(o){var a=co(i,o.rank),s=i,u=o;a!=null&&(u=o.transpose(a),s=lo(s.length,o.rank));var c=function(h){var p=o.shape.slice();return i.forEach(function(m){p[m]=1}),h.reshape(p).mul(Vc(o.shape,"float32"))},l={axes:s},d=X.runKernelFunc(function(h){return h.sum(u,s)},{x:u},function(h){return{x:function(){return c(h)}}},"Sum",l);if(n){var f=Ir(d.shape,i);d=d.reshape(f)}return{value:d,gradFunc:c}})(r)}}),Aee=z({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=$(e,"x","prod");r.dtype==="bool"&&(r=r.toInt());var i=dn(t,r.shape),o=co(i,r.rank),a=i,s=r;o!=null&&(s=r.transpose(o),a=lo(a.length,r.rank));var u=X.runKernelFunc(function(l){return l.prod(s,a)},{permutedX:s});if(n){var c=Ir(u.shape,i);u=u.reshape(c)}return u}}),WD=z({elu_:function(e){var t=$(e,"x","elu");return X.runKernelFunc(function(n,r){var i=n.elu(t);return r([i]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return X.runKernelFunc(function(o){return o.eluDer(n,i)},{dy:n,y:i})}}})}}),Mee=z({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=$(e,"x","leakyRelu");return bx(ye(t).mul(n),n)}}),UD=z({prelu_:function(e,t){var n=$(e,"x","prelu"),r=$(t,"alpha","prelu");return X.runKernelFunc(function(i,o){var a=i.prelu(n,r);return o([n,r]),a},{x:n,alpha:r},function(i,o){var a=o[0],s=o[1],u=a.greater(0);return{x:function(){return Ds(u,i,i.mul(s))},alpha:function(){var c=Ds(u,rt(i),i.mul(a)),l=un(s.shape,i.shape);return l.length>0&&(c=c.sum(l)),c.reshape(s.shape)}}},"Prelu")}}),Ft=z({relu_:function(e){var t=$(e,"x","relu");return t.dtype==="bool"?t.toInt():X.runKernelFunc(function(n,r){var i=n.relu(t);return r([t]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mulStrict(i.step().toFloat())}}},"Relu")}}),zD=z({relu6_:function(e){var t=$(e,"x","relu6");return t.dtype==="bool"?t.toInt():X.runKernelFunc(function(n,r){var i=n.relu6(t);return r([t]),i},{x:t},function(n,r){var i=r[0],o=i.lessEqual(6).mul(i.step());return{x:function(){return n.mulStrict(o.toFloat())}}},"Relu6")}}),Lee=z({selu_:function(e){var t=$(e,"x","selu");return X.runKernelFunc(function(n,r){var i=n.selu(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){var o=i.greater(ye(0)),a=ye(mx),s=ye(gx),u=n.mul(s),c=n.mul(a).mul(i.toFloat().exp());return Ds(o,u,c)}}})}}),Pa=z({transpose_:function(e,t){var n=$(e,"x","transpose");if(t==null&&(t=n.shape.map(function(i,o){return o}).reverse()),W(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(i){W(i>=0&&i<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return X.runKernelFunc(function(i){return i.transpose(n,t)},{x:n},function(i){var o=ax(t);return{x:function(){return i.transpose(o)}}},"Transpose",r)}}),Fee=z({localResponseNormalization_:function(e,t,n,r,i){t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5);var o=$(e,"x","localResponseNormalization");W(o.rank===4||o.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+o.rank+"."}),W(Kt(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var a=o,s=!1;o.rank===3&&(s=!0,a=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var u=X.runKernelFunc(function(c,l){var d=c.localResponseNormalization4D(a,t,n,r,i);return l([a,d]),d},{x4D:a},function(c,l){var d=l[0],f=l[1];return{x4D:function(){return X.runKernelFunc(function(h){return h.LRNGrad(c,d,f,t,n,r,i)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),HD=z({norm_:function(e,t,n,r){t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var i=function s(u,c,l){if(l===void 0&&(l=null),u.rank===0)return u.abs();if(u.rank!==1&&l===null)return s(u.reshape([-1]),c,l);if(u.rank===1||typeof l=="number"||Array.isArray(l)&&l.length===1){if(c===1)return u.abs().sum(l);if(c===1/0)return u.abs().max(l);if(c===-1/0)return u.abs().min(l);if(c==="euclidean"||c===2)return u.abs().pow(ye(2,"int32")).sum(l).sqrt();throw new Error("Error in norm: invalid ord value: "+c)}if(Array.isArray(l)&&l.length===2){if(c===1)return u.abs().sum(l[0]).max(l[1]-1);if(c===1/0)return u.abs().sum(l[1]).max(l[0]);if(c===-1/0)return u.abs().sum(l[1]).min(l[0]);if(c==="fro"||c==="euclidean")return u.square().sum(l).sqrt();throw new Error("Error in norm: invalid ord value: "+c)}throw new Error("Error in norm: invalid axis: "+l)}(e=$(e,"x","norm"),t,n),o=i.shape;if(r){var a=dn(n,e.shape);o=Ir(i.shape,a)}return i.reshape(o)}}),Bee=z({basicLSTMCell_:function(e,t,n,r,i,o){var a=$(e,"forgetBias","basicLSTMCell"),s=$(t,"lstmKernel","basicLSTMCell"),u=$(n,"lstmBias","basicLSTMCell"),c=$(r,"data","basicLSTMCell"),l=$(i,"c","basicLSTMCell"),d=$(o,"h","basicLSTMCell"),f=c.concat(d,1).matMul(s).add(u),h=f.shape[0],p=f.shape[1]/4,m=[h,p],g=f.slice([0,0],m),v=f.slice([0,p],m),y=f.slice([0,2*p],m),b=f.slice([0,3*p],m),w=g.sigmoid().mulStrict(v.tanh()).addStrict(l.mulStrict(a.add(y).sigmoid())),E=w.tanh().mulStrict(b.sigmoid());return[w,E]}}),jee=z({multiRNNCell_:function(e,t,n,r){for(var i=$(t,"data","multiRNNCell"),o=tv(n,"c","multiRNNCell"),a=tv(r,"h","multiRNNCell"),s=i,u=[],c=0;c<e.length;c++){var l=e[c](s,o[c],a[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var d=[],f=[];for(c=0;c<u.length;c+=2)d.push(u[c]),f.push(u[c+1]);return[d,f]}}),$ee=z({movingAverage_:function(e,t,n,r,i){i===void 0&&(i=!0);var o=$(e,"v","movingAverage"),a=$(t,"x","movingAverage"),s=$(n,"decay","movingAverage");FK(o,a),W(bn(o.shape,a.shape),function(){return"Shape mismatch in v and x"});var u=ye(1),c=u.sub(s),l=a.sub(o).mul(c);if(i){W(r!=null,function(){return"When using zeroDebias: true, step is required."});var d=$(r,"step","movingAverage");l=l.div(u.sub(dv(s,d)))}return o.add(l)}}),Vee=z({stridedSlice_:function(e,t,n,r,i,o,a,s,u){if(i===void 0&&(i=0),o===void 0&&(o=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(t.length)),a!==0)throw new Error("ellipsis mask is not yet supported");var c=$(e,"x","stridedSlice"),l=k_(s),d=c.shape.slice();l.forEach(function(g){t[g]=0,n[g]=1,d.splice(g,0,1)}),c=c.reshape(d);for(var f=0;f<c.rank;f++)t[f]=QY(i,t,r,c.shape,f),n[f]=JY(o,n,r,c.shape,f),r[f]=r[f]||1;var h=k_(u);h.forEach(function(g){n[g]=t[g]+1,r[g]=1});var p=lx(t,n,r),m=p.filter(function(g,v){return h.indexOf(v)===-1});return r.every(function(g){return g===1})?oo(c,t,p).reshape(m):X.runKernelFunc(function(g){return g.stridedSlice(c,t,n,r)},{$x:c}).reshape(m)}}),Wee=z({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var r=$(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(t>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+t);var o=X.runKernelFunc(function(a){return a.topk(r,t,n)},{$x:r});return{values:o[0],indices:o[1]}}}),Uee=z({scatterND_:function(e,t,n){var r=$(e,"indices","scatterND","int32"),i=$(t,"updates","scatterND");return KY(i,r,n),X.runKernelFunc(function(o){return o.scatterND(r,i,n)},{indices:r,updates:i},null,"ScatterNd",{shape:n})}}),Sx=z({fft_:function(e){W(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return X.runKernelFunc(function(i){return i.fft(r)},{input:e}).reshape(e.shape)}}),fv=z({ifft_:function(e){W(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return X.runKernelFunc(function(i){return i.ifft(r)},{input:e}).reshape(e.shape)}}),Cx=z({rfft_:function(e,t){W(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],i=e.size/r;if(t!=null&&t<r){var o=e.shape.map(function(v){return 0}),a=e.shape.map(function(v){return v});a[e.shape.length-1]=t,n=e.slice(o,a),r=t}else if(t!=null&&t>r){var s=e.shape.map(function(v){return v});s[e.shape.length-1]=t-r,n=e.concat(Rt(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),c=In(n,u).as2D(i,r),l=Sx(c),d=Math.floor(r/2)+1,f=ei(l),h=Ki(l),p=f.split([d,r-d],f.shape.length-1),m=h.split([d,r-d],h.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=d,In(p[0],m[0]).reshape(g)}}),GD=z({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),i=fv(r);return ei(i)}var o=[n,2*(t-1)],a=ei(e).as2D(n,t),s=Ki(e).as2D(n,t),u=a.slice([0,1],[n,t-2]).reverse(1),c=s.slice([0,1],[n,t-2]).reverse(1).mul(ye(-1)),l=a.concat(u,1),d=s.concat(c,1);return r=In(l,d).as2D(o[0],o[1]),i=fv(r),ei(i)}}),zee=Object.freeze({fft:Sx,ifft:fv,rfft:Cx,irfft:GD}),Hee=z({sparseToDense_:function(e,t,n,r){r===void 0&&(r=0);var i=$(e,"sparseIndices","sparseToDense","int32"),o=$(t,"sparseValues","sparseToDense"),a=$(r,"defaultValue","sparseToDense",o.dtype);return function(s,u,c,l){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var d=s.rank>0?s.shape[0]:1,f=s.rank>1?s.shape[1]:1;if(c.length!==f)throw new Error("outputShape has incorrect number of elements:, "+c.length+", should be: "+f+".");var h=u.size;if(u.rank!==0&&(u.rank!==1||h!==d))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+d+"]");if(u.dtype!==l.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,o,n,a),X.runKernelFunc(function(s){return s.sparseToDense(i,o,n,a)},{$sparseIndices:i,$sparseValues:o,$defaultValue:a})}}),Gee=z({gatherND_:function(e,t){var n=$(t,"indices","gatherND","int32"),r=$(e,"x","gatherND");return X.runKernelFunc(function(i){return i.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),qee=z({diag_:function(e){var t=$(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return X.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(n)}}),Xee=z({dropout_:function(e,t,n,r){var i=$(e,"x","dropout");if(W(i.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."}),W(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof Lt?i.clone():i;var o=function(u,c){if(c==null)return u.shape.slice();if(bn(u.shape,c))return c;if(u.shape.length===c.length){for(var l=[],d=0;d<u.shape.length;d++)c[d]==null&&u.shape[d]!=null?l.push(u.shape[d]):l.push(c[d]);return l}return c}(i,n),a=1-t,s=UN(o,0,1,"float32",r).add(a).floor().div(a);return i.mul(s)}});function qD(e,t,n){for(var r=1-e%2,i=new Float32Array(e),o=0;o<e;++o){var a=2*Math.PI*o/(e+r-1);i[o]=t-n*Math.cos(a)}return tn(i,"float32")}var _x=z({hannWindow_:function(e){return qD(e,.5,.5)}}),XD=z({hammingWindow_:function(e){return qD(e,.54,.46)}}),kx=z({frame_:function(e,t,n,r,i){r===void 0&&(r=!1),i===void 0&&(i=0);for(var o=0,a=[];o+t<=e.size;)a.push(oo(e,o,t)),o+=n;if(r)for(;o<e.size;){var s=o+t-e.size,u=an([oo(e,o,t-s),ro([s],i)]);a.push(u),o+=n}return a.length===0?Ea([],[0,t]):an(a).as2D(a.length,t)}}),KD=z({stft_:function(e,t,n,r,i){var o;i===void 0&&(i=_x),r==null&&(o=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)))));for(var a=kx(e,t,n),s=Yn(a,i(t)),u=[],c=0;c<a.shape[0];c++)u.push(Cx(s.slice([c,0],[1,t]),r));return an(u)}}),Kee=Object.freeze({hannWindow:_x,hammingWindow:XD,frame:kx,stft:KD}),Xn,Yee=function(e,t,n){return n===void 0&&(n=1),_e(this,void 0,void 0,function(){var r,i,o,a,s,u,c,l,d,f,h,p,m,g;return ke(this,function(v){switch(v.label){case 0:return r=$(e,"predictions","inTopK"),i=$(t,"targets","inTopK"),W(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),W(r.rank-1===i.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank}),dt(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=r.shape[r.shape.length-1],W(n>0&&n<=o,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+o+"), but got "+n}),[4,r.data()];case 1:return a=v.sent(),[4,i.data()];case 2:for(s=v.sent(),u=[a.length/o,o],l=u[1],d=md("bool",c=u[0]),f=0;f<c;f++){for(h=f*l,p=a.subarray(h,h+l),m=[],g=0;g<p.length;g++)m.push({value:p[g],index:g});for(m.sort(function(y,b){return b.value-y.value}),d[f]=0,g=0;g<n;g++)if(m[g].index===s[f]){d[f]=1;break}}return e!==r&&r.dispose(),t!==i&&i.dispose(),[2,On(d,i.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Xn||(Xn={}));var Qee=z({absoluteDifference_:function(e,t,n,r){r===void 0&&(r=Xn.SUM_BY_NONZERO_WEIGHTS);var i=$(e,"labels","absoluteDifference"),o=$(t,"predictions","absoluteDifference"),a=null;n!=null&&(a=$(n,"weights","absoluteDifference")),dt(i.shape,o.shape,"Error in absoluteDifference: ");var s=i.sub(o).abs();return Fo(s,a,r)}}),Fo=z({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=Xn.SUM_BY_NONZERO_WEIGHTS);var r=$(e,"losses","computeWeightedLoss"),i=null;t!=null&&(i=$(t,"weights","computeWeightedLoss"));var o=i==null?r:r.mul(i);if(n===Xn.NONE)return o;if(n===Xn.SUM)return o.sum();if(n===Xn.MEAN){if(i==null)return o.mean();var a=r.size/i.size,s=o.sum().div(i.sum());return a>1?s.div(ye(a)):s}if(n===Xn.SUM_BY_NONZERO_WEIGHTS){if(i==null)return o.sum().div(ye(r.size));var u=i.mul(Vc(r.shape)).notEqual(ye(0)).sum().toFloat();return o.sum().div(u)}throw Error("Unknown reduction: "+n)}}),Jee=z({cosineDistance_:function(e,t,n,r,i){i===void 0&&(i=Xn.SUM_BY_NONZERO_WEIGHTS);var o=$(e,"labels","cosineDistance"),a=$(t,"predictions","cosineDistance"),s=null;r!=null&&(s=$(r,"weights","cosineDistance")),dt(o.shape,a.shape,"Error in cosineDistance: ");var u=ye(1).sub(o.mul(a).sum(n,!0));return Fo(u,s,i)}}),Zee=z({hingeLoss_:function(e,t,n,r){r===void 0&&(r=Xn.SUM_BY_NONZERO_WEIGHTS);var i=$(e,"labels","hingeLoss"),o=$(t,"predictions","hingeLoss"),a=null;n!=null&&(a=$(n,"weights","hingeLoss")),dt(i.shape,o.shape,"Error in hingeLoss: ");var s=ye(1);i=ye(2).mul(i).sub(s);var u=s.sub(i.mul(o)).relu();return Fo(u,a,r)}}),ete=z({huberLoss_:function(e,t,n,r,i){r===void 0&&(r=1),i===void 0&&(i=Xn.SUM_BY_NONZERO_WEIGHTS);var o=$(e,"labels","huberLoss"),a=$(t,"predictions","huberLoss"),s=null;n!=null&&(s=$(n,"weights","huberLoss")),dt(o.shape,a.shape,"Error in huberLoss: ");var u=ye(r),c=a.sub(o).abs(),l=ID(c,u),d=c.sub(l),f=ye(.5).mul(l.square()).add(u.mul(d));return Fo(f,s,i)}}),tte=z({logLoss_:function(e,t,n,r,i){r===void 0&&(r=1e-7),i===void 0&&(i=Xn.SUM_BY_NONZERO_WEIGHTS);var o=$(e,"labels","logLoss"),a=$(t,"predictions","logLoss"),s=null;n!=null&&(s=$(n,"weights","logLoss")),dt(o.shape,a.shape,"Error in logLoss: ");var u=ye(1),c=ye(r),l=o.mul(a.add(c).log()).neg().sub(u.sub(o).mul(u.sub(a).add(c).log()));return Fo(l,s,i)}}),nte=z({meanSquaredError_:function(e,t,n,r){r===void 0&&(r=Xn.SUM_BY_NONZERO_WEIGHTS);var i=$(e,"labels","meanSquaredError"),o=$(t,"predictions","meanSquaredError"),a=null;n!=null&&(a=$(n,"weights","meanSquaredError")),dt(i.shape,o.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(o);return Fo(s,a,r)}}),rte=z({sigmoidCrossEntropy_:function(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=Xn.SUM_BY_NONZERO_WEIGHTS);var o=$(e,"multiClassLabels","sigmoidCrossEntropy"),a=$(t,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=$(n,"weights","sigmoidCrossEntropy")),dt(o.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=ye(r),c=ye(1),l=ye(.5);o=o.mul(c.sub(u)).add(l.mul(u))}var d=function(f,h){var p=$(f,"labels","sigmoidCrossEntropyWithLogits"),m=$(h,"logits","sigmoidCrossEntropyWithLogits");dt(p.shape,m.shape,"Error in sigmoidCrossEntropyWithLogits: ");var g=m.relu(),v=m.mul(p),y=m.abs().neg().exp().log1p();return g.sub(v).add(y)}(o,a);return Fo(d,s,i)}}),ite=z({softmaxCrossEntropy_:function(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=Xn.SUM_BY_NONZERO_WEIGHTS);var o=$(e,"onehotLabels","softmaxCrossEntropy"),a=$(t,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=$(n,"weights","softmaxCrossEntropy")),dt(o.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=ye(r),c=ye(1),l=ye(o.shape[1]);o=o.mul(c.sub(u)).add(u.div(l))}var d=function(f,h,p){if(p===void 0&&(p=-1),p===-1&&(p=h.rank-1),p!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+p);return Lm(function(m,g,v){var y=g.logSumExp([p],!0),b=g.toFloat().sub(y);return v([m,b]),{value:b.mul(m).neg().sum([p]),gradFunc:function(w,E){var x=E[0],R=E[1],S=Ir(w.shape,[p]);return[w.reshape(S).mul(x.toFloat().sub(R.exp())),w.reshape(S).mul(R.exp().sub(x.toFloat()))]}}})(f,h)}(o,a);return Fo(d,s,i)}}),ote=Object.freeze({get Reduction(){return Xn},absoluteDifference:Qee,computeWeightedLoss:Fo,cosineDistance:Jee,hingeLoss:Zee,huberLoss:ete,logLoss:tte,meanSquaredError:nte,sigmoidCrossEntropy:rte,softmaxCrossEntropy:ite});function X_(e,t){return t===void 0&&(t=!1),X.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],i=WN(n),o=e.clone(),a=Ea([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,c=function(d){var f,h=o,p=s,m=i;f=X.tidy(function(){var g=o.slice([d,d],[n-d,1]),v=g.norm(),y=o.slice([d,d],[1,1]),b=Ea([[-1]]).where(y.greater(0),Ea([[1]])),w=y.sub(b.mul(v)),E=g.div(w);s=E.shape[0]===1?a.clone():a.concat(E.slice([1,0],[E.shape[0]-1,E.shape[1]]),0);var x=b.matMul(w).div(v).neg(),R=o.slice([d,0],[n-d,r]),S=x.mul(s);if(d===0)o=R.sub(S.matMul(s.transpose().matMul(R)));else{var _=R.sub(S.matMul(s.transpose().matMul(R)));o=o.slice([0,0],[d,r]).concat(_,0)}var T=i.slice([0,d],[n,i.shape[1]-d]);if(d===0)i=T.sub(T.matMul(s).matMul(S.transpose()));else{var B=T.sub(T.matMul(s).matMul(S.transpose()));i=i.slice([0,0],[n,d]).concat(B,1)}return[s,o,i]}),s=f[0],o=f[1],i=f[2],Rr([h,p,m])},l=0;l<u;++l)c(l);return!t&&n>r&&(i=i.slice([0,0],[n,r]),o=o.slice([0,0],[r,r])),[i,o]})}var ate=z({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=$(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var i=r.shape,o=r.shape.slice(-2),a=o[0],s=o[1];if(!(t<=a))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+a+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=a),n<0&&(n=s);var u=nv(0,a,1,"int32").reshape([-1,1]),c=nv(0,s,1,"int32"),l=cn(u,c),d=Bm(l.lessEqual(ye(+t,"int32")),l.greaterEqual(ye(-n,"int32"))),f=Rt([a,s],r.dtype);return zr(sn(r.reshape([-1,a,s])).map(function(h){return Ds(d,h,f)})).reshape(i)}}),ste=z({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,W(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(u){W(e[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[u].shape[0]+" vs. "+n+")"})},i=1;i<e.length;++i)r(i)}else t=!0,e=ux(e,e.shape[0],0).map(function(u){return HN(u,[0])});W(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var o=[],a=e,s=function(u){o.push(X.tidy(function(){var c=a[u];if(u>0)for(var l=0;l<u;++l){var d=VD(o[l].mulStrict(c)).mul(o[l]);c=c.sub(d)}return c.div(HD(c,"euclidean"))}))};for(i=0;i<e.length;++i)s(i);return t?zr(o,0):o}}),ute=z({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return X_(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(a,s){return a*s}),r=sn(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],o=[];return r.forEach(function(a){var s=X_(a,t),u=s[0],c=s[1];i.push(u),o.push(c)}),[zr(i,0).reshape(e.shape),zr(o,0).reshape(e.shape)]}}),cte=Object.freeze({bandPart:ate,gramSchmidt:ste,qr:ute});function Wm(e,t,n,r,i,o){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),o==null&&(o=0);var a=e.shape[0];return n=Math.min(n,a),W(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),W(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),W(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),W(t.rank===1,function(){return"scores must be a 1D tensor"}),W(t.shape[0]===a,function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+t.shape[0]}),W(0<=o&&o<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+o+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:o}}var lte=z({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var r=$(e,"images","resizeBilinear");W(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),W(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var i=r,o=!1;r.rank===3&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=X.runKernelFunc(function(c,l){return l([i]),c.resizeBilinear(i,a,s,n)},{x:i},function(c,l){return{x:function(){return X.runKernelFunc(function(d){return d.resizeBilinearBackprop(c,l[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:a,newWidth:s});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),dte=z({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var r=$(e,"images","resizeNearestNeighbor");W(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),W(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),W(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var i=r,o=!1;r.rank===3&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=X.runKernelFunc(function(c,l){return l([i]),c.resizeNearestNeighbor(i,a,s,n)},{batchImages:i},function(c,l){return{batchImages:function(){return X.runKernelFunc(function(d){return d.resizeNearestNeighborBackprop(c,l[0],n)},{})}}});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),fte=z({nonMaxSuppression_:function(e,t,n,r,i){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY);var o=$(e,"boxes","nonMaxSuppression"),a=$(t,"scores","nonMaxSuppression"),s=Wm(o,a,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return X.runKernelFunc(function(c){return c.nonMaxSuppression(o,a,n,r,i)},{boxes:o,scores:a},null,"NonMaxSuppressionV3",u)}}),hte=function(e,t,n,r,i){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),_e(this,void 0,void 0,function(){var o,a,s,u,c,l,d;return ke(this,function(f){switch(f.label){case 0:return o=$(e,"boxes","nonMaxSuppressionAsync"),a=$(t,"scores","nonMaxSuppressionAsync"),s=Wm(o,a,n,r,i),n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,Promise.all([o.data(),a.data()])];case 1:return u=f.sent(),c=u[0],l=u[1],d=fx(c,l,n,r,i),o!==e&&o.dispose(),a!==t&&a.dispose(),[2,d]}})})},pte=z({nonMaxSuppressionWithScore_:function(e,t,n,r,i,o){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),o===void 0&&(o=0);var a=$(e,"boxes","nonMaxSuppression"),s=$(t,"scores","nonMaxSuppression"),u=Wm(a,s,n,r,i,o),c={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:o=u.softNmsSigma},l=X.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},c);return{selectedIndices:l[0],selectedScores:l[1]}}}),vte=function(e,t,n,r,i,o){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),o===void 0&&(o=0),_e(this,void 0,void 0,function(){var a,s,u,c,l,d,f;return ke(this,function(h){switch(h.label){case 0:return a=$(e,"boxes","nonMaxSuppressionAsync"),s=$(t,"scores","nonMaxSuppressionAsync"),u=Wm(a,s,n,r,i,o),n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,o=u.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return c=h.sent(),l=c[0],d=c[1],f=hx(l,d,n,r,i,o),a!==e&&a.dispose(),s!==t&&s.dispose(),[2,f]}})})},mte=z({cropAndResize_:function(e,t,n,r,i,o){var a=$(e,"image","cropAndResize"),s=$(t,"boxes","cropAndResize","float32"),u=$(n,"boxInd","cropAndResize","int32");i=i||"bilinear",o=o||0;var c=s.shape[0];return W(a.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."}),W(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."}),W(u.rank===1&&u.shape[0]===c,function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."}),W(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),W(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),W(i==="bilinear"||i==="nearest",function(){return"method must be bilinear or nearest, but was "+i}),X.runKernelFunc(function(l,d){return l.cropAndResize(a,s,u,r,i,o)},{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:i,extrapolationValue:o,cropSize:r})}}),Rx=Object.freeze({resizeBilinear:lte,resizeNearestNeighbor:dte,nonMaxSuppression:fte,nonMaxSuppressionAsync:hte,nonMaxSuppressionWithScore:pte,nonMaxSuppressionWithScoreAsync:vte,cropAndResize:mte}),Ix=function(e,t){return!(e>0)||t==="linear"},Tx=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},Ox=function(e,t){var n=t,r=un(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},Px=function(e,t,n){if(t==="linear")return e;if(t==="relu")return Ft(e);if(t==="elu")return WD(e);if(t==="relu6")return zD(e);if(t==="prelu")return UD(e,n);throw new Error("Unknown fused activation "+t+".")},gte=z({fusedMatMul_:function(e){var t,n=e.a,r=e.b,i=e.transposeA,o=i!==void 0&&i,a=e.transposeB,s=a!==void 0&&a,u=e.bias,c=e.activation,l=c===void 0?"linear":c,d=e.preluActivationWeights;if(Ix(X.state.gradientDepth,l)===!1){var f=$m(n,r,o,s);return u!=null&&(f=Ke(f,u)),Px(f,l,d)}var h=$(n,"a","fused matMul"),p=$(r,"b","fused matMul");t=$t(h,p),h=t[0],p=t[1];var m=o?h.shape[h.rank-2]:h.shape[h.rank-1],g=s?p.shape[p.rank-1]:p.shape[p.rank-2],v=o?h.shape[h.rank-1]:h.shape[h.rank-2],y=s?p.shape[p.rank-2]:p.shape[p.rank-1],b=h.shape.slice(0,-2),w=p.shape.slice(0,-2),E=Re(b),x=Re(w);W(h.rank>=2&&p.rank>=2&&h.rank===p.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+p.rank+"."}),W(bn(b,w),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+w+") of Tensors with shapes "+h.shape+" and "+p.shape+" must match."}),W(m===g,function(){return"Error in fused matMul: inner shapes ("+m+") and ("+g+") of Tensors with shapes "+h.shape+" and "+p.shape+" and transposeA="+o+" and transposeB="+s+" must match."});var R,S,_=h.shape.slice(0,-2).concat([v,y]),T=o?h.as3D(E,m,v):h.as3D(E,v,m),B=s?p.as3D(x,y,g):p.as3D(x,g,y);u!=null&&et(_,(R=$t(R=$(u,"bias","fused matMul"),h)[0]).shape),d!=null&&(S=$(d,"prelu weights","fused matMul"));var L={a:T,b:B};u!=null&&(L.bias=R),d!=null&&(L.preluActivationWeights=S);var k=[T,B];return X.runKernelFunc(function(D,F){var M=D.fusedBatchMatMul({a:T,b:B,transposeA:o,transposeB:s,bias:R,activation:l,preluActivationWeights:S});return F([T,B,M]),M},L,function(D,F){var M=F[0],I=F[1],N=F[2],j=Tx(D,N,l),P={};return u!=null&&(P={bias:function(){return Ox(R,j)}}),Object.assign(o||s?!o&&s?{a:function(){return j.matMul(I,!1,!1)},b:function(){return j.matMul(M,!0,!1)}}:o&&!s?{a:function(){return I.matMul(j,!1,!0)},b:function(){return M.matMul(j,!1,!1)}}:{a:function(){return I.matMul(j,!0,!0)},b:function(){return j.matMul(M,!0,!0)}}:{a:function(){return j.matMul(I,!1,!0)},b:function(){return M.matMul(j,!0,!1)}},P)},"_FusedMatMul",{transposeA:o,transposeB:s,activation:l},k,[!0]).reshape(_)}}),yte=z({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,o=e.dataFormat,a=o===void 0?"NHWC":o,s=e.dilations,u=s===void 0?[1,1]:s,c=e.dimRoundingMode,l=e.bias,d=e.activation,f=d===void 0?"linear":d,h=e.preluActivationWeights;if(f=f||"linear",Ix(X.state.gradientDepth,f)===!1){var p=di(t,n,r,i,a,u,c);return l!=null&&(p=Ke(p,l)),Px(p,f,h)}var m=$(t,"x","conv2d"),g=$(n,"filter","conv2d"),v=m,y=!1;m.rank===3&&(y=!0,v=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),W(v.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+v.rank+"."}),W(g.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+g.rank+"."}),c!=null&&W(Kt(i),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+i+"."}),W(v.shape[3]===g.shape[2],function(){return"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+g.shape[2]+"."}),W(Tr(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),W(a==="NHWC",function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."});var b,w,E=zs(v.shape,g.shape,r,u,i,c);l!=null&&(b=$t(b=$(l,"bias","fused conv2d"),m)[0],et(E.outShape,b.shape)),h!=null&&(w=$(h,"prelu weights","fused conv2d"));var x={x:v,filter:g};l!=null&&(x.bias=b),h!=null&&(x.preluActivationWeights=w);var R=[g,v],S=X.runKernelFunc(function(_,T){var B=_.fusedConv2d({input:v,filter:g,convInfo:E,bias:b,activation:f,preluActivationWeights:w});return T([g,v,B]),B},x,function(_,T){var B=T,L=B[0],k=B[1],D=B[2],F=Tx(_,D,f);W(bc(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var M={};return l!=null&&(M={bias:function(){return Ox(b,F)}}),Object.assign({x:function(){return AD(k.shape,F,L,r,i)},filter:function(){return xx(k,F,L.shape,r,i)}},M)},"FusedConv2D",{convInfo:E,activation:f},R,[!0]);return y?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}}),bte=z({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,o=e.dataFormat,a=o===void 0?"NHWC":o,s=e.dilations,u=s===void 0?[1,1]:s,c=e.dimRoundingMode,l=e.bias,d=e.activation,f=d===void 0?"linear":d,h=e.preluActivationWeights;if(Ix(X.state.gradientDepth,f)===!1){var p=jm(t,n,r,i,a,u,c);return l!=null&&(p=Ke(p,l)),Px(p,f,h)}var m=$(t,"x","depthwiseConv2d"),g=$(n,"filter","depthwiseConv2d"),v=m,y=!1;m.rank===3&&(y=!0,v=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),W(v.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+v.rank+"."}),W(g.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."}),W(v.shape[3]===g.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+v.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."}),u==null&&(u=[1,1]),W(Tr(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),c!=null&&W(Kt(i),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+i+"."});var b,w,E=zs(v.shape,g.shape,r,u,i,c,!0);l!=null&&(b=$t(b=$(l,"bias","fused conv2d"),m)[0],et(E.outShape,b.shape)),h!=null&&(w=$(h,"prelu weights","fused depthwiseConv2d"));var x={x:v,filter:g};l!=null&&(x.bias=b),h!=null&&(x.preluActivationWeights=w);var R=[g,v],S=X.runKernelFunc(function(_,T){var B=_.fusedDepthwiseConv2D({input:v,filter:g,convInfo:E,bias:b,activation:f,preluActivationWeights:w});return T([g,v,B]),B},x,function(_,T){W(bc(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var B=T[0],L=T[1],k=T[2],D=Tx(_,k,f),F={};return l!=null&&(F={bias:function(){return Ox(b,D)}}),Object.assign({x:function(){return MD(L.shape,D,B,E)},filter:function(){return LD(L,D,B.shape,E)}},F)},"FusedDepthwiseConv2D",{convInfo:E,activation:f},R,[!0]);return y?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}}),wte=Object.freeze({matMul:gte,conv2d:yte,depthwiseConv2d:bte}),xte=Object.freeze({image:Rx,linalg:cte,losses:ote,spectral:zee,fused:wte,signal:Kee,square:tZ,squaredDifference:yD,conv1d:lee,conv2d:di,conv3d:dee,depthwiseConv2d:jm,separableConv2d:Ex,conv2dTranspose:fee,conv3dTranspose:hee,op:z,batchNormalization2d:PZ,batchNormalization3d:NZ,batchNormalization4d:DZ,batchNormalization:AZ,batchNorm:CD,batchNorm2d:MZ,batchNorm3d:LZ,batchNorm4d:FZ,booleanMaskAsync:cee,complex:In,real:ei,imag:Ki,concat:an,concat1d:wY,concat2d:xY,concat3d:EY,concat4d:SY,split:ux,matMul:$m,dot:pee,outerProduct:vee,reverse:uf,reverse1d:mee,reverse2d:gee,reverse3d:yee,reverse4d:bee,maxPool:hn,avgPool:cf,pool:wee,maxPool3d:xee,avgPool3d:Eee,slice:oo,slice1d:See,slice2d:Cee,slice3d:jD,slice4d:_ee,abs:nZ,acos:rZ,acosh:iZ,asin:oZ,asinh:aZ,atan:sZ,atanh:uZ,ceil:cZ,clipByValue:yx,cos:lZ,cosh:dZ,erf:fZ,exp:ab,expm1:hZ,floor:pZ,log:vZ,log1p:mZ,logSigmoid:gZ,neg:lv,reciprocal:yZ,round:bZ,rsqrt:bD,sigmoid:wD,sign:wZ,isNaN:xZ,isInf:EZ,isFinite:SZ,sin:CZ,sinh:_Z,softplus:kZ,sqrt:RZ,step:IZ,tan:TZ,tanh:OZ,all:kee,any:Ree,argMax:Iee,argMin:Tee,logSumExp:Oee,max:Vm,mean:Pee,min:Nee,moments:Dee,sum:VD,prod:Aee,equal:TD,equalStrict:ZZ,greater:eee,greaterEqual:OD,greaterEqualStrict:tee,greaterStrict:nee,less:ree,lessEqual:iee,lessEqualStrict:oee,lessStrict:aee,notEqual:see,notEqualStrict:uee,add:Ke,addN:$Z,addStrict:VZ,atan2:WZ,div:wi,divNoNan:UZ,divStrict:zZ,floorDiv:RD,maximum:bx,maximumStrict:HZ,minimum:ID,minimumStrict:GZ,mod:qZ,modStrict:XZ,mul:Yn,mulStrict:KZ,pow:dv,powStrict:YZ,squaredDifferenceStrict:QZ,sub:cn,subStrict:JZ,elu:WD,leakyRelu:Mee,prelu:UD,relu:Ft,relu6:zD,selu:Lee,logicalAnd:Bm,logicalNot:BZ,logicalOr:_D,logicalXor:jZ,where:Ds,whereAsync:kD,buffer:je,print:NY,batchToSpaceND:VN,broadcastTo:DY,cast:AY,clone:MY,cumsum:LY,depthToSpace:FY,expandDims:Zr,eye:WN,multinomial:BY,oneHot:nb,pad:Us,pad1d:jY,pad2d:$Y,pad3d:VY,pad4d:WY,rand:UY,randomNormal:zY,randomGamma:HY,randomUniform:UN,reshape:xi,spaceToBatchND:zN,squeeze:HN,stack:zr,tile:Uu,truncatedNormal:GY,unstack:sn,setdiff1dAsync:qY,fill:ro,linspace:bY,ones:Vc,range:nv,scalar:ye,tensor:On,tensor1d:tn,tensor2d:Ea,tensor3d:sx,tensor4d:gr,tensor5d:mY,tensor6d:gY,variable:yY,zeros:Rt,onesLike:$N,zerosLike:rt,transpose:Pa,softmax:Lo,logSoftmax:eQ,localResponseNormalization:Fee,norm:HD,gather:wx,unsortedSegmentSum:PD,basicLSTMCell:Bee,multiRNNCell:jee,movingAverage:$ee,stridedSlice:Vee,topk:Wee,scatterND:Uee,fft:Sx,ifft:fv,rfft:Cx,irfft:GD,sparseToDense:Hee,gatherND:Gee,diag:qee,dropout:Xee,hannWindow:_x,hammingWindow:XD,frame:kx,stft:KD,inTopKAsync:Yee});function ue(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&W(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function Y0(e,t,n,r){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var Ete=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new JN(n,X),n}return Ni(t,e),t.prototype.write=function(n,r,i){this.firstUse&&(this.firstUse=!1,ae().get("IS_NODE")&&ev(`
============================
Hi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var o={};return this.data.set(o,{values:n,dtype:i}),o},t.prototype.move=function(n,r,i,o){this.data.set(n,{values:r,dtype:o})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return _e(this,void 0,void 0,function(){return ke(this,function(r){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var r=this.data.get(n),i=r.dtype,o=r.complexTensors;return i==="complex64"?ob(this.readSync(o.real.dataId),this.readSync(o.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),i=r;if(n.dtype==="string")try{i=r.map(function(o){return Qp(o)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return je(n.shape,n.dtype,i)},t.prototype.makeOutput=function(n,r,i){var o=this.write(n,r,i);return X.makeTensorFromDataId(o,r,i,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return _e(this,void 0,void 0,function(){var r;return ke(this,function(i){return r=Gi(),n(),[2,{kernelMs:Gi()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,r){var i=this.makeOutput(null,n.shape,"complex64");return this.data.get(i.dataId).complexTensors={real:X.keep(n.clone()),imag:X.keep(r.clone())},i},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,i){if(ue(n,"slice"),YN(n.shape,r,i)){var o=QN(r,n.strides),a=Re(i);return On(this.readSync(n.dataId).subarray(o,o+a),i,n.dtype)}for(var s=je(i,n.dtype),u=this.bufferSync(n),c=0;c<s.size;++c){var l=s.indexToLoc(c).map(function(d,f){return d+r[f]});s.values[c]=u.get.apply(u,l)}return s.toTensor()},t.prototype.stridedSlice=function(n,r,i,o){ue(n,"stridedSlice");var a=lx(r,i,o);if(a.some(function(h){return h===0}))return On([],a);for(var s=je(a,n.dtype),u=this.bufferSync(n),c=0;c<s.size;c++){for(var l=s.indexToLoc(c),d=new Array(l.length),f=0;f<d.length;f++)d[f]=l[f]*o[f]+r[f];s.set.apply(s,[u.get.apply(u,d)].concat(l))}return s.toTensor()},t.prototype.diag=function(n){for(var r=this.readSync(n.dataId),i=je([n.size,n.size],n.dtype),o=i.values,a=0;a<r.length;a++)o[a*n.size+a]=r[a];return i.toTensor()},t.prototype.unstack=function(n,r){for(var i=n.shape[r],o=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(o[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),c=n.shape.slice();c[r]=1;var l=new Array(i);for(s=0;s<l.length;s++)u[r]=s,l[s]=this.slice(n,u,c).reshape(o);return l},t.prototype.reverse=function(n,r){ue(n,"reverse");for(var i=je(n.shape,n.dtype),o=this.bufferSync(n),a=function(u){var c=i.indexToLoc(u),l=c.slice();r.forEach(function(d){return l[d]=n.shape[d]-1-l[d]}),i.set.apply(i,[o.get.apply(o,l)].concat(c))},s=0;s<i.size;s++)a(s);return i.toTensor()},t.prototype.concat=function(n,r){var i=this;if(n[0].dtype==="complex64"){var o=n.map(function(h){return ei(h)}),a=n.map(function(h){return Ki(h)});return In(this.concat(o,r),this.concat(a,r))}var s=n.map(function(h){var p=Re(h.shape.slice(r));return h.as2D(-1,p)}),u=yc(s.map(function(h){return h.shape}),1),c=je(u,n[0].dtype).values;if(s[0].shape[0]===1){var l=0;s.forEach(function(h){c.set(i.readSync(h.dataId),l),l+=h.size})}else{var d=0;s.forEach(function(h){for(var p=i.readSync(h.dataId),m=0,g=0;g<h.shape[0];++g)for(var v=g*u[1]+d,y=0;y<h.shape[1];++y)c[v+y]=p[m++];d+=h.shape[1]})}var f=yc(n.map(function(h){return h.shape}),r);return On(c,f,n[0].dtype)},t.prototype.neg=function(n){return ue(n,"neg"),this.multiply(ye(-1),n)},t.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,o,a,s){return{real:i+a,imag:o+s}}):this.broadcastedBinaryOp(n,r,Tn(n.dtype,r.dtype),function(i,o){return i+o})},t.prototype.addN=function(n){var r=this;ue(n,"addN");for(var i=n.map(function(l){return r.readSync(l.dataId)}),o=je(n[0].shape,n[0].dtype),a=o.values,s=0;s<n.length;s++)for(var u=i[s],c=0;c<a.length;c++)a[c]+=u[c];return o.toTensor()},t.prototype.softmax=function(n,r){var i=dn([r],n.shape),o=this.max(n,i),a=Ir(o.shape,i),s=this.subtract(n,o.reshape(a)),u=this.exp(s),c=this.sum(u,i).reshape(a);return this.realDivide(u,c)},t.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,o,a,s){return{real:i-a,imag:o-s}}):this.broadcastedBinaryOp(n,r,Tn(n.dtype,r.dtype),function(i,o){return i-o})},t.prototype.pow=function(n,r){return ue([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,o){return Math.pow(i,o)})},t.prototype.batchMatMul=function(n,r,i,o){ue([n,r],"matMul");for(var a=i?n.shape[1]:n.shape[2],s=i?n.shape[2]:n.shape[1],u=o?r.shape[1]:r.shape[2],c=n.shape[0],l=this.readSync(n.dataId),d=this.readSync(r.dataId),f=i?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],h=f[0],p=f[1],m=f[2],g=o?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],v=g[0],y=g[1],b=g[2],w=s*u,E=je([c,s,u],n.dtype),x=E.values,R=this.blockSize,S=0;S<c;S++)for(var _=0;_<s;_+=R)for(var T=0;T<u;T+=R)for(var B=0;B<a;B+=R)for(var L=Math.min(_+R,s),k=Math.min(T+R,u),D=Math.min(B+R,a),F=_;F<L;F++)for(var M=T;M<k;M++){for(var I=0,N=B;N<D;N++)I+=l[S*h+F*p+N*m]*d[N*v+M*y+S*b];x[S*w+(F*u+M)]+=I}return E.toTensor()},t.prototype.fusedBatchMatMul=function(n){var r=n.a,i=n.b,o=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,c=n.preluActivationWeights,l=this.batchMatMul(r,i,o,a);return s&&(l=this.add(l,s)),u&&(l=Y0(this,l,u,c)),l},t.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,o,a,s){return{real:i*a-o*s,imag:i*s+o*a}}):this.broadcastedBinaryOp(n,r,Tn(n.dtype,r.dtype),function(i,o){return i*o})},t.prototype.realDivide=function(n,r){return ue([n,r],"realDivide"),this.broadcastedBinaryOp(n,r,"float32",function(i,o){return i/o})},t.prototype.floorDiv=function(n,r){return ue([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(i,o){return Math.floor(i/o)})},t.prototype.sum=function(n,r){ue(n,"sum"),Ar("sum",r,n.rank);for(var i=Un(n.shape,r),o=i[0],a=i[1],s=Rt(o,Tn(n.dtype,"int32")),u=Re(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=0,p=0;p<u;++p)h+=l[f+p];c[d]=h}return s},t.prototype.prod=function(n,r){ue(n,"sum");for(var i=Un(n.shape,r),o=i[0],a=i[1],s=Rt(o,Tn(n.dtype,"int32")),u=Re(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=1,p=0;p<u;++p)h*=l[f+p];c[d]=h}return s},t.prototype.unsortedSegmentSum=function(n,r,i){ue(n,"unsortedSegmentSum");for(var o=[],a=n.rank-r.rank,s=0;s<a;++s)r=r.expandDims(s+1);for(s=0;s<i;++s){var u=ye(s,"int32"),c=TD(u,r).asType("float32").mul(n).sum(0);o.push(c)}return zr(o)},t.prototype.argMin=function(n,r){ue(n,"argMin");var i=[r];Ar("argMin",i,n.rank);for(var o=Un(n.shape,i),a=o[0],s=o[1],u=Rt(a,"int32"),c=Re(s),l=this.readSync(u.dataId),d=this.readSync(n.dataId),f=0;f<l.length;++f){for(var h=f*c,p=d[h],m=0,g=0;g<c;++g){var v=d[h+g];v<p&&(p=v,m=g)}l[f]=m}return u},t.prototype.argMax=function(n,r){ue(n,"argMax");var i=[r];Ar("argMax",i,n.rank);for(var o=Un(n.shape,i),a=o[0],s=o[1],u=Rt(a,"int32"),c=Re(s),l=this.readSync(u.dataId),d=this.readSync(n.dataId),f=0;f<l.length;++f){for(var h=f*c,p=d[h],m=0,g=0;g<c;++g){var v=d[h+g];v>p&&(p=v,m=g)}l[f]=m}return u},t.prototype.cumsum=function(n,r,i,o){if(ue(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var a=Tn(n.dtype,"int32"),s=Rt(n.shape,a),u=this.readSync(s.dataId),c=this.readSync(n.dataId),l=n.shape[n.rank-1],d=o?function(g,v){return g+l-v-1}:function(g,v){return g+v},f=0;f<c.length;f+=l)for(var h=0;h<l;h++){var p=d(f,h);if(h===0)u[p]=i?0:c[p];else{var m=d(f,h-1);u[p]=i?c[m]+u[m]:c[p]+u[m]}}return s},t.prototype.equal=function(n,r){return ue([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(i,o){return i===o?1:0})},t.prototype.notEqual=function(n,r){return ue([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,o){return i!==o?1:0})},t.prototype.less=function(n,r){return ue([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(i,o){return i<o?1:0})},t.prototype.lessEqual=function(n,r){return ue([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,o){return i<=o?1:0})},t.prototype.greater=function(n,r){return ue([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(i,o){return i>o?1:0})},t.prototype.greaterEqual=function(n,r){return ue([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,o){return i>=o?1:0})},t.prototype.logicalNot=function(n){ue(n,"logicalNot");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r[o]?0:1;return this.makeOutput(i,n.shape,"bool")},t.prototype.logicalAnd=function(n,r){return ue([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(i,o){return i&&o})},t.prototype.logicalOr=function(n,r){return ue([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(i,o){return i||o})},t.prototype.select=function(n,r,i){ue([n,r,i],"select");for(var o=this.readSync(n.dataId),a=this.readSync(r.dataId),s=this.readSync(i.dataId),u=Rt(r.shape,Tn(r.dtype,i.dtype)),c=this.readSync(u.dataId),l=0,d=n.rank===0||n.rank>1||r.rank===1?1:Re(r.shape.slice(1)),f=0;f<o.length;f++)for(var h=0;h<d;h++)o[f]===1?c[l++]=a[f]:c[l++]=s[f];return u},t.prototype.where=function(n){ue([n],"where");var r=this.readSync(n.dataId);return px(n.shape,r)},t.prototype.topk=function(n,r,i){return ue(n,"topk"),aD(this.readSync(n.dataId),n.shape,n.dtype,r)},t.prototype.min=function(n,r){ue(n,"min"),Ar("min",r,n.rank);for(var i=Un(n.shape,r),o=i[0],a=i[1],s=Rt(o,n.dtype),u=Re(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=l[f],p=0;p<u;++p){var m=l[f+p];m<h&&(h=m)}c[d]=h}return s},t.prototype.minimum=function(n,r){return ue([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,o){return Math.min(i,o)})},t.prototype.mod=function(n,r){return ue([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,o){var a=i%o;return i<0&&o<0||i>=0&&o>=0?a:(a+o)%o})},t.prototype.max=function(n,r){ue(n,"max"),Ar("max",r,n.rank);for(var i=Un(n.shape,r),o=i[0],a=i[1],s=Rt(o,n.dtype),u=Re(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=l[f],p=0;p<u;++p){var m=l[f+p];m>h&&(h=m)}c[d]=h}return s},t.prototype.maximum=function(n,r){return ue([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,o){return Math.max(i,o)})},t.prototype.all=function(n,r){ue(n,"all"),Ar("all",r,n.rank);for(var i=Un(n.shape,r),o=i[0],a=i[1],s=Rt(o,n.dtype),u=Re(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=l[f],p=0;p<u;++p){var m=l[f+p];h=h&&m}c[d]=h}return s},t.prototype.any=function(n,r){ue(n,"any"),Ar("any",r,n.rank);for(var i=Un(n.shape,r),o=i[0],a=i[1],s=Rt(o,n.dtype),u=Re(a),c=this.readSync(s.dataId),l=this.readSync(n.dataId),d=0;d<c.length;++d){for(var f=d*u,h=l[f],p=0;p<u;++p){var m=l[f+p];h=h||m}c[d]=h}return s},t.prototype.squaredDifference=function(n,r){return ue([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,o){var a=i-o;return a*a})},t.prototype.ceil=function(n){ue(n,"ceil");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.ceil(r[o]);return this.makeOutput(i,n.shape,"float32")},t.prototype.floor=function(n){ue(n,"floor");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.floor(r[o]);return this.makeOutput(i,n.shape,"float32")},t.prototype.sign=function(n){ue(n,"x");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)r[o]<0?i[o]=-1:r[o]>0?i[o]=1:i[o]=0;return this.makeOutput(i,n.shape,"float32")},t.prototype.isNaN=function(n){ue(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Number.isNaN(r[o])&&(i[o]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.isInf=function(n){ue(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Math.abs(r[o])===1/0&&(i[o]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.isFinite=function(n){ue(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Number.isFinite(r[o])&&(i[o]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.round=function(n){ue(n,"round");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var a=Math.floor(r[o]);r[o]-a<.5?i[o]=Math.floor(r[o]):r[o]-a>.5?i[o]=Math.ceil(r[o]):i[o]=a%2==0?a:a+1}return this.makeOutput(i,n.shape,"float32")},t.prototype.exp=function(n){ue(n,"exp");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.exp(r[o]);return this.makeOutput(i,n.shape,"float32")},t.prototype.expm1=function(n){ue(n,"expm1");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.expm1(r[o]);return this.makeOutput(i,n.shape,"float32")},t.prototype.log=function(n){ue(n,"log");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var a=r[o];i[o]=Math.log(a)}return this.makeOutput(i,n.shape,"float32")},t.prototype.log1p=function(n){ue(n,"log1p");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var a=r[o];i[o]=Math.log1p(a)}return this.makeOutput(i,n.shape,"float32")},t.prototype.sqrt=function(n){ue(n,"sqrt");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var a=r[o];i[o]=Math.sqrt(a)}return this.makeOutput(i,n.shape,"float32")},t.prototype.rsqrt=function(n){ue(n,"rsqrt");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var a=r[o];i[o]=1/Math.sqrt(a)}return this.makeOutput(i,n.shape,"float32")},t.prototype.reciprocal=function(n){ue(n,"reciprocal");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=1/r[o];return this.makeOutput(i,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){ue(n,"relu");for(var r=Rt(n.shape,n.dtype),i=this.readSync(r.dataId),o=this.readSync(n.dataId),a=0;a<o.length;++a)i[a]=Math.max(0,o[a]);return r},t.prototype.relu6=function(n){ue(n,"relu");for(var r=Rt(n.shape,n.dtype),i=this.readSync(r.dataId),o=this.readSync(n.dataId),a=0;a<o.length;++a)i[a]=Math.min(Math.max(0,o[a]),6);return r},t.prototype.prelu=function(n,r){return ue([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,o){return i<0?o*i:i})},t.prototype.elu=function(n){ue(n,"elu");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o){var a=i[o];r[o]=a>=0?a:Math.exp(a)-1}return this.makeOutput(r,n.shape,"float32")},t.prototype.eluDer=function(n,r){ue([n,r],"eluDer");for(var i=new Float32Array(r.size),o=this.readSync(r.dataId),a=this.readSync(n.dataId),s=0;s<o.length;++s){var u=o[s];i[s]=u>=1?a[s]:a[s]*(u+1)}return this.makeOutput(i,r.shape,"float32")},t.prototype.selu=function(n){ue(n,"selu");for(var r=mx,i=gx,o=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];o[s]=u>=0?i*u:r*(Math.exp(u)-1)}return this.makeOutput(o,n.shape,"float32")},t.prototype.clip=function(n,r,i){ue(n,"clip");for(var o=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];o[s]=u>i?i:u<r?r:u}return this.makeOutput(o,n.shape,"float32")},t.prototype.abs=function(n){for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o)r[o]=Math.abs(i[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<n.size;++o){var a=i[2*o],s=i[2*o+1];r[o]=Math.hypot(a,s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.int=function(n){ue(n,"int");for(var r=new Int32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o)r[o]=i[o];return this.makeOutput(r,n.shape,"int32")},t.prototype.sigmoid=function(n){ue(n,"sigmoid");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o)r[o]=1/(1+Math.exp(-i[o]));return this.makeOutput(r,n.shape,"float32")},t.prototype.softplus=function(n){ue(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,i=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a){var s=o[a]>-r,u=o[a]<r,c=Math.exp(o[a]),l=void 0;l=u?c:s?o[a]:Math.log(1+c),i[a]=l}return this.makeOutput(i,n.shape,"float32")},t.prototype.sin=function(n){ue(n,"sin");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o)r[o]=Math.sin(i[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cos=function(n){ue(n,"cos");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o)r[o]=Math.cos(i[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tan=function(n){ue(n,"tan");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o)r[o]=Math.tan(i[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asin=function(n){ue(n,"asin");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o)r[o]=Math.asin(i[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acos=function(n){ue(n,"acos");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o)r[o]=Math.acos(i[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan=function(n){ue(n,"atan");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o)r[o]=Math.atan(i[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan2=function(n,r){return ue([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,o){return Math.atan2(i,o)})},t.prototype.sinh=function(n){ue(n,"sinh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o)r[o]=Math.sinh(i[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cosh=function(n){ue(n,"cosh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o)r[o]=Math.cosh(i[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tanh=function(n){ue(n,"tanh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o)r[o]=SK(i[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asinh=function(n){ue(n,"asinh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o)r[o]=Math.asinh(i[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acosh=function(n){ue(n,"acosh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o)r[o]=Math.acosh(i[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atanh=function(n){ue(n,"atanh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o)r[o]=Math.atanh(i[o]);return this.makeOutput(r,n.shape,"float32")},t.prototype.erf=function(n){ue(n,"erf");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),o=0;o<i.length;++o){var a=Math.sign(i[o]),s=Math.abs(i[o]),u=1/(1+.3275911*s);r[o]=a*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},t.prototype.step=function(n,r){r===void 0&&(r=0),ue(n,"step");for(var i=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a){var s=o[a];isNaN(s)?i[a]=NaN:i[a]=s>0?1:r}return this.makeOutput(i,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var r=n.input,i=n.filter,o=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,c=this.conv2d(r,i,o);return a&&(c=this.add(c,a)),s&&(c=Y0(this,c,s,u)),c},t.prototype.conv2d=function(n,r,i){ue([n,r],"conv2d");for(var o=i.filterHeight,a=i.filterWidth,s=i.dilationHeight,u=i.dilationWidth,c=i.padInfo.left,l=i.padInfo.top,d=i.dataFormat==="channelsLast",f=je(i.outShape,n.dtype),h=n.strides[0],p=d?n.strides[1]:n.strides[2],m=d?n.strides[2]:1,g=d?1:n.strides[1],v=f.strides[0],y=d?f.strides[1]:f.strides[2],b=d?f.strides[2]:1,w=d?1:f.strides[1],E=this.readSync(n.dataId),x=this.readSync(r.dataId),R=f.values,S=0;S<i.batchSize;++S)for(var _=S*h,T=S*v,B=0;B<i.outHeight;++B)for(var L=T+B*y,k=B*i.strideHeight-l,D=0;D<o;D++){var F=k+D*s;if(!(F<0||F>=i.inHeight))for(var M=D*r.strides[0],I=_+F*p,N=0;N<i.outWidth;++N)for(var j=L+N*b,P=N*i.strideWidth-c,A=0;A<a;A++){var U=P+A*u;if(!(U<0||U>=i.inWidth))for(var H=I+U*m,q=M+A*r.strides[1],Q=0;Q<i.inChannels;++Q){for(var V=E[H+Q*g],re=0;re<i.outChannels;++re)R[j+re*w]+=V*x[q+re];q+=i.outChannels}}}return f.toTensor()},t.prototype.conv3d=function(n,r,i){for(var o=i.filterDepth,a=i.filterHeight,s=i.filterWidth,u=i.dilationDepth,c=i.dilationHeight,l=i.dilationWidth,d=i.padInfo.front,f=i.padInfo.left,h=i.padInfo.top,p=je(i.outShape,n.dtype),m=this.readSync(n.dataId),g=this.readSync(r.dataId),v=p.values,y=0;y<i.batchSize;++y)for(var b=y*n.strides[0],w=y*p.strides[0],E=0;E<i.outDepth;++E)for(var x=w+E*p.strides[1],R=E*i.strideDepth-d,S=0;S<o;S++){var _=R+S*u;if(!(_<0||_>=i.inDepth))for(var T=S*r.strides[0],B=b+_*n.strides[1],L=0;L<i.outHeight;++L)for(var k=x+L*p.strides[2],D=L*i.strideHeight-h,F=0;F<a;F++){var M=D+F*c;if(!(M<0||M>=i.inHeight))for(var I=T+F*r.strides[1],N=B+M*n.strides[2],j=0;j<i.outWidth;++j)for(var P=k+j*i.outChannels,A=j*i.strideWidth-f,U=0;U<s;U++){var H=A+U*l;if(!(H<0||H>=i.inWidth))for(var q=I+U*r.strides[2],Q=N+H*i.inChannels,V=q,re=0;re<i.inChannels;++re){for(var Z=m[Q+re],he=0;he<i.outChannels;++he)v[P+he]+=Z*g[V+he];V+=i.outChannels}}}}return p.toTensor()},t.prototype.conv2dDerInput=function(n,r,i){ue([n,r],"conv2dDerInput");for(var o=je(i.inShape,"float32"),a=o.values,s=this.readSync(n.dataId),u=this.readSync(r.dataId),c=r.strides,l=c[0],d=c[1],f=c[2],h=i.batchSize,p=i.filterHeight,m=i.filterWidth,g=i.inChannels,v=i.inHeight,y=i.inWidth,b=i.outChannels,w=i.outHeight,E=i.outWidth,x=i.strideHeight,R=i.strideWidth,S=i.dataFormat,_=p-1-i.padInfo.top,T=m-1-i.padInfo.left,B=S==="channelsLast",L=o.strides[0],k=B?o.strides[1]:o.strides[2],D=B?o.strides[2]:1,F=B?1:o.strides[1],M=n.strides[0],I=B?n.strides[1]:n.strides[2],N=B?n.strides[2]:1,j=B?1:n.strides[1],P=0;P<h;++P)for(var A=0;A<g;++A)for(var U=0;U<v;++U)for(var H=U-_,q=Math.max(0,Math.ceil(H/x)),Q=Math.min(w,(p+H)/x),V=0;V<y;++V){for(var re=V-T,Z=Math.max(0,Math.ceil(re/R)),he=Math.min(E,(m+re)/R),xe=0,ie=q;ie<Q;++ie)for(var pe=ie*x-H,ce=Z;ce<he;++ce)for(var Y=M*P+I*ie+N*ce,de=l*(p-1-pe)+d*(m-1-(ce*R-re))+f*A,be=0;be<b;++be)xe+=s[Y+j*be]*u[de+be];a[L*P+k*U+D*V+F*A]=xe}return o.toTensor()},t.prototype.conv3dDerInput=function(n,r,i){for(var o=je(i.inShape,"float32"),a=o.values,s=o.strides,u=s[0],c=s[1],l=s[2],d=s[3],f=this.readSync(n.dataId),h=n.strides,p=h[0],m=h[1],g=h[2],v=h[3],y=this.readSync(r.dataId),b=r.strides,w=b[0],E=b[1],x=b[2],R=b[3],S=i.batchSize,_=i.filterDepth,T=i.filterHeight,B=i.filterWidth,L=i.inChannels,k=i.inDepth,D=i.inHeight,F=i.inWidth,M=i.outChannels,I=i.outDepth,N=i.outHeight,j=i.outWidth,P=i.strideDepth,A=i.strideHeight,U=i.strideWidth,H=_-1-i.padInfo.front,q=T-1-i.padInfo.top,Q=B-1-i.padInfo.left,V=0;V<S;++V)for(var re=0;re<L;++re)for(var Z=0;Z<k;++Z)for(var he=Z-H,xe=Math.max(0,Math.ceil(he/P)),ie=Math.min(I,(_+he)/P),pe=0;pe<D;++pe)for(var ce=pe-q,Y=Math.max(0,Math.ceil(ce/A)),de=Math.min(N,(T+ce)/A),be=0;be<F;++be){for(var le=be-Q,Tt=Math.max(0,Math.ceil(le/U)),yt=Math.min(j,(B+le)/U),Gt=0,er=xe;er<ie;++er)for(var tr=er*P-he,An=Y;An<de;++An)for(var Sn=An*A-ce,it=Tt;it<yt;++it)for(var bt=p*V+m*er+g*An+v*it,Ye=w*(_-1-tr)+E*(T-1-Sn)+x*(B-1-(it*U-le))+R*re,Ne=0;Ne<M;++Ne)Gt+=f[bt+Ne]*y[Ye+Ne];a[u*V+c*Z+l*pe+d*be+re]=Gt}return o.toTensor()},t.prototype.conv2dDerFilter=function(n,r,i){ue([n,r],"conv2dDerFilter");for(var o=i.strideHeight,a=i.strideWidth,s=i.filterHeight,u=i.filterWidth,c=i.dataFormat==="channelsLast",l=je(i.filterShape,"float32"),d=i.padInfo.left,f=i.padInfo.top,h=this.bufferSync(n),p=this.bufferSync(r),m=0;m<s;++m)for(var g=Math.max(0,Math.ceil((f-m)/o)),v=Math.min(i.outHeight,(i.inHeight+f-m)/o),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((d-y)/a)),w=Math.min(i.outWidth,(i.inWidth+d-y)/a),E=0;E<i.inChannels;++E)for(var x=0;x<i.outChannels;++x){for(var R=0,S=0;S<i.batchSize;++S)for(var _=g;_<v;++_)for(var T=m+_*o-f,B=b;B<w;++B){var L=y+B*a-d;R+=c?h.get(S,T,L,E)*p.get(S,_,B,x):h.get(S,E,T,L)*p.get(S,x,_,B)}l.set(R,m,y,E,x)}return l.toTensor()},t.prototype.conv3dDerFilter=function(n,r,i){for(var o=i.strideDepth,a=i.strideHeight,s=i.strideWidth,u=i.filterDepth,c=i.filterHeight,l=i.filterWidth,d=je(i.filterShape,"float32"),f=d.values,h=d.strides,p=h[0],m=h[1],g=h[2],v=h[3],y=this.readSync(r.dataId),b=r.strides,w=b[0],E=b[1],x=b[2],R=b[3],S=this.readSync(n.dataId),_=n.strides,T=_[0],B=_[1],L=_[2],k=_[3],D=i.padInfo.front,F=i.padInfo.left,M=i.padInfo.top,I=0;I<u;++I)for(var N=Math.max(0,Math.ceil((D-I)/o)),j=Math.min(i.outDepth,(i.inDepth+D-I)/o),P=I*p,A=0;A<c;++A)for(var U=Math.max(0,Math.ceil((M-A)/a)),H=Math.min(i.outHeight,(i.inHeight+M-A)/a),q=A*m+P,Q=0;Q<l;++Q)for(var V=Math.max(0,Math.ceil((F-Q)/s)),re=Math.min(i.outWidth,(i.inWidth+F-Q)/s),Z=Q*g+q,he=0;he<i.inChannels;++he)for(var xe=he*v+Z,ie=0;ie<i.outChannels;++ie){for(var pe=0,ce=0;ce<i.batchSize;++ce)for(var Y=ce*T,de=ce*w,be=N;be<j;++be)for(var le=(I+be*o-D)*B+Y,Tt=be*E+de,yt=U;yt<H;++yt)for(var Gt=(A+yt*a-M)*L+le,er=yt*x+Tt,tr=V;tr<re;++tr){var An=tr*R+er;pe+=S[(Q+tr*s-F)*k+Gt+he]*y[An+ie]}f[xe+ie]=pe}return d.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,i=n.filter,o=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,c=this.depthwiseConv2D(r,i,o);return a&&(c=this.add(c,a)),s&&(c=Y0(this,c,s,u)),c},t.prototype.depthwiseConv2D=function(n,r,i){ue([n,r],"depthwiseConv2D");for(var o=i.filterHeight,a=i.filterWidth,s=i.dilationHeight,u=i.dilationWidth,c=i.padInfo.left,l=i.padInfo.top,d=i.outChannels/i.inChannels,f=je(i.outShape,n.dtype),h=this.readSync(n.dataId),p=this.readSync(r.dataId),m=f.values,g=0;g<i.batchSize;++g)for(var v=g*n.strides[0],y=g*f.strides[0],b=0;b<i.outHeight;++b)for(var w=y+b*f.strides[1],E=b*i.strideHeight-c,x=0;x<o;++x){var R=E+x*s;if(!(R<0||R>=i.inHeight))for(var S=x*r.strides[0],_=v+R*n.strides[1],T=0;T<i.outWidth;++T)for(var B=w+T*f.strides[2],L=T*i.strideWidth-l,k=0;k<a;++k){var D=L+k*u;if(!(D<0||D>=i.inWidth))for(var F=S+k*r.strides[1],M=_+D*i.inChannels,I=B,N=F,j=0;j<i.inChannels;++j){for(var P=h[M+j],A=0;A<d;++A)m[I+A]+=P*p[N+A];I+=d,N+=d}}}return f.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,r,i){ue([n,r],"depthwiseConv2DDerInput");for(var o=je(i.inShape,"float32"),a=o.values,s=o.strides,u=s[0],c=s[1],l=s[2],d=this.readSync(n.dataId),f=n.strides,h=f[0],p=f[1],m=f[2],g=this.readSync(r.dataId),v=r.strides,y=v[0],b=v[1],w=v[2],E=i.batchSize,x=i.filterHeight,R=i.filterWidth,S=i.inChannels,_=i.inHeight,T=i.inWidth,B=i.outChannels,L=i.outHeight,k=i.outWidth,D=i.strideHeight,F=i.strideWidth,M=x-1-i.padInfo.top,I=R-1-i.padInfo.left,N=B/S,j=0;j<E;++j)for(var P=0;P<S;++P)for(var A=0;A<_;++A)for(var U=A-M,H=Math.max(0,Math.ceil(U/D)),q=Math.min(L,(x+U)/D),Q=0;Q<T;++Q){for(var V=Q-I,re=Math.max(0,Math.ceil(V/F)),Z=Math.min(k,(R+V)/F),he=0,xe=H;xe<q;++xe)for(var ie=xe*D-U,pe=re;pe<Z;++pe)for(var ce=h*j+p*xe+m*pe,Y=y*(x-1-ie)+b*(R-1-(pe*F-V))+w*P,de=0;de<N;++de)he+=d[ce+(P*N+de)]*g[Y+de];a[u*j+c*A+l*Q+P]=he}return o.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,r,i){ue([n,r],"depthwiseConv2DDerFilter");for(var o=i.strideHeight,a=i.strideWidth,s=i.filterHeight,u=i.filterWidth,c=je(i.filterShape,"float32"),l=i.padInfo.left,d=i.padInfo.top,f=i.outChannels/i.inChannels,h=this.bufferSync(n),p=this.bufferSync(r),m=0;m<s;++m)for(var g=Math.max(0,Math.ceil((d-m)/o)),v=Math.min(i.outHeight,(i.inHeight+d-m)/o),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((l-y)/a)),w=Math.min(i.outWidth,(i.inWidth+l-y)/a),E=0;E<i.outChannels;++E){for(var x=Math.trunc(E/f),R=E%f,S=0,_=0;_<i.batchSize;++_)for(var T=g;T<v;++T)for(var B=m+T*o-d,L=b;L<w;++L){var k=y+L*a-l;S+=h.get(_,B,k,x)*p.get(_,T,L,E)}c.set(S,m,y,x,R)}return c.toTensor()},t.prototype.tile=function(n,r){return ue(n,"tile"),oD(this.bufferSync(n),r)},t.prototype.pad=function(n,r,i){ue(n,"pad");var o=r.map(function(f,h){return f[0]+n.shape[h]+f[1]}),a=r.map(function(f){return f[0]}),s=this.bufferSync(n),u=je(o,n.dtype);i!==0&&u.values.fill(i);for(var c=0;c<n.size;c++){var l=s.indexToLoc(c),d=l.map(function(f,h){return f+a[h]});u.set.apply(u,[s.get.apply(s,l)].concat(d))}return u.toTensor()},t.prototype.transpose=function(n,r){ue(n,"transpose");for(var i=new Array(n.rank),o=0;o<i.length;o++)i[o]=n.shape[r[o]];var a=this.readSync(n.dataId),s=je(i,n.dtype),u=this.bufferSync(n);for(o=0;o<n.size;++o){for(var c=u.indexToLoc(o),l=new Array(c.length),d=0;d<l.length;d++)l[d]=c[r[d]];var f=s.locToIndex(l);s.values[f]=a[o]}return s.toTensor()},t.prototype.gather=function(n,r,i){ue([n,r],"gather");var o=n.shape.slice(),a=this.readSync(r.dataId);o[i]=a.length;for(var s=je(o,n.dtype),u=this.bufferSync(n),c=0;c<s.size;++c){var l=s.indexToLoc(c),d=l.slice();d[i]=a[l[i]];var f=u.locToIndex(d);s.values[c]=u.values[f]}return s.toTensor()},t.prototype.batchToSpaceND=function(n,r,i){ue([n],"batchToSpaceND");var o=r.reduce(function(d,f){return d*f}),a=rv(n.shape,r,o),s=iv(a.length,r.length),u=ov(n.shape,r,o),c=GN(i,r.length),l=qN(u,i,r.length);return n.reshape(a).transpose(s).reshape(u).slice(c,l)},t.prototype.spaceToBatchND=function(n,r,i){ue([n],"spaceToBatchND");var o=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,i);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),c=rv(u.shape,r,o,!1),l=iv(c.length,r.length,!1),d=ov(u.shape,r,o,!1);return u.reshape(c).transpose(l).reshape(d)},t.prototype.pool=function(n,r,i){ue(n,"pool");for(var o=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,p=this.readSync(n.dataId),m=je(r.outShape,n.dtype),g=m.values,v=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],b=r.outShape[3],w=0;w<r.batchSize;++w)for(var E=w*v,x=w*n.strides[0],R=0;R<r.inChannels;++R)for(var S=0;S<r.outHeight;++S)for(var _=S*o-d,T=Math.max(0,_),B=Math.min(r.inHeight,c+_),L=E+S*y,k=0;k<r.outWidth;++k){for(var D=k*a-f,F=Math.max(0,D),M=Math.min(r.inWidth,l+D),I=h,N=0,j=0,P=T;P<B;P+=s){for(var A=x+P*n.strides[1],U=F;U<M;U+=u){var H=p[A+U*n.strides[2]+R];i==="max"&&H>I?I=H:i==="avg"&&(N+=H,j++)}if(isNaN(I))break}g[L+k*b+R]=i==="avg"?N/j:I}return m.toTensor()},t.prototype.maxPool=function(n,r){return this.pool(n,r,"max")},t.prototype.maxPoolPositions=function(n,r){for(var i=je(r.outShape,"int32"),o=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=this.bufferSync(n),p=0;p<r.batchSize;++p)for(var m=0;m<r.inChannels;++m)for(var g=0;g<r.outHeight;++g){for(var v=g*o-d,y=v;y<0;)y+=s;for(var b=Math.min(r.inHeight,c+v),w=0;w<r.outWidth;++w){for(var E=w*a-f,x=E;x<0;)x+=u;for(var R=Math.min(r.inWidth,l+E),S=Number.NEGATIVE_INFINITY,_=-1,T=y;T<b;T+=s)for(var B=T-v,L=x;L<R;L+=u){var k=L-E,D=h.get(p,T,L,m);D>S&&(S=D,_=B*l+k)}i.set(_,p,g,w,m)}}return i.toTensor()},t.prototype.maxPoolBackprop=function(n,r,i,o){ue([r,i],"maxPoolBackprop");for(var a=this.maxPoolPositions(r,o),s=o.strideHeight,u=o.strideWidth,c=o.dilationHeight,l=o.dilationWidth,d=o.effectiveFilterHeight,f=o.effectiveFilterWidth,h=f-1-o.padInfo.left,p=d-1-o.padInfo.top,m=je(r.shape,"float32"),g=this.bufferSync(a),v=this.bufferSync(n),y=0;y<o.batchSize;++y)for(var b=0;b<o.inChannels;++b)for(var w=0;w<o.inHeight;++w)for(var E=0;E<o.inWidth;++E){for(var x=w-p,R=E-h,S=0,_=0;_<d;_+=c){var T=(x+_)/s;if(!(T<0||T>=o.outHeight||Math.floor(T)!==T))for(var B=0;B<f;B+=l){var L=(R+B)/u;if(!(L<0||L>=o.outWidth||Math.floor(L)!==L)){var k=d*f-1-g.get(y,T,L,b)===_*f+B?1:0;k!==0&&(S+=v.get(y,T,L,b)*k)}}}m.set(S,y,w,E,b)}return m.toTensor()},t.prototype.avgPoolBackprop=function(n,r,i){ue([n,r],"avgPoolBackprop");for(var o=i.strideHeight,a=i.strideWidth,s=i.filterHeight,u=i.filterWidth,c=i.dilationHeight,l=i.dilationWidth,d=i.effectiveFilterHeight,f=i.effectiveFilterWidth,h=f-1-i.padInfo.left,p=d-1-i.padInfo.top,m=je(r.shape,"float32"),g=1/(s*u),v=this.bufferSync(n),y=0;y<i.batchSize;++y)for(var b=0;b<i.inChannels;++b)for(var w=0;w<i.inHeight;++w)for(var E=0;E<i.inWidth;++E){for(var x=w-p,R=E-h,S=0,_=0;_<d;_+=c){var T=(x+_)/o;if(!(T<0||T>=i.outHeight||Math.floor(T)!==T))for(var B=0;B<f;B+=l){var L=(R+B)/a;L<0||L>=i.outWidth||Math.floor(L)!==L||(S+=v.get(y,T,L,b))}}m.set(S*g,y,w,E,b)}return m.toTensor()},t.prototype.pool3d=function(n,r,i){ue(n,"pool3d");for(var o=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,m=r.padInfo.top,g=r.padInfo.left,v=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(n.dataId),b=je(r.outShape,n.dtype),w=b.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],x=r.outShape[2]*r.outShape[3]*r.outShape[4],R=r.outShape[3]*r.outShape[4],S=r.outShape[4],_=0;_<r.batchSize;++_)for(var T=_*E,B=_*n.strides[0],L=0;L<r.inChannels;++L)for(var k=0;k<r.outDepth;++k){for(var D=k*o-p,F=D;F<0;)F+=u;for(var M=Math.min(r.inDepth,d+D),I=T+k*x,N=0;N<r.outHeight;++N){for(var j=N*a-m,P=j;P<0;)P+=c;for(var A=Math.min(r.inHeight,f+j),U=I+N*R,H=0;H<r.outWidth;++H){for(var q=H*s-g,Q=q;Q<0;)Q+=l;for(var V=Math.min(r.inWidth,h+q),re=U+H*S,Z=v,he=0,xe=0,ie=F;ie<M;ie+=u){for(var pe=B+ie*n.strides[1],ce=P;ce<A;ce+=c){for(var Y=pe+ce*n.strides[2],de=Q;de<V;de+=l){var be=y[Y+de*n.strides[3]+L];if(i==="max"&&be>Z?Z=be:i==="avg"&&(he+=be,xe++),isNaN(Z))break}if(isNaN(Z))break}if(isNaN(Z))break}w[re+L]=i==="avg"?he/xe:Z}}}return b.toTensor()},t.prototype.avgPool3d=function(n,r){return ue(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,r,i){ue([n,r],"avgPool3dBackprop");for(var o=i.strideDepth,a=i.strideHeight,s=i.strideWidth,u=i.filterDepth,c=i.filterHeight,l=i.filterWidth,d=i.dilationDepth,f=i.dilationHeight,h=i.dilationWidth,p=i.effectiveFilterDepth,m=i.effectiveFilterHeight,g=i.effectiveFilterWidth,v=p-1-i.padInfo.front,y=g-1-i.padInfo.left,b=m-1-i.padInfo.top,w=je(r.shape,"float32"),E=1/(u*c*l),x=this.bufferSync(n),R=0;R<i.batchSize;++R)for(var S=0;S<i.inChannels;++S)for(var _=0;_<i.inDepth;++_)for(var T=0;T<i.inHeight;++T)for(var B=0;B<i.inWidth;++B){for(var L=_-v,k=T-b,D=B-y,F=0,M=0;M<p;M+=d){var I=(L+M)/o;if(!(I<0||I>=i.outDepth||Math.floor(I)!==I))for(var N=0;N<m;N+=f){var j=(k+N)/a;if(!(j<0||j>=i.outHeight||Math.floor(j)!==j))for(var P=0;P<g;P+=h){var A=(D+P)/s;A<0||A>=i.outWidth||Math.floor(A)!==A||(F+=x.get(R,I,j,A,S))}}}w.set(F*E,R,_,T,B,S)}return w.toTensor()},t.prototype.maxPool3d=function(n,r){return ue(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,r){for(var i=je(r.outShape,"int32"),o=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,m=r.padInfo.top,g=r.padInfo.left,v=this.bufferSync(n),y=0;y<r.batchSize;++y)for(var b=0;b<r.inChannels;++b)for(var w=0;w<r.outDepth;++w){for(var E=w*o-p,x=E;x<0;)x+=u;for(var R=Math.min(r.inDepth,d+E),S=0;S<r.outHeight;++S){for(var _=S*a-m,T=_;T<0;)T+=c;for(var B=Math.min(r.inHeight,f+_),L=0;L<r.outWidth;++L){for(var k=L*s-g,D=k;D<0;)D+=l;for(var F=Math.min(r.inWidth,h+k),M=Number.NEGATIVE_INFINITY,I=-1,N=x;N<R;N+=u)for(var j=N-E,P=T;P<B;P+=c)for(var A=P-_,U=D;U<F;U+=l){var H=U-k,q=v.get(y,N,P,U,b);q>=M&&(M=q,I=j*f*h+A*f+H)}i.set(I,y,w,S,L,b)}}}return i.toTensor()},t.prototype.maxPool3dBackprop=function(n,r,i,o){ue([r,i],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(r,o),s=o.strideDepth,u=o.strideHeight,c=o.strideWidth,l=o.dilationDepth,d=o.dilationHeight,f=o.dilationWidth,h=o.effectiveFilterDepth,p=o.effectiveFilterHeight,m=o.effectiveFilterWidth,g=h-1-o.padInfo.front,v=m-1-o.padInfo.left,y=p-1-o.padInfo.top,b=je(r.shape,"float32"),w=this.bufferSync(a),E=this.bufferSync(n),x=0;x<o.batchSize;++x)for(var R=0;R<o.inChannels;++R)for(var S=0;S<o.inDepth;++S)for(var _=0;_<o.inHeight;++_)for(var T=0;T<o.inWidth;++T){for(var B=S-g,L=_-y,k=T-v,D=0,F=0;F<h;F+=l){var M=(B+F)/s;if(!(M<0||M>=o.outDepth||Math.floor(M)!==M))for(var I=0;I<p;I+=d){var N=(L+I)/u;if(!(N<0||N>=o.outHeight||Math.floor(N)!==N))for(var j=0;j<m;j+=f){var P=(k+j)/c;if(!(P<0||P>=o.outWidth||Math.floor(P)!==P)){var A=h*p*m-1-w.get(x,M,N,P,R)===F*p*m+I*m+j?1:0;A!==0&&(D+=E.get(x,M,N,P,R)*A)}}}}b.set(D,x,S,_,T,R)}return b.toTensor()},t.prototype.cast=function(n,r){return tD(n,r,this)},t.prototype.reshape=function(n,r){return ib(n,r)},t.prototype.avgPool=function(n,r){return ue(n,"avgPool"),this.pool(n,r,"avg").toFloat()},t.prototype.resizeBilinear=function(n,r,i,o){ue(n,"resizeBilinear");for(var a=n.shape,s=a[0],u=a[1],c=a[2],l=a[3],d=this.readSync(n.dataId),f=new Float32Array(Re([s,r,i,l])),h=[o&&r>1?u-1:u,o&&i>1?c-1:c],p=[o&&r>1?r-1:r,o&&i>1?i-1:i],m=0,g=h[0]/p[0],v=h[1]/p[1],y=0;y<s;y++)for(var b=0;b<r;b++)for(var w=g*b,E=Math.floor(w),x=w-E,R=Math.min(u-1,Math.ceil(w)),S=y*n.strides[0]+E*n.strides[1],_=y*n.strides[0]+R*n.strides[1],T=0;T<i;T++)for(var B=v*T,L=Math.floor(B),k=B-L,D=Math.min(c-1,Math.ceil(B)),F=S+L*n.strides[2],M=_+L*n.strides[2],I=S+D*n.strides[2],N=_+D*n.strides[2],j=0;j<l;j++){var P=d[F+j],A=d[M+j],U=P+(d[I+j]-P)*k,H=U+(A+(d[N+j]-A)*k-U)*x;f[m++]=H}return On(f,[s,r,i,l])},t.prototype.resizeBilinearBackprop=function(n,r,i){ue([n,r],"resizeBilinearBackprop");for(var o=r.shape,a=o[0],s=o[1],u=o[2],c=o[3],l=n.shape,d=l[1],f=l[2],h=new Float32Array(a*s*u*c),p=[i&&d>1?s-1:s,i&&f>1?u-1:u],m=[i&&d>1?d-1:d,i&&f>1?f-1:f],g=p[0]/m[0],v=p[1]/m[1],y=this.readSync(n.dataId),b=0,w=0;w<a;w++)for(var E=w*r.strides[0],x=0;x<d;x++)for(var R=x*g,S=Math.floor(R),_=Math.min(Math.ceil(R),s-1),T=E+S*r.strides[1],B=E+_*r.strides[1],L=R-S,k=1-L,D=0;D<f;D++)for(var F=D*v,M=Math.floor(F),I=Math.min(Math.ceil(F),u-1),N=F-M,j=1-N,P=T+M*r.strides[2],A=T+I*r.strides[2],U=B+M*r.strides[2],H=B+I*r.strides[2],q=k*j,Q=k*N,V=L*j,re=L*N,Z=0;Z<c;Z++){var he=y[b++];h[P+Z]+=he*q,h[A+Z]+=he*Q,h[U+Z]+=he*V,h[H+Z]+=he*re}return gr(h,[a,u,s,c],r.dtype)},t.prototype.resizeNearestNeighbor=function(n,r,i,o){ue(n,"resizeNearestNeighbor");for(var a=n.shape,s=a[0],u=a[1],c=a[2],l=a[3],d=this.readSync(n.dataId),f=new Float32Array(s*r*i*l),h=[o&&r>1?u-1:u,o&&i>1?c-1:c],p=[o&&r>1?r-1:r,o&&i>1?i-1:i],m=h[0]/p[0],g=h[1]/p[1],v=0,y=0;y<s;y++)for(var b=y*n.strides[0],w=0;w<r;w++)for(var E=m*w,x=b+Math.min(u-1,o?Math.round(E):Math.floor(E))*n.strides[1],R=0;R<i;R++)for(var S=g*R,_=x+Math.min(c-1,o?Math.round(S):Math.floor(S))*n.strides[2],T=0;T<l;T++){var B=d[_+T];f[v++]=B}return On(f,[s,r,i,l],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,r,i){ue([n,r],"resizeNearestNeighborBackprop");for(var o=r.shape,a=o[0],s=o[1],u=o[2],c=o[3],l=n.shape,d=l[1],f=l[2],h=new Float32Array(a*s*u*c),p=this.readSync(n.dataId),m=[i&&d>1?s-1:s,i&&f>1?u-1:u],g=[i&&d>1?d-1:d,i&&f>1?f-1:f],v=m[0]/g[0],y=m[1]/g[1],b=1/v,w=1/y,E=2*Math.ceil(b)+2,x=2*Math.ceil(w)+2,R=0;R<a;R++)for(var S=R*r.strides[0],_=0;_<s;_++)for(var T=S+_*r.strides[1],B=Math.floor(_*b),L=Math.floor(B-E/2),k=0;k<u;k++)for(var D=T+k*r.strides[2],F=Math.floor(k*w),M=Math.floor(F-x/2),I=0;I<c;I++){for(var N=0,j=0;j<E;j++){var P=j+L;if(!(P<0||P>=d)){var A=S+P*n.strides[1],U=P*v;if(_===Math.min(s-1,i?Math.round(U):Math.floor(U)))for(var H=0;H<x;H++){var q=H+M;if(!(q<0||q>=f)){var Q=A+q*n.strides[2],V=q*y;k===Math.min(u-1,i?Math.round(V):Math.floor(V))&&(N+=p[Q+I])}}}}h[D+I]=N}return gr(h,r.shape,r.dtype)},t.prototype.batchNormalization=function(n,r,i,o,a,s){ue([n,r,i,a,s],"batchNorm");for(var u=this.readSync(n.dataId),c=this.readSync(r.dataId),l=this.readSync(i.dataId),d=a?this.readSync(a.dataId):new Float32Array([1]),f=s?this.readSync(s.dataId):new Float32Array([0]),h=new Float32Array(u.length),p=f.length,m=d.length,g=l.length,v=c.length,y=0,b=0,w=0,E=0,x=0;x<u.length;++x)h[x]=f[y++]+(u[x]-c[b++])*d[w++]/Math.sqrt(l[E++]+o),y>=p&&(y=0),b>=v&&(b=0),w>=m&&(w=0),E>=g&&(E=0);return gr(h,n.shape)},t.prototype.localResponseNormalization4D=function(n,r,i,o,a){ue(n,"localResponseNormalization4D");var s=n.shape[3],u=s-1,c=this.readSync(n.dataId),l=n.size,d=new Float32Array(l);function f(g){for(var v=g%s,y=g-v+Math.max(0,v-r),b=g-v+Math.min(v+r,u),w=0;y<=b;y++){var E=c[y];w+=E*E}return w}for(var h=0;h<l;h++){var p=f(h),m=c[h]*Math.pow(i+o*p,-a);d[h]=m}return gr(d,n.shape)},t.prototype.LRNGrad=function(n,r,i,o,a,s,u){ue(n,"LRNGrad");for(var c=n.shape[3],l=this.readSync(n.dataId),d=this.readSync(r.dataId),f=this.readSync(i.dataId),h=new Float32Array(n.size),p=n.size,m=0;m<p;m++){for(var g=m%c,v=m-g+Math.max(0,g-o),y=m-g+Math.min(c,g+o+1),b=0,w=v;w<y;w++)b+=Math.pow(d[w],2);for(b=s*b+a,w=v;w<y;w++){var E=-2*s*u*d[w]*f[m]/b;m===w&&(E+=Math.pow(b,-u)),E*=l[m],h[w]+=E}}return gr(h,n.shape)},t.prototype.multinomial=function(n,r,i,o){ue(n,"multinomial");for(var a=r?n:Lo(n),s=a.shape[0],u=a.shape[1],c=Rt([s,i],"int32"),l=this.readSync(c.dataId),d=this.readSync(a.dataId),f=0;f<s;++f){var h=f*u,p=new Float32Array(u-1);p[0]=d[h];for(var m=1;m<p.length;++m)p[m]=p[m-1]+d[h+m];for(var g=Mm(o.toString()),v=f*i,y=0;y<i;++y){var b=g();l[v+y]=p.length;for(var w=0;w<p.length;w++)if(b<p[w]){l[v+y]=w;break}}}return c},t.prototype.oneHot=function(n,r,i,o){ue(n,"oneHot");var a=new Float32Array(n.size*r);a.fill(o);for(var s=this.readSync(n.dataId),u=0;u<n.size;++u)s[u]>=0&&s[u]<r&&(a[u*r+s[u]]=i);return Ea(a,[n.size,r],"int32")},t.prototype.nonMaxSuppression=function(n,r,i,o,a){return ue(n,"nonMaxSuppression"),fx(this.readSync(n.dataId),this.readSync(r.dataId),i,o,a)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,r){for(var i=n.shape[0],o=n.shape[1],a=je(n.shape,"float32"),s=je(n.shape,"float32"),u=ei(n).as2D(i,o),c=Ki(n).as2D(i,o),l=0;l<i;l++)for(var d=u.slice([l,0],[1,o]),f=c.slice([l,0],[1,o]),h=In(d,f),p=this.readSync(this.fftImpl(h,r).dataId),m=0;m<o;m++){var g=R_(p,m);a.values[l*o+m]=g.real,s.values[l*o+m]=g.imag}return In(a.toTensor(),s.toTensor()).as2D(i,o)},t.prototype.fftImpl=function(n,r){var i=n.as1D(),o=i.size;if(this.isExponentOf2(o)){var a=this.fftRadix2(i,o,r).as2D(n.shape[0],n.shape[1]);return r&&(a=In(ei(a).div(ye(o)),Ki(a).div(ye(o)))),a}var s=this.readSync(n.dataId),u=function(c){for(var l=new Float32Array(c.length/2),d=new Float32Array(c.length/2),f=0;f<c.length;f+=2)l[f/2]=c[f],d[f/2]=c[f+1];return{real:l,imag:d}}(this.fourierTransformByMatmul(s,o,r));return In(u.real,u.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,r,i){if(r===1)return n;var o=this.readSync(n.dataId),a=r/2,s=function(v){for(var y=Math.ceil(v.length/4),b=new Float32Array(y),w=new Float32Array(y),E=0;E<v.length;E+=4)b[Math.floor(E/4)]=v[E],w[Math.floor(E/4)]=v[E+1];return{real:b,imag:w}}(o),u=In(s.real,s.imag).as1D(),c=function(v){for(var y=Math.floor(v.length/4),b=new Float32Array(y),w=new Float32Array(y),E=2;E<v.length;E+=4)b[Math.floor(E/4)]=v[E],w[Math.floor(E/4)]=v[E+1];return{real:b,imag:w}}(o),l=In(c.real,c.imag).as1D();u=this.fftRadix2(u,a,i),l=this.fftRadix2(l,a,i);var d=function(v,y){for(var b=new Float32Array(v/2),w=new Float32Array(v/2),E=0;E<Math.ceil(v/2);E++){var x=(y?2:-2)*Math.PI*(E/v);b[E]=Math.cos(x),w[E]=Math.sin(x)}return{real:b,imag:w}}(r,i),f=In(d.real,d.imag).mul(l),h=u.add(f),p=u.sub(f),m=ei(h).concat(ei(p)),g=Ki(h).concat(Ki(p));return In(m,g).as1D()},t.prototype.fourierTransformByMatmul=function(n,r,i){for(var o=new Float32Array(2*r),a=0;a<r;a++){for(var s=0,u=0,c=0;c<r;c++){var l=nQ(a*c,r,i),d=R_(n,c);s+=d.real*l.real-d.imag*l.imag,u+=d.real*l.imag+d.imag*l.real}i&&(s/=r,u/=r),tQ(o,s,u,a)}return o},t.prototype.depthToSpace=function(n,r,i){W(i==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+i}),W(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var o=n.shape[0],a=n.shape[1],s=n.shape[2],u=n.shape[3],c=a*r,l=s*r,d=u/(r*r),f=this.readSync(n.dataId),h=new Float32Array(o*c*l*d),p=0,m=0;m<o;++m)for(var g=0;g<c;++g)for(var v=Math.floor(g/r),y=g%r,b=0;b<l;++b)for(var w=Math.floor(b/r),E=(y*r+b%r)*d,x=0;x<d;++x){var R=x+E+u*(w+s*(v+a*m));h[p++]=f[R]}return gr(h,[o,c,l,d])},t.prototype.broadcastedBinaryOp=function(n,r,i,o){var a=et(n.shape,r.shape),s=je(a,i),u=this.readSync(n.dataId),c=this.readSync(r.dataId),l=la(n.shape,a),d=la(r.shape,a),f=s.values;if(l.length+d.length===0)for(var h=0;h<f.length;++h)f[h]=o(u[h%u.length],c[h%c.length]);else{var p=this.bufferSync(n),m=this.bufferSync(r),g=function(v){var y=s.indexToLoc(v),b=y.slice(-n.rank);l.forEach(function(R){return b[R]=0});var w=p.locToIndex(b),E=y.slice(-r.rank);d.forEach(function(R){return E[R]=0});var x=m.locToIndex(E);f[v]=o(u[w],c[x])};for(h=0;h<f.length;++h)g(h)}return s.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,r,i){var o=et(n.shape,r.shape),a=je(o,"float32"),s=je(o,"float32"),u=this.readSync(n.dataId),c=this.readSync(r.dataId),l=la(n.shape,o),d=la(r.shape,o),f=a.values,h=s.values;if(l.length+d.length===0)for(var p=0;p<f.length;p++){var m=p%u.length,g=p%c.length,v=i(u[2*m],u[2*m+1],c[2*g],c[2*g+1]);f[p]=v.real,h[p]=v.imag}else{var y=this.bufferSync(this.data.get(n.dataId).complexTensors.real),b=this.bufferSync(this.data.get(r.dataId).complexTensors.real),w=function(E){var x=a.indexToLoc(E),R=x.slice(-n.rank);l.forEach(function(L){return R[L]=0});var S=y.locToIndex(R),_=x.slice(-r.rank);d.forEach(function(L){return _[L]=0});var T=b.locToIndex(_),B=i(u[2*S],u[2*S+1],c[2*T],c[2*T+1]);f[E]=B.real,h[E]=B.imag};for(p=0;p<f.length;p++)w(p)}return this.complex(a.toTensor(),s.toTensor())},t.prototype.split=function(n,r,i){return iD(n,r,i)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,r,i,o,a,s){for(var u=n.shape,c=u[0],l=u[1],d=u[2],f=u[3],h=r.shape[0],p=o[0],m=o[1],g=je([h,p,m,f],"float32"),v=this.readSync(r.dataId),y=this.readSync(i.dataId),b=this.readSync(n.dataId),w=n.strides,E=g.strides,x=0;x<h;x++){var R=4*x,S=v[R],_=v[R+1],T=v[R+2],B=v[R+3],L=y[x];if(!(L>=c))for(var k=p>1?(T-S)*(l-1)/(p-1):0,D=m>1?(B-_)*(d-1)/(m-1):0,F=0;F<p;F++){var M=p>1?S*(l-1)+F*k:.5*(S+T)*(l-1);if(M<0||M>l-1)for(var I=0;I<m;I++)for(var N=0;N<f;N++){var j=N+I*E[2]+F*E[1]+x*E[0];g.values[j]=s}else if(a==="bilinear"){var P=Math.floor(M),A=Math.ceil(M),U=M-P;for(I=0;I<m;I++)if((ie=m>1?_*(d-1)+I*D:.5*(_+B)*(d-1))<0||ie>d-1)for(N=0;N<f;N++)j=N+I*E[2]+F*E[1]+x*E[0],g.values[j]=s;else{var H=Math.floor(ie),q=Math.ceil(ie),Q=ie-H;for(N=0;N<f;N++){var V=b[j=N+H*w[2]+P*w[1]+L*w[0]],re=b[j=N+q*w[2]+P*w[1]+L*w[0]],Z=b[j=N+H*w[2]+A*w[1]+L*w[0]],he=V+(re-V)*Q,xe=Z+(b[j=N+q*w[2]+A*w[1]+L*w[0]]-Z)*Q;j=N+I*E[2]+F*E[1]+x*E[0],g.values[j]=he+(xe-he)*U}}}else for(I=0;I<m;++I){var ie;if((ie=m>1?_*(d-1)+I*D:.5*(_+B)*(d-1))<0||ie>d-1)for(N=0;N<f;N++)j=N+I*E[2]+F*E[1]+x*E[0],g.values[j]=s;else{var pe=Math.round(ie),ce=Math.round(M);for(N=0;N<f;N++){var Y=N+pe*w[2]+ce*w[1]+L*w[0],de=N+I*E[2]+F*E[1]+x*E[0];g.values[de]=b[Y]}}}}}return g.toTensor()},t.prototype.sparseToDense=function(n,r,i,o){var a=av(0,n,i),s=a.sliceRank,u=a.numUpdates,c=a.sliceSize,l=a.strides,d=a.outputSize;return this.scatter(n,r,i,d,c,u,s,l,o,!1)},t.prototype.gatherND=function(n,r){var i=r.shape,o=i[i.length-1],a=XN(n,r),s=a[0],u=a[1],c=a[2],l=a[3];if(u===0)return On([],s,n.dtype);for(var d=new gd([u,c],n.dtype),f=this.readSync(r.dataId),h=this.readSync(n.dataId),p=0;p<u;p++){for(var m=[],g=0,v=0;v<o;v++){var y=f[p*o+v];g+=y*l[v],m.push(y)}if(g<0||g>=n.size/c)throw new Error("Invalid indices: "+m+" does not index into "+n.shape);for(var b=0;b<c;b++)d.values[p*c+b]=h[g*c+b]}return d.toTensor().reshape(s)},t.prototype.scatterND=function(n,r,i){var o=av(0,n,i),a=o.sliceRank,s=o.numUpdates,u=o.sliceSize,c=o.strides,l=o.outputSize,d=ye(0);return this.scatter(n,r,i,l,u,s,a,c,d,!0)},t.prototype.fill=function(n,r,i){var o=Yp(i=i||nf(r),Re(n));return o.fill(r),X.makeTensor(o,n,i,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var r=Yp(n.dtype,Re(n.shape));return this.makeOutput(r,n.shape,n.dtype)},t.prototype.linspace=function(n,r,i){return nD(n,r,i)},t.prototype.scatter=function(n,r,i,o,a,s,u,c,l,d){var f=[o/a,a],h=this.readSync(n.dataId),p=this.readSync(r.dataId);if(o===0)return On([],i,r.dtype);var m=new gd(f,r.dtype);m.values.fill(this.readSync(l.dataId)[0]);for(var g=0;g<s;g++){for(var v=[],y=0,b=0;b<u;b++){var w=h[g*u+b];v.push(w),y+=w*c[b]}if(y<0||y>=o/a)throw new Error("Invalid indices: "+v+" does not index into "+i);for(var E=0;E<a;E++)d?m.values[y*a+E]+=p[g*a+E]:m.values[y*a+E]=r.rank===0?p[0]:p[g*a+E]}return m.toTensor().reshape(i)},t}(ZN);X.registerBackend("cpu",function(){return new Ete},1);for(var Q0=0,K_=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t,o=i.boxes,a=i.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,d=s.softNmsSigma,f=n;ue(o,"NonMaxSuppressionWithScore");var h=hx(f.data.get(o.dataId).values,f.data.get(a.dataId).values,u,c,l,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,i=n;ue(r,"square");for(var o=i.data.get(r.dataId).values,a=new Float32Array(o.length),s=0;s<o.length;++s){var u=o[s];a[s]=u*u}return{dataId:i.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:wd,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,i=r.a,o=r.b,a=n;ue([i,o],wd);var s=a.data.get(i.dataId).values,u=a.data.get(o.dataId).values,c=function(f,h,p,m,g,v){var y=et(f,h),b=y.length,w=no(y),E=md(g,Re(y)),x=f.length,R=h.length,S=no(f),_=no(h),T=la(f,y),B=la(h,y);if(T.length+B.length===0)for(var L=0;L<E.length;++L)E[L]=v(p[L%p.length],m[L%m.length]);else{var k=function(D){var F=NK(D,b,w),M=F.slice(-x);T.forEach(function(P){return M[P]=0});var I=y_(M,x,S),N=F.slice(-R);B.forEach(function(P){return N[P]=0});var j=y_(N,R,_);E[D]=v(p[I],m[j])};for(L=0;L<E.length;++L)k(L)}return[E,y]}(i.shape,o.shape,s,u,i.dtype,function(f,h){var p=f-h;return p*p}),l=c[0],d=c[1];return{dataId:a.write(l,d,i.dtype),shape:d,dtype:i.dtype}}}];Q0<K_.length;Q0++)RN(K_[Q0]);var cu,Ste=function(e){this.variableNames=["A"];var t=qn(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},Cte=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=qn(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var J0=0,Y_=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.pixels,o=r.numChannels,a=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,u=a?[i.videoWidth,i.videoHeight]:[i.width,i.height],c=u[0],l=u[1],d=[l,c],f=[l,c,o];(s||a)&&(cu==null&&(cu=document.createElement("canvas").getContext("2d")),cu.canvas.width=c,cu.canvas.height=l,cu.drawImage(i,0,0,c,l),i=cu.canvas);var h=n.makeTensorInfo(d,"int32");n.texData.get(h.dataId).usage=jr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),i);var p=ae().getBool("WEBGL_PACK")?new Cte(f):new Ste(f),m=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),m}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;ev("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var i=t,o=i.boxes,a=i.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,d=s.softNmsSigma,f=n,h=hx(f.readSync(o.dataId),f.readSync(a.dataId),u,c,l,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,i=n,o=new He(r.shape,"return x * x;");return i.runWebGLProgram(o,[r],r.dtype)}},{kernelName:wd,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,i=r.a,o=r.b,a=n,s=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new vo("return (a - b) * (a - b);",i.shape,o.shape):new Ut("return (a - b) * (a - b);",i.shape,o.shape);return a.compileAndRun(s,[i,o])}}];J0<Y_.length;J0++)RN(Y_[J0]);for(var Z0=0,Q_=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:wd,gradFunc:function(e,t){var n=t[0],r=t[1],i=ye(2);return{a:function(){return Yn(e,Yn(i,cn(n,r)))},b:function(){return Yn(e,Yn(i,cn(r,n)))}}}}];Z0<Q_.length;Z0++)xK(Q_[Z0]);var _te=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();ae().get("IS_BROWSER")&&ae().setPlatform("browser",new _te);var ey,kte=function(){return require("node-fetch")},Rte=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return ae().global.fetch!=null?ae().global.fetch(t,n):(ey==null&&(ey=kte()),ey(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();ae().get("IS_NODE")&&ae().setPlatform("node",new Rte);var sb={float32:4,int32:4,uint16:2,uint8:1,bool:1},hv=4;function YD(e,t){for(var n={},r=0,i=function(s){var u=s.name,c=s.dtype,l=s.shape,d=Re(l),f=void 0;if("quantization"in s){var h=s.quantization;if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var p=sb[h.dtype],m=e.slice(r,r+d*p),g=h.dtype==="uint8"?new Uint8Array(m):new Uint16Array(m);if(c==="float32")f=Float32Array.from(g,function(x){return x*h.scale+h.min});else{if(c!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+c);f=Int32Array.from(g,function(x){return Math.round(x*h.scale+h.min)})}r+=d*p}else if(c==="string"){var v=Re(s.shape);f=[];for(var y=0;y<v;y++){var b=new Uint32Array(e.slice(r,r+hv))[0];r+=hv;var w=new Uint8Array(e.slice(r,r+b));f.push(w),r+=b}}else{var E=sb[c];if(m=e.slice(r,r+d*E),c==="float32")f=new Float32Array(m);else if(c==="int32")f=new Int32Array(m);else{if(c!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+c);f=new Uint8Array(m)}r+=d*E}n[u]=On(f,l,c)},o=0,a=t;o<a.length;o++)i(a[o]);return n}function Ite(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(o){if(t+=o.byteLength,n.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+o.constructor.name)});var r=new Uint8Array(t),i=0;return n.forEach(function(o){r.set(new Uint8Array(o.buffer),i),i+=o.byteLength}),r.buffer}var ub=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function J_(e){return ub?Buffer.byteLength(e):new Blob([e]).size}function Nx(e){var t=0;e.forEach(function(i){t+=i.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(i){n.set(new Uint8Array(i),r),r+=i.byteLength}),n.buffer}function Z_(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function lf(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:J_(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:J_(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var $r=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var i=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(o){var a=o(t,r);a!==null&&i.push(a)}),i},e}(),Hu="://",Sa=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){W(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(Hu)&&(t=t.slice(0,t.indexOf(Hu))),W(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();W(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function Uh(e){if(e.indexOf(Hu)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Sa.getSchemes().join(","));return{scheme:e.split(Hu)[0],path:e.split(Hu)[1]}}function ek(e,t,n){return n===void 0&&(n=!1),_e(this,void 0,void 0,function(){var r,i,o,a,s,u,c,l,d;return ke(this,function(f){switch(f.label){case 0:return W(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),W((r=$r.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),W(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),i=r[0],W((o=$r.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),W(o.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),a=o[0],s=Uh(e).scheme,u=Uh(e).path,c=s===Uh(e).scheme,[4,i.load()];case 1:return l=f.sent(),n&&c?[4,Sa.getManager(s).removeModel(u)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,a.save(l)];case 4:return d=f.sent(),!n||c?[3,6]:[4,Sa.getManager(s).removeModel(u)];case 5:f.sent(),f.label=6;case 6:return[2,d.modelArtifactsInfo]}})})}var fs="models_store",da="model_info_store";function QD(){if(!ae().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function cb(e){var t=e.result;t.createObjectStore(fs,{keyPath:"modelPath"}),t.createObjectStore(da,{keyPath:"modelPath"})}var Gu=function(){function e(t){if(this.indexedDB=QD(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return _e(this,void 0,void 0,function(){return ke(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return _e(this,void 0,void 0,function(){return ke(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var r=this;return new Promise(function(i,o){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return cb(a)},a.onsuccess=function(){var s=a.result;if(n==null){var u=s.transaction(fs,"readonly"),c=u.objectStore(fs).get(r.modelPath);c.onsuccess=function(){if(c.result==null)return s.close(),o(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));i(c.result.modelArtifacts)},c.onerror=function(m){return s.close(),o(c.error)},u.oncomplete=function(){return s.close()}}else{var l,d=lf(n),f=s.transaction(da,"readwrite"),h=f.objectStore(da),p=h.put({modelPath:r.modelPath,modelArtifactsInfo:d});p.onsuccess=function(){var m=(l=s.transaction(fs,"readwrite")).objectStore(fs).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:d});m.onsuccess=function(){return i({modelArtifactsInfo:d})},m.onerror=function(g){var v=(h=f.objectStore(da)).delete(r.modelPath);v.onsuccess=function(){return s.close(),o(m.error)},v.onerror=function(y){return s.close(),o(m.error)}}},p.onerror=function(m){return s.close(),o(p.error)},f.oncomplete=function(){l==null?s.close():l.oncomplete=function(){return s.close()}}}},a.onerror=function(s){return o(a.error)}})},e.URL_SCHEME="indexeddb://",e}(),tk=function(e){return ae().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Gu.URL_SCHEME)?(t=e.slice(Gu.URL_SCHEME.length),new Gu(t)):null;var t};$r.registerSaveRouter(tk),$r.registerLoadRouter(tk);var Tte=function(){function e(){this.indexedDB=QD()}return e.prototype.listModels=function(){return _e(this,void 0,void 0,function(){var t=this;return ke(this,function(n){return[2,new Promise(function(r,i){var o=t.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return cb(o)},o.onsuccess=function(){var a=o.result,s=a.transaction(da,"readonly"),u=s.objectStore(da).getAll();u.onsuccess=function(){for(var c={},l=0,d=u.result;l<d.length;l++){var f=d[l];c[f.modelPath]=f.modelArtifactsInfo}r(c)},u.onerror=function(c){return a.close(),i(u.error)},s.oncomplete=function(){return a.close()}},o.onerror=function(a){return i(o.error)}})]})})},e.prototype.removeModel=function(t){return _e(this,void 0,void 0,function(){var n=this;return ke(this,function(r){var i;return t=(i=t).startsWith(Gu.URL_SCHEME)?i.slice(Gu.URL_SCHEME.length):i,[2,new Promise(function(o,a){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return cb(s)},s.onsuccess=function(){var u,c=s.result,l=c.transaction(da,"readwrite"),d=l.objectStore(da),f=d.get(t);f.onsuccess=function(){if(f.result==null)return c.close(),a(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var h=d.delete(t),p=function(){var m=(u=c.transaction(fs,"readwrite")).objectStore(fs).delete(t);m.onsuccess=function(){return o(f.result.modelArtifactsInfo)},m.onerror=function(g){return a(f.error)}};h.onsuccess=p,h.onerror=function(m){return p(),c.close(),a(f.error)}},f.onerror=function(h){return c.close(),a(f.error)},l.oncomplete=function(){u==null?c.close():u.oncomplete=function(){return c.close()}}},s.onerror=function(u){return a(s.error)}})]})})},e}();if(ae().getBool("IS_BROWSER"))try{Sa.registerManager(Gu.URL_SCHEME,new Tte)}catch{}var wo="/",mu="tensorflowjs_models",JD="info",Ote="model_topology",Pte="weight_specs",Nte="weight_data",Dte="model_metadata";function ZD(e){return{info:[mu,e,JD].join(wo),topology:[mu,e,Ote].join(wo),weightSpecs:[mu,e,Pte].join(wo),weightData:[mu,e,Nte].join(wo),modelMetadata:[mu,e,Dte].join(wo)}}function Ate(e){var t=e.split(wo);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(wo)}var qu=function(){function e(t){if(!ae().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=ZD(this.modelPath)}return e.prototype.save=function(t){return _e(this,void 0,void 0,function(){var n,r,i;return ke(this,function(o){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),i=lf(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(a){if(ub)return Buffer.from(a).toString("base64");for(var s=new Uint8Array(a),u="",c=0,l=s.length;c<l;c++)u+=String.fromCharCode(s[c]);return btoa(u)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:i}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+i.modelTopologyBytes+", weightSpecsBytes="+i.weightSpecsBytes+", weightDataBytes="+i.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return _e(this,void 0,void 0,function(){var t,n,r,i,o,a,s;return ke(this,function(u){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(i=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=i,(o=this.LS.getItem(this.keys.modelMetadata))!=null&&(a=JSON.parse(o),n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,n.userDefinedMetadata=a.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(c){if(ub){var l=Buffer.from(c,"base64");return l.buffer.slice(l.byteOffset,l.byteOffset+l.byteLength)}for(var d=atob(c),f=new Uint8Array(d.length),h=0;h<d.length;++h)f.set([d.charCodeAt(h)],h);return f.buffer}(s),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),nk=function(e){return ae().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(qu.URL_SCHEME)?(t=e.slice(qu.URL_SCHEME.length),new qu(t)):null;var t};$r.registerSaveRouter(nk),$r.registerLoadRouter(nk);var Mte=function(){function e(){W(ae().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),W(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return _e(this,void 0,void 0,function(){var t,n,r,i,o,a;return ke(this,function(s){for(t={},n=mu+wo,r=wo+JD,i=0;i<this.LS.length;++i)(o=this.LS.key(i)).startsWith(n)&&o.endsWith(r)&&(a=Ate(o),t[a]=JSON.parse(this.LS.getItem(o)));return[2,t]})})},e.prototype.removeModel=function(t){return _e(this,void 0,void 0,function(){var n,r;return ke(this,function(i){var o;if(t=(o=t).startsWith(qu.URL_SCHEME)?o.slice(qu.URL_SCHEME.length):o,n=ZD(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},e}();if(ae().getBool("IS_BROWSER"))try{Sa.registerManager(qu.URL_SCHEME,new Mte)}catch{}var Lte="model",Fte=".json",Bte=".weights.bin";function rk(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var ty=function(){function e(t){if(!ae().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=Lte),this.modelTopologyFileName=t+Fte,this.weightDataFileName=t+Bte}return e.prototype.save=function(t){return _e(this,void 0,void 0,function(){var n,r,i,o,a,s;return ke(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(a=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=o,[4,rk(function(){return a.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),t.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,rk(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:lf(t)}]}})})},e.URL_SCHEME="downloads://",e}(),jte=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return _e(this,void 0,void 0,function(){var t,n,r=this;return ke(this,function(i){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(o,a){var s=new FileReader;s.onload=function(u){var c=JSON.parse(u.target.result),l=c.modelTopology;if(l!=null){n.length===0&&o({modelTopology:l});var d=c.weightsManifest;if(d!=null){var f;try{f=r.checkManifestAndWeightFiles(d,n)}catch(g){return void a(g)}var h=[],p=[],m=[];d.forEach(function(g){g.paths.forEach(function(v){p.push(v),m.push(null)}),h.push.apply(h,g.weights)}),d.forEach(function(g){g.paths.forEach(function(v){var y=new FileReader;y.onload=function(b){var w=b.target.result,E=p.indexOf(v);m[E]=w,m.indexOf(null)===-1&&o({modelTopology:l,weightSpecs:h,weightData:Nx(m),format:c.format,generatedBy:c.generatedBy,convertedBy:c.convertedBy,userDefinedMetadata:c.userDefinedMetadata})},y.onerror=function(b){return a("Failed to weights data from file of path '"+v+"'.")},y.readAsArrayBuffer(f[v])})})}else a(new Error("weightManifest field is missing from file "+t.name))}else a(new Error("modelTopology field is missing from file "+t.name))},s.onerror=function(u){return a("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var r=[],i=n.map(function(u){return Z_(u.name)}),o={},a=0,s=t;a<s.length;a++)s[a].paths.forEach(function(u){var c=Z_(u);if(r.indexOf(c)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+c+"'");if(r.push(c),i.indexOf(c)===-1)throw new Error("Weight file with basename '"+c+"' is not provided.");o[u]=n[i.indexOf(c)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return o},e}();function ik(e,t,n,r){(function(o){W(o!=null&&Array.isArray(o)&&o.length>0,function(){return"promises must be a none empty array"})})(e),function(o,a){W(o>=0&&o<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+o}),W(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+a}),W(a>=o,function(){return"startFraction must be no more than endFraction, but got startFraction "+o+" and endFraction "+a})}(n=n??0,r=r??1);var i=0;return Promise.all(e.map(function(o){return o.then(function(a){var s=n+ ++i/e.length*(r-n);return t(s),a}),o}))}function eA(e,t){return _e(this,void 0,void 0,function(){var n,r,i,o,a,s,u,c,l;return ke(this,function(d){switch(d.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?ae().platform.fetch:t.fetchFunc,r=e.map(function(f){return n(f,t.requestInit,{isBinary:!0})}),i=0,o=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return a=d.sent(),[3,4];case 2:return[4,ik(r,t.onProgress,i,o)];case 3:a=d.sent(),d.label=4;case 4:return s=a.map(function(f){return f.arrayBuffer()}),u=.5,c=1,t.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return l=d.sent(),[3,8];case 6:return[4,ik(s,t.onProgress,u,c)];case 7:l=d.sent(),d.label=8;case 8:return[2,l]}})})}function ok(e){var t=this;return function(n,r,i){return r===void 0&&(r=""),_e(t,void 0,void 0,function(){var o,a,s,u,c,l,d,f,h,p;return ke(this,function(m){switch(m.label){case 0:if(o=n.map(function(){return!1}),a={},s=i!=null?i.map(function(){return!1}):[],u=[],n.forEach(function(g,v){var y=0;g.weights.forEach(function(b){var w="quantization"in b?b.quantization.dtype:b.dtype,E=sb[w]*Re(b.shape),x=function(){o[v]=!0,a[v]==null&&(a[v]=[]),a[v].push({manifestEntry:b,groupOffset:y,sizeBytes:E})};i!=null?i.forEach(function(R,S){R===b.name&&(x(),s[S]=!0)}):x(),u.push(b.name),y+=E})}),!s.every(function(g){return g}))throw c=i.filter(function(g,v){return!s[v]}),new Error("Could not find weights in manifest with names: "+c.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return l=o.reduce(function(g,v,y){return v&&g.push(y),g},[]),d=[],l.forEach(function(g){n[g].paths.forEach(function(v){var y=r+(r.endsWith("/")?"":"/")+v;d.push(y)})}),[4,e(d)];case 1:return f=m.sent(),h={},p=0,l.forEach(function(g){for(var v=n[g].paths.length,y=0,b=0;b<v;b++)y+=f[p+b].byteLength;for(var w=new ArrayBuffer(y),E=new Uint8Array(w),x=0,R=0;R<v;R++){var S=new Uint8Array(f[p+R]);E.set(S,x),x+=S.byteLength}a[g].forEach(function(_){var T=YD(w.slice(_.groupOffset,_.groupOffset+_.sizeBytes),[_.manifestEntry]);for(var B in T)h[B]=T[B]}),p+=v}),[2,h]}})})}}$r.registerSaveRouter(function(e){return ae().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(ty.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new ty(t)}(e.slice(ty.URL_SCHEME.length)):null});var tA=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(W(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=ae().platform.fetch,W(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&W(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return _e(this,void 0,void 0,function(){var n,r,i,o;return ke(this,function(a){switch(a.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(i)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((o=a.sent()).ok)return[2,{modelArtifactsInfo:lf(t),responses:[o]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+o.status+".")}})})},e.prototype.load=function(){return _e(this,void 0,void 0,function(){var t,n,r,i,o,a,s,u,c,l,d,f;return ke(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,t.json()];case 3:return n=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(i=n.modelTopology,o=n.weightsManifest,a=n.generatedBy,s=n.convertedBy,u=n.format,c=n.userDefinedMetadata,i==null&&o==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return o==null?[3,7]:[4,this.loadWeights(o)];case 6:f=h.sent(),l=f[0],d=f[1],h.label=7;case 7:return[2,{modelTopology:i,weightSpecs:l,weightData:d,userDefinedMetadata:c,generatedBy:a,convertedBy:s,format:u}]}})})},e.prototype.loadWeights=function(t){return _e(this,void 0,void 0,function(){var n,r,i,o,a,s,u,c,l,d,f;return ke(this,function(h){switch(h.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(p){var m=p.lastIndexOf("/"),g=p.lastIndexOf("?"),v=p.substring(0,m),y=g>m?p.substring(g):"";return[v+"/",y]}(n),i=r[0],o=r[1],a=this.weightPathPrefix||i,s=[],u=0,c=t;u<c.length;u++)l=c[u],s.push.apply(s,l.weights);return d=[],t.forEach(function(p){p.paths.forEach(function(m){d.push(a+m+o)})}),[4,eA(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=h.sent(),[2,[s,Nx(f)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function lb(e){return e.match(tA.URL_SCHEME_REGEX)!=null}var ak=function(e,t){return typeof fetch>"u"?null:(Array.isArray(e)?e.every(function(n){return lb(n)}):lb(e))?db(e,{onProgress:t}):null};function db(e,t){return new tA(e,t)}$r.registerSaveRouter(ak),$r.registerLoadRouter(ak);var ny=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return _e(this,void 0,void 0,function(){return ke(this,function(t){return[2,this.modelArtifacts]})})},e}(),$te=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return _e(this,void 0,void 0,function(){return ke(this,function(n){return[2,this.saveHandler(t)]})})},e}(),nA=Object.freeze({browserFiles:function(e){return new jte(e)},browserHTTPRequest:function(e,t){return db(e,t)},concatenateArrayBuffers:Nx,decodeWeights:YD,encodeWeights:function(e,t){return _e(this,void 0,void 0,function(){var n,r,i,o,a,s=this;return ke(this,function(u){switch(u.label){case 0:for(n=[],r=[],i=Array.isArray(e)?e.map(function(c){return c.name}):Object.keys(e),o=function(c){var l=i[c],d=Array.isArray(e)?e[c].tensor:e[l];if(d.dtype!=="float32"&&d.dtype!=="int32"&&d.dtype!=="bool"&&d.dtype!=="string")throw new Error("Unsupported dtype in weight '"+l+"': "+d.dtype);var f={name:l,shape:d.shape,dtype:d.dtype};if(d.dtype==="string"){var h=new Promise(function(p){return _e(s,void 0,void 0,function(){var m,g,v,y,b,w,E;return ke(this,function(x){switch(x.label){case 0:return[4,d.bytes()];case 1:for(m=x.sent(),g=m.reduce(function(R,S){return R+S.length},0)+hv*m.length,v=new Uint8Array(g),y=0,b=0;b<m.length;b++)w=m[b],E=new Uint8Array(new Uint32Array([w.length]).buffer),v.set(E,y),y+=hv,v.set(w,y),y+=w.length;return p(v),[2]}})})});r.push(h)}else r.push(d.data());t!=null&&(f.group=t),n.push(f)},a=0;a<i.length;++a)o(a);return[4,Promise.all(r)];case 1:return[2,{data:Ite(u.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new ny(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new ny({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new ny({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return $r.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:lf,getSaveHandlers:function(e){return $r.getSaveHandlers(e)},http:db,isHTTPScheme:lb,loadWeights:function(e,t,n,r){return t===void 0&&(t=""),_e(this,void 0,void 0,function(){return ke(this,function(i){return[2,ok(function(o){return eA(o,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return $r.registerLoadRouter(e)},registerSaveRouter:function(e){return $r.registerSaveRouter(e)},weightsLoaderFactory:ok,withSaveHandler:function(e){return new $te(e)},copyModel:function(e,t){return _e(this,void 0,void 0,function(){return ke(this,function(n){return[2,ek(e,t,!1)]})})},listModels:function(){return _e(this,void 0,void 0,function(){var e,t,n,r,i,o,a;return ke(this,function(s){switch(s.label){case 0:e=Sa.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(i=r[n],[4,Sa.getManager(i).listModels()]):[3,4];case 2:for(a in o=s.sent())t[i+Hu+a]=o[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return _e(this,void 0,void 0,function(){return ke(this,function(n){return[2,ek(e,t,!0)]})})},removeModel:function(e){return _e(this,void 0,void 0,function(){var t;return ke(this,function(n){return t=Uh(e),[2,Sa.getManager(t.scheme).removeModel(t.path)]})})}}),lu;z({confusionMatrix_:function(e,t,n){var r=$(e,"labels","confusionMatrix"),i=$(t,"predictions","confusionMatrix");W(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),W(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),W(i.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+i.rank}),W(r.shape[0]===i.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."}),W(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var o=nb(r.asType("int32"),n),a=nb(i.asType("int32"),n);return o.transpose().matMul(a).asType("int32")}});var Vte=z({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,i=!1,o=!1,a=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)o=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);a=!0}if(i&&i&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(kN("FromPixels",X.backendName)!=null)return X.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,c=i?[e.videoWidth,e.videoHeight]:[e.width,e.height],l=c[0],d=c[1];if(a?s=e.getContext("2d").getImageData(0,0,l,d).data:r||n?s=e.data:(o||i)&&(lu==null&&(lu=document.createElement("canvas").getContext("2d")),lu.canvas.width=l,lu.canvas.height=d,lu.drawImage(e,0,0,l,d),s=lu.getImageData(0,0,l,d).data),t===4)u=new Int32Array(s);else{var f=l*d;u=new Int32Array(f*t);for(var h=0;h<f;h++)for(var p=0;p<t;++p)u[h*t+p]=s[4*h+p]}return sx(u,[d,l,t],"int32")}}),Dx=Object.freeze({toPixels:function(e,t){return _e(this,void 0,void 0,function(){var n,r,i,o,a,s,u,c,l,d,f,h,p,m,g,v,y,b,w,E,x,R,S;return ke(this,function(_){switch(_.label){case 0:if(n=$(e,"img","toPixels"),e instanceof Lt||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],o=r[1],(a=n.rank===2?1:n.shape[2])>4||a===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=_.sent(),u=n.min(),c=n.max(),[4,Promise.all([u.data(),c.data()])];case 2:if(l=_.sent(),d=l[0],f=l[1],h=d[0],p=f[0],u.dispose(),c.dispose(),n.dtype==="float32"){if(h<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+p+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+p+"].")}for(m=n.dtype==="float32"?255:1,g=new Uint8ClampedArray(o*i*4),v=0;v<i*o;++v)y=void 0,b=void 0,w=void 0,E=void 0,a===1?(y=s[v]*m,b=s[v]*m,w=s[v]*m,E=255):a===3?(y=s[3*v]*m,b=s[3*v+1]*m,w=s[3*v+2]*m,E=255):a===4&&(y=s[4*v]*m,b=s[4*v+1]*m,w=s[4*v+2]*m,E=s[4*v+3]*m),g[(x=4*v)+0]=Math.round(y),g[x+1]=Math.round(b),g[x+2]=Math.round(w),g[x+3]=Math.round(E);return t!=null&&(t.width=o,t.height=i,R=t.getContext("2d"),S=new ImageData(g,o,i),R.putImageData(S,0,0)),n!==e&&n.dispose(),[2,g]}})})},fromPixels:Vte}),Wte=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),Ute=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function Hs(e){W(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),W(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),W(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),Ute.register(e)}var Gs=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ni(t,e),t.prototype.minimize=function(n,r,i){r===void 0&&(r=!1);var o=this.computeGradients(n,i),a=o.value,s=o.grads;if(i!=null){var u=i.map(function(c){return{name:c.name,tensor:s[c.name]}});this.applyGradients(u)}else this.applyGradients(s);return Rr(s),r?a:(a.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,r){return ZY(n,r)},t.prototype.dispose=function(){this.iterations_!=null&&Rr(this.iterations_)},t.prototype.saveIterations=function(){return _e(this,void 0,void 0,function(){return ke(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:ye(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return _e(this,void 0,void 0,function(){return ke(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return _e(this,void 0,void 0,function(){return ke(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return _e(this,void 0,void 0,function(){var r;return ke(this,function(i){switch(i.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=i.sent()[0],[2,n.slice(1)]}})})},t}(Wte);Object.defineProperty(Gs,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var zte=function(e){function t(n,r,i){i===void 0&&(i=null);var o=e.call(this)||this;return o.learningRate=n,o.rho=r,o.epsilon=i,o.accumulatedGrads=[],o.accumulatedUpdates=[],i==null&&(o.epsilon=X.backend.epsilon()),o}return Ni(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,o){var a=X.registeredVariables[i];r.accumulatedGrads[o]==null&&(r.accumulatedGrads[o]={originalName:i+"/accum_grad",variable:Se(function(){return rt(a).variable(!1)})}),r.accumulatedUpdates[o]==null&&(r.accumulatedUpdates[o]={originalName:i+"/accum_var",variable:Se(function(){return rt(a).variable(!1)})});var s=Array.isArray(n)?n[o].tensor:n[i];if(s!=null){var u=r.accumulatedGrads[o].variable,c=r.accumulatedUpdates[o].variable;Se(function(){var l=u.mul(r.rho).add(s.square().mul(1-r.rho)),d=c.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),f=c.mul(r.rho).add(d.square().mul(1-r.rho));u.assign(l),c.assign(f);var h=d.mul(-r.learningRate).add(a);a.assign(h)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Rr(this.accumulatedGrads.map(function(n){return n.variable})),Rr(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return _e(this,void 0,void 0,function(){var n;return ke(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return _e(this,void 0,void 0,function(){var r;return ke(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(Gs);Hs(zte);var Hte=function(e){function t(n,r){r===void 0&&(r=.1);var i=e.call(this)||this;return i.learningRate=n,i.initialAccumulatorValue=r,i.accumulatedGrads=[],i}return Ni(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,o){var a=X.registeredVariables[i];r.accumulatedGrads[o]==null&&(r.accumulatedGrads[o]={originalName:i+"/accumulator",variable:Se(function(){return ro(a.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[o].tensor:n[i];if(s!=null){var u=r.accumulatedGrads[o].variable;Se(function(){var c=u.add(s.square());u.assign(c);var l=s.div(c.add(X.backend.epsilon()).sqrt()).mul(-r.learningRate).add(a);a.assign(l)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&Rr(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return _e(this,void 0,void 0,function(){return ke(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return _e(this,void 0,void 0,function(){return ke(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(Gs);Hs(Hte);var Gte=function(e){function t(n,r,i,o){o===void 0&&(o=null);var a=e.call(this)||this;return a.learningRate=n,a.beta1=r,a.beta2=i,a.epsilon=o,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],Se(function(){a.accBeta1=ye(r).variable(),a.accBeta2=ye(i).variable()}),o==null&&(a.epsilon=X.backend.epsilon()),a}return Ni(t,e),t.prototype.applyGradients=function(n){var r=this,i=Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n);Se(function(){var o=cn(1,r.accBeta1),a=cn(1,r.accBeta2);i.forEach(function(s,u){var c=X.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:Se(function(){return rt(c).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:Se(function(){return rt(c).variable(!1)})});var l=Array.isArray(n)?n[u].tensor:n[s];if(l!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedSecondMoment[u].variable,h=d.mul(r.beta1).add(l.mul(1-r.beta1)),p=f.mul(r.beta2).add(l.square().mul(1-r.beta2)),m=h.div(o),g=p.div(a);d.assign(h),f.assign(p);var v=m.div(g.sqrt().add(r.epsilon)).mul(-r.learningRate).add(c);c.assign(v)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Rr(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&Rr(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return _e(this,void 0,void 0,function(){var n;return ke(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return _e(this,void 0,void 0,function(){var r,i=this;return ke(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),Se(function(){i.accBeta1.assign(dv(i.beta1,i.iterations_+1)),i.accBeta2.assign(dv(i.beta2,i.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(Gs);Hs(Gte);var qte=function(e){function t(n,r,i,o,a){o===void 0&&(o=null),a===void 0&&(a=0);var s=e.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=i,s.epsilon=o,s.decay=a,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],Se(function(){s.iteration=ye(0).variable(),s.accBeta1=ye(r).variable()}),o==null&&(s.epsilon=X.backend.epsilon()),s}return Ni(t,e),t.prototype.applyGradients=function(n){var r=this,i=Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n);Se(function(){var o=cn(1,r.accBeta1),a=wi(-r.learningRate,r.iteration.mul(r.decay).add(1));i.forEach(function(s,u){var c=X.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:rt(c).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:rt(c).variable(!1)});var l=Array.isArray(n)?n[u].tensor:n[s];if(l!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedWeightedInfNorm[u].variable,h=d.mul(r.beta1).add(l.mul(1-r.beta1)),p=f.mul(r.beta2),m=l.abs(),g=p.maximum(m);d.assign(h),f.assign(g);var v=a.div(o).mul(h.div(g.add(r.epsilon))).add(c);c.assign(v)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Rr(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&Rr(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return _e(this,void 0,void 0,function(){return ke(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return _e(this,void 0,void 0,function(){return ke(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(Gs);Hs(qte);var rA=function(e){function t(n){var r=e.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return Ni(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,o){var a=Array.isArray(n)?n[o].tensor:n[i];if(a!=null){var s=X.registeredVariables[i];Se(function(){var u=r.c.mul(a).add(s);s.assign(u)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=hY(ye(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return _e(this,void 0,void 0,function(){return ke(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return _e(this,void 0,void 0,function(){return ke(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,r){return new n(r.learningRate)},t.className="SGD",t}(Gs);Hs(rA);var Xte=function(e){function t(n,r,i){i===void 0&&(i=!1);var o=e.call(this,n)||this;return o.learningRate=n,o.momentum=r,o.useNesterov=i,o.accumulations=[],o.m=ye(o.momentum),o}return Ni(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,o){var a=X.registeredVariables[i];r.accumulations[o]==null&&(r.accumulations[o]={originalName:i+"/momentum",variable:Se(function(){return rt(a).variable(!1)})});var s=r.accumulations[o].variable,u=Array.isArray(n)?n[o].tensor:n[i];u!=null&&Se(function(){var c,l=r.m.mul(s).add(u);c=r.useNesterov?r.c.mul(u.add(l.mul(r.m))).add(a):r.c.mul(l).add(a),s.assign(l),a.assign(c)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Rr(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return _e(this,void 0,void 0,function(){return ke(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return _e(this,void 0,void 0,function(){return ke(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(rA);Hs(Xte);var Kte=function(e){function t(n,r,i,o,a){r===void 0&&(r=.9),i===void 0&&(i=0),o===void 0&&(o=null),a===void 0&&(a=!1);var s=e.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=i,s.epsilon=o,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=a,o==null&&(s.epsilon=X.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return Ni(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,o){var a=X.registeredVariables[i];r.accumulatedMeanSquares[o]==null&&(r.accumulatedMeanSquares[o]={originalName:i+"/rms",variable:Se(function(){return rt(a).variable(!1)})}),r.accumulatedMoments[o]==null&&(r.accumulatedMoments[o]={originalName:i+"/momentum",variable:Se(function(){return rt(a).variable(!1)})}),r.accumulatedMeanGrads[o]==null&&r.centered&&(r.accumulatedMeanGrads[o]={originalName:i+"/mg",variable:Se(function(){return rt(a).variable(!1)})});var s=Array.isArray(n)?n[o].tensor:n[i];if(s!=null){var u=r.accumulatedMeanSquares[o].variable,c=r.accumulatedMoments[o].variable;Se(function(){var l=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var d=r.accumulatedMeanGrads[o].variable,f=d.mul(r.decay).add(s.mul(1-r.decay)),h=c.mul(r.momentum).add(s.mul(r.learningRate).div(l.sub(f.square().add(r.epsilon)).sqrt()));u.assign(l),d.assign(f),c.assign(h);var p=a.sub(h);a.assign(p)}else{var m=u.mul(r.decay).add(s.square().mul(1-r.decay));h=c.mul(r.momentum).add(s.mul(r.learningRate).div(m.add(r.epsilon).sqrt())),u.assign(m),c.assign(h),p=a.sub(h),a.assign(p)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Rr(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Rr(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&Rr(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return _e(this,void 0,void 0,function(){var n;return ke(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return _e(this,void 0,void 0,function(){var r;return ke(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(Gs);Hs(Kte);Lt.prototype.squaredDifference=function(e){return yD(this,e)},ne=xte;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var fb=function(e,t){return fb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},fb(e,t)};function Be(e,t){fb(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Hn=function(){return Hn=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Hn.apply(this,arguments)};function Te(e,t,n,r){function i(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function s(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?o(l.value):i(l.value).then(s,u)}c((r=r.apply(e,[])).next())})}function Oe(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(l){return u([c,l])}}function u(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=t.call(e,n)}catch(l){c=[6,l],i=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function $l(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var ws=function(){function e(t,n){if(!xs(t)||!xs(n))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:n}));this._width=t,this._height=n}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function Um(e,t){return e instanceof Lt&&e.shape.length===t}function Yte(e){return Um(e,2)}function zm(e){return Um(e,3)}function Ca(e){return Um(e,4)}function Qte(e){return e%1!==0}function sk(e){return e%2===0}function Jte(e,t){t===void 0&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}function uk(e){return e&&e.width&&e.height}function Zte(e,t){var n=e.width,r=e.height,i=t/Math.max(r,n);return new ws(Math.round(n*i),Math.round(r*i))}function Ax(e){return e.reduce(function(t,n){return t.add(n)},new ut(0,0)).div(new ut(e.length,e.length))}function xd(e,t,n){return Array(e).fill(0).map(function(r,i){return t+i*n})}function xs(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||e===0}function ck(e){return xs(e)&&0<=e&&e<=1}var ut=function(){function e(t,n){this._x=t,this._y=n}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),Na=function(){function e(t,n){n===void 0&&(n=!0);var r=t||{},i=[r.left,r.top,r.right,r.bottom].every(xs),o=[r.x,r.y,r.width,r.height].every(xs);if(!o&&!i)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=o?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],c=a[2],l=a[3];e.assertIsValidBox({x:s,y:u,width:c,height:l},"Box.constructor",n),this._x=s,this._y=u,this._width=c,this._height=l}return e.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(xs)},e.assertIsValidBox=function(t,n,r){if(r===void 0&&(r=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new ut(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new ut(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new ut(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new ut(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(a){return Math.round(a)}),n=t[0],r=t[1],i=t[2],o=t[3];return new e({x:n,y:r,width:i,height:o})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(a){return Math.floor(a)}),n=t[0],r=t[1],i=t[2],o=t[3];return new e({x:n,y:r,width:i,height:o})},e.prototype.toSquare=function(){var t=this,n=t.x,r=t.y,i=t.width,o=t.height,a=Math.abs(i-o);return i<o&&(n-=a/2,i+=a),o<i&&(r-=a/2,o+=a),new e({x:n,y:r,width:i,height:o})},e.prototype.rescale=function(t){var n=uk(t)?t.width:t,r=uk(t)?t.height:t;return new e({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},e.prototype.pad=function(t,n){var r=[this.x-t/2,this.y-n/2,this.width+t,this.height+n],i=r[0],o=r[1],a=r[2],s=r[3];return new e({x:i,y:o,width:a,height:s})},e.prototype.clipAtImageBorders=function(t,n){var r=this,i=r.x,o=r.y,a=r.right,s=r.bottom,u=Math.max(i,0),c=Math.max(o,0),l=a-u,d=s-c,f=Math.min(l,t-u),h=Math.min(d,n-c);return new e({x:u,y:c,width:f,height:h}).floor()},e.prototype.shift=function(t,n){var r=this,i=r.width,o=r.height,a=this.x+t,s=this.y+n;return new e({x:a,y:s,width:i,height:o})},e.prototype.padAtBorders=function(t,n){var r=this.width+1,i=this.height+1,o=1,a=1,s=r,u=i,c=this.left,l=this.top,d=this.right,f=this.bottom;return d>n&&(s=-d+n+r,d=n),f>t&&(u=-f+t+i,f=t),c<1&&(u=2-c,c=1),l<1&&(u=2-l,l=1),{dy:a,edy:u,dx:o,edx:s,y:l,ey:f,x:c,ex:d,w:r,h:i}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),Hm=function(e){Be(t,e);function t(n,r,i,o,a){return a===void 0&&(a=!1),e.call(this,{left:n,top:r,right:i,bottom:o},a)||this}return t}(Na),iA=function(){function e(t,n,r,i,o){this._imageDims=new ws(o.width,o.height),this._score=t,this._classScore=n,this._className=r,this._box=new Na(i).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new Na(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),Ai=function(e){Be(t,e);function t(n,r,i){return e.call(this,n,n,"",r,i)||this}return t.prototype.forSize=function(n,r){var i=e.prototype.forSize.call(this,n,r),o=i.score,a=i.relativeBox,s=i.imageDims;return new t(o,a,s)},t}(iA);function ene(e,t,n){n===void 0&&(n=!0);var r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),i=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),o=r*i;return n?o/(e.area+t.area-o):o/Math.min(e.area,t.area)}function tne(e){var t=e.map(function(s){return s.x}),n=e.map(function(s){return s.y}),r=t.reduce(function(s,u){return u<s?u:s},1/0),i=n.reduce(function(s,u){return u<s?u:s},1/0),o=t.reduce(function(s,u){return s<u?u:s},0),a=n.reduce(function(s,u){return s<u?u:s},0);return new Hm(r,i,o,a)}function Ed(e,t,n,r){r===void 0&&(r=!0);for(var i=t.map(function(s,u){return{score:s,boxIndex:u}}).sort(function(s,u){return s.score-u.score}).map(function(s){return s.boxIndex}),o=[],a=function(){var s=i.pop();o.push(s);for(var u=i,c=[],l=0;l<u.length;l++){var d=u[l],f=e[s],h=e[d];c.push(ene(f,h,r))}i=i.filter(function(p,m){return c[m]<=n})};i.length>0;)a();return o}function df(e,t){return Se(function(){var n=t[0],r=t[1],i=t[2],o=ro($l(e.shape.slice(0,3),[1]),n),a=ro($l(e.shape.slice(0,3),[1]),r),s=ro($l(e.shape.slice(0,3),[1]),i),u=an([o,a,s],3);return cn(e,u)})}function nne(e,t){return t===void 0&&(t=!1),Se(function(){var n=e.shape.slice(1),r=n[0],i=n[1];if(r===i)return e;var o=Math.abs(r-i),a=Math.round(o*(t?.5:1)),s=r>i?2:1,u=function(h){var p=e.shape.slice();return p[s]=h,ro(p,0)},c=u(a),l=o-c.shape[s],d=t&&l?u(l):null,f=[d,e,c].filter(function(h){return!!h}).map(function(h){return h.toFloat()});return an(f,s)})}function ry(e){return 1/(1+Math.exp(-e))}var Mx=function(e){Be(t,e);function t(n,r,i,o,a){return a===void 0&&(a=!1),e.call(this,{x:n,y:r,width:i,height:o},a)||this}return t}(Na),rne=.5,ine=.43,one=.45,Sd=function(){function e(t,n,r){r===void 0&&(r=new ut(0,0));var i=n.width,o=n.height;this._imgDims=new ws(i,o),this._shift=r,this._positions=t.map(function(a){return a.mul(new ut(i,o)).add(r)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new ut(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(n){return n.sub(t._shift).div(new ut(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new this.constructor(this.relativePositions,{width:t,height:n})},e.prototype.shiftBy=function(t,n){return new this.constructor(this.relativePositions,this._imgDims,new ut(t,n))},e.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},e.prototype.align=function(t,n){if(n===void 0&&(n={}),t){var r=t instanceof Ai?t.box.floor():new Na(t);return this.shiftBy(r.x,r.y).align(null,n)}var i=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},n),o=i.useDlibAlignment,a=i.minBoxPadding;return o?this.alignDlib():this.alignMinBbox(a)},e.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),n=t[0],r=t[1],i=t[2],o=function(d){return i.sub(d).magnitude()},a=(o(n)+o(r))/2,s=Math.floor(a/one),u=Ax(t),c=Math.floor(Math.max(0,u.x-rne*s)),l=Math.floor(Math.max(0,u.y-ine*s));return new Mx(c,l,Math.min(s,this.imageWidth+c),Math.min(s,this.imageHeight+l))},e.prototype.alignMinBbox=function(t){var n=tne(this.positions);return n.pad(n.width*t,n.height*t)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),ane=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var n=this.positions;return[n[0],n[1],Ax([n[3],n[4]])]},t}(Sd),sne=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(Ax)},t}(Sd),lk=function(){function e(t,n){this._label=t,this._distance=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+Jte(this.distance)+")":"")},e}(),dk=function(e){Be(t,e);function t(n,r){var i=e.call(this,n)||this;return i._label=r,i}return t.assertIsValidLabeledBox=function(n,r){if(Na.assertIsValidBox(n,r),!xs(n.label))throw new Error(r+" - expected property label ("+n.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(Na),ph=function(){function e(t,n){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},e.fromJSON=function(t){var n=t.descriptors.map(function(r){return new Float32Array(r)});return new e(t.label,n)},e}();(function(e){Be(t,e);function t(n,r,i,o){var a=e.call(this,n,r)||this;return a._score=i,a._classScore=o,a}return t.assertIsValidPredictedBox=function(n,r){if(dk.assertIsValidLabeledBox(n,r),!ck(n.score)||!ck(n.classScore))throw new Error(r+" - expected properties score ("+n.score+") and ("+n.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(dk);function oA(e){return e.detection instanceof Ai}function Cd(e,t){var n={detection:t};return Object.assign({},e,n)}function aA(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:t}}function sA(e){var t="";if(!e)try{e=require("fs")}catch(r){t=r.toString()}var n=e?function(r){return new Promise(function(i,o){e.readFile(r,function(a,s){return a?o(a):i(s)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:n}}function uA(){var e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},i=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},o=sA();return Hn({Canvas:e||function(){function a(){}return a}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function a(){}return a}(),Image:t||function(){function a(){}return a}(),ImageData:global.ImageData||function(){function a(){}return a}(),Video:global.HTMLVideoElement||function(){function a(){}return a}(),createCanvasElement:n,createImageElement:r,fetch:i},o)}function cA(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function lA(){return typeof global=="object"&&typeof require=="function"&&typeof ZA<"u"&&typeof process<"u"&&!!process.version}var nn;function une(){if(!nn)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return nn}function hb(e){nn=e}function Lx(){cA()&&hb(aA()),lA()&&hb(uA())}function cne(e){if(nn||Lx(),!nn)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=t===void 0?nn.Canvas:t,r=e.Image,i=r===void 0?nn.Image:r;nn.Canvas=n,nn.Image=i,nn.createCanvasElement=e.createCanvasElement||function(){return new n},nn.createImageElement=e.createImageElement||function(){return new i},nn.ImageData=e.ImageData||nn.ImageData,nn.Video=e.Video||nn.Video,nn.fetch=e.fetch||nn.fetch,nn.readFile=e.readFile||nn.readFile}var Zn={getEnv:une,setEnv:hb,initialize:Lx,createBrowserEnv:aA,createFileSystem:sA,createNodejsEnv:uA,monkeyPatch:cne,isBrowser:cA,isNodejs:lA};Lx();function dA(e){return!Zn.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function As(e){var t=Zn.getEnv(),n=t.Canvas,r=t.CanvasRenderingContext2D;if(e instanceof r)return e;var i=dA(e);if(!(i instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var o=i.getContext("2d");if(!o)throw new Error("resolveContext2d - canvas 2d context is null");return o}var fk;(function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"})(fk||(fk={}));function fA(e){var t=Zn.getEnv(),n=t.Image,r=t.Video;return e instanceof n&&e.complete||e instanceof r&&e.readyState>=3}function lne(e){return new Promise(function(t,n){if(e instanceof Zn.getEnv().Canvas||fA(e))return t();function r(o){o.currentTarget&&(o.currentTarget.removeEventListener("load",r),o.currentTarget.removeEventListener("error",i),t(o))}function i(o){o.currentTarget&&(o.currentTarget.removeEventListener("load",r),o.currentTarget.removeEventListener("error",i),n(o))}e.addEventListener("load",r),e.addEventListener("error",i)})}function Fx(e){var t=Zn.getEnv(),n=t.Image,r=t.Video;return e instanceof n?new ws(e.naturalWidth,e.naturalHeight):e instanceof r?new ws(e.videoWidth,e.videoHeight):new ws(e.width,e.height)}function Gm(e){var t=e.width,n=e.height,r=Zn.getEnv().createCanvasElement,i=r();return i.width=t,i.height=n,i}function Bx(e,t){var n=Zn.getEnv().ImageData;if(!(e instanceof n)&&!fA(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=Fx(e),i=r.width,o=r.height,a=Gm({width:i,height:o});return e instanceof n?As(a).putImageData(e,0,0):As(a).drawImage(e,0,0,i,o),a}function dne(e,t){return Te(this,void 0,void 0,function(){var n,r,i,o,a,s;return Oe(this,function(u){switch(u.label){case 0:return n=Zn.getEnv().createCanvasElement(),r=e.shape.slice(Ca(e)?1:0),i=r[0],o=r[1],a=r[2],s=Se(function(){return e.as3D(i,o,a).toInt()}),[4,Dx.toPixels(s,n)];case 1:return u.sent(),s.dispose(),[2,n]}})})}function hk(e){var t=Zn.getEnv(),n=t.Image,r=t.Canvas,i=t.Video;return e instanceof n||e instanceof r||e instanceof i}function fne(e,t,n){n===void 0&&(n=!1);var r=Zn.getEnv(),i=r.Image,o=r.Canvas;if(!(e instanceof i||e instanceof o))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=Fx(e),s=t/Math.max(a.height,a.width),u=s*a.width,c=s*a.height,l=Gm({width:t,height:t}),d=e instanceof o?e:Bx(e),f=Math.abs(u-c)/2,h=n&&u<c?f:0,p=n&&c<u?f:0;return As(l).drawImage(d,h,p,u,c),l}var pv=function(){function e(t,n){var r=this;if(n===void 0&&(n=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=n,this._batchSize=t.length,t.forEach(function(i,o){if(zm(i)){r._imageTensors[o]=i,r._inputDimensions[o]=i.shape;return}if(Ca(i)){var a=i.shape[0];if(a!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+a+" passed, but not supported in input array");r._imageTensors[o]=i,r._inputDimensions[o]=i.shape.slice(1);return}var s=i instanceof Zn.getEnv().Canvas?i:Bx(i);r._canvases[o]=s,r._inputDimensions[o]=[s.height,s.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var t=this;return xd(this.batchSize,0,1).map(function(n,r){return t.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},e.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},e.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},e.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},e.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var n=this.getInputWidth(t),r=this.getInputHeight(t);return Zte({width:n,height:r},this.inputSize)},e.prototype.toBatchTensor=function(t,n){var r=this;return n===void 0&&(n=!0),this._inputSize=t,Se(function(){var i=xd(r.batchSize,0,1).map(function(a){var s=r.getInput(a);if(s instanceof Lt){var u=Ca(s)?s:s.expandDims();return u=nne(u,n),(u.shape[1]!==t||u.shape[2]!==t)&&(u=Rx.resizeBilinear(u,[t,t])),u.as3D(t,t,3)}if(s instanceof Zn.getEnv().Canvas)return Dx.fromPixels(fne(s,t,n));throw new Error("toBatchTensor - at batchIdx "+a+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+s)}),o=zr(i.map(function(a){return a.toFloat()})).as4D(r.batchSize,t,t,3);return o})},e}();function wn(e){return Te(this,void 0,void 0,function(){var t,n,r;return Oe(this,function(i){switch(i.label){case 0:if(e instanceof pv)return[2,e];if(t=Array.isArray(e)?e:[e],!t.length)throw new Error("toNetInput - empty array passed as input");return n=function(o){return Array.isArray(e)?" at input index "+o+":":""},r=t.map(dA),r.forEach(function(o,a){if(!hk(o)&&!zm(o)&&!Ca(o))throw typeof t[a]=="string"?new Error("toNetInput -"+n(a)+" string passed, but could not resolve HTMLElement for element id "+t[a]):new Error("toNetInput -"+n(a)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Ca(o)){var s=o.shape[0];if(s!==1)throw new Error("toNetInput -"+n(a)+" tf.Tensor4D with batchSize "+s+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(o){return hk(o)&&lne(o)}))];case 1:return i.sent(),[2,new pv(r,Array.isArray(e))]}})})}function jx(e,t){return Te(this,void 0,void 0,function(){var n,r,i,o,a,s,u;return Oe(this,function(c){switch(c.label){case 0:return n=Zn.getEnv().Canvas,r=e,e instanceof n?[3,5]:[4,wn(e)];case 1:if(i=c.sent(),i.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return o=i.getInput(0),o instanceof n?(a=o,[3,4]):[3,2];case 2:return[4,dne(o)];case 3:a=c.sent(),c.label=4;case 4:r=a,c.label=5;case 5:return s=As(r),u=t.map(function(l){return l instanceof Ai?l.forSize(r.width,r.height).box.floor():l}).map(function(l){return l.clipAtImageBorders(r.width,r.height)}),[2,u.map(function(l){var d=l.x,f=l.y,h=l.width,p=l.height,m=Gm({width:h,height:p});return As(m).putImageData(s.getImageData(d,f,h,p),0,0),m})]}})})}function $x(e,t){return Te(this,void 0,void 0,function(){return Oe(this,function(n){if(!zm(e)&&!Ca(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Ca(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,Se(function(){var r=e.shape.slice(Ca(e)?1:0),i=r[0],o=r[1],a=r[2],s=t.map(function(c){return c instanceof Ai?c.forSize(o,i).box:c}).map(function(c){return c.clipAtImageBorders(o,i)}),u=s.map(function(c){var l=c.x,d=c.y,f=c.width,h=c.height;return jD(e.as3D(i,o,a),[d,l,0],[h,f,a])});return u})]})})}function hne(e,t){return Te(this,void 0,void 0,function(){var n,r;return Oe(this,function(i){switch(i.label){case 0:return n=Zn.getEnv().fetch,[4,n(e,t)];case 1:if(r=i.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function pne(e){return Te(this,void 0,void 0,function(){return Oe(this,function(t){switch(t.label){case 0:return[4,hne(e)];case 1:return[2,t.sent().json()]}})})}function hA(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if(e==="/")return{modelBaseUri:"/",manifestUri:"/"+n};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(r,"");var i=e.split("/").filter(function(s){return s}),o=e.endsWith(".json")?i[i.length-1]:n,a=r+(e.endsWith(".json")?i.slice(0,i.length-1):i).join("/");return a=e.startsWith("/")?"/"+a:a,{modelBaseUri:a,manifestUri:a==="/"?"/"+o:a+"/"+o}}function vne(e,t){return Te(this,void 0,void 0,function(){var n,r,i,o;return Oe(this,function(a){switch(a.label){case 0:return n=hA(e,t),r=n.manifestUri,i=n.modelBaseUri,[4,pne(r)];case 1:return o=a.sent(),[2,nA.loadWeights(o,i)]}})})}function mne(e,t,n){var r=Fx(t),i=r.width,o=r.height;return e.width=i,e.height=o,{width:i,height:o}}var Bo=function(){function e(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(t){var n=this.traversePropertyPath(t),r=n.obj,i=n.objProp;return r[i]},e.prototype.reassignParamFromPath=function(t,n){var r=this.traversePropertyPath(t),i=r.obj,o=r.objProp;i[o].dispose(),i[o]=n},e.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(n){var r=n.paramPath;return{path:r,tensor:t.getParamFromPath(r)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof gc})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof gc)})},e.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(n){var r=n.path,i=n.tensor;t.reassignParamFromPath(r,i.variable())})},e.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(n){var r=n.path,i=n.tensor,o=On(i.dataSync());i.dispose(),t.reassignParamFromPath(r,o)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(n){if(t&&n.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+n.path);n.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var n=t.tensor;return Array.from(n.dataSync())}).reduce(function(t,n){return t.concat(n)}))},e.prototype.load=function(t){return Te(this,void 0,void 0,function(){return Oe(this,function(n){switch(n.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return n.sent(),[2]}})})},e.prototype.loadFromUri=function(t){return Te(this,void 0,void 0,function(){var n;return Oe(this,function(r){switch(r.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,vne(t,this.getDefaultModelName())];case 1:return n=r.sent(),this.loadFromWeightMap(n),[2]}})})},e.prototype.loadFromDisk=function(t){return Te(this,void 0,void 0,function(){var n,r,i,o,a,s,u,c,l,d;return Oe(this,function(f){switch(f.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return n=Zn.getEnv().readFile,r=hA(t,this.getDefaultModelName()),i=r.manifestUri,o=r.modelBaseUri,a=function(h){return Promise.all(h.map(function(p){return n(p).then(function(m){return m.buffer})}))},s=nA.weightsLoaderFactory(a),l=(c=JSON).parse,[4,n(i)];case 1:return u=l.apply(c,[f.sent().toString()]),[4,s(u,o)];case 2:return d=f.sent(),this.loadFromWeightMap(d),[2]}})})},e.prototype.loadFromWeightMap=function(t){var n=this.extractParamsFromWeigthMap(t),r=n.paramMappings,i=n.params;this._paramMappings=r,this._params=i},e.prototype.extractWeights=function(t){var n=this.extractParams(t),r=n.paramMappings,i=n.params;this._paramMappings=r,this._params=i},e.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var n=t.split("/").reduce(function(o,a){if(!o.nextObj.hasOwnProperty(a))throw new Error("traversePropertyPath - object does not have property "+a+", for path "+t);return{obj:o.nextObj,objProp:a,nextObj:o.nextObj[a]}},{nextObj:this.params}),r=n.obj,i=n.objProp;if(!r||!i||!(r[i]instanceof Lt))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:r,objProp:i}},e}();function Vr(e,t,n){return Se(function(){var r=Ex(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=Ke(r,t.bias),r})}function iy(e,t,n){return n===void 0&&(n=!1),Se(function(){var r=Ft(n?Ke(di(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):Vr(e,t.conv0,[2,2])),i=Vr(r,t.conv1,[1,1]),o=Ft(Ke(r,i)),a=Vr(o,t.conv2,[1,1]);return Ft(Ke(r,Ke(i,a)))})}function vh(e,t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!0),Se(function(){var i=Ft(n?Ke(di(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):Vr(e,t.conv0,r?[2,2]:[1,1])),o=Vr(i,t.conv1,[1,1]),a=Ft(Ke(i,o)),s=Vr(a,t.conv2,[1,1]),u=Ft(Ke(i,Ke(o,s))),c=Vr(u,t.conv3,[1,1]);return Ft(Ke(i,Ke(o,Ke(s,c))))})}function ki(e,t,n,r){return n===void 0&&(n="same"),r===void 0&&(r=!1),Se(function(){var i=Ke(di(e,t.filters,[1,1],n),t.bias);return r?Ft(i):i})}function jo(e,t){Object.keys(e).forEach(function(n){t.some(function(r){return r.originalPath===n})||e[n].dispose()})}function qm(e,t){return function(n,r,i,o){var a=gr(e(n*r*i*i),[i,i,n,r]),s=tn(e(r));return t.push({paramPath:o+"/filters"},{paramPath:o+"/bias"}),{filters:a,bias:s}}}function Vx(e,t){return function(n,r,i){var o=Ea(e(n*r),[n,r]),a=tn(e(r));return t.push({paramPath:i+"/weights"},{paramPath:i+"/bias"}),{weights:o,bias:a}}}var pA=function(){function e(t,n,r){this.depthwise_filter=t,this.pointwise_filter=n,this.bias=r}return e}();function Wx(e,t){return function(n,r,i){var o=gr(e(9*n),[3,3,n,1]),a=gr(e(n*r),[1,1,n,r]),s=tn(e(r));return t.push({paramPath:i+"/depthwise_filter"},{paramPath:i+"/pointwise_filter"},{paramPath:i+"/bias"}),new pA(o,a,s)}}function Ux(e){return function(t){var n=e(t+"/depthwise_filter",4),r=e(t+"/pointwise_filter",4),i=e(t+"/bias",1);return new pA(n,r,i)}}function Wa(e,t){return function(n,r,i){var o=e[n];if(!Um(o,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+o);return t.push({originalPath:n,paramPath:i||n}),o}}function $o(e){var t=e;function n(i){var o=t.slice(0,i);return t=t.slice(i),o}function r(){return t}return{extractWeights:n,getRemainingWeights:r}}function vA(e,t){var n=qm(e,t),r=Wx(e,t);function i(a,s,u,c){c===void 0&&(c=!1);var l=c?n(a,s,3,u+"/conv0"):r(a,s,u+"/conv0"),d=r(s,s,u+"/conv1"),f=r(s,s,u+"/conv2");return{conv0:l,conv1:d,conv2:f}}function o(a,s,u,c){c===void 0&&(c=!1);var l=i(a,s,u,c),d=l.conv0,f=l.conv1,h=l.conv2,p=r(s,s,u+"/conv3");return{conv0:d,conv1:f,conv2:h,conv3:p}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:o}}function gne(e){var t=[],n=$o(e),r=n.extractWeights,i=n.getRemainingWeights,o=vA(r,t).extractDenseBlock4Params,a=o(3,32,"dense0",!0),s=o(32,64,"dense1"),u=o(64,128,"dense2"),c=o(128,256,"dense3");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u,dense3:c}}}function mA(e){return function(t){var n=e(t+"/filters",4),r=e(t+"/bias",1);return{filters:n,bias:r}}}function gA(e,t){var n=Wa(e,t),r=mA(n),i=Ux(n);function o(s,u){u===void 0&&(u=!1);var c=u?r(s+"/conv0"):i(s+"/conv0"),l=i(s+"/conv1"),d=i(s+"/conv2");return{conv0:c,conv1:l,conv2:d}}function a(s,u){u===void 0&&(u=!1);var c=u?r(s+"/conv0"):i(s+"/conv0"),l=i(s+"/conv1"),d=i(s+"/conv2"),f=i(s+"/conv3");return{conv0:c,conv1:l,conv2:d,conv3:f}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:a}}function yne(e){var t=[],n=gA(e,t).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return jo(e,t),{params:r,paramMappings:t}}var yA=function(e){Be(t,e);function t(){return e.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return Se(function(){var i=n.toBatchTensor(112,!0),o=[122.782,117.001,104.298],a=df(i,o).div(ye(255)),s=vh(a,r.dense0,!0);return s=vh(s,r.dense1),s=vh(s,r.dense2),s=vh(s,r.dense3),s=cf(s,[7,7],[2,2],"valid"),s})},t.prototype.forward=function(n){return Te(this,void 0,void 0,function(){var r;return Oe(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,wn(n)];case 1:return[2,r.apply(this,[i.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(n){return yne(n)},t.prototype.extractParams=function(n){return gne(n)},t}(Bo);function Qi(e,t){return Se(function(){return Ke($m(e,t.weights),t.bias)})}function bne(e,t,n){var r=[],i=$o(e),o=i.extractWeights,a=i.getRemainingWeights,s=Vx(o,r),u=s(t,n,"fc");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:u}}}function wne(e){var t=[],n=Wa(e,t);function r(o){var a=n(o+"/weights",2),s=n(o+"/bias",1);return{weights:a,bias:s}}var i={fc:r("fc")};return jo(e,t),{params:i,paramMappings:t}}function bA(e){var t={},n={};return Object.keys(e).forEach(function(r){var i=r.startsWith("fc")?n:t;i[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var wA=function(e){Be(t,e);function t(n,r){var i=e.call(this,n)||this;return i._faceFeatureExtractor=r,i}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,i=this.params;if(!i)throw new Error(this._name+" - load model before inference");return Se(function(){var o=n instanceof pv?r.faceFeatureExtractor.forwardInput(n):n;return Qi(o.as2D(o.shape[0],-1),i.fc)})},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),i=r.params,o=r.paramMappings;this._params=i,this._paramMappings=o},t.prototype.extractClassifierParams=function(n){return bne(n,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(n){var r=bA(n),i=r.featureExtractorMap,o=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(i),wne(o)},t.prototype.extractParams=function(n){var r=this.getClassifierChannelsIn(),i=this.getClassifierChannelsOut(),o=i*r+i,a=n.slice(0,n.length-o),s=n.slice(n.length-o);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(s)},t}(Bo),pk=["neutral","happy","sad","angry","fearful","disgusted","surprised"],xne=function(){function e(t){var n=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);pk.forEach(function(r,i){n[r]=t[i]})}return e.prototype.asSortedArray=function(){var t=this;return pk.map(function(n){return{expression:n,probability:t[n]}}).sort(function(n,r){return r.probability-n.probability})},e}(),Ene=function(e){Be(t,e);function t(n){return n===void 0&&(n=new yA),e.call(this,"FaceExpressionNet",n)||this}return t.prototype.forwardInput=function(n){var r=this;return Se(function(){return Lo(r.runNet(n))})},t.prototype.forward=function(n){return Te(this,void 0,void 0,function(){var r;return Oe(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,wn(n)];case 1:return[2,r.apply(this,[i.sent()])]}})})},t.prototype.predictExpressions=function(n){return Te(this,void 0,void 0,function(){var r,i,o,a,s=this;return Oe(this,function(u){switch(u.label){case 0:return[4,wn(n)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return i=u.sent(),[4,Promise.all(sn(i).map(function(c){return Te(s,void 0,void 0,function(){var l;return Oe(this,function(d){switch(d.label){case 0:return[4,c.data()];case 1:return l=d.sent(),c.dispose(),[2,l]}})})}))];case 3:return o=u.sent(),i.dispose(),a=o.map(function(c){return new xne(c)}),[2,r.isBatchInput?a:a[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(wA);function xA(e,t){var n={expressions:t};return Object.assign({},e,n)}function EA(e){return oA(e)&&e.landmarks instanceof Sd&&e.unshiftedLandmarks instanceof Sd&&e.alignedRect instanceof Ai}function Xm(e,t){var n=e.detection.box,r=t.shiftBy(n.x,n.y),i=r.align(),o=e.detection.imageDims,a=new Ai(e.detection.score,i.rescale(o.reverse()),o),s={landmarks:r,unshiftedLandmarks:t,alignedRect:a};return Object.assign({},e,s)}function Sne(e,t){var n=qm(e,t),r=Wx(e,t);function i(a,s,u){var c=r(a,s,u+"/separable_conv0"),l=r(s,s,u+"/separable_conv1"),d=n(a,s,1,u+"/expansion_conv");return{separable_conv0:c,separable_conv1:l,expansion_conv:d}}function o(a,s){var u=r(a,a,s+"/separable_conv0"),c=r(a,a,s+"/separable_conv1"),l=r(a,a,s+"/separable_conv2");return{separable_conv0:u,separable_conv1:c,separable_conv2:l}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:i,extractMainBlockParams:o}}function Cne(e,t){var n=[],r=$o(e),i=r.extractWeights,o=r.getRemainingWeights,a=Sne(i,n),s=a.extractConvParams,u=a.extractSeparableConvParams,c=a.extractReductionBlockParams,l=a.extractMainBlockParams,d=s(3,32,3,"entry_flow/conv_in"),f=c(32,64,"entry_flow/reduction_block_0"),h=c(64,128,"entry_flow/reduction_block_1"),p={conv_in:d,reduction_block_0:f,reduction_block_1:h},m={};xd(t,0,1).forEach(function(b){m["main_block_"+b]=l(128,"middle_flow/main_block_"+b)});var g=c(128,256,"exit_flow/reduction_block"),v=u(256,512,"exit_flow/separable_conv"),y={reduction_block:g,separable_conv:v};if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:n,params:{entry_flow:p,middle_flow:m,exit_flow:y}}}function _ne(e,t){var n=Wa(e,t),r=mA(n),i=Ux(n);function o(s){var u=i(s+"/separable_conv0"),c=i(s+"/separable_conv1"),l=r(s+"/expansion_conv");return{separable_conv0:u,separable_conv1:c,expansion_conv:l}}function a(s){var u=i(s+"/separable_conv0"),c=i(s+"/separable_conv1"),l=i(s+"/separable_conv2");return{separable_conv0:u,separable_conv1:c,separable_conv2:l}}return{extractConvParams:r,extractSeparableConvParams:i,extractReductionBlockParams:o,extractMainBlockParams:a}}function kne(e,t){var n=[],r=_ne(e,n),i=r.extractConvParams,o=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,u=i("entry_flow/conv_in"),c=a("entry_flow/reduction_block_0"),l=a("entry_flow/reduction_block_1"),d={conv_in:u,reduction_block_0:c,reduction_block_1:l},f={};xd(t,0,1).forEach(function(g){f["main_block_"+g]=s("middle_flow/main_block_"+g)});var h=a("exit_flow/reduction_block"),p=o("exit_flow/separable_conv"),m={reduction_block:h,separable_conv:p};return jo(e,n),{params:{entry_flow:d,middle_flow:f,exit_flow:m},paramMappings:n}}function SA(e,t,n){return Ke(di(e,t.filters,n,"same"),t.bias)}function oy(e,t,n){n===void 0&&(n=!0);var r=n?Ft(e):e;return r=Vr(r,t.separable_conv0,[1,1]),r=Vr(Ft(r),t.separable_conv1,[1,1]),r=hn(r,[3,3],[2,2],"same"),r=Ke(r,SA(e,t.expansion_conv,[2,2])),r}function Rne(e,t){var n=Vr(Ft(e),t.separable_conv0,[1,1]);return n=Vr(Ft(n),t.separable_conv1,[1,1]),n=Vr(Ft(n),t.separable_conv2,[1,1]),n=Ke(n,e),n}var Ine=function(e){Be(t,e);function t(n){var r=e.call(this,"TinyXception")||this;return r._numMainBlocks=n,r}return t.prototype.forwardInput=function(n){var r=this,i=this.params;if(!i)throw new Error("TinyXception - load model before inference");return Se(function(){var o=n.toBatchTensor(112,!0),a=[122.782,117.001,104.298],s=df(o,a).div(ye(256)),u=Ft(SA(s,i.entry_flow.conv_in,[2,2]));return u=oy(u,i.entry_flow.reduction_block_0,!1),u=oy(u,i.entry_flow.reduction_block_1),xd(r._numMainBlocks,0,1).forEach(function(c){u=Rne(u,i.middle_flow["main_block_"+c])}),u=oy(u,i.exit_flow.reduction_block),u=Ft(Vr(u,i.exit_flow.separable_conv,[1,1])),u})},t.prototype.forward=function(n){return Te(this,void 0,void 0,function(){var r;return Oe(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,wn(n)];case 1:return[2,r.apply(this,[i.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(n){return kne(n,this._numMainBlocks)},t.prototype.extractParams=function(n){return Cne(n,this._numMainBlocks)},t}(Bo);function Tne(e){var t=[],n=$o(e),r=n.extractWeights,i=n.getRemainingWeights,o=Vx(r,t),a=o(512,1,"fc/age"),s=o(512,2,"fc/gender");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:t,params:{fc:{age:a,gender:s}}}}function One(e){var t=[],n=Wa(e,t);function r(o){var a=n(o+"/weights",2),s=n(o+"/bias",1);return{weights:a,bias:s}}var i={fc:{age:r("fc/age"),gender:r("fc/gender")}};return jo(e,t),{params:i,paramMappings:t}}var vv;(function(e){e.FEMALE="female",e.MALE="male"})(vv||(vv={}));var Pne=function(e){Be(t,e);function t(n){n===void 0&&(n=new Ine(2));var r=e.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=n,r}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,i=this.params;if(!i)throw new Error(this._name+" - load model before inference");return Se(function(){var o=n instanceof pv?r.faceFeatureExtractor.forwardInput(n):n,a=cf(o,[7,7],[2,2],"valid").as2D(o.shape[0],-1),s=Qi(a,i.fc.age).as1D(),u=Qi(a,i.fc.gender);return{age:s,gender:u}})},t.prototype.forwardInput=function(n){var r=this;return Se(function(){var i=r.runNet(n),o=i.age,a=i.gender;return{age:o,gender:Lo(a)}})},t.prototype.forward=function(n){return Te(this,void 0,void 0,function(){var r;return Oe(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,wn(n)];case 1:return[2,r.apply(this,[i.sent()])]}})})},t.prototype.predictAgeAndGender=function(n){return Te(this,void 0,void 0,function(){var r,i,o,a,s,u,c=this;return Oe(this,function(l){switch(l.label){case 0:return[4,wn(n)];case 1:return r=l.sent(),[4,this.forwardInput(r)];case 2:return i=l.sent(),o=sn(i.age),a=sn(i.gender),s=o.map(function(d,f){return{ageTensor:d,genderTensor:a[f]}}),[4,Promise.all(s.map(function(d){var f=d.ageTensor,h=d.genderTensor;return Te(c,void 0,void 0,function(){var p,m,g,v,y;return Oe(this,function(b){switch(b.label){case 0:return[4,f.data()];case 1:return p=b.sent()[0],[4,h.data()];case 2:return m=b.sent()[0],g=m>.5,v=g?vv.MALE:vv.FEMALE,y=g?m:1-m,f.dispose(),h.dispose(),[2,{age:p,gender:v,genderProbability:y}]}})})}))];case 3:return u=l.sent(),i.age.dispose(),i.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),i=r.params,o=r.paramMappings;this._params=i,this._paramMappings=o},t.prototype.extractClassifierParams=function(n){return Tne(n)},t.prototype.extractParamsFromWeigthMap=function(n){var r=bA(n),i=r.featureExtractorMap,o=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(i),One(o)},t.prototype.extractParams=function(n){var r=1539,i=n.slice(0,n.length-r),o=n.slice(n.length-r);return this.faceFeatureExtractor.extractWeights(i),this.extractClassifierParams(o)},t}(Bo),CA=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.postProcess=function(n,r,i){var o=i.map(function(s){var u=s.width,c=s.height,l=r/Math.max(c,u);return{width:u*l,height:c*l}}),a=o.length;return Se(function(){var s=function(f,h){return zr([ro([68],f),ro([68],h)],1).as2D(1,136).as1D()},u=function(f,h){var p=o[f],m=p.width,g=p.height;return h(m,g)?Math.abs(m-g)/2:0},c=function(f){return u(f,function(h,p){return h<p})},l=function(f){return u(f,function(h,p){return p<h})},d=n.mul(ro([a,136],r)).sub(zr(Array.from(Array(a),function(f,h){return s(c(h),l(h))}))).div(zr(Array.from(Array(a),function(f,h){return s(o[h].width,o[h].height)})));return d})},t.prototype.forwardInput=function(n){var r=this;return Se(function(){var i=r.runNet(n);return r.postProcess(i,n.inputSize,n.inputDimensions.map(function(o){var a=o[0],s=o[1];return{height:a,width:s}}))})},t.prototype.forward=function(n){return Te(this,void 0,void 0,function(){var r;return Oe(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,wn(n)];case 1:return[2,r.apply(this,[i.sent()])]}})})},t.prototype.detectLandmarks=function(n){return Te(this,void 0,void 0,function(){var r,i,o,a=this;return Oe(this,function(s){switch(s.label){case 0:return[4,wn(n)];case 1:return r=s.sent(),i=Se(function(){return sn(a.forwardInput(r))}),[4,Promise.all(i.map(function(u,c){return Te(a,void 0,void 0,function(){var l,d,f,h,p;return Oe(this,function(m){switch(m.label){case 0:return f=(d=Array).from,[4,u.data()];case 1:return l=f.apply(d,[m.sent()]),h=l.filter(function(g,v){return sk(v)}),p=l.filter(function(g,v){return!sk(v)}),[2,new sne(Array(68).fill(0).map(function(g,v){return new ut(h[v],p[v])}),{height:r.getInputHeight(c),width:r.getInputWidth(c)})]}})})}))];case 2:return o=s.sent(),i.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?o:o[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(wA),_A=function(e){Be(t,e);function t(n){return n===void 0&&(n=new yA),e.call(this,"FaceLandmark68Net",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(CA);function Nne(e){var t=[],n=gA(e,t).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return jo(e,t),{params:r,paramMappings:t}}function Dne(e){var t=[],n=$o(e),r=n.extractWeights,i=n.getRemainingWeights,o=vA(r,t).extractDenseBlock3Params,a=o(3,32,"dense0",!0),s=o(32,64,"dense1"),u=o(64,128,"dense2");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u}}}var Ane=function(e){Be(t,e);function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return Se(function(){var i=n.toBatchTensor(112,!0),o=[122.782,117.001,104.298],a=df(i,o).div(ye(255)),s=iy(a,r.dense0,!0);return s=iy(s,r.dense1),s=iy(s,r.dense2),s=cf(s,[14,14],[2,2],"valid"),s})},t.prototype.forward=function(n){return Te(this,void 0,void 0,function(){var r;return Oe(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,wn(n)];case 1:return[2,r.apply(this,[i.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(n){return Nne(n)},t.prototype.extractParams=function(n){return Dne(n)},t}(Bo),Mne=function(e){Be(t,e);function t(n){return n===void 0&&(n=new Ane),e.call(this,"FaceLandmark68TinyNet",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(CA);(function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(_A);function Lne(e,t){return Ke(Yn(e,t.weights),t.biases)}function zx(e,t,n,r,i){i===void 0&&(i="same");var o=t.conv,a=o.filters,s=o.bias,u=di(e,a,n,i);return u=Ke(u,s),u=Lne(u,t.scale),r?Ft(u):u}function Fne(e,t){return zx(e,t,[1,1],!0)}function kA(e,t){return zx(e,t,[1,1],!1)}function RA(e,t){return zx(e,t,[2,2],!0,"valid")}function Bne(e,t){function n(s,u,c){var l=e(s),d=l.length/(u*c*c);if(Qte(d))throw new Error("depth has to be an integer: "+d+", weights.length: "+l.length+", numFilters: "+u+", filterSize: "+c);return Se(function(){return Pa(gr(l,[u,d,c,c]),[2,3,1,0])})}function r(s,u,c,l){var d=n(s,u,c),f=tn(e(u));return t.push({paramPath:l+"/filters"},{paramPath:l+"/bias"}),{filters:d,bias:f}}function i(s,u){var c=tn(e(s)),l=tn(e(s));return t.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:c,biases:l}}function o(s,u,c,l){var d=r(s,u,c,l+"/conv"),f=i(u,l+"/scale");return{conv:d,scale:f}}function a(s,u,c,l,d){d===void 0&&(d=!1);var f=o((d?.5:1)*s,u,c,l+"/conv1"),h=o(s,u,c,l+"/conv2");return{conv1:f,conv2:h}}return{extractConvLayerParams:o,extractResidualLayerParams:a}}function jne(e){var t=$o(e),n=t.extractWeights,r=t.getRemainingWeights,i=[],o=Bne(n,i),a=o.extractConvLayerParams,s=o.extractResidualLayerParams,u=a(4704,32,7,"conv32_down"),c=s(9216,32,3,"conv32_1"),l=s(9216,32,3,"conv32_2"),d=s(9216,32,3,"conv32_3"),f=s(36864,64,3,"conv64_down",!0),h=s(36864,64,3,"conv64_1"),p=s(36864,64,3,"conv64_2"),m=s(36864,64,3,"conv64_3"),g=s(147456,128,3,"conv128_down",!0),v=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),b=s(589824,256,3,"conv256_down",!0),w=s(589824,256,3,"conv256_1"),E=s(589824,256,3,"conv256_2"),x=s(589824,256,3,"conv256_down_out"),R=Se(function(){return Pa(Ea(n(256*128),[128,256]),[1,0])});if(i.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var S={conv32_down:u,conv32_1:c,conv32_2:l,conv32_3:d,conv64_down:f,conv64_1:h,conv64_2:p,conv64_3:m,conv128_down:g,conv128_1:v,conv128_2:y,conv256_down:b,conv256_1:w,conv256_2:E,conv256_down_out:x,fc:R};return{params:S,paramMappings:i}}function $ne(e,t){var n=Wa(e,t);function r(a){var s=n(a+"/scale/weights",1),u=n(a+"/scale/biases",1);return{weights:s,biases:u}}function i(a){var s=n(a+"/conv/filters",4),u=n(a+"/conv/bias",1),c=r(a);return{conv:{filters:s,bias:u},scale:c}}function o(a){return{conv1:i(a+"/conv1"),conv2:i(a+"/conv2")}}return{extractConvLayerParams:i,extractResidualLayerParams:o}}function Vne(e){var t=[],n=$ne(e,t),r=n.extractConvLayerParams,i=n.extractResidualLayerParams,o=r("conv32_down"),a=i("conv32_1"),s=i("conv32_2"),u=i("conv32_3"),c=i("conv64_down"),l=i("conv64_1"),d=i("conv64_2"),f=i("conv64_3"),h=i("conv128_down"),p=i("conv128_1"),m=i("conv128_2"),g=i("conv256_down"),v=i("conv256_1"),y=i("conv256_2"),b=i("conv256_down_out"),w=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!Yte(w))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+w);var E={conv32_down:o,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:c,conv64_1:l,conv64_2:d,conv64_3:f,conv128_down:h,conv128_1:p,conv128_2:m,conv256_down:g,conv256_1:v,conv256_2:y,conv256_down_out:b,fc:w};return jo(e,t),{params:E,paramMappings:t}}function Vi(e,t){var n=Fne(e,t.conv1);return n=kA(n,t.conv2),n=Ke(n,e),n=Ft(n),n}function mh(e,t){var n=RA(e,t.conv1);n=kA(n,t.conv2);var r=cf(e,2,2,"valid"),i=Rt(r.shape),o=r.shape[3]!==n.shape[3],a=r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2];if(a){var s=$l(n.shape);s[1]=1;var u=Rt(s);n=an([n,u],1);var c=$l(n.shape);c[2]=1;var l=Rt(c);n=an([n,l],2)}return r=o?an([r,i],3):r,n=Ke(r,n),n=Ft(n),n}var Wne=function(e){Be(t,e);function t(){return e.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return Se(function(){var i=n.toBatchTensor(150,!0).toFloat(),o=[122.782,117.001,104.298],a=df(i,o).div(ye(256)),s=RA(a,r.conv32_down);s=hn(s,3,2,"valid"),s=Vi(s,r.conv32_1),s=Vi(s,r.conv32_2),s=Vi(s,r.conv32_3),s=mh(s,r.conv64_down),s=Vi(s,r.conv64_1),s=Vi(s,r.conv64_2),s=Vi(s,r.conv64_3),s=mh(s,r.conv128_down),s=Vi(s,r.conv128_1),s=Vi(s,r.conv128_2),s=mh(s,r.conv256_down),s=Vi(s,r.conv256_1),s=Vi(s,r.conv256_2),s=mh(s,r.conv256_down_out);var u=s.mean([1,2]),c=$m(u,r.fc);return c})},t.prototype.forward=function(n){return Te(this,void 0,void 0,function(){var r;return Oe(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,wn(n)];case 1:return[2,r.apply(this,[i.sent()])]}})})},t.prototype.computeFaceDescriptor=function(n){return Te(this,void 0,void 0,function(){var r,i,o,a=this;return Oe(this,function(s){switch(s.label){case 0:return[4,wn(n)];case 1:return r=s.sent(),i=Se(function(){return sn(a.forwardInput(r))}),[4,Promise.all(i.map(function(u){return u.data()}))];case 2:return o=s.sent(),i.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?o:o[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(n){return Vne(n)},t.prototype.extractParams=function(n){return jne(n)},t}(Bo);function IA(e,t){var n={descriptor:t};return Object.assign({},e,n)}function TA(e,t){var n={age:t};return Object.assign({},e,n)}function OA(e,t,n){var r={gender:t,genderProbability:n};return Object.assign({},e,r)}var PA=function(){function e(t){var n=t===void 0?{}:t,r=n.minFaceSize,i=n.scaleFactor,o=n.maxNumScales,a=n.scoreThresholds,s=n.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=i||.709,this._maxNumScales=o||10,this._scoreThresholds=a||[.6,.7,.7],this._scaleSteps=s,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function Une(e,t){function n(u,c){var l=gr(e(9*u),[3,3,u,1]),d=tn(e(u)),f=tn(e(u)),h=tn(e(u)),p=tn(e(u));return t.push({paramPath:c+"/filters"},{paramPath:c+"/batch_norm_scale"},{paramPath:c+"/batch_norm_offset"},{paramPath:c+"/batch_norm_mean"},{paramPath:c+"/batch_norm_variance"}),{filters:l,batch_norm_scale:d,batch_norm_offset:f,batch_norm_mean:h,batch_norm_variance:p}}function r(u,c,l,d,f){var h=gr(e(u*c*l*l),[l,l,u,c]),p=tn(e(c));return t.push({paramPath:d+"/filters"},{paramPath:d+"/"+(f?"batch_norm_offset":"bias")}),{filters:h,bias:p}}function i(u,c,l,d){var f=r(u,c,l,d,!0),h=f.filters,p=f.bias;return{filters:h,batch_norm_offset:p}}function o(u,c,l){var d=n(u,l+"/depthwise_conv"),f=i(u,c,1,l+"/pointwise_conv");return{depthwise_conv:d,pointwise_conv:f}}function a(){var u=i(3,32,3,"mobilenetv1/conv_0"),c=o(32,64,"mobilenetv1/conv_1"),l=o(64,128,"mobilenetv1/conv_2"),d=o(128,128,"mobilenetv1/conv_3"),f=o(128,256,"mobilenetv1/conv_4"),h=o(256,256,"mobilenetv1/conv_5"),p=o(256,512,"mobilenetv1/conv_6"),m=o(512,512,"mobilenetv1/conv_7"),g=o(512,512,"mobilenetv1/conv_8"),v=o(512,512,"mobilenetv1/conv_9"),y=o(512,512,"mobilenetv1/conv_10"),b=o(512,512,"mobilenetv1/conv_11"),w=o(512,1024,"mobilenetv1/conv_12"),E=o(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:c,conv_2:l,conv_3:d,conv_4:f,conv_5:h,conv_6:p,conv_7:m,conv_8:g,conv_9:v,conv_10:y,conv_11:b,conv_12:w,conv_13:E}}function s(){var u=i(1024,256,1,"prediction_layer/conv_0"),c=i(256,512,3,"prediction_layer/conv_1"),l=i(512,128,1,"prediction_layer/conv_2"),d=i(128,256,3,"prediction_layer/conv_3"),f=i(256,128,1,"prediction_layer/conv_4"),h=i(128,256,3,"prediction_layer/conv_5"),p=i(256,64,1,"prediction_layer/conv_6"),m=i(64,128,3,"prediction_layer/conv_7"),g=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),v=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),y=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),b=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),w=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),E=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),x=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),R=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),S=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),_=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),T=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),B=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),L={box_encoding_predictor:g,class_predictor:v},k={box_encoding_predictor:y,class_predictor:b},D={box_encoding_predictor:w,class_predictor:E},F={box_encoding_predictor:x,class_predictor:R},M={box_encoding_predictor:S,class_predictor:_},I={box_encoding_predictor:T,class_predictor:B};return{conv_0:u,conv_1:c,conv_2:l,conv_3:d,conv_4:f,conv_5:h,conv_6:p,conv_7:m,box_predictor_0:L,box_predictor_1:k,box_predictor_2:D,box_predictor_3:F,box_predictor_4:M,box_predictor_5:I}}return{extractMobilenetV1Params:a,extractPredictionLayerParams:s}}function zne(e){var t=[],n=$o(e),r=n.extractWeights,i=n.getRemainingWeights,o=Une(r,t),a=o.extractMobilenetV1Params,s=o.extractPredictionLayerParams,u=a(),c=s(),l=sx(r(5118*4),[1,5118,4]),d={extra_dim:l};if(t.push({paramPath:"output_layer/extra_dim"}),i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{params:{mobilenetv1:u,prediction_layer:c,output_layer:d},paramMappings:t}}function Hne(e,t){var n=Wa(e,t);function r(c,l,d){var f=n(c+"/Conv2d_"+l+"_pointwise/weights",4,d+"/filters"),h=n(c+"/Conv2d_"+l+"_pointwise/convolution_bn_offset",1,d+"/batch_norm_offset");return{filters:f,batch_norm_offset:h}}function i(c){var l="mobilenetv1/conv_"+c,d="MobilenetV1/Conv2d_"+c+"_depthwise",f=l+"/depthwise_conv",h=l+"/pointwise_conv",p=n(d+"/depthwise_weights",4,f+"/filters"),m=n(d+"/BatchNorm/gamma",1,f+"/batch_norm_scale"),g=n(d+"/BatchNorm/beta",1,f+"/batch_norm_offset"),v=n(d+"/BatchNorm/moving_mean",1,f+"/batch_norm_mean"),y=n(d+"/BatchNorm/moving_variance",1,f+"/batch_norm_variance");return{depthwise_conv:{filters:p,batch_norm_scale:m,batch_norm_offset:g,batch_norm_mean:v,batch_norm_variance:y},pointwise_conv:r("MobilenetV1",c,h)}}function o(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:i(1),conv_2:i(2),conv_3:i(3),conv_4:i(4),conv_5:i(5),conv_6:i(6),conv_7:i(7),conv_8:i(8),conv_9:i(9),conv_10:i(10),conv_11:i(11),conv_12:i(12),conv_13:i(13)}}function a(c,l){var d=n(c+"/weights",4,l+"/filters"),f=n(c+"/biases",1,l+"/bias");return{filters:d,bias:f}}function s(c){var l=a("Prediction/BoxPredictor_"+c+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+c+"/box_encoding_predictor"),d=a("Prediction/BoxPredictor_"+c+"/ClassPredictor","prediction_layer/box_predictor_"+c+"/class_predictor");return{box_encoding_predictor:l,class_predictor:d}}function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}return{extractMobilenetV1Params:o,extractPredictionLayerParams:u}}function Gne(e){var t=[],n=Hne(e,t),r=n.extractMobilenetV1Params,i=n.extractPredictionLayerParams,o=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!zm(o))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+o);var a={mobilenetv1:r(),prediction_layer:i(),output_layer:{extra_dim:o}};return jo(e,t),{params:a,paramMappings:t}}function zi(e,t,n){return Se(function(){var r=di(e,t.filters,n,"same");return r=Ke(r,t.batch_norm_offset),yx(r,0,6)})}var qne=.0010000000474974513;function Xne(e,t,n){return Se(function(){var r=jm(e,t.filters,n,"same");return r=CD(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,qne),yx(r,0,6)})}function Kne(e){return[2,4,6,12].some(function(t){return t===e})?[2,2]:[1,1]}function Yne(e,t){return Se(function(){var n=null,r=zi(e,t.conv_0,[2,2]),i=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(i.forEach(function(o,a){var s=a+1,u=Kne(s);r=Xne(r,o.depthwise_conv,u),r=zi(r,o.pointwise_conv,[1,1]),s===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function Qne(e,t,n,r,i){var o=e.shape[0],a=Math.min(n,o),s=t.map(function(l,d){return{score:l,boxIndex:d}}).filter(function(l){return l.score>i}).sort(function(l,d){return d.score-l.score}),u=function(l){return l<=r?1:0},c=[];return s.forEach(function(l){if(!(c.length>=a)){for(var d=l.score,f=c.length-1;f>=0;--f){var h=Jne(e,l.boxIndex,c[f]);if(h!==0&&(l.score*=u(h),l.score<=i))break}d===l.score&&c.push(l.boxIndex)}}),c}function Jne(e,t,n){var r=e.arraySync(),i=Math.min(r[t][0],r[t][2]),o=Math.min(r[t][1],r[t][3]),a=Math.max(r[t][0],r[t][2]),s=Math.max(r[t][1],r[t][3]),u=Math.min(r[n][0],r[n][2]),c=Math.min(r[n][1],r[n][3]),l=Math.max(r[n][0],r[n][2]),d=Math.max(r[n][1],r[n][3]),f=(a-i)*(s-o),h=(l-u)*(d-c);if(f<=0||h<=0)return 0;var p=Math.max(i,u),m=Math.max(o,c),g=Math.min(a,l),v=Math.min(s,d),y=Math.max(g-p,0)*Math.max(v-m,0);return y/(f+h-y)}function Zne(e){var t=sn(Pa(e,[1,0])),n=[cn(t[2],t[0]),cn(t[3],t[1])],r=[Ke(t[0],wi(n[0],ye(2))),Ke(t[1],wi(n[1],ye(2)))];return{sizes:n,centers:r}}function ere(e,t){var n=Zne(e),r=n.sizes,i=n.centers,o=sn(Pa(t,[1,0])),a=wi(Yn(ab(wi(o[2],ye(5))),r[0]),ye(2)),s=Ke(Yn(wi(o[0],ye(10)),r[0]),i[0]),u=wi(Yn(ab(wi(o[3],ye(5))),r[1]),ye(2)),c=Ke(Yn(wi(o[1],ye(10)),r[1]),i[1]);return Pa(zr([cn(s,a),cn(c,u),Ke(s,a),Ke(c,u)]),[1,0])}function tre(e,t,n){return Se(function(){var r=e.shape[0],i=ere(xi(Uu(n.extra_dim,[r,1,1]),[-1,4]),xi(e,[-1,4]));i=xi(i,[r,i.shape[0]/r,4]);var o=wD(oo(t,[0,0,1],[-1,-1,-1])),a=oo(o,[0,0,0],[-1,-1,1]);a=xi(a,[r,a.shape[1]]);var s=sn(i),u=sn(a);return{boxes:s,scores:u}})}function du(e,t){return Se(function(){var n=e.shape[0],r=xi(ki(e,t.box_encoding_predictor),[n,-1,1,4]),i=xi(ki(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:i}})}function nre(e,t,n){return Se(function(){var r=zi(e,n.conv_0,[1,1]),i=zi(r,n.conv_1,[2,2]),o=zi(i,n.conv_2,[1,1]),a=zi(o,n.conv_3,[2,2]),s=zi(a,n.conv_4,[1,1]),u=zi(s,n.conv_5,[2,2]),c=zi(u,n.conv_6,[1,1]),l=zi(c,n.conv_7,[2,2]),d=du(t,n.box_predictor_0),f=du(e,n.box_predictor_1),h=du(i,n.box_predictor_2),p=du(a,n.box_predictor_3),m=du(u,n.box_predictor_4),g=du(l,n.box_predictor_5),v=an([d.boxPredictionEncoding,f.boxPredictionEncoding,h.boxPredictionEncoding,p.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding],1),y=an([d.classPrediction,f.classPrediction,h.classPrediction,p.classPrediction,m.classPrediction,g.classPrediction],1);return{boxPredictions:v,classPredictions:y}})}var Km=function(){function e(t){var n=t===void 0?{}:t,r=n.minConfidence,i=n.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=i||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),NA=function(e){Be(t,e);function t(){return e.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return Se(function(){var i=n.toBatchTensor(512,!1).toFloat(),o=cn(Yn(i,ye(.007843137718737125)),ye(1)),a=Yne(o,r.mobilenetv1),s=nre(a.out,a.conv11,r.prediction_layer),u=s.boxPredictions,c=s.classPredictions;return tre(u,c,r.output_layer)})},t.prototype.forward=function(n){return Te(this,void 0,void 0,function(){var r;return Oe(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,wn(n)];case 1:return[2,r.apply(this,[i.sent()])]}})})},t.prototype.locateFaces=function(n,r){return r===void 0&&(r={}),Te(this,void 0,void 0,function(){var i,o,a,s,u,c,l,d,f,h,p,m,g,v,y,b,w,E,x,R,S;return Oe(this,function(_){switch(_.label){case 0:return i=new Km(r),o=i.maxResults,a=i.minConfidence,[4,wn(n)];case 1:for(s=_.sent(),u=this.forwardInput(s),c=u.boxes,l=u.scores,d=c[0],f=l[0],h=1;h<c.length;h++)c[h].dispose(),l[h].dispose();return g=(m=Array).from,[4,f.data()];case 2:return p=g.apply(m,[_.sent()]),v=.5,y=Qne(d,p,o,v,a),b=s.getReshapedInputDimensions(0),w=s.inputSize,E=w/b.width,x=w/b.height,R=d.arraySync(),S=y.map(function(T){var B=[Math.max(0,R[T][0]),Math.min(1,R[T][2])].map(function(I){return I*x}),L=B[0],k=B[1],D=[Math.max(0,R[T][1]),Math.min(1,R[T][3])].map(function(I){return I*E}),F=D[0],M=D[1];return new Ai(p[T],new Mx(F,L,M-F,k-L),{height:s.getInputHeight(0),width:s.getInputWidth(0)})}),d.dispose(),f.dispose(),[2,S]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(n){return Gne(n)},t.prototype.extractParams=function(n){return zne(n)},t}(Bo);(function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(NA);var rre=.4,ire=[new ut(.738768,.874946),new ut(2.42204,2.65704),new ut(4.30971,7.04493),new ut(10.246,4.59428),new ut(12.6868,11.8741)],ore=[new ut(1.603231,2.094468),new ut(6.041143,7.080126),new ut(2.882459,3.518061),new ut(4.266906,5.178857),new ut(9.041765,10.66308)],are=[117.001,114.697,97.404],sre="tiny_yolov2_model",ure="tiny_yolov2_separable_conv_model",gh=function(e){return typeof e=="number"};function cre(e){if(!e)throw new Error("invalid config: "+e);if(typeof e.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!gh(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(t){return t||{}}).every(function(t){return gh(t.x)&&gh(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(gh)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}function Hx(e){return Se(function(){var t=Yn(e,ye(.10000000149011612));return Ke(Ft(cn(e,t)),t)})}function Xo(e,t){return Se(function(){var n=Us(e,[[0,0],[1,1],[1,1],[0,0]]);return n=di(n,t.conv.filters,[1,1],"valid"),n=cn(n,t.bn.sub),n=Yn(n,t.bn.truediv),n=Ke(n,t.conv.bias),Hx(n)})}function Ko(e,t){return Se(function(){var n=Us(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Ex(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=Ke(n,t.bias),Hx(n)})}function lre(e,t){var n=qm(e,t);function r(a,s){var u=tn(e(a)),c=tn(e(a));return t.push({paramPath:s+"/sub"},{paramPath:s+"/truediv"}),{sub:u,truediv:c}}function i(a,s,u){var c=n(a,s,3,u+"/conv"),l=r(s,u+"/bn");return{conv:c,bn:l}}var o=Wx(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:i,extractSeparableConvParams:o}}function dre(e,t,n,r){var i=$o(e),o=i.extractWeights,a=i.getRemainingWeights,s=[],u=lre(o,s),c=u.extractConvParams,l=u.extractConvWithBatchNormParams,d=u.extractSeparableConvParams,f;if(t.withSeparableConvs){var h=r[0],p=r[1],m=r[2],g=r[3],v=r[4],y=r[5],b=r[6],w=r[7],E=r[8],x=t.isFirstLayerConv2d?c(h,p,3,"conv0"):d(h,p,"conv0"),R=d(p,m,"conv1"),S=d(m,g,"conv2"),_=d(g,v,"conv3"),T=d(v,y,"conv4"),B=d(y,b,"conv5"),L=w?d(b,w,"conv6"):void 0,k=E?d(w,E,"conv7"):void 0,D=c(E||w||b,5*n,1,"conv8");f={conv0:x,conv1:R,conv2:S,conv3:_,conv4:T,conv5:B,conv6:L,conv7:k,conv8:D}}else{var h=r[0],p=r[1],m=r[2],g=r[3],v=r[4],y=r[5],b=r[6],w=r[7],E=r[8],x=l(h,p,"conv0"),R=l(p,m,"conv1"),S=l(m,g,"conv2"),_=l(g,v,"conv3"),T=l(v,y,"conv4"),B=l(y,b,"conv5"),L=l(b,w,"conv6"),k=l(w,E,"conv7"),D=c(E,5*n,1,"conv8");f={conv0:x,conv1:R,conv2:S,conv3:_,conv4:T,conv5:B,conv6:L,conv7:k,conv8:D}}if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:f,paramMappings:s}}function fre(e,t){var n=Wa(e,t);function r(s){var u=n(s+"/sub",1),c=n(s+"/truediv",1);return{sub:u,truediv:c}}function i(s){var u=n(s+"/filters",4),c=n(s+"/bias",1);return{filters:u,bias:c}}function o(s){var u=i(s+"/conv"),c=r(s+"/bn");return{conv:u,bn:c}}var a=Ux(n);return{extractConvParams:i,extractConvWithBatchNormParams:o,extractSeparableConvParams:a}}function hre(e,t){var n=[],r=fre(e,n),i=r.extractConvParams,o=r.extractConvWithBatchNormParams,a=r.extractSeparableConvParams,s;if(t.withSeparableConvs){var u=t.filterSizes&&t.filterSizes.length||9;s={conv0:t.isFirstLayerConv2d?i("conv0"):a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:u>7?a("conv6"):void 0,conv7:u>8?a("conv7"):void 0,conv8:i("conv8")}}else s={conv0:o("conv0"),conv1:o("conv1"),conv2:o("conv2"),conv3:o("conv3"),conv4:o("conv4"),conv5:o("conv5"),conv6:o("conv6"),conv7:o("conv7"),conv8:i("conv8")};return jo(e,n),{params:s,paramMappings:n}}var vk;(function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"})(vk||(vk={}));var Gx=function(){function e(t){var n=t===void 0?{}:t,r=n.inputSize,i=n.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=i||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),DA=function(e){Be(t,e);function t(n){var r=e.call(this,"TinyYolov2")||this;return cre(n),r._config=n,r}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(n,r){var i=Xo(n,r.conv0);return i=hn(i,[2,2],[2,2],"same"),i=Xo(i,r.conv1),i=hn(i,[2,2],[2,2],"same"),i=Xo(i,r.conv2),i=hn(i,[2,2],[2,2],"same"),i=Xo(i,r.conv3),i=hn(i,[2,2],[2,2],"same"),i=Xo(i,r.conv4),i=hn(i,[2,2],[2,2],"same"),i=Xo(i,r.conv5),i=hn(i,[2,2],[1,1],"same"),i=Xo(i,r.conv6),i=Xo(i,r.conv7),ki(i,r.conv8,"valid",!1)},t.prototype.runMobilenet=function(n,r){var i=this.config.isFirstLayerConv2d?Hx(ki(n,r.conv0,"valid",!1)):Ko(n,r.conv0);return i=hn(i,[2,2],[2,2],"same"),i=Ko(i,r.conv1),i=hn(i,[2,2],[2,2],"same"),i=Ko(i,r.conv2),i=hn(i,[2,2],[2,2],"same"),i=Ko(i,r.conv3),i=hn(i,[2,2],[2,2],"same"),i=Ko(i,r.conv4),i=hn(i,[2,2],[2,2],"same"),i=Ko(i,r.conv5),i=hn(i,[2,2],[1,1],"same"),i=r.conv6?Ko(i,r.conv6):i,i=r.conv7?Ko(i,r.conv7):i,ki(i,r.conv8,"valid",!1)},t.prototype.forwardInput=function(n,r){var i=this,o=this.params;if(!o)throw new Error("TinyYolov2 - load model before inference");return Se(function(){var a=n.toBatchTensor(r,!1).toFloat();return a=i.config.meanRgb?df(a,i.config.meanRgb):a,a=a.div(ye(256)),i.config.withSeparableConvs?i.runMobilenet(a,o):i.runTinyYolov2(a,o)})},t.prototype.forward=function(n,r){return Te(this,void 0,void 0,function(){var i;return Oe(this,function(o){switch(o.label){case 0:return i=this.forwardInput,[4,wn(n)];case 1:return[4,i.apply(this,[o.sent(),r])];case 2:return[2,o.sent()]}})})},t.prototype.detect=function(n,r){return r===void 0&&(r={}),Te(this,void 0,void 0,function(){var i,o,a,s,u,c,l,d,f,h,p,m,g,v,y=this;return Oe(this,function(b){switch(b.label){case 0:return i=new Gx(r),o=i.inputSize,a=i.scoreThreshold,[4,wn(n)];case 1:return s=b.sent(),[4,this.forwardInput(s,o)];case 2:return u=b.sent(),c=Se(function(){return sn(u)[0].expandDims()}),l={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(c,s.getReshapedInputDimensions(0),a)];case 3:return d=b.sent(),u.dispose(),c.dispose(),f=d.map(function(w){return w.box}),h=d.map(function(w){return w.score}),p=d.map(function(w){return w.classScore}),m=d.map(function(w){return y.config.classes[w.label]}),g=Ed(f.map(function(w){return w.rescale(o)}),h,this.config.iouThreshold,!0),v=g.map(function(w){return new iA(h[w],p[w],m[w],f[w],l)}),[2,v]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(n){return hre(n,this.config)},t.prototype.extractParams=function(n){var r=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,i=r?r.length:void 0;if(i!==7&&i!==8&&i!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+i+" filterSizes in config");return dre(n,this.config,this.boxEncodingSize,r)},t.prototype.extractBoxes=function(n,r,i){return Te(this,void 0,void 0,function(){var o,a,s,u,c,l,d,f,h,p,m,g,v,y,b,w,E,x,R,S,_,T,B,L,k,D,F,M,I,N=this;return Oe(this,function(j){switch(j.label){case 0:return o=r.width,a=r.height,s=Math.max(o,a),u=s/o,c=s/a,l=n.shape[1],d=this.config.anchors.length,f=Se(function(){var P=n.reshape([l,l,d,N.boxEncodingSize]),A=P.slice([0,0,0,0],[l,l,d,4]),U=P.slice([0,0,0,4],[l,l,d,1]),H=N.withClassScores?Lo(P.slice([0,0,0,5],[l,l,d,N.config.classes.length]),3):ye(0);return[A,U,H]}),h=f[0],p=f[1],m=f[2],g=[],[4,p.array()];case 1:return v=j.sent(),[4,h.array()];case 2:y=j.sent(),b=0,j.label=3;case 3:if(!(b<l))return[3,12];w=0,j.label=4;case 4:if(!(w<l))return[3,11];E=0,j.label=5;case 5:return E<d?(x=ry(v[b][w][E][0]),!i||x>i?(R=(w+ry(y[b][w][E][0]))/l*u,S=(b+ry(y[b][w][E][1]))/l*c,_=Math.exp(y[b][w][E][2])*this.config.anchors[E].x/l*u,T=Math.exp(y[b][w][E][3])*this.config.anchors[E].y/l*c,B=R-_/2,L=S-T/2,k={row:b,col:w,anchor:E},this.withClassScores?[4,this.extractPredictedClass(m,k)]:[3,7]):[3,9]):[3,10];case 6:return I=j.sent(),[3,8];case 7:I={classScore:1,label:0},j.label=8;case 8:D=I,F=D.classScore,M=D.label,g.push(Hn({box:new Hm(B,L,B+_,L+T),score:x,classScore:x*F,label:M},k)),j.label=9;case 9:return E++,[3,5];case 10:return w++,[3,4];case 11:return b++,[3,3];case 12:return h.dispose(),p.dispose(),m.dispose(),[2,g]}})})},t.prototype.extractPredictedClass=function(n,r){return Te(this,void 0,void 0,function(){var i,o,a,s;return Oe(this,function(u){switch(u.label){case 0:return i=r.row,o=r.col,a=r.anchor,[4,n.array()];case 1:return s=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(c,l){return s[i][o][a][l]}).map(function(c,l){return{classScore:c,label:l}}).reduce(function(c,l){return c.classScore>l.classScore?c:l})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(Bo),pre=function(e){Be(t,e);function t(n){n===void 0&&(n=!0);var r=this,i=Object.assign({},{withSeparableConvs:n,iouThreshold:rre,classes:["face"]},n?{anchors:ore,meanRgb:are}:{anchors:ire,withClassScores:!0});return r=e.call(this,i)||this,r}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return Te(this,void 0,void 0,function(){var i;return Oe(this,function(o){switch(o.label){case 0:return[4,this.detect(n,r)];case 1:return i=o.sent(),[2,i.map(function(a){return new Ai(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?ure:sre},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(DA),AA=function(e){Be(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n._name="TinyFaceDetectorOptions",n}return t}(Gx),ff=function(){function e(){}return e.prototype.then=function(t){return Te(this,void 0,void 0,function(){var n;return Oe(this,function(r){switch(r.label){case 0:return n=t,[4,this.run()];case 1:return[2,n.apply(void 0,[r.sent()])]}})})},e.prototype.run=function(){return Te(this,void 0,void 0,function(){return Oe(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},e}();function Ym(e,t,n,r,i){return i===void 0&&(i=function(o){var a=o.alignedRect;return a}),Te(this,void 0,void 0,function(){var o,a,s,u,c;return Oe(this,function(l){switch(l.label){case 0:return o=e.map(function(d){return EA(d)?i(d):d.detection}),s=r,s?[3,5]:t instanceof Lt?[4,$x(t,o)]:[3,2];case 1:return u=l.sent(),[3,4];case 2:return[4,jx(t,o)];case 3:u=l.sent(),l.label=4;case 4:s=u,l.label=5;case 5:return a=s,[4,n(a)];case 6:return c=l.sent(),a.forEach(function(d){return d instanceof Lt&&d.dispose()}),[2,c]}})})}function qx(e,t,n,r,i){return Te(this,void 0,void 0,function(){var o=this;return Oe(this,function(a){return[2,Ym([e],t,function(s){return Te(o,void 0,void 0,function(){return Oe(this,function(u){return[2,n(s[0])]})})},r,i)]})})}function vre(e){return Se(function(){return zr(sn(e,3).reverse(),3)})}var yh=2,mv=12;function mre(e,t){var n=qm(e,t),r=Vx(e,t);function i(c,l){var d=tn(e(c));return t.push({paramPath:l}),d}function o(c,l,d){d===void 0&&(d=!1);var f=n(c[0],c[1],3,l+"/conv1"),h=i(c[1],l+"/prelu1_alpha"),p=n(c[1],c[2],3,l+"/conv2"),m=i(c[2],l+"/prelu2_alpha"),g=n(c[2],c[3],d?2:3,l+"/conv3"),v=i(c[3],l+"/prelu3_alpha");return{conv1:f,prelu1_alpha:h,conv2:p,prelu2_alpha:m,conv3:g,prelu3_alpha:v}}function a(){var c=o([3,10,16,32],"pnet"),l=n(32,2,1,"pnet/conv4_1"),d=n(32,4,1,"pnet/conv4_2");return Hn(Hn({},c),{conv4_1:l,conv4_2:d})}function s(){var c=o([3,28,48,64],"rnet",!0),l=r(576,128,"rnet/fc1"),d=i(128,"rnet/prelu4_alpha"),f=r(128,2,"rnet/fc2_1"),h=r(128,4,"rnet/fc2_2");return Hn(Hn({},c),{fc1:l,prelu4_alpha:d,fc2_1:f,fc2_2:h})}function u(){var c=o([3,32,64,64],"onet"),l=n(64,128,2,"onet/conv4"),d=i(128,"onet/prelu4_alpha"),f=r(1152,256,"onet/fc1"),h=i(256,"onet/prelu5_alpha"),p=r(256,2,"onet/fc2_1"),m=r(256,4,"onet/fc2_2"),g=r(256,10,"onet/fc2_3");return Hn(Hn({},c),{conv4:l,prelu4_alpha:d,fc1:f,prelu5_alpha:h,fc2_1:p,fc2_2:m,fc2_3:g})}return{extractPNetParams:a,extractRNetParams:s,extractONetParams:u}}function gre(e){var t=$o(e),n=t.extractWeights,r=t.getRemainingWeights,i=[],o=mre(n,i),a=o.extractPNetParams,s=o.extractRNetParams,u=o.extractONetParams,c=a(),l=s(),d=u();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:c,rnet:l,onet:d},paramMappings:i}}function yre(e,t){var n=Wa(e,t);function r(l){var d=n(l+"/weights",4,l+"/filters"),f=n(l+"/bias",1);return{filters:d,bias:f}}function i(l){var d=n(l+"/weights",2),f=n(l+"/bias",1);return{weights:d,bias:f}}function o(l){return n(l,1)}function a(l){var d=r(l+"/conv1"),f=o(l+"/prelu1_alpha"),h=r(l+"/conv2"),p=o(l+"/prelu2_alpha"),m=r(l+"/conv3"),g=o(l+"/prelu3_alpha");return{conv1:d,prelu1_alpha:f,conv2:h,prelu2_alpha:p,conv3:m,prelu3_alpha:g}}function s(){var l=a("pnet"),d=r("pnet/conv4_1"),f=r("pnet/conv4_2");return Hn(Hn({},l),{conv4_1:d,conv4_2:f})}function u(){var l=a("rnet"),d=i("rnet/fc1"),f=o("rnet/prelu4_alpha"),h=i("rnet/fc2_1"),p=i("rnet/fc2_2");return Hn(Hn({},l),{fc1:d,prelu4_alpha:f,fc2_1:h,fc2_2:p})}function c(){var l=a("onet"),d=r("onet/conv4"),f=o("onet/prelu4_alpha"),h=i("onet/fc1"),p=o("onet/prelu5_alpha"),m=i("onet/fc2_1"),g=i("onet/fc2_2"),v=i("onet/fc2_3");return Hn(Hn({},l),{conv4:d,prelu4_alpha:f,fc1:h,prelu5_alpha:p,fc2_1:m,fc2_2:g,fc2_3:v})}return{extractPNetParams:s,extractRNetParams:u,extractONetParams:c}}function bre(e){var t=[],n=yre(e,t),r=n.extractPNetParams,i=n.extractRNetParams,o=n.extractONetParams,a=r(),s=i(),u=o();return jo(e,t),{params:{pnet:a,rnet:s,onet:u},paramMappings:t}}function pb(e,t){var n=t[0],r=t[1];return{height:Math.floor(n*e),width:Math.floor(r*e)}}function wre(e,t,n){for(var r=n[0],i=n[1],o=mv/e,a=[],s=Math.min(r,i)*o,u=0;s>=12;)a.push(o*Math.pow(t,u)),s=s*t,u+=1;return a}var Xx=function(e){Be(t,e);function t(n,r,i,o){return e.call(this,{left:n,top:r,right:i,bottom:o},!0)||this}return t}(Na);function MA(e){return Se(function(){return Yn(cn(e,ye(127.5)),ye(.0078125))})}function Xu(e,t){return Se(function(){return Ke(Ft(e),Yn(t,lv(Ft(lv(e)))))})}function Kx(e,t,n){return n===void 0&&(n=!1),Se(function(){var r=ki(e,t.conv1,"valid");return r=Xu(r,t.prelu1_alpha),r=hn(r,n?[2,2]:[3,3],[2,2],"same"),r=ki(r,t.conv2,"valid"),r=Xu(r,t.prelu2_alpha),r=n?r:hn(r,[3,3],[2,2],"valid"),r=ki(r,t.conv3,"valid"),r=Xu(r,t.prelu3_alpha),r})}function xre(e,t){return Se(function(){var n=Kx(e,t,!0),r=ki(n,t.conv4_1,"valid"),i=Zr(Vm(r,3),3),o=Lo(cn(r,i),3),a=ki(n,t.conv4_2,"valid");return{prob:o,regions:a}})}function Ere(e,t){return Se(function(){var n=pb(t,e.shape.slice(1)),r=n.height,i=n.width,o=Rx.resizeBilinear(e,[r,i]),a=MA(o);return Pa(a,[0,2,1,3])})}function Sre(e,t,n,r){for(var i=[],o=e.arraySync(),a=0;a<e.shape[0];a++)for(var s=0;s<e.shape[1];s++)o[a][s]>=r&&i.push(new ut(s,a));var u=i.map(function(c){var l=new Hm(Math.round((c.y*yh+1)/n),Math.round((c.x*yh+1)/n),Math.round((c.y*yh+mv)/n),Math.round((c.x*yh+mv)/n)),d=o[c.y][c.x],f=t.arraySync(),h=new Xx(f[c.y][c.x][0],f[c.y][c.x][1],f[c.y][c.x][2],f[c.y][c.x][3]);return{cell:l,score:d,region:h}});return u}function Cre(e,t,n,r,i){i.stage1=[];var o=t.map(function(f){return Se(function(){var h={scale:f},p=Ere(e,f),m=Date.now(),g=xre(p,r),v=g.prob,y=g.regions;h.pnet=Date.now()-m;var b=sn(sn(v,3)[1])[0],w=sn(y)[0];return{scoresTensor:b,regionsTensor:w,scale:f,statsForScale:h}})}),a=o.map(function(f){var h=f.scoresTensor,p=f.regionsTensor,m=f.scale,g=f.statsForScale,v=Sre(h,p,m,n);if(h.dispose(),p.dispose(),!v.length)return i.stage1.push(g),[];var y=Date.now(),b=Ed(v.map(function(w){return w.cell}),v.map(function(w){return w.score}),.5);return g.nms=Date.now()-y,g.numBoxes=b.length,i.stage1.push(g),b.map(function(w){return v[w]})}),s=a.reduce(function(f,h){return f.concat(h)},[]),u=[],c=[];if(s.length>0){var l=Date.now(),d=Ed(s.map(function(f){return f.cell}),s.map(function(f){return f.score}),.7);i.stage1_nms=Date.now()-l,c=d.map(function(f){return s[f].score}),u=d.map(function(f){return s[f]}).map(function(f){var h=f.cell,p=f.region;return new Hm(h.left+p.left*h.width,h.top+p.top*h.height,h.right+p.right*h.width,h.bottom+p.bottom*h.height).toSquare().round()})}return{boxes:u,scores:c}}function LA(e,t,n){var r=n.width,i=n.height;return Te(this,void 0,void 0,function(){var o,a,s,u=this;return Oe(this,function(c){switch(c.label){case 0:return o=As(e),[4,Promise.all(t.map(function(l){return Te(u,void 0,void 0,function(){var d,f,h,p,m,g,v,y;return Oe(this,function(b){return d=l.padAtBorders(e.height,e.width),f=d.y,h=d.ey,p=d.x,m=d.ex,g=p-1,v=f-1,y=o.getImageData(g,v,m-g,h-v),[2,Zn.isNodejs()?Bx(y):createImageBitmap(y)]})})}))];case 1:return a=c.sent(),s=[],a.forEach(function(l){var d=Gm({width:r,height:i}),f=As(d);f.drawImage(l,0,0,r,i);for(var h=f.getImageData(0,0,r,i).data,p=[],m=0;m<h.length;m+=4)p.push(h[m+2]),p.push(h[m+1]),p.push(h[m]);s.push(p)}),[2,s.map(function(l){var d=Se(function(){var f=Pa(gr(l,[1,r,i,3]),[0,2,1,3]).toFloat();return MA(f)});return d})]}})})}function _re(e,t){return Se(function(){var n=Kx(e,t),r=xi(n,[n.shape[0],t.fc1.weights.shape[0]]),i=Qi(r,t.fc1),o=Xu(i,t.prelu4_alpha),a=Qi(o,t.fc2_1),s=Zr(Vm(a,1),1),u=Lo(cn(a,s),1),c=Qi(o,t.fc2_2),l=sn(u,1)[1];return{scores:l,regions:c}})}function kre(e,t,n,r,i){return Te(this,void 0,void 0,function(){var o,a,s,u,c,l,d,f,h,p,m,g,v,y;return Oe(this,function(b){switch(b.label){case 0:return o=Date.now(),[4,LA(e,t,{width:24,height:24})];case 1:return a=b.sent(),i.stage2_extractImagePatches=Date.now()-o,o=Date.now(),s=a.map(function(w){var E=_re(w,r);return w.dispose(),E}),i.stage2_rnet=Date.now()-o,u=s.length>1?an(s.map(function(w){return w.scores})):s[0].scores,d=(l=Array).from,[4,u.data()];case 2:return c=d.apply(l,[b.sent()]),u.dispose(),f=c.map(function(w,E){return{score:w,idx:E}}).filter(function(w){return w.score>n}).map(function(w){var E=w.idx;return E}),h=f.map(function(w){return t[w]}),p=f.map(function(w){return c[w]}),m=[],g=[],h.length>0&&(o=Date.now(),v=Ed(h,p,.7),i.stage2_nms=Date.now()-o,y=v.map(function(w){var E=s[f[w]].regions.arraySync();return new Xx(E[0][0],E[0][1],E[0][2],E[0][3])}),g=v.map(function(w){return p[w]}),m=v.map(function(w,E){return h[w].calibrate(y[E])})),s.forEach(function(w){w.regions.dispose(),w.scores.dispose()}),[2,{boxes:m,scores:g}]}})})}function Rre(e,t){return Se(function(){var n=Kx(e,t);n=hn(n,[2,2],[2,2],"same"),n=ki(n,t.conv4,"valid"),n=Xu(n,t.prelu4_alpha);var r=xi(n,[n.shape[0],t.fc1.weights.shape[0]]),i=Qi(r,t.fc1),o=Xu(i,t.prelu5_alpha),a=Qi(o,t.fc2_1),s=Zr(Vm(a,1),1),u=Lo(cn(a,s),1),c=Qi(o,t.fc2_2),l=Qi(o,t.fc2_3),d=sn(u,1)[1];return{scores:d,regions:c,points:l}})}function Ire(e,t,n,r,i){return Te(this,void 0,void 0,function(){var o,a,s,u,c,l,d,f,h,p,m,g,v,y,b;return Oe(this,function(w){switch(w.label){case 0:return o=Date.now(),[4,LA(e,t,{width:48,height:48})];case 1:return a=w.sent(),i.stage3_extractImagePatches=Date.now()-o,o=Date.now(),s=a.map(function(E){var x=Rre(E,r);return E.dispose(),x}),i.stage3_onet=Date.now()-o,u=s.length>1?an(s.map(function(E){return E.scores})):s[0].scores,d=(l=Array).from,[4,u.data()];case 2:return c=d.apply(l,[w.sent()]),u.dispose(),f=c.map(function(E,x){return{score:E,idx:x}}).filter(function(E){return E.score>n}).map(function(E){var x=E.idx;return x}),h=f.map(function(E){var x=s[E].regions.arraySync();return new Xx(x[0][0],x[0][1],x[0][2],x[0][3])}),p=f.map(function(E,x){return t[E].calibrate(h[x])}),m=f.map(function(E){return c[E]}),g=[],v=[],y=[],p.length>0&&(o=Date.now(),b=Ed(p,m,.7,!1),i.stage3_nms=Date.now()-o,g=b.map(function(E){return p[E]}),v=b.map(function(E){return m[E]}),y=b.map(function(E,x){return Array(5).fill(0).map(function(R,S){var _=s[E].points.arraySync();return new ut(_[0][S]*(g[x].width+1)+g[x].left,_[0][S+5]*(g[x].height+1)+g[x].top)})})),s.forEach(function(E){E.regions.dispose(),E.scores.dispose(),E.points.dispose()}),[2,{boxes:g,scores:v,points:y}]}})})}var Tre=function(e){Be(t,e);function t(){return e.call(this,"Mtcnn")||this}return t.prototype.load=function(n){return Te(this,void 0,void 0,function(){return Oe(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,n)]})})},t.prototype.loadFromDisk=function(n){return Te(this,void 0,void 0,function(){return Oe(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,n)]})})},t.prototype.forwardInput=function(n,r){return r===void 0&&(r={}),Te(this,void 0,void 0,function(){var i,o,a,s,u,c,l,d,f,h,p,m,g,v,y,b,w,E,x,R,S;return Oe(this,function(_){switch(_.label){case 0:if(i=this.params,!i)throw new Error("Mtcnn - load model before inference");if(o=n.canvases[0],!o)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return a={},s=Date.now(),u=Se(function(){return vre(Zr(Dx.fromPixels(o)).toFloat())}),c=function(T){return u.dispose(),a.total=Date.now()-s,T},l=u.shape.slice(1),d=l[0],f=l[1],h=new PA(r),p=h.minFaceSize,m=h.scaleFactor,g=h.maxNumScales,v=h.scoreThresholds,y=h.scaleSteps,b=(y||wre(p,m,[d,f])).filter(function(T){var B=pb(T,[d,f]);return Math.min(B.width,B.height)>mv}).slice(0,g),a.scales=b,a.pyramid=b.map(function(T){return pb(T,[d,f])}),w=Date.now(),[4,Cre(u,b,v[0],i.pnet,a)];case 1:return E=_.sent(),a.total_stage1=Date.now()-w,E.boxes.length?(a.stage2_numInputBoxes=E.boxes.length,w=Date.now(),[4,kre(o,E.boxes,v[1],i.rnet,a)]):[2,c({results:[],stats:a})];case 2:return x=_.sent(),a.total_stage2=Date.now()-w,x.boxes.length?(a.stage3_numInputBoxes=x.boxes.length,w=Date.now(),[4,Ire(o,x.boxes,v[2],i.onet,a)]):[2,c({results:[],stats:a})];case 3:return R=_.sent(),a.total_stage3=Date.now()-w,S=R.boxes.map(function(T,B){return Xm(Cd({},new Ai(R.scores[B],new Mx(T.left/f,T.top/d,T.width/f,T.height/d),{height:d,width:f})),new ane(R.points[B].map(function(L){return L.sub(new ut(T.left,T.top)).div(new ut(T.width,T.height))}),{width:T.width,height:T.height}))}),[2,c({results:S,stats:a})]}})})},t.prototype.forward=function(n,r){return r===void 0&&(r={}),Te(this,void 0,void 0,function(){var i;return Oe(this,function(o){switch(o.label){case 0:return i=this.forwardInput,[4,wn(n)];case 1:return[4,i.apply(this,[o.sent(),r])];case 2:return[2,o.sent().results]}})})},t.prototype.forwardWithStats=function(n,r){return r===void 0&&(r={}),Te(this,void 0,void 0,function(){var i;return Oe(this,function(o){switch(o.label){case 0:return i=this.forwardInput,[4,wn(n)];case 1:return[2,i.apply(this,[o.sent(),r])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(n){return bre(n)},t.prototype.extractParams=function(n){return gre(n)},t}(Bo),Ore=.4,Pre=[new ut(1.603231,2.094468),new ut(6.041143,7.080126),new ut(2.882459,3.518061),new ut(4.266906,5.178857),new ut(9.041765,10.66308)],Nre=[117.001,114.697,97.404],Dre=function(e){Be(t,e);function t(){var n=this,r={withSeparableConvs:!0,iouThreshold:Ore,classes:["face"],anchors:Pre,meanRgb:Nre,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return n=e.call(this,r)||this,n}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return Te(this,void 0,void 0,function(){var i;return Oe(this,function(o){switch(o.label){case 0:return[4,this.detect(n,r)];case 1:return i=o.sent(),[2,i.map(function(a){return new Ai(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(DA),Qn={ssdMobilenetv1:new NA,tinyFaceDetector:new Dre,tinyYolov2:new pre,mtcnn:new Tre,faceLandmark68Net:new _A,faceLandmark68TinyNet:new Mne,faceRecognitionNet:new Wne,faceExpressionNet:new Ene,ageGenderNet:new Pne},FA=function(e){Be(t,e);function t(n,r,i){var o=e.call(this)||this;return o.parentTask=n,o.input=r,o.extractedFaces=i,o}return t}(ff),Yx=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var n,r,i=this;return Oe(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),[4,Ym(n,this.input,function(a){return Te(i,void 0,void 0,function(){return Oe(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return Qn.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=o.sent(),[2,n.map(function(a,s){return xA(a,r[s])})]}})})},t.prototype.withAgeAndGender=function(){return new eE(this,this.input)},t}(FA),Qx=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var n,r;return Oe(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),n?[4,qx(n,this.input,function(o){return Qn.faceExpressionNet.predictExpressions(o)},this.extractedFaces)]:[2];case 2:return r=i.sent(),[2,xA(n,r)]}})})},t.prototype.withAgeAndGender=function(){return new tE(this,this.input)},t}(FA),Jx=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new nE(this,this.input)},t.prototype.withFaceDescriptors=function(){return new iE(this,this.input)},t}(Yx),Zx=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new rE(this,this.input)},t.prototype.withFaceDescriptor=function(){return new oE(this,this.input)},t}(Qx),BA=function(e){Be(t,e);function t(n,r,i){var o=e.call(this)||this;return o.parentTask=n,o.input=r,o.extractedFaces=i,o}return t}(ff),eE=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var n,r,i=this;return Oe(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),[4,Ym(n,this.input,function(a){return Te(i,void 0,void 0,function(){return Oe(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return Qn.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=o.sent(),[2,n.map(function(a,s){var u=r[s],c=u.age,l=u.gender,d=u.genderProbability;return TA(OA(a,l,d),c)})]}})})},t.prototype.withFaceExpressions=function(){return new Yx(this,this.input)},t}(BA),tE=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var n,r,i,o,a;return Oe(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?[4,qx(n,this.input,function(u){return Qn.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=s.sent(),i=r.age,o=r.gender,a=r.genderProbability,[2,TA(OA(n,o,a),i)]}})})},t.prototype.withFaceExpressions=function(){return new Qx(this,this.input)},t}(BA),nE=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new Jx(this,this.input)},t.prototype.withFaceDescriptors=function(){return new iE(this,this.input)},t}(eE),rE=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new Zx(this,this.input)},t.prototype.withFaceDescriptor=function(){return new oE(this,this.input)},t}(tE),jA=function(e){Be(t,e);function t(n,r){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i}return t}(ff),iE=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var n,r;return Oe(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Ym(n,this.input,function(o){return Promise.all(o.map(function(a){return Qn.faceRecognitionNet.computeFaceDescriptor(a)}))},null,function(o){return o.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=i.sent(),[2,r.map(function(o,a){return IA(n[a],o)})]}})})},t.prototype.withFaceExpressions=function(){return new Jx(this,this.input)},t.prototype.withAgeAndGender=function(){return new nE(this,this.input)},t}(jA),oE=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var n,r;return Oe(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),n?[4,qx(n,this.input,function(o){return Qn.faceRecognitionNet.computeFaceDescriptor(o)},null,function(o){return o.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=i.sent(),[2,IA(n,r)]}})})},t.prototype.withFaceExpressions=function(){return new Zx(this,this.input)},t.prototype.withAgeAndGender=function(){return new rE(this,this.input)},t}(jA),$A=function(e){Be(t,e);function t(n,r,i){var o=e.call(this)||this;return o.parentTask=n,o.input=r,o.useTinyLandmarkNet=i,o}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Qn.faceLandmark68TinyNet:Qn.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(ff),Are=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var n,r,i,o,a,s=this;return Oe(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return n=u.sent(),r=n.map(function(c){return c.detection}),this.input instanceof Lt?[4,$x(this.input,r)]:[3,3];case 2:return o=u.sent(),[3,5];case 3:return[4,jx(this.input,r)];case 4:o=u.sent(),u.label=5;case 5:return i=o,[4,Promise.all(i.map(function(c){return s.landmarkNet.detectLandmarks(c)}))];case 6:return a=u.sent(),i.forEach(function(c){return c instanceof Lt&&c.dispose()}),[2,n.map(function(c,l){return Xm(c,a[l])})]}})})},t.prototype.withFaceExpressions=function(){return new Jx(this,this.input)},t.prototype.withAgeAndGender=function(){return new nE(this,this.input)},t.prototype.withFaceDescriptors=function(){return new iE(this,this.input)},t}($A),Mre=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var n,r,i,o,a;return Oe(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?(r=n.detection,this.input instanceof Lt?[4,$x(this.input,[r])]:[3,3]):[2];case 2:return o=s.sent(),[3,5];case 3:return[4,jx(this.input,[r])];case 4:o=s.sent(),s.label=5;case 5:return i=o,[4,this.landmarkNet.detectLandmarks(i[0])];case 6:return a=s.sent(),i.forEach(function(u){return u instanceof Lt&&u.dispose()}),[2,Xm(n,a)]}})})},t.prototype.withFaceExpressions=function(){return new Zx(this,this.input)},t.prototype.withAgeAndGender=function(){return new rE(this,this.input)},t.prototype.withFaceDescriptor=function(){return new oE(this,this.input)},t}($A),VA=function(e){Be(t,e);function t(n,r){r===void 0&&(r=new Km);var i=e.call(this)||this;return i.input=n,i.options=r,i}return t}(ff),Lre=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var n,r,i,o;return Oe(this,function(a){switch(a.label){case 0:return n=this,r=n.input,i=n.options,i instanceof PA?[4,Qn.mtcnn.forward(r,i)]:[3,2];case 1:return[2,a.sent().map(function(s){return s.detection})];case 2:if(o=i instanceof AA?function(s){return Qn.tinyFaceDetector.locateFaces(s,i)}:i instanceof Km?function(s){return Qn.ssdMobilenetv1.locateFaces(s,i)}:i instanceof Gx?function(s){return Qn.tinyYolov2.locateFaces(s,i)}:null,!o)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,o(r)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var n=this;return new Promise(function(r){return Te(n,void 0,void 0,function(){var i;return Oe(this,function(o){switch(o.label){case 0:return[4,this.run()];case 1:return i=o.sent(),[2,r(i.map(function(a){return Cd({},a)}))]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new Are(this.runAndExtendWithFaceDetections(),this.input,n)},t.prototype.withFaceExpressions=function(){return new Yx(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new eE(this.runAndExtendWithFaceDetections(),this.input)},t}(VA),Fre=function(e){Be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var n,r;return Oe(this,function(i){switch(i.label){case 0:return[4,new Lre(this.input,this.options)];case 1:return n=i.sent(),r=n[0],n.forEach(function(o){o.score>r.score&&(r=o)}),[2,r]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var n=this;return new Promise(function(r){return Te(n,void 0,void 0,function(){var i;return Oe(this,function(o){switch(o.label){case 0:return[4,this.run()];case 1:return i=o.sent(),[2,r(i?Cd({},i):void 0)]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new Mre(this.runAndExtendWithFaceDetection(),this.input,n)},t.prototype.withFaceExpressions=function(){return new Qx(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new tE(this.runAndExtendWithFaceDetection(),this.input)},t}(VA);function Bre(e,t){return t===void 0&&(t=new Km),new Fre(e,t)}function jre(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map(function(i,o){return i-r[o]}).reduce(function(i,o){return i+Math.pow(o,2)},0))}(function(){function e(t,n){n===void 0&&(n=.6),this._distanceThreshold=n;var r=Array.isArray(t)?t:[t];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var i=1,o=function(){return"person "+i++};this._labeledDescriptors=r.map(function(a){if(a instanceof ph)return a;if(a instanceof Float32Array)return new ph(o(),[a]);if(a.descriptor&&a.descriptor instanceof Float32Array)return new ph(o(),[a.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(t,n){return n.map(function(r){return jre(r,t)}).reduce(function(r,i){return r+i},0)/(n.length||1)},e.prototype.matchDescriptor=function(t){var n=this;return this.labeledDescriptors.map(function(r){var i=r.descriptors,o=r.label;return new lk(o,n.computeMeanDistance(t,i))}).reduce(function(r,i){return r.distance<i.distance?r:i})},e.prototype.findBestMatch=function(t){var n=this.matchDescriptor(t);return n.distance<this.distanceThreshold?n:new lk("unknown",n.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},e.fromJSON=function(t){var n=t.labeledDescriptors.map(function(r){return ph.fromJSON(r)});return new e(n,t.distanceThreshold)},e})();function WA(e,t){var n=new ws(t.width,t.height),r=n.width,i=n.height;if(r<=0||i<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:r,height:i}));if(Array.isArray(e))return e.map(function(s){return WA(s,{width:r,height:i})});if(EA(e)){var o=e.detection.forSize(r,i),a=e.unshiftedLandmarks.forSize(o.box.width,o.box.height);return Xm(Cd(e,o),a)}return oA(e)?Cd(e,e.detection.forSize(r,i)):e instanceof Sd||e instanceof Ai?e.forSize(r,i):e}const $re=(e,t)=>{const n=O.useRef(!1),r=O.useRef(!1),i=224,o=.4,a=()=>!!Qn.tinyFaceDetector.params&&!!Qn.faceLandmark68TinyNet.params,s=()=>new AA({inputSize:i,scoreThreshold:o}),u=(d,f)=>{const{positions:h}=d.landmarks,p=h[36],m=h[45],g=h[48],v=h[54],y=h[51],b=h[57],w=d.alignedRect.box.width,E=d.alignedRect.box.height,x=d.alignedRect.box.x,R=d.alignedRect.box.y;f.fillStyle="blue",f.fillRect(x,R,w,E),f.fillStyle="white",f.beginPath(),f.arc(p.x,p.y,w*.1,0,Math.PI*2),f.arc(m.x,m.y,w*.1,0,Math.PI*2),f.fill(),f.fillStyle="black",f.beginPath(),f.arc(p.x,p.y,w*.05,0,Math.PI*2),f.arc(m.x,m.y,w*.05,0,Math.PI*2),f.fill(),f.fillStyle="red",f.fillRect(g.x,y.y,v.x-g.x,(b.y-y.y)/2),f.fillStyle="white",f.fillRect(g.x,y.y+(b.y-y.y)/2,v.x-g.x,(b.y-y.y)/2)},c=()=>r.current===!1?(r.current=!0,Promise.all([Qn.tinyFaceDetector.loadFromUri("/weights"),Qn.faceLandmark68TinyNet.loadFromUri("/weights")]).then(()=>{r.current=!1})):Promise.reject(),l=async()=>{var f,h;if(!n.current){(h=(f=t.current)==null?void 0:f.getContext("2d"))==null||h.clearRect(0,0,t.current.width,t.current.height);return}if(!e.current){setTimeout(()=>l(),1e3);return}if(!r.current&&!a()){c().then(l);return}const d=s();Bre(e.current,d).withFaceLandmarks(!0).run().then(p=>{if(!p)return;const m=mne(t.current,e.current),g=WA(p,m),v=t.current.getContext("2d");g&&u(g,v)}).then(()=>l())};return O.useEffect(()=>{l()},[]),{shouldRenderMask:n,drawMask:l}},mk=30,Vre=(e,t,n,r,i)=>{const o=O.useRef(!0),a=O.useRef(),s=O.useRef(),{joinSession:u,publishMedia:c,unpublishMedia:l,index:d,connectionId:f,subscribers:h,isPublisher:p,publisher:m,shouldPublish:g}=gK(),{shouldRenderMask:v,drawMask:y}=$re(n,i),b=R=>{R&&v.current!==R&&g?(v.current=!0,y()):R||(v.current=!1)},w=()=>{var R,S;console.log("CLEAR"),a.current&&clearTimeout(a.current),a.current=void 0,console.log(s.current,(R=s.current)==null?void 0:R.getTracks()),(S=s.current)==null||S.getTracks().forEach(_=>{_.stop(),s.current.removeTrack(_)}),s.current=void 0,n.current&&(n.current.onplay=null)};O.useEffect(()=>()=>{w()},[]);const E=()=>{var R;if(!n.current.paused&&!n.current.ended){const S=(R=r.current)==null?void 0:R.getContext("2d");S==null||S.drawImage(n.current,0,0,r.current.width,r.current.height),v.current&&(S==null||S.drawImage(i.current,0,0,r.current.width,r.current.height))}requestAnimationFrame(E)},x=async()=>{const R=await navigator.mediaDevices.getUserMedia({video:!0});n.current.onplay=()=>{E()},n.current.srcObject=R,s.current=R};return O.useEffect(()=>{if(!g){l();return}x().then(()=>{const R=r.current.captureStream(mk).getVideoTracks().at(0);if(!R)throw new Error("NOMEDIA");R.contentHint="motion",o.current=!0,c(R,void 0,!e,!t,mk)})},[g]),{joinSession:u,index:d,isPublisher:p,publisher:m,subscribers:h,connectionId:f,setRenderMask:b}},Wre=e=>{const[t,n]=O.useState([]),r=O.useRef(null),i=a=>{n(s=>[...s,a].slice(-40))};return O.useEffect(()=>{const a=new WebSocket("wss://i11a706.p.ssafy.io/battle-people/ws"),s=new Vw({webSocketFactory:()=>a,debug:u=>console.log(u),reconnectDelay:5e3,heartbeatIncoming:4e3,heartbeatOutgoing:4e3,onConnect:()=>{console.log("Connected to chat server"),s.subscribe(`/topic/chat/${e}`,u=>{const c=JSON.parse(u.body);i(c)})},onStompError:u=>{console.error("STOMP error",u)}});return s.activate(),r.current=s,()=>{n([]),r.current&&(r.current.deactivate(),r.current=null)}},[e]),{messages:t,sendMessage:(a,s)=>{if(r.current&&r.current.connected){const u={userId:a,message:s};r.current.publish({destination:`/app/chat/${e}`,body:JSON.stringify(u)})}else console.error("Unable to send message: STOMP client is not connected.")}}},Ure=async e=>{try{const t=await We.get(`/vote/live-user-vote-result/${e}`);return console.log(t.data),t.data}catch(t){throw console.error("Failed to fetch user vote opinion:",t),t}},zre=(e,t)=>{const[n,r]=O.useState({totalCount:0,opinions:[{index:0,opinion:"",count:0,percentage:50},{index:1,opinion:"",count:0,percentage:50}],userVoteOpinion:-1}),[i,o]=O.useState(-1);O.useEffect(()=>{(async()=>{try{const c=await Ure(t);c.code==="success"&&c.data?(r(c.data),o(c.data.userVoteOpinion)):console.error("Failed to fetch vote info:",c.msg)}catch(c){console.error("Error fetching vote info:",c)}})()},[t]);const a=O.useCallback(u=>{r(c=>({...c,opinions:u}))},[]),s=O.useCallback((u,c)=>{if(e&&e.connected){const l={type:"vote",data:{userId:u,voteInfoIndex:c}};e.publish({destination:`/app/live/${t}`,body:JSON.stringify(l)}),console.log("Vote 요청 전송됨:",l)}else console.error("요청을 보낼 수 없습니다: STOMP 클라이언트가 연결되지 않았습니다.")},[e,t]);return{choice:i,setChoice:o,voteState:n,handleVote:a,sendVote:s}},Hre=(e,t)=>{const[n,r]=O.useState([]),i=O.useCallback(a=>{r(s=>[...s,a])},[]),o=O.useCallback((a,s,u)=>{if(e&&e.connected){const c={type:"item",data:{userId:a,targetIndex:s,itemCode:u}};e.publish({destination:`/app/live/${t}`,body:JSON.stringify(c)}),console.log("Item 요청 전송됨:",c)}else console.error("요청을 보낼 수 없습니다: STOMP 클라이언트가 연결되지 않았습니다.")},[e,t]);return{items:n,handleItem:i,sendItem:o}},Gre=e=>{const t=O.useRef(null),{voteState:n,handleVote:r,sendVote:i,choice:o,setChoice:a}=zre(t.current,e),{handleItem:s,sendItem:u}=Hre(t.current,e);return O.useEffect(()=>{const c=new WebSocket("wss://i11a706.p.ssafy.io/battle-people/ws"),l=new Vw({webSocketFactory:()=>c,debug:d=>console.log(d),reconnectDelay:5e3,heartbeatIncoming:4e3,heartbeatOutgoing:4e3,onConnect:()=>{console.log("서버에 연결되었습니다."),l.subscribe(`/topic/live/${e}`,d=>{const f=JSON.parse(d.body);switch(console.log(f),f.type){case"speak":break;case"vote":r(f.responseDto.map(({index:h,opinion:p,count:m,percentage:g})=>({index:h,opinion:p,count:m,percentage:g})));break;case"item":s(f.responseDto);break;default:console.warn("알 수 없는 메시지 타입:",f.type)}})},onStompError:d=>{console.error("STOMP 오류",d)}});return l.activate(),t.current=l,()=>{t.current&&(t.current.deactivate(),t.current=null)}},[e,r,s]),{voteState:n,sendVote:i,sendItem:u,choice:o,setChoice:a}};function qre(){var I,N;hm();const e=xn(),[t,n]=O.useState(""),[r,i]=O.useState(!1),[o,a]=O.useState(!1),[s,u]=O.useState(!1),[c,l]=O.useState(),[d,f]=O.useState(!0),h=O.useRef(null),p=O.useRef(null),m=O.useRef(null),{joinSession:g,subscribers:v,index:y,publisher:b,setRenderMask:w}=Vre(o,s,h,p,m),E=(I=Pn().user)==null?void 0:I.id,{battleId:x}=ML(),{messages:R,sendMessage:S}=Wre(x),{voteState:_,sendVote:T,choice:B,setChoice:L}=Gre(x),k=()=>{a(j=>!j)},D=()=>{u(j=>(w(!j),!j))};O.useEffect(()=>{g(x)},[x,g]),O.useEffect(()=>{b==null||b.publishAudio(!o)},[o]),O.useEffect(()=>{f(!0),(async()=>{if(x&&E)try{const[P]=await Promise.all([_o.getWaitDetail(x)]);if(P.code==="fail"||!P.data){$e.error("라이브 데이터를 가져오지 못했습니다."),e("/");return}l(P.data),f(!1)}catch{$e.error("데이터를 가져오는 중 오류가 발생했습니다.")}})()},[x,e,E]);const F=O.useCallback(j=>{n(j)},[]),M=(j,P)=>{T(j,P)};return C.jsxs(C.Fragment,{children:[C.jsx(Ba,{}),C.jsx("video",{ref:h,autoPlay:!0,muted:!0,className:"fixed invisible w-[640px] h-[480px]",children:C.jsx("track",{kind:"captions"})}),C.jsx("canvas",{ref:p,className:"fixed w-[640px] h-[480px] invisible"}),C.jsx("canvas",{ref:m,className:"fixed w-[640px] h-[480px] invisible"}),C.jsxs("div",{className:"flex flex-col",children:[C.jsxs("div",{className:"flex-1 flex mt-16 px-8 pt-8",children:[!d&&C.jsx(a9,{duration:Math.floor((new Date(c.endDate).getTime()-Date.now())/1e3),onTimeOver:()=>i(!0)}),C.jsxs("div",{className:"flex-col w-full justify-center items-center h-144",children:[C.jsx(u9,{choice:B,setChoice:L,userId:E,role:y,voteState:_,title:(c==null?void 0:c.title)||"",optionA:(c==null?void 0:c.registerUser.opinion)||"",optionB:(c==null?void 0:c.oppositeUser.opinion)||"",handleVote:M,onVoteEnd:F}),C.jsx(i9,{subscribers:v,registerUser:c==null?void 0:c.registerUser,oppositeUser:c==null?void 0:c.oppositeUser}),C.jsx(e9,{isMicMuted:o,isVideoDisabled:s,canUseItem:((N=b==null?void 0:b.stream.connection.serverData)==null?void 0:N.role)==="SPEAKER"||!1,onMicClick:k,onVideoClick:D})]}),C.jsx("div",{className:"flex flex-col h-160 w-1/4 ms-6",children:C.jsx(f9,{messages:R,sendMessage:S,userId:E})})]}),r&&C.jsx(v9,{winner:t})]})]})}const Xre="/assets/person_blue-BH0U8p1X.png",Kre="/assets/person_orange-CPDgAd21.png",Yre={id:0,nickname:"",imgUrl:Kre,opinion:"No opinion"},Qre={id:0,nickname:"",imgUrl:Xre,opinion:"No opinion"};function Jre({data:e,onClose:t}){if(!e)return null;const{title:n,detail:r,opinions:i}=e;return C.jsx(xw,{title:"밸런스게임 상세보기",infoText:n,summary:r,onClose:t,borderColor:"#fbca27",children:C.jsx(Qv,{registerUser:Yre,oppositeUser:Qre,speechBubbleColor:"#fbca27",status:"balance",opinions:i})})}const Zre=J.div`
	border: 4px solid #000000;
	padding: 16px;
	margin: 12px 16px;
	width: 500px;
	border-radius: 10px;
	background-color: #ffffff;
	position: relative;
	cursor: pointer;
`,eie=J.div`
	margin-bottom: 16px;
	font-size: 1.5rem;
	display: flex;
	align-items: center;
	justify-content: center;
	text-align: center;
	width: 100%;
`,UA=J.div`
	display: flex;
	align-items: center;
	margin: 8px 0;
	cursor: ${e=>e.disabled?"not-allowed":"pointer"};
	height: 60px;
	position: relative;
	width: 100%;
`,tie=J.div`
	cursor: pointer;
	transition: all 0.15s;
	background-color: #303030;
	color: white;
	padding: 0.5rem 1rem;
	border-radius: 100%;
	border-bottom-width: 4px;
	border-color: #000000;
	border-style: solid;
	font-weight: bold;
	font-size: 1.5rem;
	box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
	margin-right: 10px;

	&:hover {
		filter: brightness(110%);
		transform: translateY(-1px);
		border-bottom-width: 6px;
	}

	&:active {
		filter: brightness(90%);
		transform: translateY(2px);
		border-bottom-width: 2px;
	}
`,nie=RT`
  from {
    background-size: 0% 100%;
  }
  to {
    background-size: 100% 100%;
  }
`,zA=J.div`
	flex-grow: 1;
	padding: 8px;
	border: 3px solid ${e=>e.borderColor};
	border-radius: 14px;
	color: #000000;
	text-align: center;
	font-size: 1.2rem;
	height: 3rem;
	display: flex;
	align-items: center;
	justify-content: center;
	position: relative;
	z-index: 1;
	background: linear-gradient(
		to right,
		${e=>e.bgColor} ${e=>e.width}%,
		transparent ${e=>e.width}%
	);
	background-size: 0 100%;
	background-repeat: no-repeat;
	animation: ${nie} 1s forwards;
`,rie=J.div`
	font-size: 1.3rem;
	font-weight: bold;
	color: ${e=>e.color};
	margin-right: 15px;
	width: 50px;
	text-align: right;
`;function iie({opinions:e,onVote:t}){return C.jsx(C.Fragment,{children:e.map((n,r)=>C.jsxs(UA,{onClick:()=>t(r),disabled:!1,children:[C.jsx(tie,{bgColor:r===0?"#F66C23":"#0B68EC",children:r===0?"A":"B"}),C.jsx(zA,{borderColor:r===0?"#F66C23":"#0B68EC",bgColor:"transparent",width:0,children:n.opinion})]},n.index))})}const oie="/assets/like-Bkc9ovWl.png",aie=J.img`
	width: 30px;
	height: 30px;
	margin-right: 8px;
`;function HA({opinions:e,userVote:t=null}){const[n,r]=O.useState(!1);return O.useEffect(()=>{const i=setTimeout(()=>{r(!0)},0);return()=>clearTimeout(i)},[]),C.jsx(C.Fragment,{children:e.map(i=>C.jsxs(UA,{disabled:!0,children:[C.jsxs(rie,{color:i.index===0?"#F66C23":"#0B68EC",children:[i.percentage,"%"]}),C.jsxs(zA,{borderColor:i.index===0?"#F66C23":"#0B68EC",bgColor:i.index===0?"#F66C23":"#0B68EC",width:n?i.percentage:0,children:[t===i.index&&C.jsx(aie,{src:oie,alt:"Like"}),i.opinion]})]},i.index))})}HA.defaultProps={userVote:null};const sie="/assets/fireExtinguisher-CQAwZ38g.gif",gv={getBalanceGames:async(e,t=6,n=0,r=10)=>{try{return(await We.get("/balance-game",{params:{page:n,size:r,category:e,status:t}})).data}catch(i){throw console.error("Failed to fetch balance games:",i),i}},createBalanceGame:async e=>{try{return(await We.post("/balance-game",e)).data}catch(t){throw console.error("Failed to create balance game:",t),t}},deleteBalanceGame:async()=>{try{return(await We.delete("/balance-game")).data}catch(e){throw console.error("Failed to delete balance game:",e),e}},getBalanceGameById:async e=>{try{return(await We.get(`/balance-game/${e}`)).data}catch(t){throw console.error(`Failed to fetch balance game with id ${e}:`,t),t}},voteBalanceGame:async(e,t)=>{try{return(await We.post(`/vote/user-vote-balance-game/${e}`,null,{params:{voteOpinionIndex:t}})).data}catch(n){throw console.error("Failed to submit vote:",n),n}}},gk=J.img`
	width: 50px;
	height: 50px;
	margin-right: 8px;
`;function uie({data:e,onVote:t,disabled:n,isEnded:r}){const[i,o]=O.useState(e.userVote!==null&&e.userVote!==void 0),[a,s]=O.useState(!1),[u,c]=O.useState(null),[l,d]=O.useState(!1),f=xn(),{isLogin:h,user:p}=Pn(),m=async()=>{d(!0);try{const y=await gv.getBalanceGameById(e.id.toString());c(y.data),s(!0)}catch(y){console.error("Failed to fetch balance game details:",y)}finally{d(!1)}},g=y=>{if(!h||!p){$e.error("로그인이 필요합니다",{autoClose:1e3}),f("/login");return}if(i||n)return;const b=e.opinions.find(w=>w.index===y);if(!b){console.error("Selected opinion not found");return}o(!0),t(e.id,[b])},v=()=>{s(!1),c(null)};return C.jsxs(C.Fragment,{children:[C.jsxs(Zre,{children:[C.jsxs(eie,{onClick:m,children:[r&&C.jsx(gk,{src:sie,alt:"Ended"}),!r&&C.jsx(gk,{src:dm,alt:"Ing"}),e.title]}),i||n?C.jsx(HA,{opinions:e.opinions,userVote:e.userVote}):C.jsx(iie,{opinions:e.opinions,onVote:g})]}),l&&C.jsx("div",{children:"Loading..."}),a&&u&&C.jsx(Jre,{data:{...u,detail:u.detail??"No details available"},onClose:v})]})}const cie=J.div`
	display: flex;
	justify-content: center;
	align-items: center;
	width: 100%;
`,lie=J.div`
	display: grid;
	grid-template-columns: repeat(1, 1fr);
	gap: 10px;
	width: 100%;
	max-width: 1050px;
	padding: 0 10px;

	@media (min-width: 640px) {
		grid-template-columns: repeat(2, 1fr);
	}
`;function die(){const[e,t]=O.useState("전체"),[n,r]=O.useState("live"),[i,o]=O.useState([]),[a,s]=O.useState(!1),[u,c]=O.useState(0),[l,d]=O.useState(!0),f=xn(),{isLogin:h,user:p}=Pn(),m=b=>{t(b),c(0),o([]),d(!0)},g=b=>{n!==b&&(r(b),c(0),o([]),d(!0))},v=O.useCallback(()=>{window.innerHeight+document.documentElement.scrollTop+100>=document.documentElement.scrollHeight&&!a&&l&&c(b=>b+1)},[l,a]);O.useEffect(()=>{(async()=>{var w,E;if(!(a||!l)){s(!0);try{const x=e==="전체"||(w=gn.find(T=>T.name===e))==null?void 0:w.id,R=n==="live"?5:6,_=((E=(await gv.getBalanceGames(x,R,u,7)).data)==null?void 0:E.map(T=>{if(T.id===void 0)throw new Error("Invalid data: id is undefined");return{id:T.id,title:T.title,opinions:T.opinions,currentState:T.currentState,startDate:T.startDate,endDate:T.endDate,category:T.category,userVote:T.userVote??null}}))||[];_.length>0?o(T=>[...T,..._]):d(!1)}catch(x){console.error("Failed to fetch balance games:",x)}finally{s(!1)}}})()},[e,n,u]),O.useEffect(()=>(window.addEventListener("scroll",v),()=>{window.removeEventListener("scroll",v)}),[v]);const y=async(b,w)=>{var E;if(!h){$e.error("로그인이 필요합니다",{autoClose:1e3}),f("/login");return}console.log("유저 아이디",p);try{const x=(E=w[0])==null?void 0:E.index;if(x===void 0){console.error("Invalid opinion selection");return}const R=await gv.voteBalanceGame(b,x);if(console.log("응답 데이터:",R),R.data&&R.data.opinions){const S=R.data.opinions;o(_=>_.map(T=>T.id===b?{...T,opinions:S,userVote:x}:T))}else console.error("Unexpected response format:",R)}catch(x){console.error("Failed to submit vote:",x)}};return C.jsxs("div",{children:[C.jsx(Ba,{}),C.jsxs("div",{className:"p-10 pt-20",children:[C.jsx(fm,{boardName:"모닥불",categories:gn,selectedCategory:e,onCategorySelect:m,selectedStatus:n,onStatusSelect:g,boardIcon:VP}),C.jsx(cie,{children:C.jsx(lie,{children:i.map(b=>{const w=b.currentState===6;return C.jsx(uie,{data:b,onVote:y,disabled:n==="ended",isEnded:w},b.id)})})})]}),C.jsx(Uw,{strokeColor:"#000000",fillColor:"#F66C23",defaultForm:"general"})]})}const fie=J.div`
	width: 100%;
	cursor: pointer;
	position: relative;
	transition: 300ms;
	color: #000000;
	overflow: visible;
	flex: 1;
`,hie=J.div`
	background-color: #ffffff;
	padding: 12px 16px;
	border-radius: 15px;
	border: 3.5px solid ${({isOpen:e})=>e?"#f66c23":"#000000"};
	font-size: 14px;
	display: flex;
	align-items: center;
	justify-content: space-between;
	outline: none;
	color: #000000;
	transition: border-color 300ms;
	box-sizing: border-box; /* Ensure padding and border are included in total width */
`,pie=J.svg`
	height: 16px;
	width: 16px;
	fill: #000000;
	transition: 300ms;
	transform: ${({isOpen:e})=>e?"rotate(0deg)":"rotate(-90deg)"};
	transform-origin: center;
	transform: scale(1.5)
		${({isOpen:e})=>e?"rotate(0deg)":"rotate(-90deg)"};
`,vie=J.div`
	display: ${({isOpen:e})=>e?"flex":"none"};
	flex-direction: column;
	border-radius: 5px;
	padding: 5px;
	background-color: #ffffff;
	position: absolute;
	top: 100%;
	left: 0;
	width: 100%;
	transition: 200ms;
	z-index: 1000;
	box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
	max-height: 200px;
	overflow-y: auto;
`,mie=J.div`
	border-radius: 5px;
	padding: 12px 16px;
	transition: 300ms;
	background-color: #ffffff;
	font-size: 14px;
	color: #000000;
	cursor: pointer;
	&:hover {
		background-color: #f0f0f0;
	}
`;function yv(e){const{options:t,defaultOption:n,onSelect:r}=e,[i,o]=O.useState(n),[a,s]=O.useState(!1),u=()=>{s(!a)},c=l=>{o(l),s(!1),r&&r(l)};return C.jsxs(fie,{children:[C.jsxs(hie,{onClick:u,isOpen:a,children:[i,C.jsx(pie,{viewBox:"0 0 24 24",isOpen:a,children:C.jsx("path",{d:"M7 10l5 5 5-5z"})})]}),C.jsx(vie,{isOpen:a,className:"custom-scrollbar",children:t.map(l=>C.jsx(mie,{onClick:()=>c(l),children:l},l))})]})}yv.defaultProps={onSelect:()=>{}};const GA=J.form`
	margin-top: 16px;
	max-width: 800px;
	margin: 0 auto;
`,pn=J.div`
	margin-top: 13px;
	display: flex;
	flex-direction: column;
`,Pu=J.div`
	margin-top: 13px;
	display: flex;
	align-items: center;
	justify-content: space-between;
	gap: 15px;
`,Wn=J.label`
	color: #000000;
	margin-bottom: 8px;
	font-size: 17px;
	display: block;
`,yi=J.input`
	border-radius: 15px;
	border: 3.5px solid #000000;
	padding: 12px 16px;
	color: #000000;
	font-size: 14px;
	outline: none;
	flex: 1;
	box-sizing: border-box;

	&:focus {
		border-color: #f66c23;
	}
`,qA=J.textarea`
	width: 100%;
	border-radius: 15px;
	border: 3.5px solid #000000;
	color: #000000;
	padding: 12px 16px;
	font-size: 14px;
	outline: none;
	box-sizing: border-box;

	&:focus {
		border-color: #f66c23;
	}
`,XA=J.div`
	display: flex;
	justify-content: flex-end;
`,KA=J.button`
	margin-top: 16px;
	background-color: #000000;
	color: white;
	border-radius: 15px;
	padding: 8px 16px;
	cursor: pointer;
	border: none;

	&:hover {
		background-color: #f66c23;
	}
`,vr=J.span`
	color: #f66c23;
	font-size: 0.8rem;
	margin-left: 8px;
`;function gie(){var y;const e=xn(),[t,n]=O.useState(""),[r,i]=O.useState(""),[o,a]=O.useState(""),[s,u]=O.useState(""),[c,l]=O.useState(""),[d,f]=O.useState({title:!1,category:!1,optionA:!1,optionB:!1,details:!1}),h=gn.filter(b=>b.name!=="전체").map(b=>b.name),p=b=>{i(b),f(w=>({...w,category:!1}))},g=(y=Po().state)==null?void 0:y.user,v=async b=>{var _;b.preventDefault();const w={title:!t,category:!r,optionA:!o,optionB:!s,details:!c};if(Object.values(w).some(T=>T)){f(w);return}const E=(_=gn.find(T=>T.name===r))==null?void 0:_.id;if(E===void 0){console.error("Invalid category selected");return}const S={...{title:t,detail:c,startDate:new Date().toISOString(),endDate:new Date(Date.now()+36e5).toISOString(),category:E},opinions:[{index:0,opinion:o},{index:1,opinion:s}].map(T=>T.opinion)};console.log("Data to be sent:",S);try{const T=await gv.createBalanceGame(S);console.log("Form submitted successfully:",T),e("/bonfire")}catch(T){console.error("Failed to submit form:",T)}};return C.jsxs(GA,{onSubmit:v,children:[C.jsx(pn,{children:C.jsxs(Pu,{children:[C.jsxs(pn,{style:{flex:2},children:[C.jsxs(Wn,{htmlFor:"title",children:["제목",d.title&&C.jsx(vr,{children:" 필수 입력 사항입니다."})]}),C.jsx(yi,{id:"title",type:"text",placeholder:"제목을 입력하세요",value:t,maxLength:16,onChange:b=>{n(b.target.value),f(w=>({...w,title:!1}))}})]}),C.jsxs(pn,{style:{flex:1},children:[C.jsxs(Wn,{htmlFor:"category",children:["카테고리",d.category&&C.jsx(vr,{children:" 필수 입력 사항입니다."})]}),C.jsx(yv,{options:h,defaultOption:"카테고리 선택",onSelect:p})]})]})}),C.jsxs(pn,{children:[C.jsx(Wn,{htmlFor:"author",children:"작성자 닉네임"}),C.jsx(yi,{id:"author",type:"text",value:(g==null?void 0:g.nickname)||"",placeholder:"닉네임을 입력하세요",disabled:!0,style:{cursor:"default"}})]}),C.jsxs(Pu,{children:[C.jsxs(pn,{style:{flex:1},children:[C.jsxs(Wn,{htmlFor:"optionA",children:["선택지 A",d.optionA&&C.jsx(vr,{children:" 필수 입력 사항입니다."})]}),C.jsx(yi,{id:"optionA",type:"text",placeholder:"선택지 A를 입력하세요",value:o,maxLength:16,onChange:b=>{a(b.target.value),f(w=>({...w,optionA:!1}))}})]}),C.jsxs(pn,{style:{flex:1},children:[C.jsxs(Wn,{htmlFor:"optionB",children:["선택지 B",d.optionB&&C.jsx(vr,{children:" 필수 입력 사항입니다."})]}),C.jsx(yi,{id:"optionB",type:"text",placeholder:"선택지 B를 입력하세요",value:s,maxLength:16,onChange:b=>{u(b.target.value),f(w=>({...w,optionB:!1}))}})]})]}),C.jsxs(pn,{children:[C.jsxs(Wn,{htmlFor:"details",children:["토론 상세 정보 작성",d.details&&C.jsx(vr,{children:" 필수 입력 사항입니다."})]}),C.jsx(qA,{id:"details",placeholder:"상세 정보를 입력하세요",value:c,onChange:b=>{l(b.target.value),f(w=>({...w,details:!1}))}})]}),C.jsx(XA,{children:C.jsx(KA,{type:"submit",children:"등록"})})]})}const yie=J.div`
	display: flex;
	flex-direction: column;
	border-radius: 5px;
	padding: 5px;
	background-color: #ffffff;
	position: absolute;
	top: 100%;
	left: 0;
	width: 100%;
	z-index: 1000;
	box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
	max-height: 200px; /* 고정 크기 */
	overflow-y: auto; /* 스크롤 추가 */
	/* Optional: Custom scrollbar styling */
	&::-webkit-scrollbar {
		width: 8px;
	}
	&::-webkit-scrollbar-thumb {
		background-color: #000000;
		border-radius: 10px;
	}
	&::-webkit-scrollbar-thumb:hover {
		background-color: #aaaaaa;
	}
	&::-webkit-scrollbar-track {
		background-color: #f0f0f0;
		border-radius: 10px;
	}
`,bie=J.div`
	border-radius: 5px;
	padding: 12px 16px;
	transition: 300ms;
	background-color: #ffffff;
	font-size: 14px;
	color: #000000;
	cursor: pointer;
	&:hover {
		background-color: #f0f0f0;
	}
`,wie=async e=>{try{return(await Kn.searchUserByNickname(e)).data||[]}catch(t){return console.error("Error fetching user suggestions: ",t),[]}};function xie(){var j;const e=xn(),t=gn.filter(P=>P.name!=="전체").map(P=>P.name),r=(j=Po().state)==null?void 0:j.user,[i,o]=O.useState(""),[a,s]=O.useState(""),[u,c]=O.useState(""),[l,d]=O.useState(null),[f,h]=O.useState([]),[p,m]=O.useState(""),[g,v]=O.useState(""),[y,b]=O.useState("10"),[w,E]=O.useState(""),[x,R]=O.useState(""),[S,_]=O.useState({title:!1,category:!1,opponent:!1,authorChoice:!1,startTime:!1,duration:!1,maxParticipants:!1,details:!1}),T=P=>{s(P),_(A=>({...A,category:!1}))},B=P=>{b(P),_(A=>({...A,duration:!1}))},L=()=>{const P=new Date;P.setMinutes(P.getMinutes()+3);const A=P.getFullYear(),U=String(P.getMonth()+1).padStart(2,"0"),H=String(P.getDate()).padStart(2,"0"),q=String(P.getHours()).padStart(2,"0"),Q=String(P.getMinutes()).padStart(2,"0");return`${A}-${U}-${H}T${q}:${Q}`},k=P=>{const A=new Date(P.target.value),U=new Date(L());A<U?($e.error("라이브 개최 시간은 최소 3분 이후로 설정해주세요.",{autoClose:1500}),v(L())):(v(P.target.value),_(H=>({...H,startTime:!1})))},D=O.useMemo(()=>HB(async P=>{const A=await wie(P);h(A)},300),[]),F=O.useCallback(P=>D(P),[D]),M=P=>{const A=P.target.value;c(A),_(U=>({...U,opponent:!1})),d(null),F(A)},I=P=>{c(P.nickname),d(P.id),h([])},N=async P=>{var re;P.preventDefault();const A={title:!i,category:!a,opponent:!u||l===null,authorChoice:!p,startTime:!g,duration:!y,maxParticipants:!w||parseInt(w,10)<5||parseInt(w,10)>99,details:!x};if(Object.values(A).some(Z=>Z)){_(A);return}const U=(re=gn.find(Z=>Z.name===a))==null?void 0:re.id;if(U===void 0){console.error("Invalid category selected");return}if(l===null){alert("상대방 닉네임을 찾을 수 없습니다.");return}const H=5,q=new Date(g),Q=new Date(q.getTime()+parseInt(y,10)*6e4),V={title:i,detail:x,startDate:q.toISOString(),endDate:Q.toISOString(),time:parseInt(y,10),category:U,oppositeUserId:l,opinion:p,minPeopleCount:H,maxPeopleCount:parseInt(w,10),battleRule:""};console.log("Data to be sent:",V);try{console.log("Sending data to the server...",V);const Z=await V1.inviteBattle(V);console.log("Received response from server:",Z),Z.code==="fail"?alert(Z.msg):(console.log("Battle invitation sent successfully:",Z),e("/fanning"),$e.info("배틀 신청이 성공적으로 전달되었습니다!",{autoClose:1500}))}catch(Z){console.error("Failed to invite to battle:",Z),$e.error("이미 해당시간에 예정된 배틀이 존재합니다.",{autoClose:1500})}};return C.jsxs(GA,{onSubmit:N,children:[C.jsx(pn,{children:C.jsxs(Pu,{children:[C.jsxs(pn,{style:{flex:2},children:[C.jsxs(Wn,{htmlFor:"title",children:["제목",S.title&&C.jsx(vr,{children:" 필수 입력 사항입니다."})]}),C.jsx(yi,{id:"title",type:"text",placeholder:"제목을 입력하세요",value:i,maxLength:16,onChange:P=>{o(P.target.value),_(A=>({...A,title:!1}))}})]}),C.jsxs(pn,{style:{flex:1},children:[C.jsxs(Wn,{htmlFor:"category",children:["카테고리",S.category&&C.jsx(vr,{children:" 필수 입력 사항입니다."})]}),C.jsx(yv,{options:t,defaultOption:"카테고리 선택",onSelect:T})]})]})}),C.jsxs(Pu,{children:[C.jsxs(pn,{style:{flex:1},children:[C.jsx(Wn,{htmlFor:"author",children:"작성자 닉네임"}),C.jsx(yi,{id:"author",type:"text",value:(r==null?void 0:r.nickname)||"",placeholder:"닉네임을 입력하세요",disabled:!0})]}),C.jsxs(pn,{style:{flex:1,position:"relative"},children:[C.jsxs(Wn,{htmlFor:"opponent",children:["상대방 닉네임",S.opponent&&u&&l===null?C.jsx(vr,{children:" 등록되지 않은 사용자입니다."}):S.opponent&&C.jsx(vr,{children:" 필수 입력 사항입니다."})]}),C.jsx(yi,{id:"opponent",type:"text",placeholder:"상대방 닉네임을 입력하세요",value:u,onChange:M}),f.length>0&&C.jsx(yie,{children:f.map(P=>C.jsx(bie,{onClick:()=>I(P),children:P.nickname},P.id))})]})]}),C.jsxs(Pu,{children:[C.jsxs(pn,{style:{flex:1},children:[C.jsxs(Wn,{htmlFor:"authorChoice",children:["작성자 선택지",S.authorChoice&&C.jsx(vr,{children:" 필수 입력 사항입니다."})]}),C.jsx(yi,{id:"authorChoice",type:"text",maxLength:16,placeholder:"작성자 선택지를 입력하세요",value:p,onChange:P=>{m(P.target.value),_(A=>({...A,authorChoice:!1}))}})]}),C.jsxs(pn,{style:{flex:1},children:[C.jsx(Wn,{htmlFor:"opponentChoice",children:"상대방 선택지"}),C.jsx(yi,{id:"opponentChoice",type:"text",placeholder:"상대방 선택지는 상대방이 작성합니다.",value:"",disabled:!0,style:{cursor:"not-allowed"}})]})]}),C.jsxs(Pu,{children:[C.jsxs(pn,{style:{flex:2},children:[C.jsxs(Wn,{htmlFor:"startTime",children:["라이브 시작 시간",S.startTime&&C.jsx(vr,{children:" 필수 입력 사항입니다."})]}),C.jsx(yi,{id:"startTime",type:"datetime-local",min:L(),value:g,onChange:k,placeholder:"라이브 시작 시간을 입력하세요"})]}),C.jsxs(pn,{style:{flex:1},children:[C.jsxs(Wn,{htmlFor:"duration",children:["분",S.duration&&C.jsx(vr,{children:" 필수 입력 사항입니다."})]}),C.jsx(yv,{options:["10","20","30","40","50","60"],defaultOption:"10",onSelect:B})]}),C.jsxs(pn,{style:{flex:1},children:[C.jsxs(Wn,{htmlFor:"maxParticipants",children:["최대 인원 수",S.maxParticipants&&C.jsx(vr,{children:" 필수 입력 사항입니다."})]}),C.jsx(yi,{id:"maxParticipants",type:"number",placeholder:"최대 인원 수",value:w,min:5,max:99,onChange:P=>{E(P.target.value),_(A=>({...A,maxParticipants:!1}))}})]})]}),C.jsxs(pn,{children:[C.jsxs(Wn,{htmlFor:"details",children:["토론 상세 정보 작성",S.details&&C.jsx(vr,{children:" 필수 입력 사항입니다."})]}),C.jsx(qA,{id:"details",placeholder:"상세 정보를 입력하세요",value:x,onChange:P=>{R(P.target.value),_(A=>({...A,details:!1}))}})]}),C.jsx(XA,{children:C.jsx(KA,{type:"submit",children:"등록"})})]})}const Eie=J.div`
	min-height: 100vh;
	margin-top: 100px;
`,Sie=J.div`
	max-width: 768px;
	margin: 0 auto;
	padding: 24px;
	border-radius: 18px;
	margin-top: 32px;
	border: 3.5px solid #000000;
	margin-bottom: 50px;
`,Cie=J.div`
	display: flex;
	align-items: center;
	justify-content: space-between;
	margin-bottom: 24px;
`,_ie=J.h1`
	font-size: 1.5rem;
`,kie=J.div`
	display: flex;
	gap: 16px;
`,Rie=J.div`
	position: relative;
	display: flex;
	align-items: center;
	cursor: pointer;
	padding: 8px;
	border-radius: 8px;
	transition: all 0.3s ease;

	&:focus {
		outline: none;
	}
`,Iie=J.input`
	position: absolute;
	opacity: 0;
	width: 0;
	height: 0;
	cursor: pointer;
`,Tie=J.span`
	position: relative;
	margin-right: 8px;
	display: inline-block;
	width: 16px;
	height: 16px;
	border: 2px solid ${({isSelected:e})=>e?"#f66c23":"#333"};
	border-radius: 50%;
	transition: all 0.3s ease;

	${({isSelected:e})=>e&&ui`
			&::after {
				content: "";
				position: absolute;
				top: 50%;
				left: 50%;
				width: 8px;
				height: 8px;
				background-color: #f66c23;
				border-radius: 50%;
				transform: translate(-50%, -50%);
				transition: all 0.3s ease;
			}
		`}
`;function Oie({defaultForm:e="general"}){var a;hm();const n=((a=Po().state)==null?void 0:a.defaultForm)||e,[r,i]=O.useState(n),o=(s,u)=>{(s.key==="Enter"||s.key===" ")&&i(u)};return C.jsxs(Eie,{children:[C.jsx(Ba,{}),C.jsxs(Sie,{children:[C.jsxs(Cie,{children:[C.jsx(_ie,{children:"새로운 토론 주제 등록"}),C.jsx(kie,{children:["general","live"].map(s=>C.jsxs(Rie,{isSelected:r===s,onClick:()=>i(s),onKeyPress:u=>o(u,s),tabIndex:0,role:"button",children:[C.jsx(Iie,{type:"radio",name:"formType",value:s,checked:r===s,onChange:()=>i(s)}),C.jsx(Tie,{isSelected:r===s}),C.jsx("span",{children:s==="general"?"밸런스 게임":"라이브 개최"})]},s))})]}),r==="general"&&C.jsx(gie,{}),r==="live"&&C.jsx(xie,{})]})]})}const Pie="/assets/edit-DrUiXord.png";function Nie(){const e=xn(),t=Po(),[n,r]=O.useState("");O.useEffect(()=>{const o=[{label:"Win Rate",value:""},{label:"Created Lives",value:"created-lives"},{label:"Participated Votes",value:"participated-votes"},{label:"Interests",value:"interests"}],a=t.pathname.split("/").pop();a&&o.some(s=>s.value===a)&&r(a)},[t.pathname]);const i=o=>{r(o),e(`/my-page/${o}`)};return C.jsxs("div",{className:"mypage-content-container",children:[C.jsx("ul",{className:"tabs-navigation",role:"tablist",children:[{label:"승률",value:""},{label:"개최한 라이브",value:"created-lives"},{label:"참여한 투표",value:"participated-votes"},{label:"관심사",value:"interests"}].map(({label:o,value:a})=>C.jsx("li",{role:"presentation",children:C.jsx("a",{href:`#tabs-${a}`,className:`tab-link ${n===a?"active":""}`,role:"tab","aria-selected":n===a,onClick:s=>{s.preventDefault(),i(a)},children:o})},a))}),C.jsxs("div",{className:"mypage-content",children:[C.jsx(KL,{})," "]})]})}const Die="/assets/pen-CR_F_2Oi.png";function Aie(){hm();const e=xn(),[t,n]=O.useState(!1),[r,i]=O.useState(!1),[o,a]=O.useState({nickname:""}),[s,u]=O.useState(!1),c=O.useRef(null),l=O.useRef(new FormData),{user:d,setUser:f}=Pn();O.useEffect(()=>{d||e("/login",{replace:!0})},[d,e]);const[h,p]=O.useState((d==null?void 0:d.imgUrl)||ss),[m,g]=O.useState((d==null?void 0:d.nickname)||""),[v,y]=O.useState((d==null?void 0:d.nickname)||""),b=(d==null?void 0:d.email)||"",w=()=>{t&&((async()=>{const D=d==null?void 0:d.imgUrl;p(D||ss)})(),a({nickname:""})),n(!t)},E=()=>{i(!0)},x=k=>{const D=k.target.value;if(D.length<=12&&g(D),D===v){a({nickname:""});return}if(!D){a({nickname:"닉네임을 입력해 주세요."});return}Kn.checkNicknameAvailability(D).then(F=>{a(F?{nickname:""}:{nickname:"이미 사용 중인 닉네임입니다."})})},R=async()=>{if(!m){u(!0),a({nickname:"닉네임을 입력해 주세요."}),setTimeout(()=>u(!1),500);return}if(m===v){i(!1);return}if(o.nickname){u(!0),setTimeout(()=>u(!1),500);return}try{await Kn.updateUserProfile({...d,nickname:m}),y(m),i(!1),f({...d,nickname:m}),$e.info("닉네임이 수정되었습니다.",{autoClose:1e3})}catch{u(!0),setTimeout(()=>u(!1),500)}},S=()=>{g(v),a({nickname:""}),i(!1)},_=async()=>{try{const k=await Kn.uploadProfileImage(l.current);if(k.code==="success"&&k.data){const D=k.data;p(D||ss),d.imgUrl=D,f(d)}await Kn.updateUserProfile(d),n(!1),$e.info("프로필이 저장되었습니다.",{autoClose:1e3})}catch{u(!0),setTimeout(()=>u(!1),500)}},T=()=>{t&&c.current&&c.current.click()},B=()=>{p(ss)},L=k=>{var F;const D=(F=k.target.files)==null?void 0:F[0];if(D){const M=["image/jpeg","image/png","image/gif"];if(console.log(D.type),!M.includes(D.type)){$e.error("이미지 파일 형식이 아닙니다. jpg, jpeg, png, gif 형식의 파일만 업로드할 수 있습니다.",{autoClose:1500}),c.current&&(c.current.value=""),B();return}l.current.set("file",D);const I=new FileReader;I.onload=()=>{I.result&&p(I.result)},I.readAsDataURL(D)}c.current&&(c.current.value="")};return C.jsxs("div",{children:[C.jsx(Ba,{}),C.jsxs("div",{className:"mypage-container",children:[C.jsxs("div",{className:"mypage-header",children:[C.jsx("div",{className:"left-section",children:C.jsxs("div",{className:"profile-section",children:[C.jsxs("div",{className:"profile-img-container",children:[C.jsx("img",{className:`profile-img ${t?"darken":""}`,src:h,alt:"프로필 이미지",onClick:T,onError:B,onKeyDown:k=>{(k.key==="Enter"||k.key===" ")&&T()},role:"button",tabIndex:t?0:-1}),t&&C.jsx("img",{className:"edit-icon",src:Pie,alt:"편집 아이콘",onClick:T,onKeyDown:k=>{(k.key==="Enter"||k.key===" ")&&T()},role:"button",tabIndex:0})]}),C.jsx("input",{type:"file",ref:c,style:{display:"none"},onChange:L,accept:"image/*"}),C.jsxs("div",{className:"button-group",children:[C.jsx("button",{className:"edit-btn",onClick:w,children:t?"Cancel":"Edit"}),t&&C.jsx("button",{onClick:_,className:`save-btn ${s?"shake":""}`,children:"Save"})]})]})}),C.jsx("div",{className:"right-section",children:C.jsxs("div",{className:"profile-info",children:[C.jsx("label",{children:"이메일"}),C.jsx("input",{type:"text",value:b,readOnly:!0}),C.jsxs("label",{children:["닉네임",!r&&C.jsx("img",{className:"edit-icon-small",src:Die,alt:"닉네임 수정",onClick:E,onKeyDown:k=>{(k.key==="Enter"||k.key===" ")&&E()},role:"button",tabIndex:0})]}),C.jsxs("div",{className:"input-with-error",children:[C.jsx("input",{type:"text",name:"nickname",value:m,onChange:x,readOnly:!r,maxLength:12,className:r?"editable":""}),r&&C.jsxs("div",{className:"nickname-edit-buttons",children:[C.jsx("button",{onClick:R,className:`save-btn ${s?"shake":""}`,style:{backgroundColor:"#1D3D6B",color:"#fff"},children:"저장"}),C.jsx("button",{onClick:S,children:"취소"})]}),o.nickname&&C.jsx("div",{className:"error-message",children:o.nickname})]})]})})]}),C.jsx(Nie,{})]})]})}var YA={exports:{}},Mie="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Lie=Mie,Fie=Lie;function QA(){}function JA(){}JA.resetWarningCache=QA;var Bie=function(){function e(r,i,o,a,s,u){if(u!==Fie){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:JA,resetWarningCache:QA};return n.PropTypes=n,n};YA.exports=Bie();var jie=YA.exports;const Qm=Ms(jie);function yk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function El(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?yk(Object(n),!0).forEach(function(r){$ie(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yk(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function $ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ay(e,t){return function(n){if(Array.isArray(n))return n}(e)||function(n,r){var i=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(i!=null){var o,a,s=[],u=!0,c=!1;try{for(i=i.call(n);!(u=(o=i.next()).done)&&(s.push(o.value),!r||s.length!==r);u=!0);}catch(l){c=!0,a=l}finally{try{u||i.return==null||i.return()}finally{if(c)throw a}}return s}}(e,t)||function(n,r){if(n){if(typeof n=="string")return bk(n,r);var i=Object.prototype.toString.call(n).slice(8,-1);if(i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set")return Array.from(n);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return bk(n,r)}}(e,t)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function bk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wc=O.createContext(),Vie=function(){var e=O.useContext(Wc),t=e.id,n=e.unit,r=e.number,i=e.counter,o=e.textPosition,a=e.fontSize,s=e.fontWeight,u=e.fontColor;return r?we.createElement("text",{x:"50%",y:"50%",fontSize:a,fontWeight:s,fill:u,textAnchor:"middle",dy:o},we.createElement("tspan",{className:"circular-percent-".concat(t)},i),we.createElement("tspan",{className:"circular-unit-".concat(t)},n)):null},Wie=function(){var e=O.useContext(Wc),t=e.stroke,n=e.fill,r=e.round,i=e.inverse,o=e.strokeBottom,a=e.cut,s=e.rotation,u=e.colorCircle,c=e.strokeDasharray,l=264-2.64*(100-a);return we.createElement("circle",{cx:"50",cy:"50",r:"42",shapeRendering:"geometricPrecision",fill:n,style:{transform:"rotate(".concat(s,"deg)"),transformOrigin:"50% 50%"},stroke:u,strokeWidth:o||t,strokeLinecap:r&&!c?"round":"butt",strokeDashoffset:i?-l:l,strokeDasharray:a?264:c})},Uie=function(e){var t=e.children,n=O.useContext(Wc),r=n.id,i=n.size,o=n.counter;return we.createElement("svg",{role:"progressbar",width:i,height:i,"data-index":r,viewBox:"0 0 100 100","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":o,"aria-labelledby":"circular progress bar"},t)},zie=function(e){var t=e.index,n=O.useContext(Wc).linearGradient,r=-100,i="linear-gradient-".concat(t);return we.createElement("defs",null,we.createElement("linearGradient",{id:i},n.map(function(o,a){return r+=100,we.createElement("stop",{key:a,offset:r/(n.length-1)+"%",stopColor:o})})))},Hie=function(){var e=O.useContext(Wc),t=e.id,n=e.rotation,r=e.linearGradient,i=e.animationSmooth,o=e.inverse,a=e.counter,s=e.stroke,u=e.round,c=e.cut,l=e.colorSlice,d=r!==void 0?"url(#linear-gradient-".concat(t||0,")"):l,f=i!==void 0?{transition:"stroke-dashoffset ".concat(i)}:"";return we.createElement(we.Fragment,null,r&&we.createElement(zie,{index:t,linearGradient:r}),we.createElement("circle",{cx:"50%",cy:"50%",r:"42",shapeRendering:"geometricPrecision",fill:"none",style:El({transform:"rotate(".concat(n,"deg)"),transformOrigin:"50% 50%"},f),stroke:d,strokeWidth:s,strokeLinecap:u?"round":"butt",strokeDashoffset:function(h,p,m){var g=264-h/100*(p?2.64*(100-p):264);return m?-g:g}(a,c,o),strokeDasharray:264}))},wk=Qm.bool,po=Qm.number,Yo=Qm.string,Gie=Qm.array,qie={percent:po.isRequired,colorSlice:Yo,colorCircle:Yo,round:wk,opacity:po,number:wk,size:po,speed:po,cut:po,rotation:po,unit:Yo,textPosition:Yo,fontSize:Yo,fill:Yo,fontWeight:po,stroke:po,strokeBottom:po,strokeDasharray:Yo,fontColor:Yo,linearGradient:Gie},vb=function(e){var t=e.children,n=e.percent,r=e.speed,i=e.animationOff,o=ay(O.useState(i?n:0),2),a=o[0],s=o[1],u=O.useRef(),c=function(p){var m=ay(O.useState(!1),2),g=m[0],v=m[1];return O.useEffect(function(){var y=new IntersectionObserver(function(b){var w=ay(b,1)[0];w.intersectionRatio>=.5&&v(w.isIntersecting)},{root:null,rootMargin:"0px",threshold:.5});return p&&p.current&&y.observe(p.current),function(){y.disconnect()}},[p]),g}(u);O.useEffect(function(){var p,m;if(c)if(i)s(n);else{var g=Number((p=u.current)===null||p===void 0||(m=p.dataset)===null||m===void 0?void 0:m.angel);if(!(n>100||n<0||g===n)){var v,y=1e3/r,b=performance.now();return v=requestAnimationFrame(function w(E){v=requestAnimationFrame(w);var x=E-b;x>=y-.1&&(b=E-x%y,g>n&&s(function(R){return R-1}),g<n&&s(function(R){return R+1}))}),function(){return cancelAnimationFrame(v)}}}},[a,i,r,c,n]);var l,d,f,h=El(El({},e),{},{counter:a});return we.createElement("div",{ref:u,style:(l=e,d=l.styles,f=l.size,El(El({},d),{},{width:f,height:f})),"data-angel":a},we.createElement(Wc.Provider,{value:h},t,we.createElement(Uie,null,e.colorCircle&&we.createElement(Wie,null),we.createElement(Hie,null),we.createElement(Vie,null))))};vb.propTypes=qie,vb.defaultProps={id:0,colorSlice:"#00a1ff",round:!1,number:!0,stroke:10,opacity:10,size:200,speed:1e3,cut:0,rotation:-90,unit:"%",textPosition:".35em",fontSize:"1.6rem",fontColor:"#000",fill:"none",fontWeight:400};const aE="/assets/empty-CSew7NfA.png";function Xie(){const[e,t]=O.useState(null),[n,r]=O.useState(!0),[i,o]=O.useState(null);if(O.useEffect(()=>{(async()=>{try{const u=await Kn.getLoginUserWinHistory();t(u)}catch{o("Failed to load win history")}finally{r(!1)}})()},[]),n)return C.jsx("div",{children:"Loading..."});if(i)return C.jsxs("div",{style:{textAlign:"center",fontSize:"x-large"},children:[C.jsx("img",{src:aE,alt:"Error",style:{marginLeft:25,marginTop:-30,width:"200px",height:"200px"}}),C.jsx("span",{children:"조회된 내역이 없습니다."})]});if(!e)return null;const a={winRate:{textAlign:"center",marginTop:"20px",display:"flex",justifyContent:"center",alignItems:"center"},winRateCircle:{display:"flex",justifyContent:"center",alignItems:"center",margin:"20px 20px 20px 0"},winRateDetails:{listStyle:"none",padding:0,fontSize:"18px",textAlign:"left",marginLeft:"20px"},winRateDetailsItem:{margin:"5px 0"}};return C.jsxs("div",{style:a.winRate,children:[C.jsx("div",{style:a.winRateCircle,children:C.jsx(vb,{colorCircle:"#ededed",colorSlice:"#1D3D6B",percent:e.winRate,fontColor:"#1D3D6B",round:!0,fontSize:"20px",textPosition:"0.35em"})}),C.jsxs("ul",{style:a.winRateDetails,children:[C.jsxs("li",{style:a.winRateDetailsItem,children:["참여한 토론의 수 : ",e.debateCnt]}),C.jsxs("li",{style:a.winRateDetailsItem,children:["승리한 토론의 수 : ",e.winCnt]}),C.jsxs("li",{style:a.winRateDetailsItem,children:["패배한 토론의 수 : ",e.loseCnt]})]})]})}const Kie=J.div`
	width: 100%;
	height: 300px;
	padding: 20px;
	overflow-y: auto;
`,Yie=J.ul`
	list-style: none;
	padding: 0;
	margin: 0;
`,Qie=J.li`
	display: flex;
	align-items: center;
	justify-content: space-between;
	border-radius: 30px;
	border: 3px solid #e0e0e0;
	padding: 5px 20px;
	margin-bottom: 10px;
	font-size: 16px;
`,Jie=J.span`
	font-size: 14px;
	color: #333;
`,Zie=J.span`
	font-size: 14px;
`,eoe=J.div`
	flex-grow: 1;
	text-align: left;
`,toe=J.div`
	display: flex;
	align-items: center;
	justify-content: flex-end;
	gap: 10px; /* 날짜와 상태 아이콘 사이의 간격 */
`;function noe(){const[e,t]=O.useState([]),[n,r]=O.useState(!0),[i,o]=O.useState(null);return O.useEffect(()=>{(async()=>{try{const u=(await Kn.getUserCreatedLives()).map(c=>{const d=pc(c.registDate,"Asia/Seoul").split(" ")[0];let f;return c.isWin===0?f="승":c.isWin===1?f="패":c.isWin===2?f="무":c.isWin===4?f="-":f="",{battleBoardId:c.battleBoardId,title:c.title,date:`${d}`,statusText:f}});t(u)}catch{o("Failed to fetch created lives")}finally{r(!1)}})()},[]),i||e.length===0?C.jsxs("div",{style:{textAlign:"center",fontSize:"x-large"},children:[C.jsx("img",{src:aE,alt:"Error",style:{marginLeft:25,marginTop:-30,width:"200px",height:"200px"}}),C.jsx("span",{children:"조회된 내역이 없습니다."})]}):n?C.jsx("div",{children:"Loading..."}):i?C.jsx("div",{children:i}):C.jsx(Kie,{className:"custom-scrollbar",children:C.jsx(Yie,{children:e.map(a=>C.jsxs(Qie,{children:[C.jsx(eoe,{children:a.title}),C.jsxs(toe,{children:[C.jsx(Jie,{children:a.date}),C.jsx(Zie,{children:a.statusText})]})]},a.battleBoardId))})})}const roe=J.div`
	width: 100%;
	height: 300px;
	padding: 20px;
	overflow-y: auto;
`,ioe=J.ul`
	list-style: none;
	padding: 0;
	margin: 0;
`,ooe=J.li`
	display: flex;
	align-items: center;
	justify-content: space-between;
	border-radius: 30px;
	border: 3px solid #e0e0e0;
	padding: 5px 20px;
	margin-bottom: 10px;
	font-size: 16px;
`,aoe=J.span`
	font-size: 14px;
	color: #333;
`,soe=J.div`
	flex-grow: 1;
	text-align: left;
`,uoe=J.div`
	display: flex;
	align-items: center;
	justify-content: flex-end;
	gap: 10px; /* 날짜와 상태 아이콘 사이의 간격 */
`,coe=J.span`
	font-size: 14px;
	color: #333;
`;function loe(){const[e,t]=O.useState([]),[,n]=O.useState(!0),[r,i]=O.useState(null);return O.useEffect(()=>{(async()=>{try{const s=(await Kn.getUserVotes()).map(u=>{const l=pc(u.registDate,"Asia/Seoul").split(" ")[0];return{id:u.id,title:u.title,date:`${l}`,detail:u.detail,statusColor:u.isWin?"#BDE3FF":"#FFC7C2",statusText:u.isWin?"승":"패"}});t(s)}catch{i("Failed to fetch user votes.")}finally{n(!1)}})()},[]),r||e.length===0?C.jsxs("div",{style:{textAlign:"center",fontSize:"x-large"},children:[C.jsx("img",{src:aE,alt:"Error",style:{marginLeft:25,marginTop:-30,width:"200px",height:"200px"}}),C.jsx("span",{children:"조회된 내역이 없습니다."})]}):C.jsx(roe,{className:"custom-scrollbar",children:C.jsx(ioe,{children:e.map(o=>C.jsxs(ooe,{children:[C.jsx(soe,{children:o.title}),C.jsxs(uoe,{children:[C.jsx(aoe,{children:o.date}),C.jsx(coe,{children:o.statusText})]})]},o.id))})})}const doe=J.div`
	text-align: center;
	padding: 20px;
`,foe=J.div`
	text-align: left;
	margin-bottom: 20px;
`,hoe=J.h2`
	font-size: 24px;
`,poe=J.p`
	font-size: 18px;
	margin-bottom: 10px;
`,voe=J.div`
	display: grid;
	grid-template-columns: repeat(4, 1fr);
	gap: 10px;
	justify-content: center;
	margin-bottom: 20px;
`,moe=J.button`
	padding: 10px 20px;
	border: 4px solid ${({isSelected:e})=>e?"#001f3f":"#999999"};
	background-color: #ffffff;
	color: ${({isSelected:e})=>e?"#001f3f":"#000000"};
	border-radius: 30px;
	cursor: pointer;
	font-size: 16px;
	transition: all 0.3s ease;
`,goe=J.button`
	grid-column: 4 / span 1;
	grid-row: 2;
	padding: 12px 20px;
	background-color: #001f3f;
	color: #fff;
	border: none;
	border-radius: 30px;
	cursor: pointer;
	font-size: 16px;

	&:hover {
		background-color: #003366;
	}
`;function yoe(){const[e,t]=O.useState([]);O.useEffect(()=>{(async()=>{try{const o=await Kn.getUserInterests();t(o)}catch(o){console.error("Failed to fetch user interests:",o)}})()},[]);const n=i=>{t(o=>o.includes(i)?o.filter(a=>a!==i):[...o,i])},r=async()=>{try{(await Kn.postUserInterests(e)).code==="success"&&$e.info("관심사 저장이 완료되었습니다.",{autoClose:1e3})}catch(i){console.error("Failed to save user interests:",i)}};return C.jsxs(doe,{children:[C.jsxs(foe,{children:[C.jsx(hoe,{children:"무엇을 좋아하세요?"}),C.jsx(poe,{children:"맞춤 컨텐츠를 우선으로 보여드립니다!"})]}),C.jsxs(voe,{children:[gn.filter(i=>i.id!==7).map(i=>C.jsx(moe,{isSelected:e.includes(i.id),onClick:()=>n(i.id),children:i.name},i.id)),C.jsx(goe,{onClick:r,children:"저장"})]})]})}const boe=rF([{path:"*",element:C.jsx(XL,{to:"/"})},{path:"/",element:C.jsx(IH,{})},{path:"/login",element:C.jsx(TH,{})},{path:"/join",element:C.jsx(OH,{})},{path:"/firework",element:C.jsx(n7,{})},{path:"/notification",element:C.jsx(a7,{})},{path:"/fanning",element:C.jsx(j7,{})},{path:"/live/:battleId",element:C.jsx(qre,{})},{path:"/bonfire",element:C.jsx(die,{})},{path:"/ignition",element:C.jsx(Oie,{})},{path:"/my-page",element:C.jsx(Aie,{}),children:[{path:"",element:C.jsx(Xie,{})},{path:"created-lives",element:C.jsx(noe,{})},{path:"participated-votes",element:C.jsx(loe,{})},{path:"interests",element:C.jsx(yoe,{})}]}]);sy.createRoot(document.getElementById("root")).render(C.jsxs(C.Fragment,{children:[C.jsx(fF,{router:boe}),C.jsx(IF,{})]}))});export default woe();
